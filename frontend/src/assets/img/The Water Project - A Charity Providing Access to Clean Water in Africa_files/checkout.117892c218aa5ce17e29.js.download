!function(){var e,t,n,i,s,a={3393:function(e,t,n){var i=n(9658);e.exports={compressPayload:function(e){var t={};return Object.keys(i).forEach((function(n){var s=n,a=i[n];t[s]=e[a]})),t},expandPayload:function(e){var t={},n=["up"],s=Object.keys(e).filter((function(e){return-1===Object.keys(i).indexOf(e)&&!n.includes(e)}));return s.length&&(t.UNMATCHED={},s.forEach((function(n){t.UNMATCHED[n]=e[n]})),t.invalid=!0),Object.keys(i).forEach((function(s){if(!n.includes(s)){var a=s,o=i[s];e[a]&&(t[o]=e[a])}})),t}}},5302:function(e,t,n){"use strict";var i,s=n(2155);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a.apply(null,arguments)}var o=function(e,t){return s.createElement("svg",a({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),i||(i=s.createElement("path",{d:"m6 9 6 6 6-6",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},r=(0,s.forwardRef)(o),l=(0,s.memo)(r);t.A=l},7998:function(e,t,n){"use strict";var i,s=n(2155);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a.apply(null,arguments)}var o=function(e,t){return s.createElement("svg",a({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),i||(i=s.createElement("path",{d:"m9.09 9c.2351-.66833.69915-1.23189 1.31-1.59087.6108-.35897 1.3289-.49019 2.0272-.37042.6983.11978 1.3316.48281 1.7879 1.02482.4562.542.706 1.22799.7049 1.93647 0 2-3 3-3 3m.08 4c.2761 0 .5-.2239.5-.5s-.2239-.5-.5-.5m0 1c-.2761 0-.5-.2239-.5-.5s.2239-.5.5-.5m0 1v-1m10-4c0 5.5228-4.4772 10-10 10-5.52285 0-10-4.4772-10-10 0-5.52285 4.47715-10 10-10 5.5228 0 10 4.47715 10 10z",stroke:"currentColor",strokeLinecap:"round"})))},r=(0,s.forwardRef)(o),l=(0,s.memo)(r);t.A=l},8480:function(e,t,n){"use strict";var i,s=n(2155);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a.apply(null,arguments)}var o=function(e,t){return s.createElement("svg",a({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),i||(i=s.createElement("path",{d:"m18 6-12 12m0-12 12 12",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},r=(0,s.forwardRef)(o),l=(0,s.memo)(r);t.A=l},2598:function(e,t,n){"use strict";var i;function s(e,t,n){const s=n-1;switch(e.code){case i.DOWN:return e.preventDefault(),null===t||t+1>s?{currentOptionIdx:0}:{currentOptionIdx:t+1};case i.UP:return e.preventDefault(),null===t||t-1<0?{currentOptionIdx:s}:{currentOptionIdx:t-1};case i.ENTER:return e.preventDefault(),{currentOptionIdx:t,needSelectOption:!0};case i.ESC:return{closeDropdown:!0,currentOptionIdx:null};default:return{currentOptionIdx:null}}}n.d(t,{J:function(){return i},t:function(){return s}}),function(e){e.DOWN="ArrowDown",e.UP="ArrowUp",e.RIGHT="ArrowRight",e.LEFT="ArrowLeft",e.TAB="Tab",e.ENTER="Enter",e.ESC="Escape",e.SPACE="Space"}(i||(i={}))},984:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var i=n(5723),s=n(851);const a=e=>{const{htmlFor:t,label:n,labelOptional:a,labelSrOnly:o,labelFloating:r,formGroupClass:l,formLabelClass:c,formControlValue:u,children:d,dataQa:h}=e;return(0,i.jsxs)("div",{className:(0,s.A)("form-group",l),children:[d,(0,i.jsxs)("label",{htmlFor:t,className:(0,s.A)("form-label",{"sr-only":o,"is-floating":r,"has-value":u},c),"data-qa":h,children:[n,a&&(0,i.jsxs)("span",{className:"font-weight-400 text-gray-60",children:[" (",a,")"]})]})]})}},6960:function(e,t,n){"use strict";n.d(t,{t:function(){return d}});var i=n(5959),s=n(5723),a=n(851),o=n(2155),r=n(984),l=n(8983),c=n(7352),u=n(1146);const d=e=>{var{label:t,labelSrOnly:n,labelFloating:d,value:h,autoFocus:m,dataQa:p,dataTestId:g,children:y,className:f,placeholder:v,formGroupClass:S,formLabelClass:E,labelOptional:A,id:C,error:b,customPrefix:P,dataTrackingElementName:N,type:D="text",autoCorrect:T="off",spellCheck:k="false",autoFocusMode:I=l.Q.DESKTOP,setRef:_,autoScroll:O,forceShowPlaceholder:x}=e,w=(0,i.Tt)(e,["label","labelSrOnly","labelFloating","value","autoFocus","dataQa","dataTestId","children","className","placeholder","formGroupClass","formLabelClass","labelOptional","id","error","customPrefix","dataTrackingElementName","type","autoCorrect","spellCheck","autoFocusMode","setRef","autoScroll","forceShowPlaceholder"]);const R=(0,o.useRef)(null);(0,c.f)({ref:R,autoFocus:m,mode:I}),(0,u.Q)(R,{shouldScroll:O,shouldFocus:!0}),(0,o.useImperativeHandle)(_,(()=>R.current),[]);const M=((e,t,n)=>n?e:t?void 0:e)(v,d,x);return(0,s.jsxs)(r.s,{htmlFor:C,label:t,labelSrOnly:n,labelFloating:d,labelOptional:A,formGroupClass:S,formLabelClass:(0,a.A)(E,{"has-error":b}),formControlValue:h,dataQa:p+"-label",children:[P,(0,s.jsx)("input",Object.assign({id:C,className:(0,a.A)("form-control",f,{"has-label-floating":d,"has-error":b}),"aria-invalid":b,ref:R,type:D,placeholder:M,value:h,autoCorrect:T,spellCheck:k,"data-qa":p,"data-testid":g,"data-tracking-element-name":N},w)),y]})}},7001:function(e,t,n){"use strict";n.d(t,{J:function(){return d}});var i=n(5723),s=n(2155);const a=e=>(0,s.useContext)(e);var o=n(5959),r=n(7376);const l=e=>{let{scrollIntoView:t,focus:n}=e;const i=(0,r.M)(),a=(0,s.useRef)(null),l=(0,s.useCallback)((()=>(0,o.sH)(void 0,void 0,void 0,(function*(){yield new Promise((e=>{i.addEventListener("scrollend",e,{once:!0}),setTimeout(e,350)})),n()}))),[i,n]);return(0,s.useEffect)((()=>{a.current={scrollIntoView:t,focus:l}}),[l,t]),a};var c=n(1146);const u=e=>t=>{let{state:n,children:a}=t;const o=(0,s.useRef)(new Set),[r,l]=(0,s.useState)(null),u=(0,s.useRef)(!1),[d,h]=(0,s.useState)(),m=(0,s.useCallback)((()=>{u.current=!0,l(null),h({})}),[]);return(0,s.useEffect)((()=>{if(u.current){for(const e of o.current)if(e.ruleFunction(n)){l(e.ref);break}u.current=!1}}),[n,d]),(0,c.Q)(r,{shouldScroll:!0,shouldFocus:!0}),(0,i.jsx)(e.Provider,{value:{fields:o.current,setTriggered:m},children:a})},d=()=>{const e=(0,s.createContext)({setTriggered:()=>{},fields:new Set});return{useAddFieldToScroll:(t,n)=>((e,t,n)=>{const{fields:i}=a(e);(0,s.useEffect)((()=>{const e={ref:t,ruleFunction:n};if(null==t?void 0:t.current)return i.add(e),()=>{i.delete(e)}}),[i,t,n])})(e,t,n),useScrollToFieldsTrigger:()=>(e=>{const{setTriggered:t}=a(e);return t})(e),useFakeStripeElement:l,ScrollToFieldsProvider:u(e)}}},2753:function(e,t,n){"use strict";n.d(t,{G:function(){return s},n:function(){return a}});var i=n(2155);const s=(0,i.createContext)(null);function a(){const e=(0,i.useContext)(s);if(!e)throw new Error("CheckoutConfiguration data is not provided");return e}},7376:function(e,t,n){"use strict";n.d(t,{M:function(){return a},U:function(){return s}});var i=n(2155);const s=(0,i.createContext)(null);function a(){const e=(0,i.useContext)(s);if(!e)throw new Error("iframe window is not provided");return e}},5493:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var i=n(2753);function s(){return(0,i.n)().infrastructureParams.isMobile}},8548:function(e,t,n){"use strict";n.d(t,{Qq:function(){return o},Tn:function(){return s},wf:function(){return a}});var i=n(2155);const s=(0,i.createContext)(null);function a(){const e=(0,i.useContext)(s);if(!e)throw new Error("Portal ref was not provided");return e}const o=(0,i.createContext)(null)},1819:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(8693),s=n(4857);function a(){const e=(0,i.C)(),t=(0,s.Q)();return e&&!1!==t}},8693:function(e,t,n){"use strict";n.d(t,{C:function(){return a},m:function(){return s}});var i=n(2155);const s=(0,i.createContext)(!1);function a(){return(0,i.useContext)(s)}},4857:function(e,t,n){"use strict";n.d(t,{C:function(){return s},Q:function(){return a}});var i=n(2155);const s=(0,i.createContext)(null);function a(){return(0,i.useContext)(s)}},6758:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var i=n(3488),s=n(2753);function a(){return(0,s.n)().infrastructureParams.OS===i.lS.IOS}},8983:function(e,t,n){"use strict";var i;n.d(t,{Q:function(){return i}}),function(e){e.DESKTOP="desktop",e.MOBILE="mobile",e.ALL="all"}(i||(i={}))},7352:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var i=n(2155),s=n(5493),a=n(1819),o=n(6758),r=n(8983),l=n(1220),c=n(322);const u=e=>{const{ref:t,autoFocus:n,mode:u,preventScroll:d=!1}=e,h=(0,a.k)(),m=(0,s.P)(),p=(0,o.j)(),g=(0,c.$)(),y=(0,l.a)();(0,i.useEffect)((()=>{if(!g&&n&&h&&y.current&&((e,t,n)=>e===r.Q.DESKTOP?!t:e!==r.Q.MOBILE||t&&!n)(u,m,p)){if(!t.current)throw new Error("ref is not provided");(()=>{const e=()=>{var e;null===(e=t.current)||void 0===e||e.focus({preventScroll:d})};"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e)})()}}),[t,n,h,m,p,g,y,u,d])}},5200:function(e,t,n){"use strict";n.d(t,{l:function(){return s}});var i=n(2753);const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,i.n)(),{browser:s,browserVersion:a}=n.infrastructureParams;if(s!==e)return!1;const o=Number(a);return!(Number.isNaN(o)||o<t)}},1769:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var i=n(2155);function s(e){const t=(0,i.useRef)(),n=(0,i.useRef)(e);(0,i.useEffect)((()=>{n.current=e}),[e]);const s=(0,i.useCallback)((()=>{window.clearTimeout(t.current)}),[]),a=(0,i.useCallback)((function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;s(),i?t.current=window.setTimeout((()=>{n.current(...e)}),i):n.current(...e)}),[s]);return(0,i.useEffect)((()=>s),[s]),{set:a,clear:s}}},1220:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var i=n(2155);function s(){const e=(0,i.useRef)(!1);return(0,i.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}},1146:function(e,t,n){"use strict";n.d(t,{Q:function(){return s}});var i=n(2155);const s=(e,t)=>{(0,i.useEffect)((()=>{var n;(null==t?void 0:t.shouldScroll)&&(null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.scrollIntoView)&&(e.current.scrollIntoView({behavior:"smooth",block:"center"}),t.shouldFocus&&e.current.focus({preventScroll:!0}))}),[null==t?void 0:t.shouldFocus,null==t?void 0:t.shouldScroll,e])}},322:function(e,t,n){"use strict";n.d(t,{$:function(){return s}});var i=n(2753);const s=()=>(0,i.n)().infrastructureParams.showcase},4528:function(e,t,n){"use strict";(this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((i=i.apply(e,t||[])).next())}))})(void 0,void 0,void 0,(function*(){if(void 0===window.ResizeObserver){window.ResizeObserver=class{observe(){}unobserve(){}disconnect(){}};const e=yield n.e(772).then(n.bind(n,2772));window.ResizeObserver=e.ResizeObserver}}))},1432:function(e,t,n){"use strict";n.d(t,{U:function(){return v}});var i,s=n(5959),a=n(5723),o=n(2155);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r.apply(null,arguments)}var l=function(e,t){return o.createElement("svg",r({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),i||(i=o.createElement("path",{d:"m12 8v4m.5 3.5c0 .2761-.2239.5-.5.5m.5-.5c0-.2761-.2239-.5-.5-.5m.5.5h-1m.5.5c-.2761 0-.5-.2239-.5-.5m.5.5v-1m-.5.5c0-.2761.2239-.5.5-.5m10-3c0 5.5228-4.4772 10-10 10-5.52285 0-10-4.4772-10-10 0-5.52285 4.47715-10 10-10 5.5228 0 10 4.47715 10 10z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},c=(0,o.forwardRef)(l),u=(0,o.memo)(c),d=n(8809),h=n(851),m=n(8548),p=n(2455),g=n(7804);const y=["top","bottom"],f=e=>{var{className:t,children:n,showTooltip:i,dataQa:o,tooltipDataQa:r}=e,l=(0,s.Tt)(e,["className","children","showTooltip","dataQa","tooltipDataQa"]);const c=(0,p.Q)(),f=(0,g.t)(),v=(0,m.wf)(),S=i?"manual":"click";return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d.S,{content:n,trigger:S,manualOpen:i,placement:c?"left":"right",fallbackPlacements:y,rootContainer:v,"data-qa":r?`${r}-tooltip-error-label`:"tooltip-error-label",children:(0,a.jsx)("button",Object.assign({type:"button",className:(0,h.A)("btn-icon font-size-18 text-red-60",t),"aria-label":f.translate("common.errorTooltipButtonAriaLabel"),"data-qa":o?`${o}-tooltip-error-trigger`:"tooltip-error-trigger"},l,{children:(0,a.jsx)(u,{className:"icon-stroke d-block","aria-hidden":!0})}))})})},v=(0,o.memo)(f)},4010:function(e,t,n){"use strict";n.d(t,{FM:function(){return s},pv:function(){return a},rp:function(){return o}});var i=n(7001);const{useAddFieldToScroll:s,useScrollToFieldsTrigger:a,ScrollToFieldsProvider:o}=(0,i.J)()},3429:function(e,t,n){"use strict";n.d(t,{FM:function(){return s},pv:function(){return a},rp:function(){return o}});var i=n(7001);const{useAddFieldToScroll:s,useScrollToFieldsTrigger:a,ScrollToFieldsProvider:o}=(0,i.J)()},2455:function(e,t,n){"use strict";n.d(t,{Q:function(){return r}});var i=n(4729),s=n(5029),a=n(2155),o=n(7804);function r(){const e=(0,o.t)();return(0,a.useMemo)((()=>(0,i.iJ)(e.language)===s.p.RTL),[e.language])}},7852:function(e,t,n){"use strict";const i=(()=>{try{return window}catch(e){return self}})(),s=(i.FUN_ENV,i.FUN_HOST||"https://api.fundraiseup.com"),a=(i.FUN_CDN,i.FUN_STATIC||"https://static.fundraiseup.com");i.FUN_STATIC_S3,n.p=a+("/"===a.slice(-1)?"":"/");var o;!function(e){e[e.BACKDROP=1]="BACKDROP",e[e.STATIC_CONFIG=2]="STATIC_CONFIG",e[e.KEYS_KEEPER=3]="KEYS_KEEPER",e[e.COLLECTOR=4]="COLLECTOR",e[e.RESOLVER=5]="RESOLVER",e[e.DEBUG=6]="DEBUG",e[e.TRACKING_URLS=7]="TRACKING_URLS",e[e.FUN_SESSION_STORAGE=8]="FUN_SESSION_STORAGE",e[e.EMBED_ELEMENTS_API=9]="EMBED_ELEMENTS_API",e[e.EMBED_CHECKOUT_API=10]="EMBED_CHECKOUT_API",e[e.EMBED_INTERNAL_API=11]="EMBED_INTERNAL_API",e[e.EMBED_FORMS_API=12]="EMBED_FORMS_API",e[e.EMBED_CONFIG=13]="EMBED_CONFIG",e[e.EMBED_TRACKER=14]="EMBED_TRACKER",e[e.FUN_EXPERIMENTS_STORAGE=15]="FUN_EXPERIMENTS_STORAGE",e[e.CHECKOUT=16]="CHECKOUT",e[e.EMBED_ELEMENTS_SERVICE=17]="EMBED_ELEMENTS_SERVICE",e[e.ELEMENTS_API=18]="ELEMENTS_API",e[e.EVENT_EMITTER=19]="EVENT_EMITTER",e[e.HTML_ELEMENT_STYLE_MANAGER=20]="HTML_ELEMENT_STYLE_MANAGER",e[e.FUN_TRACKER_STORAGE=21]="FUN_TRACKER_STORAGE",e[e.FUN_STAT_STORAGE=22]="FUN_STAT_STORAGE",e[e.FUN_COOKIES_MIGRATOR=23]="FUN_COOKIES_MIGRATOR",e[e.FUN_COOKIES_MANAGER=24]="FUN_COOKIES_MANAGER",e[e.USER_SESSION=25]="USER_SESSION",e[e.FUN_DEBUG_STORAGE=26]="FUN_DEBUG_STORAGE",e[e.SENTRY_CLIENT=27]="SENTRY_CLIENT",e[e.EXPERIMENTS_CONTROLLER=28]="EXPERIMENTS_CONTROLLER",e[e.CHECKOUT_SKELETON=29]="CHECKOUT_SKELETON",e[e.EMBED_ELEMENTS_URL_API=30]="EMBED_ELEMENTS_URL_API",e[e.CHECKOUT_STEPLESS=31]="CHECKOUT_STEPLESS",e[e.GIFT_CATALOG_CHECKOUT=32]="GIFT_CATALOG_CHECKOUT",e[e.CONSENT_MANAGER_API=33]="CONSENT_MANAGER_API",e[e.GOALS_LOADER=34]="GOALS_LOADER",e[e.EMBED_GIFT_CATALOG_API=35]="EMBED_GIFT_CATALOG_API",e[e.GIFT_CATALOG_CART=36]="GIFT_CATALOG_CART"}(o||(o={}));var r,l,c,u,d=n(5959);n(4528),function(e){e.ERROR_TYPE="error_type",e.ACTION="action",e.PAYMENT_METHOD="payment_method",e.EMBED_VERSION="embed_version"}(r||(r={})),function(e){e.CHECKOUT_INITIALIZATION_CRITICAL="Checkout Initialization Critical",e.CHECKOUT_HANGING="Checkout Hanging",e.UI_CRITICAL="UI Critical",e.STRIPE_SDK_INITIALIZATION="Stripe SDK Initialization",e.STRIPE_SDK_INTERACTION="Stripe SDK Interaction",e.PAYPAL_SDK_INITIALIZATION="Paypal SDK Initialization",e.PAYPAL_SDK_INTERACTION="Paypal SDK Interaction",e.GOOGLE_PAY_SDK_INTERACTION="Google Pay SDK Interaction",e.FORM_FLOW="Form Flow",e.WIDGET_SESSION_VALIDATION="Widget Session Validation"}(l||(l={})),function(e){e.PAYMENT_SESSION_UPDATE="Payment Session Update",e.PAYMENT_SESSION_PAY="Payment Session Pay"}(c||(c={})),function(e){e.DUMMY_EXPERIMENT="DummyExperiment",e.CHECKOUT_BUNDLE_EXPERIMENT="CheckoutBundleExperiment",e.DONOR_PORTAL_TEST_EXPERIMENT="DonorPortalTestExperiment",e.CAMPAIGN_PAGE_TEST_EXPERIMENT="CampaignPageTestExperiment",e.EMBED_TEST_EXPERIMENT="EmbedTestExperiment",e.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT="CheckoutWithoutPreDonationUpsellExperiment",e.CAMPAIGN_PAGES_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT="CampaignPagesWithoutPreDonationUpsellExperiment",e.SMART_COVERING_FEE_CHECKOUT_V_2_EXPERIMENT="SmartCoveringFeeSuggestionCheckoutExperimentV2",e.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT="SmartCoveringFeeSuggestionCampaignPagesExperimentV2",e.AA_CHECKOUT_EXPERIMENT="AACheckoutExperiment",e.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT="SmartPostDonationUpsellCheckoutV2Experiment",e.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT="SmartPostDonationUpsellCampaignPagesV2Experiment",e.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT="UpsellAmountsDatasetModalExperiment",e.UPSELL_AMOUNTS_DATASET_PAGES_EXPERIMENT="UpsellAmountsDatasetPagesExperiment",e.UPGRADE_LINKS_PAGE_AI_V_2_EXPERIMENT="UpgradeLinksPageAIv2Experiment",e.STEPLESS_MOBILE_CHECKOUT_EXPERIMENT="SteplessMobileCheckoutExperiment",e.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT="CollectDatasetPostDonationUpsellAmountCheckoutV3Experiment",e.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT="CollectDatasetPostDonationUpsellAmountCampaignPagesV3Experiment",e.SMART_PDU_CHECKOUT_V_3_EXPERIMENT="SmartPDUCheckoutV3Experiment",e.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT="SmartPDUCampaignPagesV3Experiment",e.RECURRING_FREQUENCY_HINT_CAMPAIGN_PAGES_EXPERIMENT="RecurringFrequencyHintCampaignPagesExperiment",e.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT="CheckoutStepsCampaignPagesExperiment",e.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT="CheckoutStepsCheckoutModalExperiment",e.DONOR_RATING_CHECKOUT_EXPERIMENT="DonorRatingCheckoutExperiment",e.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT="DonorRatingCampaignPagesExperiment",e.ML_DONATION_RETRY_V_3_EXPERIMENT="MlDonationRetryV3Experiment",e.AVERAGE_DONATION_HINT_EXPERIMENT="AverageDonationHintExperiment",e.AVERAGE_DONATION_HINT_CAMPAIGN_PAGES_EXPERIMENT="AverageDonationHintCampaignPagesExperiment",e.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT="FastTrackCampaignPagesExperiment",e.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT="SmartCoveringFeeCheckoutV4Experiment",e.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT="SmartCoveringFeeCampaignPagesV4Experiment",e.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT="MultipleRecurringPlanCheckoutExperiment",e.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT="AmountPresetsCheckoutV5Experiment",e.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT="AmountPresetsPagesV5Experiment",e.AMOUNT_PRESETS_DONATION_FORM_V_5_EXPERIMENT="AmountPresetsDonationFormV5Experiment",e.STRIPE_LINK_CHECKOUT_EXPERIMENT="StripeLinkCheckoutExperiment",e.STRIPE_LINK_PAGES_EXPERIMENT="StripeLinkPagesExperiment",e.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT="FeeCoverageSelectionModalExperiment",e.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT="FeeCoverageSelectionPagesExperiment",e.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT="DonateByVoiceV2ModalExperiment",e.DONATE_BY_VOICE_V2_PAGES_EXPERIMENT="DonateByVoiceV2PagesExperiment",e.DONOR_PORTAL_COLORFUL_DONATE_BUTTON_EXPERIMENT="DonorPortalColorfulDonateButtonExperiment",e.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT="UpsellScreenCampaingPageV3Experiment",e.LAPSED_DONOR_REENGAGEMENT_EXPERIMENT="LapsedDonorReengagementExperiment",e.SOFT_UPGRADE_LINKS_EXPERIMENT="SoftUpgradeLinksExperiment",e.PRE_DONATION_AMOUNTS_100_200_USD_PAGES_EXPERIMENT="PreDonationAmounts100200USDPagesExperiment",e.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT="PreDonationAmounts100200USDModalExperiment",e.DONOR_PORTAL_DONATION_SHARING_BUTTON_EXPERIMENT="DonorPortalDonationSharingButtonExperiment",e.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT="NewFontForHintToRecurringExperiment",e.QUARTERLY_UPSELL_MODAL_EXPERIMENT="QuarterlyUpsellModalExperiment",e.QUARTERLY_UPSELL_PAGES_EXPERIMENT="QuarterlyUpsellPagesExperiment",e.MOBILE_FIRST_STEP_PAGES_EXPERIMENT="MobileFirstStepPagesExperiment"}(u||(u={}));const h={[u.DUMMY_EXPERIMENT]:"33802",[u.CHECKOUT_BUNDLE_EXPERIMENT]:"61172",[u.DONOR_PORTAL_TEST_EXPERIMENT]:"68092",[u.CAMPAIGN_PAGE_TEST_EXPERIMENT]:"68383",[u.EMBED_TEST_EXPERIMENT]:"65492",[u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT]:"73814",[u.CAMPAIGN_PAGES_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT]:"73816",[u.SMART_COVERING_FEE_CHECKOUT_V_2_EXPERIMENT]:"82767-modal",[u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT]:"82767-pages",[u.AA_CHECKOUT_EXPERIMENT]:"77715",[u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT]:"79870-modal",[u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT]:"79870-pages",[u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT]:"87159-modal",[u.UPSELL_AMOUNTS_DATASET_PAGES_EXPERIMENT]:"87159-pages",[u.UPGRADE_LINKS_PAGE_AI_V_2_EXPERIMENT]:"87190",[u.STEPLESS_MOBILE_CHECKOUT_EXPERIMENT]:"60395",[u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT]:"89924-modal",[u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT]:"89924-pages",[u.SMART_PDU_CHECKOUT_V_3_EXPERIMENT]:"89260-modal",[u.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT]:"89260-pages",[u.RECURRING_FREQUENCY_HINT_CAMPAIGN_PAGES_EXPERIMENT]:"59392-pages",[u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT]:"133620-pages",[u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT]:"133620-modal",[u.DONOR_RATING_CHECKOUT_EXPERIMENT]:"99706-modal",[u.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT]:"99706-pages",[u.ML_DONATION_RETRY_V_3_EXPERIMENT]:"99145",[u.AMOUNT_PRESETS_DONATION_FORM_V_5_EXPERIMENT]:"115114-DF",[u.AVERAGE_DONATION_HINT_EXPERIMENT]:"101523-modal",[u.AVERAGE_DONATION_HINT_CAMPAIGN_PAGES_EXPERIMENT]:"101523-pages",[u.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT]:"101284-pages",[u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT]:"113277-pages",[u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT]:"113277-modal",[u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT]:"114635-modal",[u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT]:"115114-modal",[u.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT]:"115114-pages",[u.DONOR_PORTAL_COLORFUL_DONATE_BUTTON_EXPERIMENT]:"120437",[u.STRIPE_LINK_CHECKOUT_EXPERIMENT]:"115596-modal",[u.STRIPE_LINK_PAGES_EXPERIMENT]:"115596-pages",[u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT]:"101219-modal",[u.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT]:"101219-pages",[u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT]:"138976-modal",[u.DONATE_BY_VOICE_V2_PAGES_EXPERIMENT]:"138976-pages",[u.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT]:"118987",[u.LAPSED_DONOR_REENGAGEMENT_EXPERIMENT]:"120522",[u.SOFT_UPGRADE_LINKS_EXPERIMENT]:"124937",[u.PRE_DONATION_AMOUNTS_100_200_USD_PAGES_EXPERIMENT]:"135267-pages",[u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT]:"135267-modal",[u.DONOR_PORTAL_DONATION_SHARING_BUTTON_EXPERIMENT]:"119139",[u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT]:"141481",[u.QUARTERLY_UPSELL_MODAL_EXPERIMENT]:"133727-modal",[u.QUARTERLY_UPSELL_PAGES_EXPERIMENT]:"133727-pages",[u.MOBILE_FIRST_STEP_PAGES_EXPERIMENT]:"141253"};var m,p,g,y,f,v,S,E,A,C,b,P,N,D,T,k,I,_,O,x,w,R,M,L,F,U,j,B,G,q,V,H,K,Y,z,W,$,X,Q,Z,J,ee,te,ne,ie,se,ae,oe,re,le,ce,ue,de,he,me,pe,ge,ye,fe,ve,Se,Ee,Ae;Object.values(h),function(e){e.BILLING="billing",e.EMBED="embed",e.CAMPAIGN_PAGES="campaignPages",e.DONOR_PORTAL="donorPortal",e.EMAILS="emails"}(m||(m={})),function(e){e.CONTROL="control",e.TEST="test"}(p||(p={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3"}(g||(g={})),function(e){e.CONTROL="control",e.TEST="test"}(y||(y={})),function(e){e.CONTROL="control",e.TEST="test"}(f||(f={})),function(e){e.CONTROL="control",e.TEST="test"}(v||(v={})),function(e){e.CONTROL="control",e.TEST="test"}(S||(S={})),function(e){e.CONTROL="control",e.TEST="test"}(E||(E={})),function(e){e.CONTROL="control",e.TEST="test"}(A||(A={})),function(e){e.CONTROL="control",e.TEST="test"}(C||(C={})),function(e){e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3"}(b||(b={})),function(e){e.CONTROL="control",e.TEST="test"}(P||(P={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(N||(N={})),function(e){e.CONTROL="control",e.TEST="test"}(D||(D={})),function(e){e.CONTROL="control",e.TEST="test"}(T||(T={})),function(e){e.CONTROL="control",e.TEST="test"}(k||(k={})),function(e){e.CONTROL="control",e.TEST="test"}(I||(I={})),function(e){e.CONTROL="control",e.TEST="test"}(_||(_={})),function(e){e.CONTROL="control",e.TEST="test"}(O||(O={})),function(e){e.CONTROL="control",e.TEST="test"}(x||(x={})),function(e){e.CONTROL="control",e.TEST="test"}(w||(w={})),function(e){e.CONTROL="control",e.TEST="test"}(R||(R={})),function(e){e.CONTROL="control",e.TEST="test"}(M||(M={})),function(e){e.CONTROL="control",e.TEST="test"}(L||(L={})),function(e){e.CONTROL="control",e.TEST="test"}(F||(F={})),function(e){e.DEVELOPMENT="development",e.PRODUCTION="production",e.STAGING="staging",e.TESTING="testing"}(U||(U={})),function(e){e.CONTROL="control",e.TEST="test"}(j||(j={})),function(e){e.CONTROL="control",e.TEST="test"}(B||(B={})),function(e){e.CONTROL="control",e.TEST="test"}(G||(G={})),function(e){e.CONTROL="control",e.TEST="test"}(q||(q={})),function(e){e.CONTROL="control",e.TEST="test"}(V||(V={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(H||(H={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(K||(K={})),function(e){e.CONTROL="control",e.TEST="test"}(Y||(Y={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3",e.TEST_4="test-4"}(z||(z={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3"}(W||(W={})),function(e){e.CONTROL="control",e.TEST="test"}($||($={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(X||(X={})),function(e){e.CONTROL="control",e.TEST="test"}(Q||(Q={})),function(e){e.CONTROL="control",e.TEST="test"}(Z||(Z={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(J||(J={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3",e.TEST_4="test-4"}(ee||(ee={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2",e.TEST_3="test-3",e.TEST_4="test-4"}(te||(te={})),function(e){e.CONTROL="control",e.TEST="test"}(ne||(ne={})),function(e){e.CONTROL="control",e.TEST="test"}(ie||(ie={})),function(e){e.CONTROL="control",e.TEST="test"}(se||(se={})),function(e){e.CONTROL="control",e.TEST="test"}(ae||(ae={})),function(e){e.CONTROL="control",e.TEST="test"}(oe||(oe={})),function(e){e.CONTROL="control",e.TEST="test"}(re||(re={})),function(e){e.CONTROL="control",e.TEST="test"}(le||(le={})),function(e){e.CONTROL="control",e.TEST="test"}(ce||(ce={})),function(e){e.CONTROL="control",e.TEST="test"}(ue||(ue={})),function(e){e.CONTROL="control",e.TEST="test"}(de||(de={})),function(e){e.CONTROL="control",e.TEST="test"}(he||(he={})),function(e){e.CONTROL="control",e.TEST="test"}(me||(me={})),function(e){e.CONTROL="control",e.TEST="test"}(pe||(pe={})),function(e){e.CONTROL="control",e.TEST_1="test-1",e.TEST_2="test-2"}(ge||(ge={})),function(e){e.CONTROL="control",e.TEST="test"}(ye||(ye={})),function(e){e.CONTROL="control",e.TEST="test"}(fe||(fe={})),function(e){e.CONTROL="control",e.TEST="test"}(ve||(ve={})),function(e){e.AUSTRALIA="AU",e.AUSTRIA="AT",e.BELGIUM="BE",e.BRAZIL="BR",e.BULGARIA="BG",e.CANADA="CA",e.CROATIA="HR",e.CYPRUS="CY",e.CZECH_REPUBLIC="CZ",e.DENMARK="DK",e.ESTONIA="EE",e.FINLAND="FI",e.FRANCE="FR",e.GERMANY="DE",e.GREECE="GR",e.HONG_KONG="HK",e.HUNGARY="HU",e.INDIA="IN",e.INDONESIA="ID",e.IRELAND="IE",e.ITALY="IT",e.JAPAN="JP",e.LATVIA="LV",e.LITHUANIA="LT",e.LUXEMBOURG="LU",e.MALAYSIA="MY",e.MALTA="MT",e.MEXICO="MX",e.NETHERLANDS="NL",e.NEW_ZEALAND="NZ",e.NORWAY="NO",e.POLAND="PL",e.PORTUGAL="PT",e.ROMANIA="RO",e.SINGAPORE="SG",e.SLOVAKIA="SK",e.SLOVENIA="SI",e.SPAIN="ES",e.SWEDEN="SE",e.SWITZERLAND="CH",e.THAILAND="TH",e.UNITED_ARAB_EMIRATES="AE",e.UNITED_KINGDOM="GB",e.UNITED_STATES="US",e.GIBRALTAR="GI",e.LIECHTENSTEIN="LI",e.PHILIPPINES="PH",e.ISRAEL="IL"}(Se||(Se={}));class Ce{constructor(e){this.window=e,this.hideTimeout=null,this.hiddenElementsList=[],this.elementsSelectorList=[".s.u.m.o"]}hideAll(){const e=()=>{this.elementsSelectorList.forEach((e=>{this.window.document.querySelectorAll(e).forEach(this.hideNode.bind(this))}))};e(),this.hideTimeout=this.window.setInterval(e,1e3)}restoreAll(){this.hideTimeout&&clearTimeout(this.hideTimeout),this.hiddenElementsList.forEach((({node:e,style:t})=>{null===t?e.removeAttribute("style"):e.setAttribute("style",t)})),this.hiddenElementsList=[]}hideNode(e){this.hiddenElementsList.some((t=>t.node===e))||(this.hiddenElementsList.push({node:e,style:e.getAttribute("style")}),e.setAttribute("style","display: none;"))}}!function(e){e.CHECKOUT_STEPLESS_SECTION_VIEW="checkoutSectionView",e.CAMPAIGN_PAGES_GOAL_METER_VIEW="campaignGoalMeterView",e.CAMPAIGN_PAGES_COOKIE_BANNER_VIEW="cookieBannerView",e.CAMPAIGN_PAGES_COOKIE_BANNER_PREFERENCES_VIEW="manageCookieView",e.CAMPAIGN_PAGES_COOKIE_BANNER_PREFERENCES_CONFIRM="confirmMyPreferences",e.CAMPAIGN_PAGES_WEB_VITALS_METRICS="campaignPagesWebVitalsMetrics",e.DONATION_CURRENCY_SELECTED="selectCurrency",e.WEB_SHARE_API_MORE_OPTIONS_ABORTED="shareMoreOptionsAborted",e.POST_DONATION_CELEBRATION_ANIMATION_SHOWN="postDonationCelebrationAnimationShown",e.ML_DEFAULT_FREQUENCY_V3_RESPONSE="checkoutDefaultFrequencyResponseV3",e.EXPERIMENT_TEST_GROUP_EXPOSED="testGroupExposed",e.EXPERIMENT_DONOR_RATING_BANNER_TRIGGER="donorRatingBannerTrigger",e.EXPERIMENT_DONOR_RATING_UPSELL_TOOLTIP_TRIGGER="donorRatingUpsellTooltipTrigger",e.EXPERIMENT_DONOR_RATING_UPSELL_CLICK="donorRatingUpsellClick",e.EXPERIMENT_ML_AMOUNT_PRESETS_RESPONSE="checkoutPresetsResponse",e.EXPERIMENT_ML_AMOUNT_PRESETS_V5_RESPONSE="checkoutPresetsResponseV5",e.EXPERIMENT_ML_PRE_DONATION_UPSELL_RESPONSE="preDonationUpsellMlResponse",e.EXPERIMENT_ML_PRE_DONATION_UPSELL_AMOUNT_SUGGESTION="UpsellAmountSuggestion",e.EXPERIMENT_ML_PRE_DONATION_UPSELL_V2_RESPONSE="preDonationUpsellMlV2Response",e.EXPERIMENT_ML_SMART_COVERING_FEE_V2_RESPONSE="smartCoveringFeeV2Response",e.EXPERIMENT_ML_SMART_COVERING_FEE_V4_RESPONSE="smartCoveringFeeV4Response",e.EXPERIMENT_ML_POST_DONATION_UPSELL_AMOUNT_SUGGESTION="postDonationUpsellAmountSuggestion",e.EXPERIMENT_ML_POST_DONATION_UPSELL_COLLECT_DATASET_AMOUNT_STRATEGY="PDUAmountStrategy",e.PAYMENT_METHOD_PERSONAL_DATA_VALIDATION_ERROR="paymentMethodPersonalDataValidationError",e.ADD_DONATION_ITEM="addDonationItem",e.REMOVE_DONATION_ITEM="removeDonationItem",e.DESIGNATION_TREE_SCROLL_USED="designationTreeScrollUsed",e.DONATION_ITEMS_VALIDATION_ERROR="donationItemsValidationError",e.DESIGNATION_TREE_SEARCH_RESULT="designationTreeSearchResult",e.BENEFIT_CHOSEN="benefitChosen",e.BENEFIT_UPSELL="benefitUpsell",e.BENEFIT_OPTION_VALUE_CHOSEN="benefitOptionValueChosen",e.BENEFIT_RESET="benefitReset",e.BENEFIT_DELIVERY_COUNTRY_IS_INCORRECT="benefitDeliveryCountryIsIncorrect",e.STRIPE_LINK_FILLED="stripeLinkFilled",e.STRIPE_LINK_USED="stripeLinkUsed",e.FEEDBACK_FORM_OPENED="feedbackFormOpened",e.FEEDBACK_FORM_INPUT_STARTED="feedbackFormInputStarted",e.FEEDBACK_FORM_SENT="feedbackFormSent"}(Ee||(Ee={})),function(e){e.CHECKOUT_BEFORE_OPEN="checkoutBeforeOpen",e.CHECKOUT_OPEN="checkoutOpen",e.CHECKOUT_CLOSE="checkoutClose",e.CHECKOUT_INTENT="checkoutIntent",e.DONATION_COMPLETE="donationComplete"}(Ae||(Ae={}));var be,Pe,Ne,De=n(588);function Te(e,t){const n=t.findElement(e);if(!n)throw new Error('No element with id "root"');return n}function ke(e){if(!e.iframeDocument||!e.iframeWindow)throw new Error("No window or document in iframe");return{target:e.iframeWindow,global:window}}!function(e){e.CLOSE="close",e.OPEN="open",e.DONATION_COMPLETE="donationComplete",e.CHECKOUT_INTENT="checkoutIntent"}(be||(be={})),function(e){e.LIVE="live",e.TEST="test"}(Pe||(Pe={})),function(e){e.DONATE_FORM="donate-form",e.COMMENT="comment",e.UPSELL="upsell",e.PAYMENT_METHOD="payment-method",e.PAYPAL="paypal",e.BANK_LOADING="bank-loading",e.CREDIT_CARD="credit-card",e.UK_BACS="uk-bacs",e.UK_BACS_CONFIRMATION="uk-bacs-confirmation",e.AU_BECS="au-becs",e.SEPA="sepa",e.PRIVACY="privacy",e.DOUBLE="double",e.GIFT_AID="gift-aid",e.MAILING_ADDRESS="mailing-address",e.THANK_YOU="thank-you",e.THANK_YOU_TRIBUTE="thank-you-tribute",e.QUESTIONS1="questions1",e.QUESTIONS="questions",e.REMIND_ME="remind-me",e.ASK_PAGE="ask-page",e.POST_DONATION_UPSELL="post-donation-upsell",e.BLOCKED="blocked",e.COMMUNICATION_CONSENT="communication-consent",e.IDEAL_CONFIRMATION="ideal-confirmation",e.FAST_TRACK_PAYMENT_OPTION="fast-track-payment-options"}(Ne||(Ne={}));class Ie{get iframeNode(){throw new Error("Not implemented")}destroy(e){throw new Error("Not implemented")}}class _e extends Ie{constructor(e,t,n){super(),this.checkoutUI=e,this.checkoutCore=t,this.foreignElements=n,this.eventEmitter=new De.A,this.destroyed=!1}get iframeNode(){return this.checkoutUI.iframeNode}get checkoutLocale(){return this.checkoutCore.intl.locale}initialize(){this.checkoutAPIBridge.on(be.DONATION_COMPLETE,(e=>{this.emit(be.DONATION_COMPLETE,e)}))}destroy(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.assertNotDestroyed(),this.checkoutUI.close();const t=Object.assign(Object.assign({},e),this.checkoutAPIBridge.getClosePublicJsApiPayload());this.checkoutCore.logger.checkoutClose({key:this.checkoutCore.checkoutConfiguration.campaign.key,name:this.checkoutCore.checkoutConfiguration.campaign.name},this.checkoutAPIBridge.getClosePublicJsApiPayload()),this.emit(be.CLOSE,t),this.emit(be.CHECKOUT_INTENT,this.checkoutAPIBridge.getIntent()),this.foreignElements&&this.foreignElements.restoreAll(),this.eventEmitter.removeAllListeners(),this.checkoutAPIBridge.dispose(),this.checkoutCore.dispose(),this.destroyed=!0}))}on(e,t){this.assertNotDestroyed(),this.eventEmitter.on(e,t)}getOpenParams(){return this.checkoutAPIBridge.getOpenParams()}get checkoutAPIBridge(){return this.checkoutCore.checkoutAPIBridge}emit(e,t){this.eventEmitter.emit(e,t)}assertNotDestroyed(){if(this.destroyed)throw new Error("CheckoutAPI destroyed")}}var Oe=n(2319);class xe extends Error{constructor(e){super(`4 - ${e}`)}}class we extends Error{constructor(e){super(`6 - ${e}`)}}class Re extends Error{constructor(e){super(`8 - ${e}`)}}class Me extends Error{constructor(e){super(`5 - ${e}`)}}class Le extends Error{constructor(e){super(`9 - ${e}`)}}class Fe{constructor({distributionId:e,name:t,variants:n,sentry:i}){this.variants=new Map,this.distributionId=e,this.name=t,this.sentry=i,n.forEach((e=>{this.variants.set(e.name,{name:e.name,key:e.key,weight:e.weight})})),this.variantSelectors=this.getDistributedSelectors()}get currentVariantName(){return this._currentVariantName}get currentVariantKey(){var e;return this._currentVariantName?null===(e=this.variants.get(this._currentVariantName))||void 0===e?void 0:e.key:void 0}get previousVariantName(){return this._previousVariantName}initCurrentVariantName(){var e;const t=this.getSelection(),n=[];this.variantSelectors.forEach(((e,t)=>{n.push([t,e])})),this.currentVariantName=null===(e=n.find((([,[e,n]])=>t>=e&&t<n)))||void 0===e?void 0:e[0]}setVariant(e){this.variants.has(e)?this.currentVariantName=e:this.sentry.captureException(new Me(this.name))}set currentVariantName(e){this._previousVariantName=this._currentVariantName,this._currentVariantName=e}getSelection(){const e=this.getMaxDistributionValue();return Number((0,Oe.A)(`${this.distributionId}:${this.name}`)%e)}getDistributedSelectors(){let e=0;const t=new Map;return this.assertVariantsWithWeight(this.variants),this.variants.forEach((({weight:n},i)=>{const s=this.getWeightSum(),a=this.getMaxDistributionValue()/s;t.set(i,[e,e+a*n]),e+=a*n})),t}getWeightSum(){let e=0;return this.assertVariantsWithWeight(this.variants),this.variants.forEach((({weight:t})=>e+=t)),e}getMaxDistributionValue(){return 100*this.variants.size}assertVariantsWithWeight(e){if(![...e.entries()].every((([,{weight:e}])=>void 0!==e)))throw new Error("Every variant should have weight")}}class Ue{constructor(e){this.experiments=new Map;const{experimentsSettings:t,tracker:n,funStorage:i,companyKey:s,widgetKey:a,user:o,parentCompanyKey:r,infrastructureParams:l,sentry:c,distributionId:u,isDebugMode:d,isFundraiseupVisitor:h,isAbTestMode:m=!1}=e;if(this.experimentsSettings=t,this.tracker=n,this.funStorage=i,this.companyKey=s,this.parentCompanyKey=r,this.widgetKey=a,this.user=o,this.infrastructureParams=l,this.sentry=c,this.distributionId=u,this.isDebugMode=d,this.isFundraiseupVisitor=h,this.isAbTestMode=m,!this.distributionId)throw new Error("ExperimentController: Distribution ID is required")}get allowExperiments(){return!!this.isDebugMode||!this.isFundraiseupVisitor&&!this.isAbTestMode}register(e,t){if(this.experiments.has(e))return;const n=this.createExperiment(e,t);n&&this.experiments.set(e,n)}get(e){if(!this.experiments.has(e)){const t=new Le(e);throw this.sentry.captureException(t),t}return this.experiments.get(e)}registerAndGet(e,t){return this.register(e,t),this.get(e)}has(e){return this.experiments.has(e)}createExperiment(e,t){const n=h[e];if(!n)throw new Error(`ExperimentController: Experiment ID not found for experiment ${e}`);const i=this.experimentsSettings.find((e=>e.experimentId===n));if(!i)return this.sentry.captureException(new Re(e)),null;const s=this.getDistributionExperimentName(i),a=new Fe({distributionId:this.distributionId,name:s,variants:i.variants,sentry:this.sentry});return new t({settings:i,companyKey:this.companyKey,parentCompanyKey:this.parentCompanyKey,tracker:this.tracker,funStorage:this.funStorage,user:this.user,widgetKey:this.widgetKey,infrastructureParams:this.infrastructureParams,sentry:this.sentry,distribution:a,allowExperiments:this.allowExperiments})}getDistributionExperimentName(e){return e.experimentId===h[u.AMOUNT_PRESETS_DONATION_FORM_V_5_EXPERIMENT]?u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT:e.name}}function je(e){return e.map((e=>({...e,variants:Be(e.variants)})))}function Be(e){return e.map((e=>({...e,key:e.name})))}const Ge={experimentId:h[u.CAMPAIGN_PAGE_TEST_EXPERIMENT],name:u.CAMPAIGN_PAGE_TEST_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:f.CONTROL,weight:1},{name:f.TEST,weight:1}]},qe={experimentId:h[u.CAMPAIGN_PAGES_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT],name:u.CAMPAIGN_PAGES_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:C.CONTROL,weight:1},{name:C.TEST,weight:1}]},Ve={experimentId:h[u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT],name:u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:D.CONTROL,weight:1},{name:D.TEST,weight:1}]},He={experimentId:h[u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT],name:u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:_.CONTROL,weight:1},{name:_.TEST,weight:1}]},Ke={experimentId:h[u.UPSELL_AMOUNTS_DATASET_PAGES_EXPERIMENT],name:u.UPSELL_AMOUNTS_DATASET_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:x.CONTROL,weight:0},{name:x.TEST,weight:1}]},Ye={experimentId:h[u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT],name:u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:L.CONTROL,weight:0},{name:L.TEST,weight:1}]},ze={experimentId:h[u.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT],name:u.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:B.CONTROL,weight:1},{name:B.TEST,weight:1}]},We={experimentId:h[u.RECURRING_FREQUENCY_HINT_CAMPAIGN_PAGES_EXPERIMENT],name:u.RECURRING_FREQUENCY_HINT_CAMPAIGN_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:G.CONTROL,weight:1},{name:G.TEST,weight:1}]},$e={experimentId:h[u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT],name:u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:q.CONTROL,weight:1},{name:q.TEST,weight:1}]},Xe={experimentId:h[u.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT],name:u.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:K.CONTROL,weight:1},{name:K.TEST_1,weight:1},{name:K.TEST_2,weight:1}]},Qe={experimentId:h[u.AVERAGE_DONATION_HINT_CAMPAIGN_PAGES_EXPERIMENT],name:u.AVERAGE_DONATION_HINT_CAMPAIGN_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:$.CONTROL,weight:1},{name:$.TEST,weight:1}]},Ze={experimentId:h[u.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT],name:u.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:X.CONTROL,weight:1},{name:X.TEST_1,weight:1},{name:X.TEST_2,weight:1}]},Je={experimentId:h[u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT],name:u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:Z.CONTROL,weight:1},{name:Z.TEST,weight:1}]},et={experimentId:h[u.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT],name:u.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:te.CONTROL,weight:1},{name:te.TEST_1,weight:1},{name:te.TEST_2,weight:1},{name:te.TEST_3,weight:1},{name:te.TEST_4,weight:1}]},tt={experimentId:h[u.STRIPE_LINK_PAGES_EXPERIMENT],name:u.STRIPE_LINK_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:ie.CONTROL,weight:1},{name:ie.TEST,weight:1}]},nt={experimentId:h[u.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT],name:u.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:ae.CONTROL,weight:1},{name:ae.TEST,weight:1}]},it={experimentId:h[u.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT],name:u.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:ce.CONTROL,weight:1},{name:ce.TEST,weight:1}]},st={experimentId:h[u.PRE_DONATION_AMOUNTS_100_200_USD_PAGES_EXPERIMENT],name:u.PRE_DONATION_AMOUNTS_100_200_USD_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:de.CONTROL,weight:1},{name:de.TEST,weight:1}],documentationUrl:"https://www.notion.so/fundraiseup/ML-DEG-Pre-donation-Amounts-100-200-pages-2657e95f5bc58039b41bf22ebc2287ad",featureUrl:"https://fundraiseup.tpondemand.com/entity/135267-mldeg-experiment-pre-donation-amounts-100"},at={experimentId:h[u.DONATE_BY_VOICE_V2_PAGES_EXPERIMENT],name:u.DONATE_BY_VOICE_V2_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:re.CONTROL,weight:1},{name:re.TEST,weight:1}]},ot={experimentId:h[u.QUARTERLY_UPSELL_PAGES_EXPERIMENT],name:u.QUARTERLY_UPSELL_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:fe.CONTROL,weight:0},{name:fe.TEST,weight:1}],documentationUrl:"https://www.notion.so/fundraiseup/FAST-Quarterly-upsell-for-monthly-donors-pages-26a7e95f5bc5802d8f7bc8c43a4d86ae",featureUrl:"https://fundraiseup.tpondemand.com/entity/133722-experiment-quarterly-upsell-for-monthly-donors"},rt={experimentId:h[u.MOBILE_FIRST_STEP_PAGES_EXPERIMENT],name:u.MOBILE_FIRST_STEP_PAGES_EXPERIMENT,enabled:!1,scope:m.CAMPAIGN_PAGES,variants:[{name:ve.CONTROL,weight:1},{name:ve.TEST,weight:1}],documentationUrl:"https://www.notion.so/Campaign-page-Mobile-First-Step-Checkout-v2-on-SMS-Email-All-Traffic-28b7e95f5bc580b9af88ff293b2b39c7?source=copy_link",featureUrl:"https://fundraiseup.tpondemand.com/restui/board.aspx?#page=board/4975145038670903421&appConfig=eyJhY2lkIjoiQzE5MzBDMkFFRUIyMzg3MUIzRjYxNkIwQjNBMTUzNUYifQ==&boardPopup=feature/141268"};const lt={experimentId:h[u.DUMMY_EXPERIMENT],name:u.DUMMY_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:p.CONTROL,weight:1},{name:p.TEST,weight:1}]},ct={experimentId:h[u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT],name:u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:A.CONTROL,weight:1},{name:A.TEST,weight:1}]},ut={experimentId:h[u.SMART_COVERING_FEE_CHECKOUT_V_2_EXPERIMENT],name:u.SMART_COVERING_FEE_CHECKOUT_V_2_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:N.CONTROL,weight:1},{name:N.TEST_1,weight:1},{name:N.TEST_2,weight:1}]},dt={experimentId:h[u.AA_CHECKOUT_EXPERIMENT],name:u.AA_CHECKOUT_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:T.CONTROL,weight:1},{name:T.TEST,weight:1}]},ht={experimentId:h[u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT],name:u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:I.CONTROL,weight:1},{name:I.TEST,weight:1}]},mt={experimentId:h[u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT],name:u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:O.CONTROL,weight:0},{name:O.TEST,weight:1}]},pt={experimentId:h[u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT],name:u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:M.CONTROL,weight:0},{name:M.TEST,weight:1}]},gt={experimentId:h[u.SMART_PDU_CHECKOUT_V_3_EXPERIMENT],name:u.SMART_PDU_CHECKOUT_V_3_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:j.CONTROL,weight:1},{name:j.TEST,weight:1}]},yt={experimentId:h[u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT],name:u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:V.CONTROL,weight:1},{name:V.TEST,weight:1}]},ft={experimentId:h[u.DONOR_RATING_CHECKOUT_EXPERIMENT],name:u.DONOR_RATING_CHECKOUT_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:H.CONTROL,weight:1},{name:H.TEST_1,weight:1},{name:H.TEST_2,weight:1}]},vt={experimentId:h[u.AVERAGE_DONATION_HINT_EXPERIMENT],name:u.AVERAGE_DONATION_HINT_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:W.CONTROL,weight:1},{name:W.TEST_1,weight:1},{name:W.TEST_2,weight:1},{name:W.TEST_3,weight:1}]},St={experimentId:h[u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT],name:u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:Q.CONTROL,weight:1},{name:Q.TEST,weight:1}]},Et={experimentId:h[u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT],name:u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:J.CONTROL,weight:1},{name:J.TEST_1,weight:1},{name:J.TEST_2,weight:1}]},At={experimentId:h[u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT],name:u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:ee.CONTROL,weight:1},{name:ee.TEST_1,weight:1},{name:ee.TEST_2,weight:1},{name:ee.TEST_3,weight:1},{name:ee.TEST_4,weight:1}]},Ct={experimentId:h[u.STRIPE_LINK_CHECKOUT_EXPERIMENT],name:u.STRIPE_LINK_CHECKOUT_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:ne.CONTROL,weight:1},{name:ne.TEST,weight:1}]},bt={experimentId:h[u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT],name:u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:se.CONTROL,weight:1},{name:se.TEST,weight:1}]},Pt={experimentId:h[u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT],name:u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:oe.CONTROL,weight:1},{name:oe.TEST,weight:1}]},Nt={experimentId:h[u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT],name:u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:he.CONTROL,weight:1},{name:he.TEST,weight:1}],documentationUrl:"https://www.notion.so/fundraiseup/ML-DEG-Pre-donation-Amounts-100-200-modal-2657e95f5bc58057a560f954d9aa5f52",featureUrl:"https://fundraiseup.tpondemand.com/entity/135267-mldeg-experiment-pre-donation-amounts-100"},Dt={experimentId:h[u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT],name:u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:ge.CONTROL,weight:1},{name:ge.TEST_1,weight:1},{name:ge.TEST_2,weight:1}]},Tt={experimentId:h[u.QUARTERLY_UPSELL_MODAL_EXPERIMENT],name:u.QUARTERLY_UPSELL_MODAL_EXPERIMENT,enabled:!1,scope:m.EMBED,variants:[{name:ye.CONTROL,weight:1},{name:ye.TEST,weight:1}]};var kt,It,_t=function(e){return je([lt,ct,ut,dt,ht,mt,pt,gt,yt,ft,vt,St,Et,At,Ct,bt,Pt,Nt,Dt,Tt]).map((t=>{const n=e.find((e=>e.experimentId===t.experimentId));return n?{experimentId:n.experimentId,enabledWidgets:n.enabledWidgets,disabledWidgets:n.disabledWidgets,scope:n.scope,name:n.name,enabled:n.enabled,variants:Be(n.variants),disabledAccounts:n.disabledAccounts,enabledAccounts:n.enabledAccounts}:t}))};!function(e){e.SESSION="fundraiseup_session",e.FUNC="fundraiseup_func",e.PERFORMANCE="fundraiseup_stat",e.CONSENT="fundraiseup_consent",e.MARKETING="fundraiseup_mark",e.CID="fundraiseup_cid",e.DEBUG="fundraiseup_debug",e.EXPERIMENTS="fundraiseup_experiments",e.FUN_AB_STORAGE="fundraiseup_ab_test",e.DEV_MODE="developmentMode"}(kt||(kt={})),function(e){e.TOP_LEVEL_DOMAIN="topLevelDomain",e.INTENT="intent",e.MESSAGE_BAR="messageBar",e.SOCIAL_PROOF="socialProof",e.POPUP="popup",e.SESSION_AT="sessionAt",e.SESSION_PAGE="sessionPage",e.X_FACTOR="xFactor",e.LIGHTBOX="lightbox",e.LAST_SUCCESS_DONATION_AT="lastSuccessDonationAt",e.FLOATING_BUTTON_POPUP_SHOWN="floatingButtonPopupShown",e.GIFT_CATALOG_CART_ITEMS="giftsCatalogCartItems"}(It||(It={}));class Ot{constructor(e,t){this.storage=e,this.initAt=t||(new Date).getTime(),this.read()}incrementSession(){this.sessionPage++,this.refresh()}refresh(){this.sessionAt||this.addSession(),this.write()}addSession(){this.sessionAt=this.initAt}write(){this.storage.setField(It.SESSION_AT,this.sessionAt.toString(10)),this.storage.setField(It.SESSION_PAGE,this.sessionPage)}read(){this.sessionAt=Number(this.storage.getField(It.SESSION_AT))||0,this.sessionPage=Number(this.storage.getField(It.SESSION_PAGE))||0}}class xt{constructor(e,t){this.field=e,this.storage=t}get(){return this.storage.get(this.field)}set(e,t){this.storage.set(this.field,e,t)}remove(e){this.storage.remove(this.field,e)}}var wt,Rt,Mt,Lt,Ft=n(4698);function Ut(){const e=[],t=window.location.hostname.split(".");let n=t.splice(-1).join();for(let i=t.length;i>0;i--)n=t.splice(-1).join()+"."+n,e.push(n);return e}!function(e){e.DEVELOPMENT="development",e.PRODUCTION="production",e.STAGING="staging",e.TESTING="testing"}(wt||(wt={})),function(e){e.STRING="string",e.OBJECT="object"}(Rt||(Rt={})),function(e){e.ENABLED="1"}(Mt||(Mt={})),function(e){e.STRING="string",e.OBJECT="object"}(Lt||(Lt={}));var jt=n(6971);const Bt=[jt.D.EN_US,jt.D.EN_GB,jt.D.EN_CA,jt.D.FR_CA,jt.D.FR_FR,jt.D.ES,jt.D.NL,jt.D.NO,jt.D.DE,jt.D.FI_FI,jt.D.SV,jt.D.IT,jt.D.PT_PT,jt.D.PT_BR,jt.D.AR_001,jt.D.ZH_CN,jt.D.ZH_TW,jt.D.JA,jt.D.KO,jt.D.HU,jt.D.DA,jt.D.ES_US,jt.D.PL_PL,jt.D.DE_X_INFORMAL,jt.D.RU_RU];var Gt=n(4729);class qt{static isLocaleCode(e){return void 0!==e&&Bt.includes(e)}constructor(e,t,n,i,s,a,o){this.translationService=e,this.dateFormatter=t,this.currencyFormatter=n,this.numberFormatter=i,this.company=s,this.donateToPayTokens=a,this._locale=qt.DEFAULT_LOCALE,this.availableLocales=o.availableLocales,this.locale=o.locale,this.company=s,this.donateToPayTokens=a,this.dateFormatter.intl=this}get locale(){return this._locale}get language(){return this.locale.split("-")[0]}getCurrencyFormat(){return this.currencyFormatter.getFormat()}setLocale(e){const t=this.locale;this.locale=e;const n=[this.translationService.changeLocale(this.locale)];return Promise.all(n).then((()=>this.locale)).catch((e=>(this.locale=t,Promise.reject(e)))).finally((()=>{this.dateFormatter.changeLocale(this.locale),this.currencyFormatter.changeLocale(this.locale),this.numberFormatter.changeLocale(this.locale)}))}translate(e,t){const n=(0,Gt.q1)(this.translationService.translate(e,t));return this.replaceDonateToPay(e,n)}safeTranslate(e,t){const n=(0,Gt.q1)(this.translationService.safeTranslate(e,t));return this.replaceDonateToPay(e,n)}formatDate(e,t){return this.dateFormatter.format(e,t)}formatCurrency(e,t){return this.currencyFormatter.format(e,t)}formatAmount(e){return this.currencyFormatter.formatAmount(e)}formatSymbol(e,t){return this.currencyFormatter.formatCurrencySymbol(e,t)}formatNumber(e,t){return this.numberFormatter.format(e,t)}isLocaleAvailable(e){return this.availableLocales.some((t=>t===e))}replaceDonateToPay(e,t){if("AFJCHFEK"===this.company&&this.locale===jt.D.EN_US&&this.donateToPayTokens.includes(e)){const e={donation:"payment",Donation:"Payment",Donate:"Pay",donate:"pay",donating:"paying"};return t.replace(/donation|Donation|Donate|donate|donating/g,(t=>e[t]))}return t}set locale(e){this.isLocaleAvailable(e)?this._locale=e:this._locale=qt.DEFAULT_LOCALE}}qt.DEFAULT_LOCALE=jt.D.EN_US;class Vt{constructor(e,t,n,i){this.createFundraiseupAddressProvider=e,this.sentry=t,this.requestService=n,this.config=i}async getPlaces(e){const{customData:t,input:n,sessionToken:i,restrictCountries:s}=e,a=this.createFundraiseupAddressProvider(this.sentry,this.config);return n&&i?await a.getPlaces({customData:t,input:n,sessionToken:i,restrictCountries:s}):[]}shouldFindSubplaces(e){const{place:t,restrictCountries:n}=e;return this.createFundraiseupAddressProvider(this.sentry,this.config).shouldFindSubplaces({place:t,restrictCountries:n})}getSubplaces(e){const{place:t,input:n,sessionToken:i,restrictCountries:s}=e;return this.createFundraiseupAddressProvider(this.sentry,this.config).getSubplaces({place:t,input:n,sessionToken:i,restrictCountries:s})}getDetails(e){const{customData:t,place:n,sessionToken:i,restrictCountries:s}=e;return this.createFundraiseupAddressProvider(this.sentry,this.config).getDetails({customData:t,place:n,sessionToken:i,restrictCountries:s})}}var Ht,Kt,Yt,zt,Wt=n(1040),$t=n(3417),Xt=n(104);!function(e){e.PREFIX="prefix",e.POSTFIX="postfix"}(Ht||(Ht={})),function(e){e.STANDARD="standard",e.COMPACT="compact",e.ROUNDED="rounded",e.FLOAT="float",e.TRIM="trim",e.INTEGER="integer"}(Kt||(Kt={})),function(e){e.SHORT="short",e.EXPLICIT="explicit"}(Yt||(Yt={})),function(e){e.PREFIX="prefix",e.POSTFIX="postfix"}(zt||(zt={}));const Qt={[jt.D.EN_US]:zt.PREFIX,[jt.D.EN_GB]:zt.PREFIX,[jt.D.EN_CA]:zt.PREFIX,[jt.D.FR_CA]:zt.POSTFIX,[jt.D.ES]:zt.POSTFIX,[jt.D.ES_US]:zt.PREFIX,[jt.D.NL]:zt.PREFIX,[jt.D.NO]:zt.PREFIX,[jt.D.DE]:zt.POSTFIX,[jt.D.DE_X_INFORMAL]:zt.POSTFIX,[jt.D.FI_FI]:zt.POSTFIX,[jt.D.FR_FR]:zt.POSTFIX,[jt.D.SV]:zt.POSTFIX,[jt.D.IT]:zt.POSTFIX,[jt.D.PT_PT]:zt.POSTFIX,[jt.D.PT_BR]:zt.PREFIX,[jt.D.AR_001]:zt.PREFIX,[jt.D.ZH_CN]:zt.PREFIX,[jt.D.ZH_TW]:zt.PREFIX,[jt.D.JA]:zt.PREFIX,[jt.D.KO]:zt.PREFIX,[jt.D.HU]:zt.POSTFIX,[jt.D.DA]:zt.POSTFIX,[jt.D.RU_RU]:zt.POSTFIX,[jt.D.PL_PL]:zt.POSTFIX},Zt={[Kt.STANDARD]:"full",[Kt.COMPACT]:"short",[Kt.ROUNDED]:"round",[Kt.FLOAT]:"floatcents",[Kt.TRIM]:"trimzeroes",[Kt.INTEGER]:"scopeFloatCents"},Jt={[Kt.STANDARD]:"fullstrict",[Kt.COMPACT]:"fulltrimzeroes",[Kt.ROUNDED]:"roundstrict",[Kt.FLOAT]:"fulltrimzeroes",[Kt.TRIM]:"fulltrimzeroes",[Kt.INTEGER]:"scopeFloatCents"};class en{constructor(){this._currenciesData=null,this.notUseLetterSymbol=!1,this.currenciesExtraData=new Map}setData(e){if(this._currenciesData=e,!this._currenciesData)return;const t=this._currenciesData;Object.keys(t).forEach((e=>{this.currenciesExtraData.set(e,{symbolHasLetters:/[a-zA-Z]/.test(t[e].symbol)})}))}formatAmount(e){const{amount:t,currency:n,withoutPrefix:i,withoutSuffix:s,locale:a,numberFormat:o,currencyFormat:r,forceExplicit:l}=e,c=(r===Yt.EXPLICIT?Jt:Zt)[o];return this.formatCurrency(t,n,c,i,s,a,"narrowSymbol",l)}formatCurrency(e,t="USD",n="full",i=!1,s=!1,a,o="narrowSymbol",r){const l=this.currenciesData[t];e=(e||0)/Math.pow(10,l.digits);const c=this.buildOptions({amount:e,display:n,currency:t,displayCurrency:o,datum:l,withoutPrefix:i,withoutSuffix:s,forceSuffix:r});e<0&&0===c.intlOptions.maximumFractionDigits&&(e=0),a===jt.D.KO&&e>1e4&&(c.intlOptions.minimumFractionDigits=0,c.intlOptions.maximumFractionDigits=1);const u=this.currenciesExtraData.get(l.code);return(null==u?void 0:u.symbolHasLetters)&&this.notUseLetterSymbol&&(c.intlOptions.currencyDisplay="code"),en.castIntl({amount:e,locale:a,options:c,datum:l})}getCurrencyFormat(e){return{decimalSeparator:Intl.NumberFormat(e).format(1.1).replace(/\d/g,""),groupSeparator:Intl.NumberFormat(e).format(1e5).replace(/\d/g,"")}}static castIntl({amount:e,locale:t,options:n,datum:i}){let s;try{s=Intl.NumberFormat(t,n.intlOptions).format(e)}catch(i){if(!en.isUnsupportedBrowserError(i,n))throw i;n.intlOptions.currencyDisplay=Wt.Uk,s=Intl.NumberFormat(t,n.intlOptions).format(e)}return i.symbol&&s.includes(i.code)&&"code"!==n.intlOptions.currencyDisplay&&(s=s.replace(i.code,i.symbol)),n.internalOptions.pushSuffix&&(s+=`${i.code}`),t===jt.D.EN_CA&&"USD"===i.code&&"narrowSymbol"===n.intlOptions.currencyDisplay&&(s=s.replace("US$","$")),s}formatSymbol(e,t,n){const i=en.currencySymbolPosition(n);return i===zt.PREFIX&&t===Ht.PREFIX||i===zt.POSTFIX&&t===Ht.POSTFIX?e:""}get currenciesData(){if(!this._currenciesData)throw new Error("Currencies data was not set");return this._currenciesData}buildOptions({amount:e,display:t,currency:n,datum:i,withoutPrefix:s,withoutSuffix:a,displayCurrency:o="narrowSymbol",forceSuffix:r=!1}){const l=i.type===Xt.Z.CRYPTO,c=l?void 0:i.symbol,u={style:c?"currency":"decimal",currency:l?void 0:n,notation:"standard",currencyDisplay:o,minimumFractionDigits:0,maximumFractionDigits:0,numberingSystem:"latn"},d={pushSuffix:!c};switch(t){case"short":{const t=this.shortFormatNotation(e),n=this.shortFormatFractionDigits(e);"compact"===t&&(u.minimumFractionDigits=0,u.maximumFractionDigits=n),u.notation=t;break}case"shortlabel":{const t=this.shortFormatNotation(e),n=this.shortFormatFractionDigits(e);"compact"===t&&(u.minimumFractionDigits=0,u.maximumFractionDigits=n),u.notation=t,d.pushSuffix=!1;break}case"round":break;case"roundstrict":d.pushSuffix=!0;break;case"roundlabel":d.pushSuffix=!1;break;case"full":l&&(u.style="decimal",d.pushSuffix=!0),u.maximumFractionDigits=i.digits,u.minimumFractionDigits=l?Wt.lt:i.digits;break;case"fullstrict":l&&(u.style="decimal"),d.pushSuffix=!0,u.maximumFractionDigits=i.digits,u.minimumFractionDigits=l?Wt.lt:i.digits;break;case"floatcents":Math.round(e)!==e?(u.maximumFractionDigits=i.digits,u.minimumFractionDigits=i.digits):(u.maximumFractionDigits=0,u.minimumFractionDigits=0);break;case"trimzeroes":l?(u.maximumFractionDigits=i.digits,u.minimumFractionDigits=0):Math.round(e)!==e?(u.maximumFractionDigits=i.digits,u.minimumFractionDigits=i.digits):(u.maximumFractionDigits=0,u.minimumFractionDigits=0);break;case"fulltrimzeroes":d.pushSuffix=!0,l?(u.maximumFractionDigits=i.digits,u.minimumFractionDigits=0,u.style="decimal"):Math.round(e)!==e?(u.maximumFractionDigits=i.digits,u.minimumFractionDigits=i.digits):(u.maximumFractionDigits=0,u.minimumFractionDigits=0);break;case"scopeFloatCents":throw new Error("Unused, not rewritten at the moment");default:throw new Error(`Unknown display type ${t}`)}return s&&(u.style="decimal"),(a||(0,$t.f)(n))&&(d.pushSuffix=!1),r&&!(0,$t.f)(n)&&(d.pushSuffix=!0),{intlOptions:u,internalOptions:d}}shortFormatNotation(e){return Math.abs(e)<1e4?"standard":"compact"}shortFormatFractionDigits(e){const t=Math.abs(e),n=this.calcDivisor(t);let i=en.calcDigits(t,n);return t>=en.TEN_THOUSAND&&t<en.HUNDRED_THOUSAND&&(i=1),t%n==0&&(i=0),i}calcDivisor(e){let t=1;return e>=en.MILLION?t=en.TEN_MILLIONS:e>=en.TEN_THOUSAND&&(t=en.THOUSAND),t}static calcDigits(e,t=1){const n=2-Math.ceil(Math.log10(e/t));return Math.max(0,n)}static currencySymbolPosition(e){return Qt[e]}static isUnsupportedBrowserError(e,t){const n="narrowSymbol"===t.intlOptions.currencyDisplay,i=e.toString()===Wt.yb;return n&&i}}en.THOUSAND=1e3,en.TEN_THOUSAND=1e4,en.HUNDRED_THOUSAND=1e5,en.MILLION=1e6,en.TEN_MILLIONS=1e7;class tn extends en{constructor(e){super(),this.currencyDataLoader=e,this.loadFiat()}async loadCrypto(){const e={...await this.currencyDataLoader.loadCrypto(),...this._currenciesData};this.setData(e)}loadFiat(){const e={...this.currencyDataLoader.loadFiat(),...this._currenciesData};this.setData(e)}}var nn,sn,an=n(5913);class on extends an.${async getCryptoCurrencies(){return(await Promise.resolve().then(n.t.bind(n,9895,19))).default}}class rn{}class ln extends rn{isEnabled(e,t){return t.showMailing?e>=t.showMailingFromAmount:t.showMailing}isRequired(e,t){return t.showMailing&&t.mailingRequired?e>=t.mailingRequiredFromAmount:!!t.showMailing&&t.mailingRequired}}class cn extends rn{isEnabled(){return!0}isRequired(){return!0}}!function(e){e.DONOR_PORTAL_SUBSCRIPTION_EDITOR="donorPortalSubscriptionEditor",e.DASHBOARD_SUBSCRIPTION_EDITOR="dashboardSubscriptionEditor",e.WIDGET="widget",e.VIRTUAL_TERMINAL="virtualTerminal"}(nn||(nn={}));class un extends rn{constructor(e){super(),this.mailingAddressCheckoutScreenLogic=e}isEnabled(e,t){return!!this.mailingAddressCheckoutScreenLogic.isEnabled(e,t)||!!this.isRequiredByPaymentMethod(t)||!!this.isRequiredByGiftAid(t)}isRequired(e,t){return!!this.mailingAddressCheckoutScreenLogic.isRequired(e,t)||!!this.isRequiredByPaymentMethod(t)||!!this.isRequiredByGiftAid(t)}isRequiredByPaymentMethod(e){return!!e.paymentMethod&&e.paymentMethodAvailabilityManagerRepository.getManager(e.paymentMethod,nn.WIDGET).isRequired("address",{ibanCountry:e.paymentMethodCountry})}isRequiredByGiftAid(e){return e.isGiftAidAccepted}}function dn(e){return e.isException&&e.country===sn.CANADA?new cn:new ln}!function(e){e.AUSTRALIA="AU",e.AUSTRIA="AT",e.BELGIUM="BE",e.BRAZIL="BR",e.BULGARIA="BG",e.CANADA="CA",e.CROATIA="HR",e.CYPRUS="CY",e.CZECH_REPUBLIC="CZ",e.DENMARK="DK",e.ESTONIA="EE",e.FINLAND="FI",e.FRANCE="FR",e.GERMANY="DE",e.GREECE="GR",e.HONG_KONG="HK",e.HUNGARY="HU",e.INDIA="IN",e.INDONESIA="ID",e.IRELAND="IE",e.ITALY="IT",e.JAPAN="JP",e.LATVIA="LV",e.LITHUANIA="LT",e.LUXEMBOURG="LU",e.MALAYSIA="MY",e.MALTA="MT",e.MEXICO="MX",e.NETHERLANDS="NL",e.NEW_ZEALAND="NZ",e.NORWAY="NO",e.POLAND="PL",e.PORTUGAL="PT",e.ROMANIA="RO",e.SINGAPORE="SG",e.SLOVAKIA="SK",e.SLOVENIA="SI",e.SPAIN="ES",e.SWEDEN="SE",e.SWITZERLAND="CH",e.THAILAND="TH",e.UNITED_ARAB_EMIRATES="AE",e.UNITED_KINGDOM="GB",e.UNITED_STATES="US",e.GIBRALTAR="GI",e.LIECHTENSTEIN="LI",e.PHILIPPINES="PH",e.ISRAEL="IL"}(sn||(sn={}));const hn=[sn.CANADA,sn.GERMANY];class mn{constructor(e){this.widget=e.widget}}class pn extends mn{get currency(){return this.widget.defaultCurrency}}class gn extends mn{get currency(){return"EUR"}}class yn extends rn{constructor(e,t){super(),this.checkoutScreenLogic=e,this.params=t}isEnabled(e,t){return this.checkoutScreenLogic.isEnabled(e,t)||this.mailingAddressForceRequired(t)}isRequired(e,t){return this.checkoutScreenLogic.isRequired(e,t)||this.mailingAddressForceRequired(t)}mailingAddressForceRequired(e){return e.paymentMethodAvailabilityManagerRepository.getManager(e.paymentMethod,nn.VIRTUAL_TERMINAL).isRequired("address",{ibanCountry:e.paymentMethodCountry})}}const fn={showMailing:!0,showMailingFromAmount:0,mailingRequired:!0,mailingRequiredFromAmount:3e4},vn={showMailing:!0,showMailingFromAmount:0,mailingRequired:!0,mailingRequiredFromAmount:0},Sn={showMailing:!1,showMailingFromAmount:0,mailingRequired:!1,mailingRequiredFromAmount:0};class En{}class An extends En{getDefaults(){return Sn}}class Cn extends En{getDefaults(){return vn}}class bn extends En{getDefaults(){return fn}}class Pn{constructor(e){this.validator=e,this.legalText=""}getValidAmounts(e,t){return this.validator.isValid(e).isValid?{showMailingFromAmount:e.showMailingFromAmount,mailingRequiredFromAmount:e.mailingRequiredFromAmount}:{showMailingFromAmount:t,mailingRequiredFromAmount:t}}}class Nn extends Pn{constructor(){super(...arguments),this.shouldHideEditor=!1,this.showMailingShouldAlwaysEnabled=!1,this.mailingRequiredShouldAlwaysEnabled=!1}}class Dn extends Pn{constructor(){super(...arguments),this.shouldHideEditor=!0,this.showMailingShouldAlwaysEnabled=!1,this.mailingRequiredShouldAlwaysEnabled=!1}}const Tn=3e4;class kn extends Pn{constructor(){super(...arguments),this.shouldHideEditor=!1,this.showMailingShouldAlwaysEnabled=!0,this.mailingRequiredShouldAlwaysEnabled=!0,this.legalText="We recommend leaving address optional if possible; requiring it prior to checkout may cause you to lose donations. Due to German receipt regulations, an address must be required on donations over 300 euros."}getValidAmounts(e,t){const n=super.getValidAmounts(e,t);let i=n.showMailingFromAmount,s=n.mailingRequiredFromAmount;const a=this.validator.isValid({showMailingFromAmount:n.showMailingFromAmount,mailingRequiredFromAmount:n.mailingRequiredFromAmount,showMailing:e.showMailing,mailingRequired:e.mailingRequired}),o=a.meta.isShowMailingFromAmountValid,r=a.meta.isMailingRequiredFromAmountValid;return e.showMailing&&!o&&(i=kn.MAX_SHOW_MAILING_FROM_AMOUNT),e.mailingRequired&&!r&&(s=kn.MAX_MAILING_REQUIRED_FROM_AMOUNT),{showMailingFromAmount:i,mailingRequiredFromAmount:s}}}kn.MAX_SHOW_MAILING_FROM_AMOUNT=Tn,kn.MAX_MAILING_REQUIRED_FROM_AMOUNT=3e4;class In{isValid(e){if(e.showMailing&&e.mailingRequired){const t=e.showMailingFromAmount<=e.mailingRequiredFromAmount;return{isValid:t,meta:{isMailingRequiredFromAmountValid:t,isShowMailingFromAmountValid:t}}}return{isValid:!0,meta:{isMailingRequiredFromAmountValid:!0,isShowMailingFromAmountValid:!0}}}}class _n extends In{isValid(e){const t=super.isValid(e),n=e.showMailingFromAmount<=Tn,i=e.mailingRequiredFromAmount<=Tn;return{isValid:t.isValid&&i&&n,meta:{isMailingRequiredFromAmountValid:i,isShowMailingFromAmountValid:n}}}}class On{constructor(e){var t;this.company=On.resolveCompanyConfig(e),this.isDevelopmentMode=null!==(t=e.isDevelopmentMode)&&void 0!==t&&t}get isExceptionLogic(){return this.company.nonProfit&&hn.includes(this.company.country)}static resolveCompanyConfig(e){return e.company.useParentPaymentAccounts&&e.parentCompany?{nonProfit:e.parentCompany.nonProfit,country:e.parentCompany.country}:{nonProfit:e.company.nonProfit,country:e.company.country}}getWidgetDefaultsLogic(){return function(e){if(e.isException)switch(e.country){case sn.GERMANY:return new bn;case sn.CANADA:return new Cn;default:return new An}return new An}({country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode})}getCurrencyLogic(e){return function(e){return e.isException&&e.country===sn.GERMANY?new gn(e):new pn(e)}({country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode,widget:e.widget})}getWidgetEditorLogic(){return function(e){if(e.isException)switch(e.country){case sn.GERMANY:return new kn(e.validator);case sn.CANADA:return new Dn(e.validator);default:return new Nn(e.validator)}return new Nn(e.validator)}({country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode,validator:this.getValidator()})}getCheckoutScreenLogic(){return function(e){const t=dn(e);return new un(t)}({country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode})}getVirtualTerminalLogic(){return function(e){const t=dn(e);return new yn(t,e)}({country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode,nonProfit:this.company.nonProfit})}getValidator(){return(e={country:this.company.country,isException:this.isExceptionLogic,isDevelopmentMode:this.isDevelopmentMode}).isException&&e.country===sn.GERMANY?new _n:new In;var e}}var xn=n(7226);const wn=class{static isFailure(e){return"Failure"===e._tag}static isSuccess(e){return"Success"===e._tag}static fail(e){return{_tag:"Failure",failureResult:e}}static success(e){return{_tag:"Success",successResult:e}}constructor(){throw new Error("Either can not be instantiated")}},Rn={withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}};class Mn{constructor(e="",t){this.baseURL=e,this.request=t}sendRequest(e){const t={...Rn,...e};return t.url=this.baseURL+t.url,this.request(t).then((({data:e,valid:t})=>t?wn.success(e):wn.fail(e)))}sendRequestWithStatus(e){const t={...Rn,...e};return t.url=this.baseURL+t.url,this.request(t).then((({data:e,valid:t,status:n})=>{const i=null===e||"object"!=typeof e||Array.isArray(e)?{data:e,status:n}:{...e,status:n};return t?wn.success(i):wn.fail(i)}))}get(e){return this.sendRequest({...e,method:"GET"})}post(e){return this.sendRequest({...e,method:"POST"})}postWithStatus(e){return this.sendRequestWithStatus({...e,method:"POST"})}}var Ln=n(2774),Fn=n.n(Ln);class Un{constructor(e){this.currencyService=e,this.numbers=this.generateNumbers()}beautify(e,t,n){const i=Array.isArray(e);let s=Fn()(e).map((e=>this.currencyService.toFloat(e,t)));const a=this.sortAsc(s);s=a.list;const o=a.positions;let r=this.findNearestPosition(s[0],0,this.numbers.length-s.length);if(n){const e=this.currencyService.toFloat(n,t),i=this.numbers[this.numbers.length-1];for(;e&&this.numbers[r]<e&&e<i;)r++}const l=this.getPositionsArray(r,s.length);for(let e=l.length-1;e>0;e--){const t=this.findNearestPosition(s[e],l[e-1]+1,l[e+1]-1);l[e]=t||l[e]}return s=this.restoreSort(l.map((e=>this.numbers[e]?this.numbers[e]:this.numbers[this.numbers.length-1])),o).map((e=>this.currencyService.fromFloat(e,t))),i?s:s[0]}generateNumbers(){const e=[1,2,3,4,5,6,7,8,9,10,12,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,100,120,130,140,150,160,170,180,190,200,250,300,350,400,450,500,600,650,700,750,800,900],t=[10,12,15,20,25,30,35,40,50,60,70,80,90];for(let n=100;n<1e7;n*=10)t.forEach((t=>e.push(t*n)));return e}sortAsc(e){let t=0;const n=e.map((e=>({val:e,pos:t++}))).sort(((e,t)=>e.val-t.val));return{list:n.map((e=>e.val)),positions:n.map((e=>e.pos))}}restoreSort(e,t){let n=0;return t.map((t=>({pos:t,val:e[n++]}))).sort(((e,t)=>e.pos-t.pos)).map((e=>e.val))}findNearestPosition(e,t,n){if(t=t||0,n=n||this.numbers.length-1,e>=this.numbers[n])return n;for(let i=n;i>t;i--)if(this.numbers[i-1]<=e&&e<=this.numbers[i])return e-this.numbers[i-1]>=this.numbers[i]-e?i:i-1;return 0}getPositionsArray(e,t){const n=[];for(let i=e;i<e+t;i++)n.push(i);return n}}let jn;function Bn(){return void 0===jn&&(jn=!1),jn}var Gn,qn,Vn,Hn,Kn,Yn,zn,Wn,$n,Xn,Qn;!function(e){e.CARD="creditCard",e.APPLE_PAY="applePay",e.GOOGLE_PAY="googlePay",e.CLICK_TO_PAY="clickToPay",e.ACH="ach",e.PLAID="plaid",e.PAYPAL="paypal",e.VENMO="venmo",e.AU_BECS="auBecsDebit",e.UK_BACS="ukBacs",e.ACSS="acss",e.SEPA="sepa",e.IDEAL="ideal",e.CRYPTO="crypto",e.STOCK="stock",e.US_BANK_ACCOUNT="usBankAccount"}(Gn||(Gn={})),(zn=qn||(qn={})).ONCE="once",zn.DAILY="daily",zn.WEEKLY="weekly",zn.BIWEEKLY="biweekly",zn.EVERY_4_WEEKS="every4weeks",zn.MONTHLY="monthly",zn.BIMONTHLY="bimonthly",zn.QUARTERLY="quarterly",zn.SEMIANNUAL="semiannual",zn.ANNUAL="annual",function(e){e.US_BANK_ACCOUNT="us-bank-account",e.US_BANK_ACCOUNT_DONATE_OPTIONS="us-bank-account-donate-options",e.US_BANK_ACCOUNT_CONFIRMATION="us-bank-account-confirmation",e.US_BANK_ACCOUNT_VERIFICATION_GUIDE="us-bank-account-verification-guide",e.AU_BECS="au-becs",e.CREDIT_CARD="credit-card",e.DONATE="donate-form",e.DOUBLE="double",e.GIFT_AID="gift-aid",e.PAYMENT_OPTIONS="payment-method",e.SEPA="sepa",e.UK_BACS="uk-bacs",e.UK_BACS_CONFIRMATION="uk-bacs-confirmation",e.IDEAL_CONFIRMATION="ideal-confirmation",e.UPSELL="upsell",e.COMMUNICATION_CONSENT="communication-consent",e.FAST_TRACK_PAYMENT_OPTIONS="fast-track-payment-options",e.DONATE_BY_VOICE="donate-by-voice"}(Vn||(Vn={})),function(e){e.REMINDER="reminder",e.DONATE_BUTTON="donateButton",e.STICKY_BUTTON="stickyButton",e.IMAGE_CARD="imageCard",e.TEXT_LINK="textLink",e.DONATION_FORM="donationForm",e.SIMPLE_FORM="simpleForm",e.GOAL_METER="goalMeter",e.STAT_COUNTER="statCounter",e.IMPACT_SLIDER="impactSlider",e.DONATION_LEVELS="donationLevels",e.BUTTON_GROUP="buttonGroup",e.FLOATING_BUTTON="floatingButton",e.MESSAGE_BAR="messageBar",e.TOP_SUPPORTERS="topSupporters",e.TOP_LOCATIONS="topLocations",e.SOCIAL_PROOF="socialProof",e.QR_CODE="qrCode",e.RECENT_DONATIONS="recentDonations",e.P2P_BUTTON="p2pButton",e.P2P_LINK="p2pLink",e.TOP_FUNDRAISERS="topFundraisers",e.DONOR_MAP="donorMap",e.LIGHTBOX="lightbox",e.FUNDRAISING_PAGE_LINK="fundraisingPageLink",e.FUNDRAISING_PAGE_INVITE_LINK="fundraisingPageInviteLink",e.LINK="link",e.DIRECT_LINK="direct",e.DEBUG_PANEL="debugPanel",e.TEST_MODE_PANEL="testModePanel",e.SPLIT_TESTING="splitTesting",e.JS_API="jsApi"}(Hn||(Hn={})),function(e){e.MODAL="modal",e.PAGE="page"}(Kn||(Kn={}));class Zn{constructor(e,t){this.window=e,this.sentry=t}subscribeOnUserInteraction(e){var t;const n=function(e,t){let n=!1;return t=>{n||(e(t),n=!0,setTimeout((()=>{n=!1}),1e3))}}(e);try{this.window.addEventListener("mousemove",n),this.window.addEventListener("touchstart",e),this.window.addEventListener("keypress",e)}catch(e){const n=window.document.children[0];throw null===(t=this.sentry)||void 0===t||t.captureException(new Error("UserInteraction error"),{extra:{tagName:n.tagName,classList:n.classList,id:n.id,style:n.getAttribute("style")}}),e}return()=>{this.window.removeEventListener("mousemove",n),this.window.removeEventListener("touchstart",e),this.window.removeEventListener("keypress",e)}}}function Jn(e,t){var n;return(null!==(n=null==t?void 0:t.document)&&void 0!==n?n:document).cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${e}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1")}!function(e){e.INITIATE_CHECKOUT="InitiateCheckout",e.DONATE="Donate",e.PURCHASE="Purchase"}(Yn||(Yn={}));class ei{constructor(){this.queue=[]}pushEvent(e,t){this.queue.push({eventName:e,eventPayload:t})}clear(){this.queue.length=0}[Symbol.iterator](){return this.queue.values()}}!function(e){e.EVENT_DONATION_COMPLETE="donationComplete",e.EVENT_CHECKOUT_CLOSE="checkoutClose",e.EVENT_CHECKOUT_OPEN="checkoutOpen"}(Wn||(Wn={}));class ti{constructor(e){this.window=e}track(e,t){switch(e){case Wn.EVENT_CHECKOUT_OPEN:this.openEvent(e,t);break;case Wn.EVENT_CHECKOUT_CLOSE:this.closeEvent(e,t);break;case Wn.EVENT_DONATION_COMPLETE:this.donationEvent(e,t)}}openEvent(e,t){const n={event:"FundraiseUp."+e,FundraiseUp:t.data,ecommerce:{}};this.pushEvent(n)}closeEvent(e,t){const n={event:"FundraiseUp."+e,FundraiseUp:t.data,ecommerce:{}};this.pushEvent(n)}donationEvent(e,t){var n,i,s,a,o,r,l,c,u;const d=t.data,h={event:"FundraiseUp."+e,FundraiseUp:d,ecommerce:{transaction_id:null===(n=d.donation)||void 0===n?void 0:n.id,value:null===(i=d.donation)||void 0===i?void 0:i.amount,currency:null===(s=d.donation)||void 0===s?void 0:s.currency,items:[{item_id:t.widget.key,item_name:t.widget.name,index:0,item_brand:"Fundraise Up",item_category:null===(a=d.designation)||void 0===a?void 0:a.name,item_category2:null===(o=d.designation)||void 0===o?void 0:o.id,item_category3:null===(r=d.designation)||void 0===r?void 0:r.code,item_variant:null===(l=d.donation)||void 0===l?void 0:l.frequency,price:null===(c=d.donation)||void 0===c?void 0:c.amount,quantity:1,currency:null===(u=d.donation)||void 0===u?void 0:u.currency}]}};this.pushEvent(h)}pushEvent(e){this.window.dataLayer=this.window.dataLayer||[],this.window.dataLayer.push(e)}}class ni{constructor(e){this.observers=[],this.isActive=!0,this._eventsQueue=null,this.isEnabled=e.enabledByDefault,this.window=e.window,this.checkoutConfiguration=e.checkoutConfiguration,this.sessionTokenService=e.sessionTokenService,this.initialize()}donationComplete(e,t){const n={widget:e,data:t};this.observe(Wn.EVENT_DONATION_COMPLETE,n)}checkoutClose(e,t){const n={widget:e,data:t};this.observe(Wn.EVENT_CHECKOUT_CLOSE,n)}checkoutOpen(e,t){const n={widget:e,data:t};this.observe(Wn.EVENT_CHECKOUT_OPEN,n)}observe(e,t){this.isActive&&this.isEnabled?this.observeEvent(e,t):this.eventsQueue.pushEvent(e,t)}setActive(e){if(this.isActive=e,this.isActive&&this.isEnabled){for(const{eventName:e,eventPayload:t}of this.eventsQueue)this.observeEvent(e,t);this.eventsQueue.clear()}}get eventsQueue(){return this._eventsQueue||(this._eventsQueue=new ei),this._eventsQueue}observeEvent(e,t){for(const n of this.observers)n.track(e,t)}resolveFacebookPixels(){var e;let t=[];const n=this.window.fbq;if(!n)return t;if("function"==typeof(null==n?void 0:n.getState)){const i=n.getState();if(null===(e=null==i?void 0:i.pixels)||void 0===e?void 0:e.length)return t=i.pixels.map((e=>e.id)),t}const i=n.queue;return i.length?(i.forEach((e=>{const n=e[0],i=e[1];"init"===n&&i&&t.push(i)})),t):t}resolveFacebookEventOptions(e){return Object.assign(Object.assign({},e),{fbp:Jn("_fbp")})}initializeFacebookPixelTracking(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.overrideFacebookPixelQueuePush(),this.overrideFacebookPixelCallMethod()||e>24||setTimeout((()=>this.initializeFacebookPixelTracking(e+1)),100*e)}overrideFacebookPixelCallMethod(){const e=this.window.fbq;if(!e||!e.callMethod||!e.queue)return!1;if(e.callMethod.overridden)return!0;if(e.queue.length)return!1;const t=e.callMethod,n=this;return e.callMethod=function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];const a=n.prepareFacebookEventArgs(i);t.call(this,...a)},e.callMethod.overridden=!0,!0}transformQueuePushArgs(e){if((e=Array.isArray(e)?e:Array.from(e)).length<4)return e;const t=e[3];return t&&"object"==typeof t?(t.content_ids&&!Array.isArray(t.content_ids)&&(t.content_ids=[t.content_ids]),e.splice(1,1),e):e}overrideFacebookPixelQueuePush(){const e=this.window.fbq;if(!e||e.callMethod||!e.queue)return;if(e.queue.push.overridden)return;const t=this,n=e.queue.push;e.queue.push=function(e){if(!e)return n.call(this,e);const i=t.prepareFacebookEventArgs(e);n.call(this,i)},e.queue.push.overridden=!0}initializeObservers(){this.observers.push(new ti(this.window))}initialize(){(this.checkoutConfiguration.infrastructureParams.livemode||this.checkoutConfiguration.company.trackToMarketingPixels.trackTestData)&&(this.initializeObservers(),this.initializeFacebookPixelTracking())}prepareFacebookEventArgs(e){let t,n;e.length>2&&"string"==typeof e[1]&&"string"==typeof e[2]?(t=e[2],n=4):(t=e[1],n=3);const i=e[n];if("string"!=typeof t||(null==i?void 0:i.eventID)||![Yn.INITIATE_CHECKOUT,Yn.DONATE].includes(t))return e;const s=[...e],a=Object.assign(Object.assign({},i),{eventID:this.sessionTokenService.token});return s.length>n?s[n]=a:(s.length<n&&s.push({}),s.push(a)),s}}class ii{constructor(e){this.excluded=!1,this.isInitialized=!1,this.isActive=!1;const{settings:t,companyKey:n,widgetKey:i,tracker:s,funStorage:a,user:o,parentCompanyKey:r,infrastructureParams:l,sentry:c,distribution:u,allowExperiments:d=!0}=e;this.sentry=c,this.companyKey=n,this.parentCompanyKey=r,this.widgetKey=i,this.tracker=s,this.funStorage=a,this.user=o,this.infrastructureParams=l;const{experimentId:h,name:m,disabledAccounts:p,enabledAccounts:g,enabled:y,enabledWidgets:f}=t;this.name=m,this.experimentId=h,this.disabledAccounts=p,this.enabledAccounts=g,this.enabledWidgets=f,this.disabledWidgets=t.disabledWidgets,this.settings=t,this.enabled=y,this.distribution=u;const v=Array.isArray(window.FUN_DISABLED_EXPERIMENTS)?window.FUN_DISABLED_EXPERIMENTS:[];this.globalDisabled=!d||window.FUN_DISABLE_EXPERIMENTS||-1!==v.indexOf(h)}get isExperimentEnabled(){return((e,t)=>{var n;if(!t)return!1;const{enabled:i,experimentId:s}=t,a=e.get(),o=a&&(null===(n=a.settings[s])||void 0===n?void 0:n.enabled);return i||Boolean(o)})(this.funStorage,this.settings)}getDebugPanelEnabled(){var e,t;const n=null===(e=this.funStorage.get())||void 0===e?void 0:e.settings;return Boolean(n&&(null===(t=n[this.experimentId])||void 0===t?void 0:t.enabled))}get active(){return this.isActive}get variantName(){return this.distribution.currentVariantName}get variantKey(){return this.distribution.currentVariantKey}start(e){if(!this.checkDisabled()&&(this.isInitialized=this.init(),this.isInitialized)){this.activate();const e=this.getTags();this.tracker.setEventTags(e)}}getTags(){const e=[this.experimentId,`${this.experimentId}-${this.variantName}`];return this.excluded&&e.push(`${this.experimentId}-exclusion`),e}isVariant(e){return this.variantKey===e}setVariant(e,t=!0){this.distribution.setVariant(e),this.excluded=t;const n=[this.experimentId];this.tracker.removeEventTags(n);const i=this.getTags();this.tracker.setEventTags(i)}restoreVariant(){this.distribution.previousVariantName&&this.setVariant(this.distribution.previousVariantName,!1)}exposure(){this.isActive&&this.tracker.customTrack({type:"testGroupExposed",data:{exclusion:this.excluded,experimentId:this.experimentId,variantName:this.variantName}})}init(){var e,t,n,i;const s=this.getDebugPanelVariant();if(s.variant&&s.enabled)return this.setVariant(s.variant),!0;if(s.enabled&&!s.variant&&(this.excluded=!0),!((e,t)=>{const{disabledAccounts:n,enabledAccounts:i}=e;if(null==n?void 0:n.find((e=>e===t)))return!1;const s=null==i?void 0:i.find((e=>e===t));return!((null==i?void 0:i.length)&&!s)})(this.settings,this.companyKey))return!1;const a=null===(e=this.enabledWidgets)||void 0===e?void 0:e.find((e=>e===this.widgetKey));if((null===(t=this.enabledWidgets)||void 0===t?void 0:t.length)&&!a)return!1;const o=null===(n=this.disabledWidgets)||void 0===n?void 0:n.find((e=>e===this.widgetKey));return!((null===(i=this.disabledWidgets)||void 0===i?void 0:i.length)&&o||(this.distribution.initCurrentVariantName(),0))}activate(){this.isActive?this.sentry.captureException(new xe(this.name)):this.isActive=!0}checkDisabled(){const e=this.getDebugPanelExperimentsSettings();if(e){const t=e[this.experimentId];if(t&&t.enabled)return!1}return!this.enabled||this.globalDisabled}getDebugPanelExperimentsSettings(){const e=this.funStorage.get();return"object"!=typeof e?(this.sentry.captureException(new we(e)),null):(null==e?void 0:e.settings)||null}getDebugPanelVariant(){var e;const t=null===(e=this.funStorage.get())||void 0===e?void 0:e.settings;if(!t)return{enabled:!1};const n=t[this.experimentId];return n&&(null==n?void 0:n.enabled)?{enabled:!0,variant:n.variant}:{enabled:!1}}}!function(e){e.MONEY="money",e.CRYPTO="crypto"}($n||($n={}));class si extends ii{tryStart(e){this.canBeStarted(e)&&(this.isActive||super.start())}isTestGroup(){return this.isActive&&this.isVariant(q.TEST)}canBeStarted(e){return e.flowType===$n.MONEY&&!!e.isMobile}}class ai extends ii{tryStart(e){this.canBeStarted(e)&&(this.isActive||super.start())}isTestGroup(){return this.isActive&&this.isVariant(V.TEST)}canBeStarted(e){return e.flowType===$n.MONEY&&!!e.isMobile}}class oi extends ii{get isTestGroup(){return this.isActive&&this.isVariant(oe.TEST)}tryStart(e){this.active||this.isAllowedByCompany(e)&&this.isAllowedByUserCountry(e)&&this.isAllowedByPaymentOptions(e)&&this.isAllowedByAmount(e)&&this.isAllowedByCurrency(e)&&this.isAllowedByFrequencies(e)&&this.isAllowedByRateMatching(e)&&this.start()}isAllowedByCompany(e){return!oi.FORBIDDEN_COMPANIES.includes(e.companyKey)}isAllowedByUserCountry(e){return e.userCountry===Se.UNITED_STATES||Bn()}isAllowedByPaymentOptions(e){return!!e.isStripeAccountConnected&&(e.paymentOptions.creditCard||e.paymentOptions.applePay)}isAllowedByAmount(e){return e.isAmountEditable}isAllowedByCurrency(e){return"USD"===e.defaultCurrency}isAllowedByFrequencies(e){return 2===Object.values(e.frequencies).filter((e=>e.enabled&&!e.hintsEnabled)).length}isAllowedByRateMatching(e){return!e.rateMatching.show}}oi.FORBIDDEN_COMPANIES=["AFGSSTXA","ADCYPWMX","APCQSSNA","ADGJGYAN","ANSBECBT"],function(e){e.TOP_40="40",e.TOP_20="20",e.TOP_10="10",e.TOP_5="5",e.TOP_3="3",e.TOP_2="2",e.TOP_1="1",e.TOP_0_5="0_5",e.TOP_0_1="0_1",e.NONE="none"}(Xn||(Xn={})),function(e){e.TEST_1="test1",e.TEST_2="test2"}(Qn||(Qn={}));class ri extends ii{constructor(){super(...arguments),this.isUpsellApplied=!1,this.exposed=!1,this.donorRating=null}get isTestGroup1(){return this.isActive&&this.isVariant(K.TEST_1)}get isTestGroup2(){return this.isActive&&this.isVariant(K.TEST_2)}get testGroupKey(){return this.isTestGroup1?K.TEST_1:this.isTestGroup2?K.TEST_2:null}tryStart(e){this.canBeStarted(e)&&(this.donorRating=e.donorRating,super.start())}isEnabled(e){return!!this.canBeStarted(e)&&!!this.active}tryToExpose(){this.exposed||(this.exposure(),this.exposed=!0)}trackBannerVisibility(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_BANNER_TRIGGER,data:{show:e.show,type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,creationDate:this.getCreationDate()}})}trackUpsellVisibility(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_UPSELL_TOOLTIP_TRIGGER,data:{show:e.position!==Xn.NONE,type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,upsellAmount:e.upsellAmount,creationDate:this.getCreationDate()}})}trackUpsellClick(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_UPSELL_CLICK,data:{type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,upsellAmount:e.upsellAmount,creationDate:this.getCreationDate()}})}getCreationDate(){var e,t;return null!==(t=null===(e=this.donorRating)||void 0===e?void 0:e.date)&&void 0!==t?t:""}convertThresholdNameToNumber(e){return e===Xn.NONE?0:Number(ri.THRESHOLD_NAME_MAP[e])}isDonorRatingTopExists(e){const{donorRating:t,enabledFrequencies:n}=e;return!!t&&(n.some((e=>void 0!==t.control[e]))||n.some((e=>void 0!==t.test1[e]))||n.some((e=>void 0!==t.test2[e])))}canBeStarted(e){return!e.isMatchingEnabled&&!!this.isDonorRatingTopExists(e)}}ri.DEBOUNCE_TIMEOUT=500,ri.THRESHOLD_NAME_MAP={[Xn.TOP_40]:"40",[Xn.TOP_20]:"20",[Xn.TOP_10]:"10",[Xn.TOP_5]:"5",[Xn.TOP_3]:"3",[Xn.TOP_2]:"2",[Xn.TOP_1]:"1",[Xn.TOP_0_5]:"0.5",[Xn.TOP_0_1]:"0.1",[Xn.NONE]:""};class li extends ii{constructor(){super(...arguments),this.hideTimeoutId=null,this.isUpsellApplied=!1,this.exposed=!1,this.donorRating=null}get isTestGroup1(){return this.isActive&&this.isVariant(H.TEST_1)}get isTestGroup2(){return this.isActive&&this.isVariant(H.TEST_2)}get testGroupKey(){return this.isTestGroup1?H.TEST_1:this.isTestGroup2?H.TEST_2:null}tryStart(e){this.canBeStarted(e)&&(this.donorRating=e.donorRating,super.start())}isEnabled(e){return!!this.canBeStarted(e)&&!!this.active}tryToExpose(){this.exposed||(this.exposure(),this.exposed=!0)}trackBannerVisibility(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_BANNER_TRIGGER,data:{show:e.show,type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,creationDate:this.getCreationDate()}})}trackUpsellVisibility(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_UPSELL_TOOLTIP_TRIGGER,data:{show:e.position!==Xn.NONE,type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,upsellAmount:e.upsellAmount,creationDate:this.getCreationDate()}})}trackUpsellClick(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_DONOR_RATING_UPSELL_CLICK,data:{type:this.convertThresholdNameToNumber(e.position),frequency:e.frequency,amount:e.amount,upsellAmount:e.upsellAmount,creationDate:this.getCreationDate()}})}getCreationDate(){var e,t;return null!==(t=null===(e=this.donorRating)||void 0===e?void 0:e.date)&&void 0!==t?t:""}convertThresholdNameToNumber(e){return e===Xn.NONE?0:Number(li.THRESHOLD_NAME_MAP[e])}isDonorRatingTopExists(e){const{donorRating:t,enabledFrequencies:n}=e;return!!t&&(n.some((e=>void 0!==t.control[e]))||n.some((e=>void 0!==t.test1[e]))||n.some((e=>void 0!==t.test2[e])))}canBeStarted(e){return!!this.isDonorRatingTopExists(e)}}li.BANNER_VISIBILITY_TIMEOUT=3e3,li.THRESHOLD_NAME_MAP={[Xn.TOP_40]:"40",[Xn.TOP_20]:"20",[Xn.TOP_10]:"10",[Xn.TOP_5]:"5",[Xn.TOP_3]:"3",[Xn.TOP_2]:"2",[Xn.TOP_1]:"1",[Xn.TOP_0_5]:"0.5",[Xn.TOP_0_1]:"0.1",[Xn.NONE]:""};class ci extends ii{constructor(){super(...arguments),this.exposed=!1}get isTestGroup(){return this.isTestGroup1||this.isTestGroup2}get isTestGroup1(){return this.isActive&&this.isVariant(X.TEST_1)}get isTestGroup2(){return this.isActive&&this.isVariant(X.TEST_2)}tryStart(e){this.isActive||this.canBeStarted(e)&&this.start()}isEnabled(e){return!!this.canBeStarted(e)&&!!this.active}tryToExpose(){this.exposed||(this.exposure(),this.exposed=!0)}canBeStarted(e){var t,n,i;if(e.isCustomerTitleEnabled)return!1;const s=null===(t=e.allowedPaymentMethods[Gn.GOOGLE_PAY])||void 0===t?void 0:t.visible,a=null===(n=e.allowedPaymentMethods[Gn.APPLE_PAY])||void 0===n?void 0:n.visible,o=null===(i=e.allowedPaymentMethods[Gn.PAYPAL])||void 0===i?void 0:i.visible;return!(!s&&!a&&o&&e.isPhoneRequired)&&(s||a||o)}}class ui extends ii{get isTestGroup(){return this.isActive&&this.isVariant(se.TEST)}tryStart(){this.isActive||super.start()}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}canBeStarted(e){return!(e.donationItems.length>1)&&(e.frequency===qn.ONCE&&e.amountInUsd>=5e4||e.frequency===qn.MONTHLY&&e.amountInUsd>=2e4)}}class di extends ii{constructor(){super(...arguments),this.excludedLocales=[jt.D.IT,jt.D.PL_PL]}get isTestGroup(){return this.isTestGroup1||this.isTestGroup2}get isTestGroup1(){return this.isActive&&this.isVariant(J.TEST_1)}get isTestGroup2(){return this.isActive&&this.isVariant(J.TEST_2)}tryStart(e){this.isActive||this.canBeStarted(e)&&this.start()}isEnabled(e){return!!this.canBeStarted(e)&&!!this.active}canBeStarted(e){const{checkoutConfiguration:t}=e,n=t.element.locale||t.environmentConfig.locale;if(this.excludedLocales.includes(n))return!1;if(!t.company.recurringPlans.annual)return!1;const i=t.enabledFrequencies;return!(2!==i.length||!i.includes(qn.ONCE)||!i.includes(qn.MONTHLY)||i.some((e=>t.campaign.config.frequencies[e].hintsEnabled))&&!t.infrastructureParams.isMobile)}}class hi extends ii{constructor(){super(...arguments),this.isExposed=!1}get isTestGroup(){return this.isActive&&this.isVariant(he.TEST)}tryStart(e){let{isUpsellEnabled:t}=e;this.isActive||t&&super.start()}tryExpose(e){this.isExposed||this.canBeStarted(e)&&(this.exposure(),this.isExposed=!0)}isEnabled(e){return!!this.isTestGroup&&!!this.canBeStarted(e)}canBeStarted(e){if(!e.preDonationUpsellDataPoint.isEnabled)return!1;if(e.preDonationUpsellDataPoint.upsellFrequency!==qn.MONTHLY)return!1;const t=e.preDonationUpsellDataPoint.upsellInitialAmountInUsd;return!(null===t||t<1e4||t>2e4)}}class mi extends ii{constructor(){super(...arguments),this.isExposed=!1}get isTestGroup(){return this.isActive&&this.isVariant(de.TEST)}tryStart(e){let{isUpsellEnabled:t}=e;this.isActive||t&&super.start()}tryExpose(e){this.isExposed||this.canBeStarted(e)&&(this.exposure(),this.isExposed=!0)}isEnabled(e){return!!this.isTestGroup&&!!this.canBeStarted(e)}canBeStarted(e){if(!e.preDonationUpsellDataPoint.isEnabled)return!1;if(e.preDonationUpsellDataPoint.upsellFrequency!==qn.MONTHLY)return!1;const t=e.preDonationUpsellDataPoint.upsellInitialAmountInUsd;return!(null===t||t<1e4||t>2e4)}}class pi extends ii{get isTestGroup(){return this.isActive&&this.isVariant(B.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!!e.isPostDonationUpsellEnabled&&!!e.isPaid}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}}class gi extends ii{get isTestGroup(){return this.isActive&&this.isVariant(j.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!!e.isPostDonationUpsellEnabled&&!!e.isPaid}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}}class yi extends ii{constructor(){super(...arguments),this._supportedBrowsers=["Safari","Chrome","Edge","Mobile Safari","Chrome Headless"]}get isTestGroup(){return this.isActive&&this.isVariant(ne.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}canBeStarted(e){return!!e.isMobile&&this._supportedBrowsers.includes(e.browser)}}class fi extends ii{constructor(){super(...arguments),this._supportedBrowsers=["Safari","Chrome","Edge","Mobile Safari","Chrome Headless"]}get isTestGroup(){return this.isActive&&this.isVariant(ie.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}canBeStarted(e){return this._supportedBrowsers.includes(e.browser)}}class vi extends ii{get isTestGroup(){return this.isActive&&this.isVariant(ce.TEST)}tryStart(e){this.active||this.canBeStarted(e)&&this.start()}tryExposure(e){e.isAnnualTribute||this.exposure()}canBeStarted(e){return!!e.isPreDonationUpsellEnabled}}var Si,Ei,Ai,Ci,bi=n(8461);!function(e){e.GOOGLE_PLACES="google-places",e.LOB="lob",e.LOQATE="loqate"}(Si||(Si={})),function(e){e.DELIVERABLE="deliverable",e.UNDELIVERABLE="undeliverable"}(Ei||(Ei={})),function(e){e[e.STREET=200]="STREET",e[e.APARTMENT=200]="APARTMENT",e[e.CITY=40]="CITY",e[e.STATE=200]="STATE",e[e.ZIP=100]="ZIP",e[e.SUBLOCALITY=200]="SUBLOCALITY",e[e.ADMINISTRATIVE_AREA=200]="ADMINISTRATIVE_AREA"}(Ai||(Ai={})),function(e){e.AFGHANISTAN="AF",e.ALAND_ISLANDS="AX",e.ALBANIA="AL",e.ALGERIA="DZ",e.AMERICAN_SAMOA="AS",e.ANDORRA="AD",e.ANGOLA="AO",e.ANGUILLA="AI",e.ANTIGUA_AND_BARBUDA="AG",e.ARGENTINA="AR",e.ARMENIA="AM",e.ARUBA="AW",e.AUSTRALIA="AU",e.AUSTRIA="AT",e.AZERBAIJAN="AZ",e.BAHAMAS="BS",e.BAHRAIN="BH",e.BANGLADESH="BD",e.BARBADOS="BB",e.BELARUS="BY",e.BELGIUM="BE",e.BELIZE="BZ",e.BENIN="BJ",e.BERMUDA="BM",e.BHUTAN="BT",e.BOLIVIA="BO",e.BONAIRE="BQ",e.BOSNIA_AND_HERZEGOVINA="BA",e.BOTSWANA="BW",e.BRAZIL="BR",e.BRITISH_INDIAN_OCEAN_TERRITORY="IO",e.BRUNEI="BN",e.BULGARIA="BG",e.BURKINA_FASO="BF",e.BURUNDI="BI",e.CABO_VERDE="CV",e.CAMBODIA="KH",e.CAMEROON="CM",e.CANADA="CA",e.CAYMAN_ISLANDS="KY",e.CENTRAL_AFRICAN_REPUBLIC="CF",e.CHAD="TD",e.CHILE="CL",e.CHINA="CN",e.CHRISTMAS_ISLAND="CX",e.COCOS_KEELING_ISLANDS="CC",e.COLOMBIA="CO",e.COMOROS="KM",e.COOK_ISLANDS="CK",e.COSTA_RICA="CR",e.CROATIA="HR",e.CUBA="CU",e.CURACAO="CW",e.CYPRUS="CY",e.CZECH_REPUBLIC="CZ",e.COTE_DIVOIRE="CI",e.DEMOCRATIC_REPUBLIC_OF_THE_CONGO="CD",e.DENMARK="DK",e.DJIBOUTI="DJ",e.DOMINICA="DM",e.DOMINICAN_REPUBLIC="DO",e.ECUADOR="EC",e.EGYPT="EG",e.EL_SALVADOR="SV",e.EQUATORIAL_GUINEA="GQ",e.ERITREA="ER",e.ESTONIA="EE",e.ETHIOPIA="ET",e.FALKLAND_ISLANDS="FK",e.FAROE_ISLANDS="FO",e.FEDERATED_STATES_OF_MICRONESIA="FM",e.FIJI="FJ",e.FINLAND="FI",e.FORMER_YUGOSLAV_REPUBLIC_OF_MACEDONIA="MK",e.FRANCE="FR",e.FRENCH_GUIANA="GF",e.FRENCH_POLYNESIA="PF",e.FRENCH_SOUTHERN_TERRITORIES="TF",e.GABON="GA",e.GAMBIA="GM",e.GEORGIA="GE",e.GERMANY="DE",e.GHANA="GH",e.GIBRALTAR="GI",e.GREECE="GR",e.GREENLAND="GL",e.GRENADA="GD",e.GUADELOUPE="GP",e.GUAM="GU",e.GUATEMALA="GT",e.GUERNSEY="GG",e.GUINEA="GN",e.GUINEA_BISSAU="GW",e.GUYANA="GY",e.HAITI="HT",e.HOLY_SEE="VA",e.HONDURAS="HN",e.HONG_KONG="HK",e.HUNGARY="HU",e.ICELAND="IS",e.INDIA="IN",e.INDONESIA="ID",e.IRAN_ISLAMIC_REPUBLIC_OF="IR",e.IRAQ="IQ",e.IRELAND="IE",e.ISLE_OF_MAN="IM",e.ISRAEL="IL",e.ITALY="IT",e.JAMAICA="JM",e.JAPAN="JP",e.JERSEY="JE",e.JORDAN="JO",e.KAZAKHSTAN="KZ",e.KENYA="KE",e.KIRIBATI="KI",e.KUWAIT="KW",e.KYRGYZSTAN="KG",e.LAOS="LA",e.LATVIA="LV",e.LEBANON="LB",e.LESOTHO="LS",e.LIBERIA="LR",e.LIBYA="LY",e.LIECHTENSTEIN="LI",e.LITHUANIA="LT",e.LUXEMBOURG="LU",e.MACAU="MO",e.MADAGASCAR="MG",e.MALAWI="MW",e.MALAYSIA="MY",e.MALDIVES="MV",e.MALI="ML",e.MALTA="MT",e.MARSHALL_ISLANDS="MH",e.MARTINIQUE="MQ",e.MAURITANIA="MR",e.MAURITIUS="MU",e.MAYOTTE="YT",e.MEXICO="MX",e.MOLDOVA="MD",e.MONACO="MC",e.MONGOLIA="MN",e.MONTENEGRO="ME",e.MONTSERRAT="MS",e.MOROCCO="MA",e.MOZAMBIQUE="MZ",e.MYANMAR="MM",e.NAMIBIA="NA",e.NAURU="NR",e.NEPAL="NP",e.NETHERLANDS="NL",e.NEW_CALEDONIA="NC",e.NEW_ZEALAND="NZ",e.NICARAGUA="NI",e.NIGER="NE",e.NIGERIA="NG",e.NIUE="NU",e.NORFOLK_ISLAND="NF",e.NORTH_KOREA="KP",e.NORTHERN_MARIANA_ISLANDS="MP",e.NORWAY="NO",e.OMAN="OM",e.PAKISTAN="PK",e.PALAU="PW",e.PANAMA="PA",e.PAPUA_NEW_GUINEA="PG",e.PARAGUAY="PY",e.PERU="PE",e.PHILIPPINES="PH",e.PITCAIRN="PN",e.POLAND="PL",e.PORTUGAL="PT",e.PUERTO_RICO="PR",e.QATAR="QA",e.REPUBLIC_OF_THE_CONGO="CG",e.ROMANIA="RO",e.RUSSIA="RU",e.RWANDA="RW",e.REUNION="RE",e.SAINT_BARTHELEMY="BL",e.SAINT_HELENA="SH",e.SAINT_KITTS_AND_NEVIS="KN",e.SAINT_LUCIA="LC",e.SAINT_MARTIN="MF",e.SAINT_PIERRE_AND_MIQUELON="PM",e.SAINT_VINCENT_AND_THE_GRENADINES="VC",e.SAMOA="WS",e.SAN_MARINO="SM",e.SAO_TOME_AND_PRINCIPE="ST",e.SAUDI_ARABIA="SA",e.SENEGAL="SN",e.SERBIA="RS",e.SEYCHELLES="SC",e.SIERRA_LEONE="SL",e.SINGAPORE="SG",e.SINT_MAARTEN="SX",e.SLOVAKIA="SK",e.SLOVENIA="SI",e.SOLOMON_ISLANDS="SB",e.SOMALIA="SO",e.SOUTH_AFRICA="ZA",e.SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS="GS",e.SOUTH_KOREA="KR",e.SOUTH_SUDAN="SS",e.SPAIN="ES",e.SRI_LANKA="LK",e.STATE_OF_PALESTINE="PS",e.SUDAN="SD",e.SURINAME="SR",e.SVALBARD_AND_JAN_MAYEN="SJ",e.SWAZILAND="SZ",e.SWEDEN="SE",e.SWITZERLAND="CH",e.SYRIAN_ARAB_REPUBLIC="SY",e.TAIWAN="TW",e.TAJIKISTAN="TJ",e.TANZANIA="TZ",e.THAILAND="TH",e.TIMOR_LESTE="TL",e.TOGO="TG",e.TOKELAU="TK",e.TONGA="TO",e.TRINIDAD_AND_TOBAGO="TT",e.TUNISIA="TN",e.TURKEY="TR",e.TURKMENISTAN="TM",e.TURKS_AND_CAICOS_ISLANDS="TC",e.TUVALU="TV",e.UGANDA="UG",e.UKRAINE="UA",e.UNITED_ARAB_EMIRATES="AE",e.UNITED_KINGDOM="GB",e.UNITED_STATES_MINOR_OUTLYING_ISLANDS="UM",e.UNITED_STATES_OF_AMERICA="US",e.URUGUAY="UY",e.UZBEKISTAN="UZ",e.VANUATU="VU",e.VENEZUELA="VE",e.VIETNAM="VN",e.VIRGIN_ISLANDS_BRITISH="VG",e.VIRGIN_ISLANDS_US="VI",e.WALLIS_AND_FUTUNA="WF",e.WESTERN_SAHARA="EH",e.YEMEN="YE",e.ZAMBIA="ZM",e.ZIMBABWE="ZW"}(Ci||(Ci={}));class Pi{constructor(e,t,n){this.sentry=e,this.requestService=t,this.config=n,this.baseURL="",this.basePrefix="",(null==n?void 0:n.baseURL)&&(this.baseURL=n.baseURL)}setForcedProviderType(e){this.forcedProviderType=e}getForcedProviderType(e){const{restrictCountries:t}=e;switch(t&&t[0]){case sn.UNITED_KINGDOM:case sn.IRELAND:return Si.LOQATE;default:return}}getPlaces(e){var t;const{customData:n,input:i,sessionToken:s,restrictCountries:a}=e,o=this.getForcedProviderType({restrictCountries:a});return this.requestService.get({url:`${this.baseURL}${this.basePrefix}/addresses/autocomplete`,withCredentials:!0,headers:{...null===(t=this.config)||void 0===t?void 0:t.fundraiseupAddressProviderHeaders,Accept:"application/json"},params:{customData:bi.stringify(n),input:i,sessionToken:s,restrictCountries:a,forceAddressProviderType:o},rejectOnInvalid:!0}).then((e=>wn.isFailure(e)?(this.sentry.captureException(new xn.Ki,{extra:{failureResult:e.failureResult},tags:{service:Pi.name}}),[]):e.successResult)).catch((e=>(this.sentry.captureException(e,{tags:{service:Pi.name}}),[])))}shouldFindSubplaces(){return!1}getSubplaces(){return Promise.reject(new Error("There is no subplaces in fundraiseup provider"))}getDetails(e){var t;const{customData:n,place:i,sessionToken:s,restrictCountries:a}=e,o=this.getForcedProviderType({restrictCountries:a});if(i.address)return Promise.resolve(i.address);if(!i.placeId)return Promise.reject(new Error("Nor address field neither placeId field is defined in place object, something gone wrong"));const{placeId:r}=i;return this.requestService.get({url:`${this.baseURL}${this.basePrefix}/addresses/${r}`,withCredentials:!0,headers:{...null===(t=this.config)||void 0===t?void 0:t.fundraiseupAddressProviderHeaders,Accept:"application/json"},params:{customData:bi.stringify(n),sessionToken:s,restrictCountries:a,forceAddressProviderType:o},rejectOnInvalid:!0}).then((e=>wn.isFailure(e)?Promise.reject(new xn.Ki):e.successResult))}}const Ni={[qn.DAILY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.WEEKLY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.BIWEEKLY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.EVERY_4_WEEKS]:[2e4,1e4,5e3,3e3,1e3,500],[qn.MONTHLY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.BIMONTHLY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.QUARTERLY]:[2e4,1e4,5e3,3e3,1e3,500],[qn.SEMIANNUAL]:[2e4,1e4,5e3,3e3,1e3,500],[qn.ANNUAL]:[2e4,1e4,5e3,3e3,1e3,500],[qn.ONCE]:[1e5,5e4,25e3,1e4,5e3,2500]},Di="paymentSession",Ti={[qn.ONCE]:10,[qn.ANNUAL]:20,[qn.SEMIANNUAL]:30,[qn.QUARTERLY]:40,[qn.MONTHLY]:50,[qn.EVERY_4_WEEKS]:60,[qn.BIMONTHLY]:70,[qn.WEEKLY]:80,[qn.BIWEEKLY]:90,[qn.DAILY]:100},ki=[500,1e3,3e3],Ii=[2500,5e3,1e4],_i=[500,1e3,3e3,5e3,1e4,2e4],Oi=[2500,5e3,1e4,25e3,5e4,1e5],xi=2500;class wi extends Pi{constructor(e,t,n,i){super(e,t,n),this.sentry=e,this.requestService=t,this.config=n,this.checkoutSessionTokenService=i}getPlaces(e){var t,n,i;const{customData:s,input:a,sessionToken:o,restrictCountries:r}=e,l=(null===(t=this.checkoutSessionTokenService)||void 0===t?void 0:t.token)||(null==s?void 0:s.token);return l?this.requestService.get({url:`${this.baseURL}/${Di}/${l}/addresses/autocomplete`,withCredentials:!0,headers:Object.assign(Object.assign({},null===(n=this.config)||void 0===n?void 0:n.fundraiseupAddressProviderHeaders),{Accept:"application/json"}),params:{input:a,sessionToken:o,restrictCountries:r,forceAddressProviderType:this.getForcedProviderType({restrictCountries:r}),locale:null===(i=this.config)||void 0===i?void 0:i.locale},rejectOnInvalid:!0}).then((e=>wn.isFailure(e)?(this.sentry.captureException(new xn.Ki,{extra:{failureResult:e.failureResult},tags:{service:Pi.name}}),[]):e.successResult)):Promise.reject(new Error("Expected the widgetSession token"))}getDetails(e){var t,n,i;const{customData:s,place:a,sessionToken:o,restrictCountries:r}=e;if(a.address)return Promise.resolve(a.address);if(!a.placeId)return Promise.reject(new Error("Nor address field neither placeId field is defined in place object, something gone wrong"));const{placeId:l}=a,c=(null===(t=this.checkoutSessionTokenService)||void 0===t?void 0:t.token)||(null==s?void 0:s.token);return c?this.requestService.get({url:`${this.baseURL}/${Di}/${c}/addresses/${l}`,withCredentials:!0,headers:Object.assign(Object.assign({},null===(n=this.config)||void 0===n?void 0:n.fundraiseupAddressProviderHeaders),{Accept:"application/json"}),params:{sessionToken:o,forceAddressProviderType:this.getForcedProviderType({restrictCountries:r}),locale:null===(i=this.config)||void 0===i?void 0:i.locale},rejectOnInvalid:!0}).then((e=>wn.isFailure(e)?Promise.reject(new xn.Ki):e.successResult)):Promise.reject(new Error("Expected the widgetSession token"))}}function Ri(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}class Mi{constructor(){this._promise=new Promise(((e,t)=>{this._resolver=e,this._rejector=t}))}get promise(){return this._promise}resolve(e){this.resolver(e)}reject(e){this.rejector(e)}get resolver(){if(!this._resolver)throw new Error("_resolver is undefined");return this._resolver}get rejector(){if(!this._rejector)throw new Error("_rejector is undefined");return this._rejector}}class Li{constructor(){this.storage=[]}enqueue(e){this.storage.push(e)}dequeue(){return this.storage.shift()}size(){return this.storage.length}toArray(){return[...this.storage]}front(){return this.storage[0]}clear(){this.storage=[]}isEmpty(){return!this.storage.length}}class Fi{constructor(e){this.debounce=e,this.queue=new Li,this.currentRequestPromise=null}request(e){let{promise:t,allowDelay:n,allowMerge:i}=e;const s=new Mi;return this.queue.enqueue({promise:t,deferredPromise:s,allowMerge:i,allowDelay:n}),this.performRequest(),s.promise}getRequestBatch(){var e;const t=this.queue.dequeue();if(!t)return[];if(!(null==t?void 0:t.allowMerge))return[t];const n=[t];for(;null===(e=this.queue.front())||void 0===e?void 0:e.allowMerge;){const e=this.queue.dequeue();e&&n.push(e)}return n}getRequestBatches(){const e=[];for(;!this.queue.isEmpty();)e.push(this.getRequestBatch());return e}executeBatch(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=e[e.length-1];if(t)try{const n=yield t.promise();e.forEach((e=>e.deferredPromise.resolve(n)))}catch(t){e.forEach((e=>e.deferredPromise.reject(t)))}}))}performDelayedRequest(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.queue.front();if(!e)return;e.allowDelay&&(yield Ri(this.debounce));const t=this.getRequestBatches();for(const e of t)yield this.executeBatch(e)}))}performRequest(){return(0,d.sH)(this,void 0,void 0,(function*(){for(;null===this.currentRequestPromise&&!this.queue.isEmpty();)try{this.currentRequestPromise=this.performDelayedRequest(),yield this.currentRequestPromise}finally{this.currentRequestPromise=null}}))}}class Ui{constructor(e){this.params=e,this.guessedCurrency=this.guessCurrency(),this.currency=this.guessedCurrency}getCurrency(){return this.currency}getGuessedCurrency(){return this.guessedCurrency}setCurrency(e){this.currency=e}guessAndSetCurrency(e){this.guessedCurrency=this.guessCurrency(e),this.currency=this.guessedCurrency}guessCurrency(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.params.isRecurring,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.params.countryCurrencies,i=this.params.guessedCurrencies,s=this.params.defaultCurrency;return this.params.shouldDisableCurrencyGuess&&!t?s:(this.params.isCurrencyGuessEnabled||t)&&this.params.isCurrencyChangeEnabled?e&&!this.params.isCurrencyChangeEnabledForRecurring?s:n.length&&i.includes(n[0])?n[0]:s:s}}function ji(e){const{checkoutConfiguration:t}=e;return new Ui({defaultCurrency:t.campaign.config.defaultCurrency,countryCurrencies:[...t.currencies.countryCurrencies],guessedCurrencies:[...t.guessedCurrencies],isRecurring:t.defaultFrequency!==qn.ONCE,isCurrencyChangeEnabled:t.campaign.config.currencyEnabled,isCurrencyChangeEnabledForRecurring:t.campaign.config.currencyEnabledRecurrings,isCurrencyGuessEnabled:t.campaign.config.guessCurrency,shouldDisableCurrencyGuess:t.infrastructureParams.showcase})}function Bi(){return function(){if(!function(){try{return void 0!==window.Intl}catch{return!1}}())return;const e=window.Intl;if(e&&"object"==typeof e&&"function"==typeof e.DateTimeFormat){const t=new e.DateTimeFormat("en-US");if("object"!=typeof t)return;const n="function"==typeof t.resolvedOptions&&t.resolvedOptions();if("object"!=typeof n)return;const i=n.timeZone;if(!i)return;return i}}()||function(){const e=-(new Date).getTimezoneOffset()/60;return e>=0?`UTC+${e}`:`UTC${e}`}()}const Gi={isFallback:!0},qi="USD";class Vi{constructor(e){this._options=e,this._suggestions={},this._fetchCallsCount={}}getSuggestionRequestDurationMs(e){const t=this._suggestions[e];return(null==t?void 0:t.requestDurationMs)||0}isSuggestionRequested(e){const t=this._suggestions[e];return Boolean(null==t?void 0:t.isSuggestionRequested)}getSuggestion(e){const t=this._suggestions[e];return t?t.suggestion:Gi}getSuggestionFetchCallsCount(e){return this._fetchCallsCount[e]||0}fetchSuggestion(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){var n,i;if(this.needFetchSuggestion()&&!this.isSuggestionRequested(e)){this._suggestions[e]={isSuggestionRequested:!0,suggestion:Gi};try{const s=performance.now(),a=yield Promise.race([this.timeoutPromise,this.request(e,t)]);let o;(null===(n=a.data.v3)||void 0===n?void 0:n.isFallback)?o=a.data.v3:(null===(i=a.data.v3)||void 0===i?void 0:i.presets)&&(o={presets:this.convertAmountOptions(a.data.v3.presets,e),isFallback:!1}),this._suggestions[e].suggestion=a.data.isFallback?a.data:{presets:this.convertAmountOptions(a.data.presets,e),isFallback:!1,v3:o},this._suggestions[e].requestDurationMs=Math.round(performance.now()-s)}catch(t){this._suggestions[e]={suggestion:Gi,requestDurationMs:0}}}}))}get timeoutPromise(){return new Promise((e=>{setTimeout((()=>{e({data:Gi,valid:!0})}),1500)}))}get clientTimeOptions(){const e=new Date;return{clientTimeZone:Bi(),clientWeekday:e.getDay(),clientHour:e.getHours(),eventTime:e.toISOString()}}needFetchSuggestion(){return!this._options.experimentsStorage||!this._options.experimentSettings||this._options.experimentSettings.some((e=>this._options.experimentsStorage&&((e,t)=>{var n;if(!t)return!1;const{enabled:i,experimentId:s}=t,a=e.get(),o=a&&(null===(n=a.settings[s])||void 0===n?void 0:n.enabled);return i||Boolean(o)})(this._options.experimentsStorage,e)))}convertAmountOptions(e,t){if(t===qi||!this._options.currencyService)return e;const n={};for(const[i,s]of Object.entries(e))n[i]={currency:t,defaultAmount:this._options.currencyService.convert(s.defaultAmount,qi,t),amountOptions:s.amountOptions.map((e=>this._options.currencyService.convert(e,qi,t)))};return n}request(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){try{const n=yield(0,xn.Em)({url:`${this._options.apiHost}/checkout/getAmountPresets?token=${this._options.sessionTokenService.token}`,method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8","X-FRU-Embed-Version":this._options.embedVersion||"unknown"},params:Object.assign(Object.assign({},this.getRequestOptions(e)),{version:t})});if(!n.valid)throw new Error("Invalid response");return n}finally{this._fetchCallsCount[e]=this._fetchCallsCount[e]+1||1}}))}getRequestOptions(e){const t=this._options.currencyRates[e],n=Object.assign(Object.assign({companyKey:this._options.companyKey,campaignKey:this._options.campaignKey,clientLocale:this._options.clientLocale,utmSource:this._options.utmSource,currency:e,currencyRate:t,fundraiserKey:this._options.fundraiserKey,fundraiserMemberKey:this._options.fundraiserMemberKey},this.clientTimeOptions),{clientId:this._options.clientId,clientConnectionType:this._options.clientConnectionType,clientDeviceMemory:this._options.clientDeviceMemory,clientHardwareConcurrency:this._options.clientHardwareConcurrency,clientConnectionDownlink:this._options.clientConnectionDownlink,clientDoNotTrack:Boolean(this._options.clientDoNotTrack),clientDevicePixelRatio:this._options.clientDevicePixelRatio,clientBatteryLevel:this._options.clientBatteryLevel,checkoutType:this._options.checkoutType,elementType:this._options.elementType});return this.validateRequestOptionsSilently(n),n}validateRequestOptionsSilently(e){return void 0!==e.currency&&void 0!==e.currencyRate||(this._options.sentry.captureException(new Error("Amount Presets: request body is invalid"),{extra:{options:e}}),!1)}}const Hi={isFallback:!0,defaultFrequency:null};class Ki{constructor(e){this._options=e,this._suggestion=Hi,this._requestDurationMs=0,this._fetchCallsCount=0}getMeta(){return{requestDurationMs:this._requestDurationMs,fetchCallsCount:this._fetchCallsCount}}getSuggestion(){return this._suggestion}fetchSuggestion(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{if(this._options.isLighthouse||this._options.isShowcase)return wn.fail(void 0);const t=performance.now(),n=yield Promise.race([this.timeoutPromise,this.request(e)]);return this._suggestion=n.data,this._requestDurationMs=Math.round(performance.now()-t),wn.success(void 0)}catch(e){return this._suggestion=Hi,this._requestDurationMs=0,wn.success(void 0)}}))}get clientTimeOptions(){const e=new Date;return{clientTimeZone:Bi(),clientWeekday:e.getDay(),clientHour:e.getHours(),eventTime:e.toISOString().replace(/\.\d{3}Z$/,"Z")}}get timeoutPromise(){return new Promise((e=>{setTimeout((()=>{e({data:Hi,valid:!0})}),1500)}))}request(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{const t=yield(0,xn.Em)({url:`${this._options.apiHost}/checkout/getDefaultFrequency?token=${this._options.sessionTokenService.token}`,method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8","X-FRU-Embed-Version":this._options.embedVersion||"unknown"},params:this.requestOptions(e)});if(!t.valid)throw new Error("Invalid response");return t}finally{this._fetchCallsCount++}}))}requestOptions(e){return Object.assign(Object.assign({},e),this.clientTimeOptions)}}const Yi=[jt.D.EN_GB],zi={[jt.D.EN_US]:"en_US",[jt.D.EN_GB]:"en_GB",[jt.D.EN_CA]:"en_CA",[jt.D.FR_CA]:"fr_CA",[jt.D.ES]:"es_ES",[jt.D.ES_US]:"es_US",[jt.D.NL]:"nl_NL",[jt.D.NO]:"no_NO",[jt.D.DE]:"de_DE",[jt.D.DE_X_INFORMAL]:"de_DE",[jt.D.FI_FI]:"fi_FI",[jt.D.FR_FR]:"fr_FR",[jt.D.AR_001]:"ar_AE",[jt.D.SV]:"sv_SE",[jt.D.IT]:"it_IT",[jt.D.PT_PT]:"pt_PT",[jt.D.PT_BR]:"pt_BR",[jt.D.ZH_CN]:"zh_CN",[jt.D.ZH_TW]:"zh_TW",[jt.D.JA]:"ja_JP",[jt.D.KO]:"ko_KR",[jt.D.HU]:"hu_HU",[jt.D.DA]:"da_DK",[jt.D.RU_RU]:"ru_RU",[jt.D.PL_PL]:"pl_PL"};function Wi(e){return zi[e]}var $i=n(4280);const Xi="supporter",Qi="1234@example.com",Zi="https://js.stripe.com/v3/";class Ji extends Error{constructor(){super(Ji.errorMessage)}}Ji.errorMessage="Stripe.js could not be loaded";const es={target:window,apiVersion:"2025-02-24.acacia",deferred:!1,promiseHandlerTimeout:0,locale:jt.D.EN_US};function ts(e,t,n,i){const s=n.target,a=function(e){return Yi.includes(e)?e:e.split("-")[0]}(n.locale);return(0,$i.k0)(Zi,n.deferred,s,{},!1,n.loadScriptTimeout).then((()=>new Promise(((i,o)=>{const r=()=>{s.Stripe?i(s.Stripe(e,{stripeAccount:t,apiVersion:n.apiVersion,locale:a})):o(new Ji)};n.promiseHandlerTimeout?setTimeout((()=>{r()}),n.promiseHandlerTimeout):r()})))).catch((e=>{throw e.message.match("js.stripe.com")&&i.captureException(e,{extra:{script:e.message,stripeAccount:t}}),e}))}var ns=n(9199);const is=60*ns.MS.SECOND,ss=window.devicePixelRatio>1;class as extends Error{constructor(e){super("[Stripe Factory]"+e)}}const os=new WeakMap;function rs(e,t){if(e.showcase)return()=>{};let n;const i=()=>(0,d.sH)(this,void 0,void 0,(function*(){if(!e.targetWindow)throw new as("target window is not provided");const i=os.get(e.targetWindow);i?n=i:(n=async function(e,t,n,i=es){let s;const a=Object.assign({},es,i);try{return s=await ts(e,t,a,n),s}catch(i){return ts(e,t,{...a,promiseHandlerTimeout:500},n)}}(e.publicKey,e.stripeAccount||"",t,{target:e.targetWindow,locale:e.locale,loadScriptTimeout:is}),os.set(e.targetWindow,n))}));return i(),function(){return(0,d.sH)(this,void 0,void 0,(function*(){return n||(yield i(),n)}))}}class ls{constructor(){this.disposables=new Set}static isFunction(e){return"function"==typeof e}run(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.initializeCurrencyFilter(),yield this.setLocale(null==e?void 0:e.localeCode),this.initializePageGuardManager(),this.initializePublicJsApi(),this.initializeCookieConsent(),this.initializeUserSession(),this.initializeRouter(),this.initializeTracker(),this.initializeExperiments(),yield this.initializeCurrencyService(),yield this.startFlow(null==e?void 0:e.initialScreen);const t=this.subscribeOnUserInteraction();this.subscribeOnHistoryInteraction(),this.disposables.add(t).add(this.checkoutRouter).add(this.trackerCheckout).add(this.flowManager),this.initializeIFrameRemover()}))}dispose(){this.disposables.forEach((e=>{ls.isFunction(e)?e():e.dispose()}))}}var cs,us,ds,hs,ms;!function(e){e.INACTIVITY="inactivity",e.EXIT="exit",e.PAYMENT_ISSUE="paymentIssue",e.REMINDER_REQUEST="reminderRequest"}(cs||(cs={})),function(e){e.YES="yes",e.NO="no",e.NOT_GIVEN="notGiven"}(us||(us={}));class ps{constructor(e){this.checkoutConfiguration=e,this.eventEmitter=new De.A}getOpenParams(){var e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f;const v=this.checkoutConfiguration.campaign,S=this.checkoutConfiguration.external,E=this.checkoutConfiguration.mergedCustomFields;return{customFields:Object.fromEntries(null!==(e=null==E?void 0:E.map((e=>{let{name:t,value:n}=e;return[t,n]})))&&void 0!==e?e:[]),livemode:this.checkoutConfiguration.infrastructureParams.livemode,campaign:{id:v.key,code:v.code||null,name:v.name},utm:{source:(null===(t=S.utm)||void 0===t?void 0:t.source)||(null===(n=this.checkoutConfiguration.infrastructureQueryParams)||void 0===n?void 0:n.utm_source)||"",campaign:(null===(i=S.utm)||void 0===i?void 0:i.campaign)||(null===(s=this.checkoutConfiguration.infrastructureQueryParams)||void 0===s?void 0:s.utm_campaign)||"",medium:(null===(a=S.utm)||void 0===a?void 0:a.medium)||(null===(o=this.checkoutConfiguration.infrastructureQueryParams)||void 0===o?void 0:o.utm_medium)||"",content:(null===(r=S.utm)||void 0===r?void 0:r.content)||(null===(l=this.checkoutConfiguration.infrastructureQueryParams)||void 0===l?void 0:l.utm_content)||"",term:(null===(c=S.utm)||void 0===c?void 0:c.term)||(null===(u=this.checkoutConfiguration.infrastructureQueryParams)||void 0===u?void 0:u.utm_term)||""},element:{id:null===(d=null==S?void 0:S.element)||void 0===d?void 0:d.key,type:null===(h=null==S?void 0:S.element)||void 0===h?void 0:h.title,name:null===(m=null==S?void 0:S.element)||void 0===m?void 0:m.name},benefit:{id:null===(g=null===(p=this.checkoutConfiguration.external.state)||void 0===p?void 0:p.benefit)||void 0===g?void 0:g.id,optionValueId:null===(f=null===(y=this.checkoutConfiguration.external.state)||void 0===y?void 0:y.benefit)||void 0===f?void 0:f.optionValueId}}}on(e,t){return this.eventEmitter.on(e,t),this}emitCheckoutOpen(e){this.emit(be.OPEN,null!=e?e:this.getOpenParams())}emitDonationComplete(e){this.emit(be.DONATION_COMPLETE,Object.assign(Object.assign({},this.getOpenParams()),e))}setDonationParams(e){this.donationParams=e}setIntentParams(e){this.intent=this.formatIntent(e)}getClosePublicJsApiPayload(){if(!this.donationParams)throw new Error("Call setDonationParams first to set public donation params");return Object.assign(Object.assign({},this.getOpenParams()),this.donationParams)}getIntent(){if(void 0===this.intent)throw new Error("Call setIntentParams on close to set public intent params");return this.intent}dispose(){this.eventEmitter.removeAllListeners()}canFormatIntent(e){var t;if(!e)return!1;const n=!!this.checkoutConfiguration.rawExternal.intent,i=(null===(t=this.checkoutConfiguration.external.element)||void 0===t?void 0:t.type)===Hn.JS_API;return!(e.isSavedEmailOnExit===us.YES)&&(!n||i)}formatIntent(e){var t,n,i,s;if(!this.canFormatIntent(e))return null;const a=this.checkoutConfiguration.external,o=this.checkoutConfiguration.campaign,r=this.checkoutConfiguration.fundraisingPage,l={flowType:e.flowType,campaign:{id:o.key},element:{key:null===(t=a.element)||void 0===t?void 0:t.key,type:null===(n=a.element)||void 0===n?void 0:n.type},checkoutSettings:{customFields:this.checkoutConfiguration.mergedCustomFields,designation:e.checkoutSettings.designation,modifyAmount:e.checkoutSettings.modifyAmount,modifyDesignation:e.checkoutSettings.modifyDesignation},comment:e.comment,donation:e.donation,supporter:e.supporter,tribute:e.tribute,feeCovered:e.feeCovered,benefit:e.benefit};if(r){const e=(null===(s=null===(i=a.campaign)||void 0===i?void 0:i.fundraiser)||void 0===s?void 0:s.key)||r.key;l.fundraisingPage={key:e,customerKey:r.admin}}return l}emit(e,t){this.eventEmitter.emit(e,t)}}function gs(e,t=!0){if(!e)return{};const n=/([^=&#?]+)=([^=&#?]+)/gi,i={};for(;;){const s=n.exec(e);if(!s)break;const[,a,o]=s;try{t?i[decodeURIComponent(a)]=decodeURIComponent(o):i[a]=o}catch(e){console.error(e)}}return i}function ys(e,t){let n=e;for(;;){if(t(n))return n;if(!n.parentNode)return;n=n.parentNode}}function fs(e={},t=!0){const n=[];for(const i in e){const s=e[i];t?n.push(`${encodeURIComponent(i)}=${encodeURIComponent(s)}`):n.push(`${i}=${s}`)}return n.join("&")}function vs(e,t){const n=e.storage;let i=0;const s=n.getField(It.X_FACTOR);if(s)return Number(s)||0;if(!e.sessionAt)return i;try{const n=Date.now(),s=e.sessionPage,a=n-e.sessionAt;t&&(i+=10),/win/i.test(window.navigator.platform)&&(i-=10),/mac/i.test(window.navigator.platform)&&(i+=5),a>648e4&&(i+=10),s<=2&&(i+=15),s>5&&(i+=5),a<6e3&&(i+=5),a>=18e3&&(i+=10)}catch(e){i=0,console.error(e)}return i&&n.setField(It.X_FACTOR,String(i)),i}!function(e){e.POSITIVE="positive",e.NEGATIVE="negative",e.NEUTRAL="neutral"}(ds||(ds={})),function(e){e.HAPPY="happy",e.SAD="sad",e.NEUTRAL="neutral"}(hs||(hs={})),function(e){e.ONCE="once",e.RECURRING="repeat"}(ms||(ms={}));var Ss,Es,As,Cs,bs,Ps,Ns,Ds,Ts,ks,Is,_s,Os,xs,ws,Rs,Ms,Ls,Fs,Us,js,Bs=n(8366);!function(e){e.PAN_ONLY="PAN_ONLY",e.CRYPTOGRAM_3DS="CRYPTOGRAM_3DS"}(Ss||(Ss={})),function(e){e.AMEX="AMEX",e.DISCOVER="DISCOVER",e.JCB="JCB",e.MASTERCARD="MASTERCARD",e.VISA="VISA"}(Es||(Es={})),function(e){e.DEFAULT_MONTHLY="defaultMonthly",e.ONLY_MONTHLY="onlyMonthly",e.DEFAULT_ONETIME="defaultOnetime",e.ONLY_ONETIME="onlyOnetime"}(As||(As={})),function(e){e.FUNDRAISING_PAGE="fundraisingPage",e.REDIRECT="redirect",e.THANK_YOU_SCREEN="thankYouScreen"}(Cs||(Cs={})),function(e){e.NONE="none",e.GENERAL="general",e.CUSTOMIZED="customized"}(bs||(bs={})),function(e){e.ADAPTIVE_COST_COVERAGE="adaptiveCostCoverage",e.PRE_DONATION_UPSELL="preDonationUpsell",e.POST_DONATION_UPSELL="postDonationUpsell",e.ABANDONED_DONATIONS_RECOVERY="abandonedDonationsRecovery",e.PLANS_SAVED_FROM_CANCELLATION="plansSavedFromCancellation",e.FRAUD_ATTEMPTS_PREVENTED="fraudAttemptsPrevented",e.MOBILE_USERS="mobileUsers"}(Ps||(Ps={})),function(e){e.GENERAL="general",e.CUSTOMIZED="customized"}(Ns||(Ns={})),function(e){e.EMAIL="email",e.POSTAL_MAIL="postalMail",e.SMS="sms",e.PHONE_CALLS="phoneCalls",e.SOCIAL_MEDIA="socialMedia"}(Ds||(Ds={})),function(e){e.NOT_SUBMITTED="notSubmitted",e.OPTED_IN="optedIn",e.OPTED_OUT="optedOut"}(Ts||(Ts={})),function(e){e.EMAIL="email",e.SMS="sms",e.PHONE_CALLS="phoneCalls",e.POSTAL_MAIL="postalMail",e.SOCIAL_MEDIA="socialMedia"}(ks||(ks={})),function(e){e.DESKTOP="desktop",e.MOBILE="mobile"}(Is||(Is={})),function(e){e.DISABLED="disabled",e.DRY_RUN="dry-run",e.ENABLED="enabled"}(_s||(_s={})),function(e){e.LIVE="live",e.TEST="test"}(Os||(Os={})),function(e){e.TEXT="text",e.EMAIL="email"}(xs||(xs={})),function(e){e.WEBSITE="website",e.CAMPAIGN_PAGE="campaignPage",e.VIRTUAL_TERMINAL="virtualTerminal",e.DONOR_PORTAL="donorPortal",e.DASHBOARD="dashboard",e.RECURRING_MIGRATION="recurringMigration",e.API="api"}(ws||(ws={})),function(e){e.DAY_7="7d",e.MONTH="1m",e.MONTH_3="3m",e.YEAR_TO_DAY="ytd",e.YEAR="1y",e.YEAR_5="5y"}(Rs||(Rs={})),function(e){e.FULL="full",e.CHUNK="chunk"}(Ms||(Ms={})),function(e){e.CHARGES="charges",e.COMPANIES="companies",e.CUSTOMERS="customers",e.ELEMENTS="elements",e.SUBSCRIPTIONS="subscriptions",e.WIDGETS="widgets",e.FUNDRAISING_PAGES="fundraisingpages",e.USERS="users"}(Ls||(Ls={})),function(e){e.FULL="full",e.FROM="from"}(Fs||(Fs={})),Rs.DAY_7,Rs.MONTH,Rs.MONTH_3,Rs.YEAR_TO_DAY,Rs.YEAR,Rs.YEAR_5;class Gs{static getDefaultFrequency(e){const t=Object.keys(e).find((t=>e[t].enabled&&e[t].default));if(!t)throw new Error("No default frequency found");return t}static getDefaultFrequencyWithOverride(e,t){return t&&this.getEnabledFrequencies(e).includes(t)?t:Object.keys(e).find((t=>e[t].enabled&&e[t].default))||null}static getSecondaryFrequency(e){return Object.keys(e).find((t=>e[t].enabled&&!e[t].default))}static getEnabledFrequencies(e){const t=Object.keys(e).filter((t=>e[t].enabled)).map((e=>e));if(0===t.length)throw new Error("No enabled frequencies found");return this.sortByWeights(t)}static isOnetimeOnly(e){const t=this.getEnabledFrequencies(e);return 1===t.length&&t.includes(qn.ONCE)}static isRecurringOnly(e){return!this.getEnabledFrequencies(e).includes(qn.ONCE)}static isOnetimeEnabled(e){return this.getEnabledFrequencies(e).includes(qn.ONCE)}static isRecurringEnabled(e){return!!this.getEnabledFrequencies(e).find((e=>e!==qn.ONCE))}static frequencySettingsToWidgetRepeat(e){const t=this.isOnetimeEnabled(e),n=this.isRecurringEnabled(e);return t&&!n?As.ONLY_ONETIME:!t&&n?As.ONLY_MONTHLY:this.getDefaultFrequency(e)===qn.ONCE?As.DEFAULT_ONETIME:As.DEFAULT_MONTHLY}static isFrequencyEnabled(e,t){return null!==t&&(Object.values(qn).includes(t)&&Gs.getEnabledFrequencies(e).includes(t))}static sortByWeights(e){return e.sort(((e,t)=>Ti[e]-Ti[t]))}}!function(e){e.HELPING_HAND_STAGING="FUNTMDMPPAF",e.ISRAELI_AMERICAN_COUNCIL_1="FUNTWQULBUW",e.ISRAELI_AMERICAN_COUNCIL_2="FUNVUTSEZXA",e.ACCESS_FUND_1="FUNFWAWHCAJ",e.ACCESS_FUND_2="FUNYGCGZKAB",e.ACCESS_FUND_3="FUNUVSVAKSL",e.IAC_1="FUNRYLWADLU",e.IAC_2="FUNQNGXYKJA",e.IAC_3="FUNSWLJZBXE",e.IAC_4="FUNALPRPKQD"}(Us||(Us={})),function(e){e.RECURRING="recurring",e.ONE_TIME="one-time",e.ALL="all"}(js||(js={}));var qs=n(4995),Vs=n.n(qs),Hs=n(7028),Ks=n(3846);function Ys(e){return(0,Ks.Ay)(e)}function zs(e){return(0,Hs.Ay)(Ys(e),(e=>e))}const Ws=2*ns.MS.SECOND,$s=5*ns.MS.SECOND,Xs=e=>`https://ucarecdn.com/7a2a472d-06d6-48fc-8c7d-37e313b717e0/-/resize/${e?"1248x":"624x"}/-/format/auto/`;var Qs;!function(e){e.ELEMENT_IMAGE_CARD="elementImageCard",e.ELEMENT_POPUP="elementPopup",e.ELEMENT_QR_CODE="elementQrCode",e.P2P_PHOTO="p2pPhoto",e.P2P_PHOTO_BIG="p2pPhotoBig",e.DONOR_PORTAL_HERO="donorPortalHero",e.DONOR_PORTAL_FAVICON="donorPortalFavicon",e.DONOR_PORTAL_P2P_GOAL_REACHED="donorPortalP2pGoalReached",e.EMAIL_LOGO="emailLogo",e.EMAIL_IMAGE="emailImage",e.EMAIL_TRIBUTE="emailTribute",e.RECEIPT_LOGO="receiptLogo",e.RECEIPT_SIGNATURE="receiptSignature",e.CHECKOUT_LOGO="checkoutLogo",e.CHECKOUT_ASK="checkoutAsk",e.PAGE_LOGO="pageLogo",e.PAGE_MAIN_IMAGE="pageMainImage",e.ORGANIZATION_LOGO="organizationLogo",e.RATE_MATCHING_SPONSOR_LOGO="rateMatchingSponsorLogo",e.BENEFIT_IMAGE="benefitImage"}(Qs||(Qs={}));const Zs={[Qs.ELEMENT_IMAGE_CARD]:{width:342,height:356},[Qs.ELEMENT_POPUP]:{width:480,height:270},[Qs.ELEMENT_QR_CODE]:{width:50,height:50},[Qs.P2P_PHOTO]:{width:64,height:64},[Qs.P2P_PHOTO_BIG]:{width:624,height:351},[Qs.DONOR_PORTAL_HERO]:{width:858,height:320},[Qs.DONOR_PORTAL_FAVICON]:{width:16,height:16},[Qs.DONOR_PORTAL_P2P_GOAL_REACHED]:{width:858,height:265},[Qs.EMAIL_LOGO]:{width:80,height:80},[Qs.EMAIL_IMAGE]:{width:580,height:218},[Qs.EMAIL_TRIBUTE]:{width:386,height:263},[Qs.RECEIPT_LOGO]:{width:80,height:80},[Qs.RECEIPT_SIGNATURE]:{width:120,height:120},[Qs.CHECKOUT_LOGO]:{width:50,height:50},[Qs.CHECKOUT_ASK]:{width:516,height:289},[Qs.PAGE_LOGO]:{width:56,height:56},[Qs.PAGE_MAIN_IMAGE]:{width:624,height:351},[Qs.ORGANIZATION_LOGO]:{width:60,height:60},[Qs.RATE_MATCHING_SPONSOR_LOGO]:{width:48,height:48},[Qs.BENEFIT_IMAGE]:{width:400,height:400}};function Js(e,t){var n,i,s,a,o;return(null===(i=null===(n=t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show)?null!==(s=t.campaign.ask.title)&&void 0!==s?s:"":null!==(o=null===(a=e.campaignPage)||void 0===a?void 0:a.ask.title)&&void 0!==o?o:""}function ea(e,t){var n,i,s,a,o,r;return(null===(i=null===(n=t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show)?null!==(s=t.campaign.ask.text)&&void 0!==s?s:"":null!==(r=null===(o=null===(a=e.campaignPage)||void 0===a?void 0:a.ask)||void 0===o?void 0:o.text)&&void 0!==r?r:""}var ta={getLinks:function(e){var t,n;return(null===(n=null===(t=e.campaignPage)||void 0===t?void 0:t.ask)||void 0===n?void 0:n.links)?[...e.campaignPage.ask.links]:[]},getAskTitle:Js,getLogoImageURL:function(e,t){var n,i,s,a,o,r;return t?null===(s=null===(i=null===(n=e.campaignPage)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.logoImage)||void 0===s?void 0:s.previewUrlRetina:null===(r=null===(o=null===(a=e.campaignPage)||void 0===a?void 0:a.ask)||void 0===o?void 0:o.logoImage)||void 0===r?void 0:r.previewUrl},getMainVideo:function(e){var t,n;return(null===(n=null===(t=e.campaignPage)||void 0===t?void 0:t.ask)||void 0===n?void 0:n.mainVideo)||null},getMainMediaProvider:function(e){var t,n;return(null===(n=null===(t=e.campaignPage)||void 0===t?void 0:t.ask)||void 0===n?void 0:n.mainMediaProvider)||null},getAskDescription:ea,getAskMainImageURL:function(e,t){var n,i,s,a,o,r;const l=Xs(t);return(t?null===(s=null===(i=null===(n=e.campaignPage)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.mainImage)||void 0===s?void 0:s.previewUrlRetina:null===(r=null===(o=null===(a=e.campaignPage)||void 0===a?void 0:a.ask)||void 0===o?void 0:o.mainImage)||void 0===r?void 0:r.previewUrl)||l},getCompanyImageURL:function(e,t){if(!e.logoUuid)return null;const n=t?"x112":"x56";return`https://ucarecdn.com/${e.logoUuid}/-/resize/${n}/-/format/auto/`},getLogoAltText:function(e){var t,n,i;return(null===(i=null===(n=null===(t=e.campaignPage)||void 0===t?void 0:t.ask)||void 0===n?void 0:n.logoImage)||void 0===i?void 0:i.alt)||null},getMainImageAltText:function(e){var t,n,i;return(null===(i=null===(n=null===(t=e.campaignPage)||void 0===t?void 0:t.ask)||void 0===n?void 0:n.mainImage)||void 0===i?void 0:i.alt)||null},getCompanyLogoImageAltText:function(e){return e.logoAlt||null},getShowTabs:function(e,t,n){if(!e)return!1;const i=Js(t,n),s=ea(t,n);return Boolean(i)&&Boolean(s)},getFundraiserImageURL:function(e,t){var n;if(!(null===(n=null==e?void 0:e.image)||void 0===n?void 0:n.uuid))return null;if(e.image.width&&e.image.width<1248)return null;if(e.image.height&&e.image.height<702)return null;const i=t?2*Zs[Qs.PAGE_MAIN_IMAGE].width:Zs[Qs.PAGE_MAIN_IMAGE].width;return`https://ucarecdn.com/${e.image.uuid}/-/resize/${i}x/-/format/auto/`}};function na(e,t){var n,i,s;return(null===(i=null===(n=t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show)?null!==(s=t.campaign.ask.title)&&void 0!==s?s:"":e.ask.title}function ia(e,t){var n,i,s;return(null===(i=null===(n=t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show)?null!==(s=t.campaign.ask.text)&&void 0!==s?s:"":e.ask.text}var sa,aa,oa,ra,la,ca,ua,da,ha,ma,pa={getLinks:function(e){return[...e.ask.links]},getAskTitle:na,getLogoImageURL:function(e,t){var n,i;return t?null===(n=e.ask.logoImage)||void 0===n?void 0:n.previewUrlRetina:null===(i=e.ask.logoImage)||void 0===i?void 0:i.previewUrl},getAskDescription:ia,getMainVideo:function(e){return e.ask.mainVideo||null},getMainMediaProvider:function(e){return e.ask.mainMediaProvider||null},getAskMainImageURL:function(e,t){var n,i;const s=Xs(t);return(t?null===(n=e.ask.mainImage)||void 0===n?void 0:n.previewUrlRetina:null===(i=e.ask.mainImage)||void 0===i?void 0:i.previewUrl)||s},getCompanyImageURL:function(e,t){if(!e.logoUuid)return null;const n=t?"x100":"x50";return`https://ucarecdn.com/${e.logoUuid}/-/resize/${n}/-/format/auto/`},getLogoAltText:function(e){var t;return(null===(t=e.ask.logoImage)||void 0===t?void 0:t.alt)||null},getMainImageAltText:function(e){var t;return(null===(t=e.ask.mainImage)||void 0===t?void 0:t.alt)||null},getCompanyLogoImageAltText:function(e){return e.logoAlt||null},getShowTabs:function(e,t,n){if(!e)return!1;const{show:i}=t.ask;if(!i)return!1;const s=na(t,n),a=ia(t,n);return Boolean(s)&&Boolean(a)},getFundraiserImageURL:function(e,t){var n;if(!(null===(n=null==e?void 0:e.image)||void 0===n?void 0:n.uuid))return null;if(e.image.width&&e.image.width<1248)return null;if(e.image.height&&e.image.height<702)return null;const i=t?2*Zs[Qs.CHECKOUT_ASK].width:Zs[Qs.CHECKOUT_ASK].width;return`https://ucarecdn.com/${e.image.uuid}/-/resize/${i}x/-/format/auto/`}};!function(e){e.IMAGE="image",e.VIDEO="video"}(sa||(sa={})),function(e){e.RELATIVE="relative",e.ABSOLUTE="absolute"}(aa||(aa={})),function(e){e.TWO_WEEKS="2weeks",e.ONE_MONTH="1month",e.THREE_MONTHS="3months"}(oa||(oa={})),function(e){e.ASC="asc",e.DESC="desc"}(ra||(ra={})),function(e){e.WITHOUT="without",e.SELECT="select",e.ASSIGN="assign"}(la||(la={})),function(e){e.ENABLED="enabled",e.DISABLED="disabled"}(ca||(ca={})),function(e){e.ACTIVE="active",e.DISABLED="disabled",e.AUTO_ARCHIVE="autoArchive"}(ua||(ua={})),function(e){e.FULL_NAME="fullName",e.FIRST_NAME_LAST_INITIALS="firstNameLastInitials",e.FIRST_NAME="firstName",e.NONE="none"}(da||(da={})),function(e){e.SPECIFIED="specified",e.DETECTED="detected",e.ACTUAL="actual"}(ha||(ha={})),function(e){e.ROUNDED="rounded",e.SHARP="sharp",e.PILL="pill"}(ma||(ma={}));const ga=(Object.values({"2:1":1.5,"1:1":2,"1:2":3,"1:3":4,"1:4":5,"1:5":6,"1:6":7,"1:7":8,"1:8":9,"1:9":10,"1:10":11}),{"2:1":1.5,"1:1":2,"1:2":3,"1:3":4,"1:4":5,"1:5":6,"1:6":7,"1:7":8,"1:8":9,"1:9":10,"1:10":11});var ya;Object.values(ga),function(e){e.UP_TO_25="up_to_25",e.UP_TO_35="up_to_35",e.UP_TO_55="up_to_55",e.UP_TO_100="up_to_100",e.UP_TO_150="up_to_150",e.UP_TO_200="up_to_200"}(ya||(ya={}));const fa={ask:{logoImage:null,mainImage:null,mainVideo:null,mainMediaProvider:sa.IMAGE,text:"",title:"",links:[]},sharing:{twitter:!1,facebook:!1,linkedin:!1,copyLink:!1,email:!1},goal:{hasGoal:!1,amount:0,endDate:null,raisedAmount:0,raisedAmountWithRateMatching:0,donorsCount:0,showTotalRaisedAmount:!1},donorImpact:{show:!1,donorNameType:da.NONE,showDonorComment:!1,showDonationAmount:!1,showDonationDate:!1,showDonorLocation:!1,currencyShowType:ha.ACTUAL,currency:""},rateMatching:{show:!1,rate:0,sponsor:null,minAmount:0,endDate:null,endDateEnabled:!1,sponsorEnabled:!1,startDate:null,totalAmountLimitEnabled:!1,totalAmountLimit:null,raised:null,remains:null},thankYouScreen:{type:Cs.THANK_YOU_SCREEN,redirect:{url:null,includeSupporterData:!1},sharing:{link:null,text:null,channels:{twitter:!1,facebook:!1,email:!1,linkedin:!1}}},appearance:{color:"",type:ma.PILL},multipleDesignations:{enabled:!1}},va={isAdaptiveDefaultFrequencySuggestionEnabled:!0},Sa={isActive:!0},Ea={enabledForDonationFrequencies:Object.values(qn),enabledTargetFrequencies:[qn.ANNUAL,qn.EVERY_4_WEEKS,qn.MONTHLY],amountsMap:{[ya.UP_TO_25]:[500,1e3],[ya.UP_TO_35]:[1e3,1500],[ya.UP_TO_55]:[1500,2e3],[ya.UP_TO_100]:[2e3,2500],[ya.UP_TO_150]:[2500,3e3],[ya.UP_TO_200]:[3e3,4e3]},isAdaptiveSuggestionEnabled:!0},Aa={disabledPaymentMethods:[],isNewIdealPaymentFlowEnabled:!1},Ca={isEnabled:!0};class ba{constructor(e,t,n){this.queryParamsFormatter=e,this.launcherParamsFormatter=t,this.intentParamsFormatter=n}format(){return{state:{donation:{amount:this.donationAmount,amountHintId:this.donationAmountHintId,enabledAmountHintsIds:this.donationEnabledAmountHintsIds,currency:this.donationCurrency,frequency:this.donationFrequency,isAmountEditable:this.isDonationAmountEditable,isEndDateEnabled:this.isDonationEndDateEnabled,isEndDateSelected:this.isDonationEndDateSelected,isFeeCovered:this.isDonationFeeCovered,donationItems:this.donationItems},designation:{id:this.designationId,isEditable:this.isDesignationEditable,key:this.designationKey,code:this.designationCode,repeat:this.designationRepeat,default:this.designationDefault,localization:this.designationLocalization,frequency:this.designationFrequency},tribute:{inHonorOf:this.tributeInHonorOf,type:this.tributeType,isSelected:this.isTributeSelected},comment:this.comment,supporter:{firstName:this.supporterFirstName,lastName:this.supporterLastName,email:this.supporterEmail},benefit:{id:this.benefitId,optionValueId:this.benefitOptionValueId}},flow:{type:this.flowType,screen:this.screen},campaign:{ask:{show:this.isAskShown,title:this.askTitle,text:this.askText},fundraiser:{key:this.fundraiserKey,customerKey:this.fundraiserCustomerKey},successUrl:this.successUrl},element:{key:this.elementKey,type:this.elementType,title:this.elementTitle,name:this.elementName,locale:this.elementLocale,reminderKey:this.elementReminderKey,splitTestName:this.splitTestName,splitTestVariant:this.splitTestVariant,trackingData:this.elementTrackingData},customFields:this.customFields,utm:{source:this.utmSource,campaign:this.utmCampaign,medium:this.utmMedium,content:this.utmContent,term:this.utmTerm},restore:{token:this.restoreToken,paymentIntentClientSecret:this.restorePaymentIntentClientSecret,clientId:this.restoreClientId},tracker:{eventTags:this.trackerEventTags,embedClientId:this.trackerEmbedClientId}}}get donationAmount(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.donationAmount)&&void 0!==e?e:this.launcherParamsFormatter.donationAmount)&&void 0!==t?t:this.queryParamsFormatter.donationAmount}get donationAmountHintId(){var e;return null!==(e=this.intentParamsFormatter.donationAmountHintId)&&void 0!==e?e:this.launcherParamsFormatter.donationAmountHintId}get donationEnabledAmountHintsIds(){return this.launcherParamsFormatter.donationEnabledAmountHintsIds}get donationCurrency(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.donationCurrency)&&void 0!==e?e:this.launcherParamsFormatter.donationCurrency)&&void 0!==t?t:this.queryParamsFormatter.donationCurrency}get donationFrequency(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.donationFrequency)&&void 0!==e?e:this.launcherParamsFormatter.donationFrequency)&&void 0!==t?t:this.queryParamsFormatter.donationFrequency}get isDonationAmountEditable(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.isDonationAmountEditable)&&void 0!==e?e:this.launcherParamsFormatter.isDonationAmountEditable)&&void 0!==t?t:this.queryParamsFormatter.isDonationAmountEditable}get isDonationEndDateEnabled(){return this.launcherParamsFormatter.isDonationEndDateEnabled}get isDonationEndDateSelected(){return this.launcherParamsFormatter.isDonationEndDateSelected}get isDonationFeeCovered(){return this.intentParamsFormatter.isDonationFeeCovered}get donationItems(){return this.intentParamsFormatter.donationItems}get designationId(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.designationId)&&void 0!==e?e:this.launcherParamsFormatter.designationId)&&void 0!==t?t:this.queryParamsFormatter.designationId}get isDesignationEditable(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.isDesignationEditable)&&void 0!==e?e:this.launcherParamsFormatter.isDesignationEditable)&&void 0!==t?t:this.queryParamsFormatter.isDesignationEditable}get designationKey(){return this.launcherParamsFormatter.designationKey}get designationCode(){return this.launcherParamsFormatter.designationCode}get designationRepeat(){return this.launcherParamsFormatter.designationRepeat}get designationDefault(){return this.launcherParamsFormatter.designationDefault}get designationLocalization(){return this.launcherParamsFormatter.designationLocalization}get designationFrequency(){return this.launcherParamsFormatter.designationFrequency}get tributeInHonorOf(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.tributeInHonorOf)&&void 0!==e?e:this.launcherParamsFormatter.tributeInHonorOf)&&void 0!==t?t:this.queryParamsFormatter.tributeInHonorOf}get tributeType(){return this.launcherParamsFormatter.tributeType}get isTributeSelected(){var e;return null!==(e=this.launcherParamsFormatter.isTributeSelected)&&void 0!==e?e:this.queryParamsFormatter.isTributeSelected}get comment(){return this.intentParamsFormatter.comment}get supporterFirstName(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.supporterFirstName)&&void 0!==e?e:this.launcherParamsFormatter.supporterFirstName)&&void 0!==t?t:this.queryParamsFormatter.supporterFirstName}get supporterLastName(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.supporterLastName)&&void 0!==e?e:this.launcherParamsFormatter.supporterLastName)&&void 0!==t?t:this.queryParamsFormatter.supporterLastName}get supporterEmail(){var e,t;return null!==(t=null!==(e=this.intentParamsFormatter.supporterEmail)&&void 0!==e?e:this.launcherParamsFormatter.supporterEmail)&&void 0!==t?t:this.queryParamsFormatter.supporterEmail}get flowType(){return this.intentParamsFormatter.flowType}get screen(){return this.launcherParamsFormatter.screen}get isAskShown(){return this.launcherParamsFormatter.isAskShown}get askTitle(){return this.launcherParamsFormatter.askTitle}get askText(){return this.launcherParamsFormatter.askText}get fundraiserKey(){var e;return null!==(e=this.launcherParamsFormatter.fundraiserKey)&&void 0!==e?e:this.queryParamsFormatter.fundraiserKey}get fundraiserCustomerKey(){return this.queryParamsFormatter.fundraiserCustomerKey}get successUrl(){return this.queryParamsFormatter.successUrl}get elementKey(){return this.launcherParamsFormatter.elementKey}get elementType(){return this.launcherParamsFormatter.elementType}get elementTitle(){return this.launcherParamsFormatter.elementTitle}get elementName(){return this.launcherParamsFormatter.elementName}get elementLocale(){return this.launcherParamsFormatter.elementLocale}get elementReminderKey(){return this.launcherParamsFormatter.elementReminderKey}get splitTestName(){return this.launcherParamsFormatter.splitTestName}get splitTestVariant(){return this.launcherParamsFormatter.splitTestVariant}get elementTrackingData(){return this.launcherParamsFormatter.elementTrackingData}get customFields(){var e;return null!==(e=this.intentParamsFormatter.customFields)&&void 0!==e?e:this.launcherParamsFormatter.customFields}get utmSource(){return this.queryParamsFormatter.utmSource}get utmCampaign(){return this.queryParamsFormatter.utmCampaign}get utmMedium(){return this.queryParamsFormatter.utmMedium}get utmContent(){return this.queryParamsFormatter.utmContent}get utmTerm(){return this.queryParamsFormatter.utmTerm}get restoreToken(){return this.queryParamsFormatter.restoreToken}get restorePaymentIntentClientSecret(){return this.queryParamsFormatter.restorePaymentIntentClientSecret}get restoreClientId(){return this.queryParamsFormatter.restoreClientId}get trackerEventTags(){return this.queryParamsFormatter.trackerEventTags}get trackerEmbedClientId(){return this.queryParamsFormatter.trackerEmbedClientId}get benefitId(){var e;return null!==(e=this.intentParamsFormatter.benefitId)&&void 0!==e?e:this.launcherParamsFormatter.benefitId}get benefitOptionValueId(){var e;return null!==(e=this.intentParamsFormatter.benefitOptionValueId)&&void 0!==e?e:this.launcherParamsFormatter.benefitOptionValueId}}function Pa(e,t){if("boolean"==typeof e)return e;if("string"==typeof e){const n=e.trim();if(null==t?void 0:t.trueValue)return n===t.trueValue;if(null==t?void 0:t.falseValue)return n!==t.falseValue}}var Na=n(7149);const Da=(0,Na.Ay)(),Ta=99999900;function ka(e,t){const n=function(e,t){var n,i;if(void 0===e)return;if("number"==typeof e)return e;const s=Number.parseFloat(e.trim()),a=null!==(i=null===(n=Da[null!=t?t:"USD"])||void 0===n?void 0:n.digits)&&void 0!==i?i:2;return s*Math.pow(10,a)}(e,t);if(void 0!==n&&!(Number.isNaN(n)||n<0))return n>Ta?Ta:Math.round(n)}function Ia(e){return!!e&&function(e){return/^(([a-zA-Z0-9-_+']+(\.[a-zA-Z0-9-_+']+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z0-9]([a-zA-Z\-0-9]*[a-zA-Z0-9]+)?\.)+[a-zA-Z]{2,}))$/.test(String(e))}(e)}function _a(e){const t=null==e?void 0:e.trim();if(t&&Ia(t))return t}function Oa(e,t){const n=null==e?void 0:e.trim();if(n&&(!t||t.includes(n)))return n}class xa{constructor(e,t){this.intentParams=e,this.config=t}get donationAmount(){var e,t;return ka(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.amount)}get donationAmountHintId(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.selectedHintId,this.config.enabledDonationAmountHintsIds)}get donationCurrency(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.currency,this.flowType===$n.CRYPTO?void 0:this.config.enabledDonationCurrencies)}get donationFrequency(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.frequency,this.config.enabledDonationFrequencies)}get isDonationAmountEditable(){var e,t;return Pa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.checkoutSettings)||void 0===t?void 0:t.modifyAmount)}get isDonationFeeCovered(){var e;return Pa(null===(e=this.intentParams)||void 0===e?void 0:e.feeCovered)}get designationId(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.checkoutSettings)||void 0===t?void 0:t.designation)}get isDesignationEditable(){var e,t;return Pa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.checkoutSettings)||void 0===t?void 0:t.modifyDesignation)}get tributeInHonorOf(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.tribute)||void 0===t?void 0:t.inHonorOf)}get comment(){var e;return Oa(null===(e=this.intentParams)||void 0===e?void 0:e.comment)}get supporterFirstName(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.supporter)||void 0===t?void 0:t.firstName)}get supporterLastName(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.supporter)||void 0===t?void 0:t.lastName)}get supporterEmail(){var e,t;return _a(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.supporter)||void 0===t?void 0:t.email)}get flowType(){var e;return Oa(null===(e=this.intentParams)||void 0===e?void 0:e.flowType,Object.values($n))}get customFields(){var e,t;return null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.checkoutSettings)||void 0===t?void 0:t.customFields}get donationItems(){var e,t;return null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.donationItems}get benefitId(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.benefit)||void 0===t?void 0:t.id)}get benefitOptionValueId(){var e,t;return Oa(null===(t=null===(e=this.intentParams)||void 0===e?void 0:e.benefit)||void 0===t?void 0:t.optionValueId)}}var wa,Ra,Ma,La,Fa;!function(e){e[e.MIN=80]="MIN",e[e.MAX=250]="MAX"}(wa||(wa={})),function(e){e.EMAIL="email",e.ADDRESS="address",e.NOT_SHARE="not_share"}(Ra||(Ra={})),function(e){e.NONE="none",e.HONOR="honor",e.MEMORY="memory"}(Ma||(Ma={})),function(e){e.POSTAL_CARD="card",e.LETTER="letter"}(La||(La={}));class Ua{constructor(e,t){this.launcherParams=e,this.config=t}get donationAmount(){var e,t,n;return ka(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.amount)}get donationAmountHintId(){var e,t,n,i;return Oa(null===(i=null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.amountHint)||void 0===i?void 0:i.id,this.config.enabledDonationAmountHintsIds)}get donationEnabledAmountHintsIds(){var e,t,n;return function(e,t){if(!e)return;const n={};for(const[i,s]of Object.entries(e)){const e=Oa(i,t.enabledDonationFrequencies),a=s.map((e=>Oa(e,t.enabledDonationAmountHintsIds))).filter((e=>void 0!==e));if(!e||a.length<s.length)return;n[e]=a}return n}(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.enabledAmountHints,this.config)}get donationCurrency(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.currency,this.config.enabledDonationCurrencies)}get donationFrequency(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.frequency,this.config.enabledDonationFrequencies)}get isDonationAmountEditable(){var e,t,n;return Pa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.isAmountEditable)}get isDonationEndDateEnabled(){var e,t,n;return Pa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.isEndDateEnabled)}get isDonationEndDateSelected(){var e,t,n;return Pa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.isEndDateSelected)}get designationId(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.id)}get isDesignationEditable(){var e,t,n;return Pa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.isEditable)}get designationKey(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.key)}get designationCode(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.code)}get designationRepeat(){var e,t,n;return null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.repeat}get designationDefault(){var e,t,n;return null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.default}get designationLocalization(){var e,t,n;return null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.localization}get designationFrequency(){var e,t,n;return null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.designation)||void 0===n?void 0:n.frequency}get tributeInHonorOf(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.tribute)||void 0===n?void 0:n.inHonorOf)}get tributeType(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.tribute)||void 0===n?void 0:n.type,Object.values(Ma))}get isTributeSelected(){var e,t,n;return Pa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.tribute)||void 0===n?void 0:n.isSelected)}get supporterFirstName(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.supporter)||void 0===n?void 0:n.firstName)}get supporterLastName(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.supporter)||void 0===n?void 0:n.lastName)}get supporterEmail(){var e,t,n;return _a(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.supporter)||void 0===n?void 0:n.email)}get screen(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.screen,Object.values(Ne))}get isAskShown(){var e,t,n,i;return Pa(null===(i=null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show)}get askTitle(){var e,t,n,i;return Oa(null===(i=null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.title)}get askText(){var e,t,n,i;return Oa(null===(i=null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.text)}get fundraiserKey(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.campaign)||void 0===n?void 0:n.fundraiser)}get elementKey(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.key)}get elementType(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.type,Object.values(Hn))}get elementTitle(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.title)}get elementName(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.name)}get elementLocale(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.locale,Object.values(jt.D))}get elementReminderKey(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.reminderKey)}get splitTestName(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.splitTestName)}get splitTestVariant(){var e,t;return Oa(null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.splitTestVariant)}get elementTrackingData(){var e;return null===(e=this.launcherParams)||void 0===e?void 0:e.elementTrackingData}get customFields(){var e,t;return null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.element)||void 0===t?void 0:t.customFields}get benefitId(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.benefit)||void 0===n?void 0:n.id)}get benefitOptionValueId(){var e,t,n;return Oa(null===(n=null===(t=null===(e=this.launcherParams)||void 0===e?void 0:e.checkoutInitialData)||void 0===t?void 0:t.benefit)||void 0===n?void 0:n.optionValueId)}}function ja(e){const t=null==e?void 0:e.trim();var n;if(t&&(n=t)&&20===n.length&&!/[^\d]/.test(n))return t}n(3393),function(e){e.CARD="creditCard",e.APPLE_PAY="applePay",e.GOOGLE_PAY="googlePay",e.CLICK_TO_PAY="clickToPay",e.ACH="ach",e.PLAID="plaid",e.PAYPAL="paypal",e.VENMO="venmo",e.AU_BECS="auBecsDebit",e.UK_BACS="ukBacs",e.ACSS="acss",e.SEPA="sepa",e.IDEAL="ideal",e.CRYPTO="crypto",e.STOCK="stock",e.US_BANK_ACCOUNT="usBankAccount"}(Fa||(Fa={}));const Ba=[[0,3,1,7,5,9,8,6,4,2],[7,0,9,2,1,5,4,8,6,3],[4,2,0,6,8,7,1,3,5,9],[1,7,5,0,9,8,3,4,2,6],[6,1,2,3,0,4,5,9,7,8],[3,6,7,4,2,0,9,5,8,1],[5,8,6,9,7,2,0,1,3,4],[8,9,4,5,3,6,2,0,1,7],[9,4,3,8,6,1,7,2,0,5],[2,5,8,1,4,3,6,7,9,0]];function Ga(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charAt(n);t=Ba[t][i]}return t.toString()}const qa=/^\d{19}$/;class Va{constructor(e,t){this.queryParams=e,this.config=t}get donationAmount(){var e,t;return ka(null===(e=this.queryParams)||void 0===e?void 0:e.amount,null!==(t=this.donationCurrency)&&void 0!==t?t:this.config.defaultCurrency)}get donationCurrency(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.currency,this.config.enabledDonationCurrencies)}get donationFrequency(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.recurring,this.config.enabledDonationFrequencies)}get isDonationAmountEditable(){var e;return Pa(null===(e=this.queryParams)||void 0===e?void 0:e.modifyAmount,{falseValue:"no"})}get designationId(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.designationId)}get isDesignationEditable(){var e;return Pa(null===(e=this.queryParams)||void 0===e?void 0:e.modifyDesignation,{falseValue:"no"})}get tributeInHonorOf(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.tributeHonoree)}get isTributeSelected(){var e;return Pa(null===(e=this.queryParams)||void 0===e?void 0:e.tributeSelected,{trueValue:"yes"})}get supporterFirstName(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.firstName)}get supporterLastName(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.lastName)}get supporterEmail(){var e;return _a(null===(e=this.queryParams)||void 0===e?void 0:e.email)}get fundraiserKey(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.fundraiser)}get fundraiserCustomerKey(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.member)}get successUrl(){var e;return function(e){const t=null==e?void 0:e.trim();if(t&&function(e){let t;try{t=new URL(e)}catch(e){return!1}return"http:"===t.protocol||"https:"===t.protocol}(t))return t}(null===(e=this.queryParams)||void 0===e?void 0:e.successUrl)}get utmSource(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.utm_source)}get utmMedium(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.utm_medium)}get utmCampaign(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.utm_campaign)}get utmContent(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.utm_content)}get utmTerm(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.utm_term)}get restoreToken(){var e;return function(e){const t=null==e?void 0:e.trim();if(t&&qa.test(t)&&function(e){const[t,n]=function(e){return[e.slice(0,-1),e.slice(-1)]}(e);return Ga(t)===n}(t))return t}(null===(e=this.queryParams)||void 0===e?void 0:e.restoreToken)}get restorePaymentIntentClientSecret(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.payment_intent_client_secret)}get restoreClientId(){var e;return ja(null===(e=this.queryParams)||void 0===e?void 0:e.clientId)}get trackerEventTags(){var e;return Oa(null===(e=this.queryParams)||void 0===e?void 0:e.eventTags)}get trackerEmbedClientId(){var e;return ja(null===(e=this.queryParams)||void 0===e?void 0:e.embedClientId)}}class Ha{static overrideWidgetGoalsConfig(e){const t=Ys(e);return Gs.isOnetimeOnly(e.frequencies)||Gs.isRecurringOnly(e.frequencies)?(this.hasDefaultGoalForAllFrequencies(e.goals)||(t.goals=t.goals.map(((e,t)=>Object.assign(Object.assign({},e),{repeat:js.ALL,default:0===t?js.ALL:null})))),t):t}static hasDefaultGoalForAllFrequencies(e){return e.some((e=>{const t=e.repeat===js.ALL,n=e.default===js.ALL;return t&&n}))}constructor(e,t,n,i,s,a,o){var r,l,c;this._showcase=e.showcase;const u=this.cloneWidget(e.campaign);this._infrastructureParams=zs(n),this._infrastructureQueryParams=o&&zs(o),this._integrations=zs(i),this._environmentConfig=zs(s),this._campaign=zs(Object.assign(Object.assign({},u),{config:Vs()(u.config,"ask")})),this._cryptoCurrencies=zs(e.config.cryptoCurrencies),this._currencies=zs(e.config.currencies),this._user=zs(e.user),this._company=this.getResolvedCompany(e.company),this._fundraisingPage=e.fundraisingPage?this.getFundraisingPage(e.fundraisingPage,this.campaign.key):void 0,this._checkoutType=a.checkoutType,this._recentDonations=e.campaign.recentDonations?zs(e.campaign.recentDonations.filter((e=>"stock"!==e.donationType)).map((t=>{var n;const i=function(e,t){if(!e||!t)return null;const n=Math.round(e*t-e);return Math.max(n,0)}(t.amount,null===(n=e.campaign.config.campaignPage)||void 0===n?void 0:n.rateMatching.rate);return Object.assign(Object.assign({},t),{matchedAmount:i})}))):null,this._totalRecentDonations=e.campaign.totalRecentDonations||null,this._donationSettings=a.donationSettings,this._commentSettings=a.commentSettings,this._preDonationUpsellSettings=a.preDonationUpsellSettings,this._paymentOptionsSettings=a.paymentOptionsSettings,this._remindMeLaterSettings=a.remindMeLaterSettings,this._currencySettings=a.currencySettings,this._aiConfig=zs(e.campaign.config.ai),this._guessedCurrencies=this.getGuessedCurrencies(),this._rawExternal=zs(t);const d=((e,t)=>{const n=new Va(e.queryParams,t),i=new Ua(e.launcher,t),s=new xa(e.intent,t);return new ba(n,i,s)})(t,{defaultCurrency:this.defaultCurrency,enabledDonationCurrencies:this.enabledCurrencies,enabledDonationFrequencies:this.enabledFrequencies,enabledDonationAmountHintsIds:this.enabledDonationAmountHintsIds});this._external=zs(d.format()),this._element=this.setInitialElement(),this._getAskPageConfig=this.getAskPageConfigGetter(u,this.external,this.company,this.fundraisingPage),this._isRestoredByWidgetSession=!1,this._canModifyAmount=null===(c=null===(l=null===(r=this.external.state)||void 0===r?void 0:r.donation)||void 0===l?void 0:l.isAmountEditable)||void 0===c||c,this._forceAllowModifyAmount=!1,this._isMultipleRecurringFrequencyEnabled=!1}get isMultipleRecurringFrequencyEnabled(){return this._isMultipleRecurringFrequencyEnabled}get allowLegacyTributeLabel(){return["ASCBRLZS","APGYPDRM","AGPUPUKX","AGDVEKDU","ASMXWWKS","AYDKPHBH"].includes(this.company.key)}get successPaymentDelayBeforeLeave(){switch(this.checkoutType){case Kn.MODAL:return Ws;case Kn.PAGE:return 0;default:throw new Bs.HP(this.checkoutType)}}get campaignPagesSharingEnabled(){return this.campaignPage.sharing.linkedin||this.campaignPage.sharing.facebook||this.campaignPage.sharing.copyLink||this.campaignPage.sharing.twitter}get showDonorImpactSection(){return this.checkoutType===Kn.PAGE&&this.campaignPage.donorImpact.show&&!!this.recentDonations}get showGoalMeterSection(){var e,t,n,i;return!(!this.fundraisingPage||this.fundraisingPage.withoutGoal)||!!(null===(t=null===(e=this.campaign.config.campaignPage)||void 0===e?void 0:e.goal)||void 0===t?void 0:t.showTotalRaisedAmount)&&!!(null===(i=null===(n=this.campaign.config.campaignPage)||void 0===n?void 0:n.goal)||void 0===i?void 0:i.hasGoal)}get showAmountCounterSection(){var e,t,n,i;return!(this.fundraisingPage&&!this.fundraisingPage.withoutGoal||!(null===(t=null===(e=this.campaign.config.campaignPage)||void 0===e?void 0:e.goal)||void 0===t?void 0:t.showTotalRaisedAmount)||(null===(i=null===(n=this.campaign.config.campaignPage)||void 0===n?void 0:n.goal)||void 0===i?void 0:i.hasGoal))}get emotionalType(){return this.campaign.classification.emotionalType}get goalMeterData(){var e,t,n,i,s,a,o,r,l,c,u,d;const h=(null===(e=this.fundraisingPage)||void 0===e?void 0:e.currency)||this.campaign.config.defaultCurrency,m=!this.fundraisingPage||(null===(t=this.fundraisingPage)||void 0===t?void 0:t.withoutGoal);let p=null,g=null;m?(p=(null===(i=null===(n=this.campaign.config.campaignPage)||void 0===n?void 0:n.goal)||void 0===i?void 0:i.amount)||null,g=(null===(a=null===(s=this.campaign.config.campaignPage)||void 0===s?void 0:s.goal)||void 0===a?void 0:a.raisedAmount)||null):(p=(null===(o=this.fundraisingPage)||void 0===o?void 0:o.goalAmount)||null,g=(null===(r=this.fundraisingPage)||void 0===r?void 0:r.donationsAmount)||null);const y=(null===(c=null===(l=this.campaign.config.campaignPage)||void 0===l?void 0:l.goal)||void 0===c?void 0:c.raisedAmountWithRateMatching)?Math.round(null===(d=null===(u=this.campaign.config.campaignPage)||void 0===u?void 0:u.goal)||void 0===d?void 0:d.raisedAmountWithRateMatching):null;return{shown:this.showGoalMeterSection,currency:h,totalAmount:p,raisedAmount:m?y:g,isFundraisingPageGoalMeter:!m}}get recentDonations(){return this._recentDonations}get totalRecentDonations(){return this._totalRecentDonations}get checkoutType(){return this._checkoutType}get showcase(){return this._showcase}get featureConfig(){return this._company.featureConfig}get parentCompanyConfig(){return this._company.parentCompanyConfig}get fundraisingPage(){return this._fundraisingPage}get defaultFlowType(){var e;return(null===(e=this.external.flow)||void 0===e?void 0:e.type)?this.external.flow.type:this.fundraisingPage&&this.enabledFlows.money?$n.MONEY:this.campaign.config.defaultDonationType}get isLighthouse(){var e;return null!==(e=this._infrastructureParams.isLighthouse)&&void 0!==e&&e}get queryTrackerParams(){var e;if(this.checkoutType!==Kn.PAGE)return{tags:[]};const t=null===(e=this.external.tracker)||void 0===e?void 0:e.eventTags;return{tags:t?t.split(","):[]}}get infrastructureQueryParams(){return this._infrastructureQueryParams||{}}get infrastructureParams(){return this._infrastructureParams}get integrations(){return this._integrations}get environmentConfig(){return this._environmentConfig}get element(){return this._element}get hasExternalAmount(){var e,t;return void 0!==(null===(t=null===(e=this.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.amount)}get hasExternalFrequency(){var e,t;return void 0!==(null===(t=null===(e=this.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.frequency)}get externalFrequency(){var e,t,n;return null!==(n=null===(t=null===(e=this.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.frequency)&&void 0!==n?n:null}get isLauncher(){var e,t;return!(!(null===(e=this.rawExternal.queryParams)||void 0===e?void 0:e.key)&&!(null===(t=this.rawExternal.queryParams)||void 0===t?void 0:t.elementKey))}get campaign(){return this._campaign}get campaignPage(){return this.campaign.config.campaignPage||fa}get company(){return this._company}get user(){return this._user}get cryptoCurrencies(){return this._cryptoCurrencies}get currencies(){return this._currencies}get mergedCustomFields(){return this.getMergedCustomFields()}get defaultCurrency(){return this.campaign.config.defaultCurrency}get enabledCurrencies(){return[...this.company.stripeCurrencies.list]}get enabledFrequencies(){return Gs.getEnabledFrequencies(this.campaign.config.frequencies)}get enabledDonationAmountHintsIds(){const e=[];for(const{suggestedAmountHints:t}of Object.values(this.campaign.config.frequencies))e.push(...(null!=t?t:[]).map((e=>e.id)));return e}get defaultFrequency(){return Gs.getDefaultFrequency(this.campaign.config.frequencies)}get lowestFrequency(){return this.enabledFrequencies[0]}get highestFrequency(){return this.enabledFrequencies[this.enabledFrequencies.length-1]}get canModifyFrequency(){return this.enabledFrequencies.length>1}get defaultAmounts(){const e=this.campaign.config.frequencies,t={};return this.frequencies.forEach((n=>{t[n]=e[n].defaultAmount})),t}get defaultAmountOptions(){const e=this.campaign.config.frequencies,t={};return this.frequencies.forEach((n=>{t[n]=e[n].amountOptions})),t}get enabledFlows(){return{[$n.MONEY]:this.campaign.config.donationTypes.money.enabled,[$n.CRYPTO]:this.campaign.config.donationTypes.crypto.enabled&&!!this.company.cryptoProvider}}get preselectDesignation(){return!Object.values(Us).includes(this.campaign.key)}get aiConfig(){return this._aiConfig}get guessedCurrencies(){return this._guessedCurrencies}get donationSettings(){return Object.assign(Object.assign({},va),this._donationSettings)}get commentSettings(){return Object.assign(Object.assign({},Sa),this._commentSettings)}get preDonationUpsellSettings(){return Object.assign(Object.assign({},Ea),this._preDonationUpsellSettings)}get paymentOptionsSettings(){return Object.assign(Object.assign({},Aa),this._paymentOptionsSettings)}get remindMeLaterSettings(){return Object.assign(Object.assign({},Ca),this._remindMeLaterSettings)}get currencySettings(){var e;return null!==(e=this._currencySettings)&&void 0!==e?e:{}}get isAbandonedDonationsEnabled(){var e;return!!(null===(e=this.company.abandonedDonations)||void 0===e?void 0:e.enabled)&&!!this.remindMeLaterSettings.isEnabled}get canModifyAmount(){return!!this._forceAllowModifyAmount||this._canModifyAmount}get forceAllowModifyAmount(){return this._forceAllowModifyAmount}get showAmountSuggestions(){var e,t,n;return null===(n=null===(t=null===(e=this.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.isAmountEditable)||void 0===n||n}get canModifyDesignation(){var e,t,n;return null===(n=null===(t=null===(e=this.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.isEditable)||void 0===n||n}get multipleDesignations(){var e;return null!==(e=this.campaignPage.multipleDesignations)&&void 0!==e?e:{enabled:!1}}get rawExternal(){return this._rawExternal}get external(){return this._external}get isRestoredByWidgetSession(){return this._isRestoredByWidgetSession}tryToEnableMultipleRecurringFrequency(){2===this.enabledFrequencies.length&&this.enabledFrequencies.includes(qn.ONCE)&&this.enabledFrequencies.includes(qn.MONTHLY)&&this.company.recurringPlans.annual&&this.user.address.countryCode===sn.UNITED_KINGDOM&&(this._isMultipleRecurringFrequencyEnabled=!0)}cloneOnceFrequencyToAnnual(){this._campaign=zs(Object.assign(Object.assign({},this._campaign),{config:Object.assign(Object.assign({},this._campaign.config),{frequencies:Object.assign(Object.assign({},this._campaign.config.frequencies),{[qn.ANNUAL]:Object.assign(Object.assign({},this._campaign.config.frequencies[qn.ONCE]),{default:!1})})})}))}allowModifyAmount(){this._forceAllowModifyAmount=!0}setRestoredByWidgetSession(){this._isRestoredByWidgetSession=!0}restoreElement(e){var t,n,i,s;this._element={key:null!==(t=e.key)&&void 0!==t?t:this._element.key,type:null!==(n=e.type)&&void 0!==n?n:this._element.type,reminderKey:null!==(i=e.reminderKey)&&void 0!==i?i:this._element.reminderKey,locale:null!==(s=e.locale)&&void 0!==s?s:this._element.locale}}mergePreDonationUpsellSettings(e){this._preDonationUpsellSettings=Object.assign(Object.assign({},this._preDonationUpsellSettings),e)}getAskPageConfig(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._getAskPageConfig(e)}getInitialCustomFields(){var e,t;const n=this.getCustomFieldsHash(this.campaign.customFields||[],!0),i=((null===(t=null===(e=this.rawExternal.launcher)||void 0===e?void 0:e.element)||void 0===t?void 0:t.customFields)||[]).filter((e=>void 0!==n[e.name])),s=this.getCustomFieldsHash(i),a=Object.assign(n,s);return Object.keys(a).map((e=>{var t;return{name:e,value:Array.isArray(a[e])?null===(t=a[e])||void 0===t?void 0:t[0]:a[e]}}))}get frequencies(){const e=this.campaign.config.frequencies,t=[];for(const n of Object.keys(e))t.push(n);return t}getMergedCustomFields(){var e,t,n,i,s,a;const o=this.getCustomFieldsHash(this.campaign.customFields||[]),r=this.getCustomFieldsHash((null===(t=null===(e=this.rawExternal.intent)||void 0===e?void 0:e.checkoutSettings)||void 0===t?void 0:t.customFields)||[]),l=this.getCustomFieldsHash((null===(i=null===(n=this.rawExternal.launcher)||void 0===n?void 0:n.element)||void 0===i?void 0:i.customFields)||[]);let c=this.rawExternal.queryParams;void 0!==(null===(s=this.fundraisingPage)||void 0===s?void 0:s.customFields)&&(null===(a=this.fundraisingPage)||void 0===a?void 0:a.customFields.length)>0&&(c=this.getCustomFieldsHash(this.fundraisingPage.customFields));const u=gs(window.location.href),d=Object.assign(o,l,c,r,u);return Object.keys(d).map((e=>{var t;return{name:e,value:Array.isArray(d[e])?null===(t=d[e])||void 0===t?void 0:t[0]:d[e]}})).filter((e=>e.value))}getFundraisingPage(e,t){if(e&&e.key&&e.openWidget===t)return e}getCustomFieldsHash(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={};return e.forEach((e=>{e.name&&(t||e.value)&&(n[e.name]=e.value)})),n}getResolvedCompany(e){if(e.key!==this.campaign.company)throw new Error("Invalid resolved company");if(e.useParentPaymentAccounts){if(!e.parentCompanyConfig)throw new Error("Widget's Parent Company not found");return Object.assign(Object.assign({},e),{stripeFee:e.parentCompanyConfig.stripeFee,applicationFees:e.parentCompanyConfig.applicationFees,coverFees:e.parentCompanyConfig.coverFees})}return Object.assign({},e)}cloneWidget(e){const t=Ha.overrideWidgetGoalsConfig(e.config);return zs(Object.assign(Object.assign({},e),{config:t}))}getAskPageConfigGetter(e,t,n,i){return s=>function(e,t,n,i){let{isRetina:s,checkoutType:a,fundraisingPage:o}=i;const r=function(e,t){var n,i;return Boolean(e.ask.show||(null===(i=null===(n=t.campaign)||void 0===n?void 0:n.ask)||void 0===i?void 0:i.show))}(e,t),l=n.name,c=null==o?void 0:o.name,u=function(e){return e===Kn.MODAL?pa:ta}(a),d=u.getShowTabs(o,e,t),h=!d&&c,m=u.getAskTitle(e,t),p=u.getAskDescription(e,t),g=u.getLinks(e),y=u.getLogoImageURL(e,s),f=u.getAskMainImageURL(e,s),v=u.getMainVideo(e),S=u.getMainMediaProvider(e);return{text:p,title:h?c:m,companyName:l,links:g,logoImage:y||u.getCompanyImageURL(n,s),fallbackCompanyLogo:u.getCompanyImageURL(n,s),mainImage:f,fundraiserImage:u.getFundraiserImageURL(o,s),logoAltText:u.getLogoAltText(e)||u.getCompanyLogoImageAltText(n),mainImageAltText:u.getMainImageAltText(e),mainVideo:v,mainMediaProvider:S,show:r,showLinks:!!g.length,showTabs:d}}(e.config,t,n,{isRetina:s,checkoutType:this.checkoutType,fundraisingPage:i})}getGuessedCurrencies(){const e=this.campaign.config.defaultCurrency,t=this.currencies.countryCurrencies[0],n=this.company.stripeCurrencies.default,i=this.currencies.countryCurrencies.slice(1),s=this.currencies.langCurrencies,a=this.company.stripeCurrencies.list;return o=[e,t,n,...i,...s].filter((e=>a.includes(e))),Array.from(new Set(o));var o}setInitialElement(){var e,t,n,i,s,a;return{key:(null===(e=this.external.element)||void 0===e?void 0:e.key)||(null===(t=this.fundraisingPage)||void 0===t?void 0:t.elementKey)||"",type:(null===(n=this.external.element)||void 0===n?void 0:n.type)||(null===(i=this.fundraisingPage)||void 0===i?void 0:i.elementType)||Hn.DIRECT_LINK,reminderKey:(null===(s=this.external.element)||void 0===s?void 0:s.reminderKey)||"",locale:null===(a=this.external.element)||void 0===a?void 0:a.locale}}}class Ka{constructor(e,t){this._locale=e,this.commonCurrencyFilter=t,this.formatCurrency=t.formatCurrency.bind(t),this.formatSymbol=t.formatSymbol.bind(t),this.getCurrencyFormat=t.getCurrencyFormat.bind(t)}changeLocale(e){return this.locale=e,this.locale}format(e,t){return this.formatCurrency(e,null==t?void 0:t.currency,null==t?void 0:t.display,null==t?void 0:t.withoutPrefix,null==t?void 0:t.withoutSuffix,this.locale,null==t?void 0:t.displayCurrency)}formatAmount(e){const t=Object.assign(Object.assign({},e),{locale:this.locale});return this.commonCurrencyFilter.formatAmount(t)}formatCurrencySymbol(e,t){return this.formatSymbol(e,t,this.locale)}getFormat(){return this.getCurrencyFormat(this.locale)}get locale(){return this._locale}set locale(e){this._locale=e}}const Ya=["XCD","ARS","USD","AUD","BBD","BMD","BND","BSD","BZD","CAD","NZD","COP","DOP","FJD","GYD","HKD","JMD","KYD","LRD","MXN","NAD","SBD","SGD","SRD","TTD","TWD","SHP","FKP","GBP","GIP","NOK","DKK","ISK","SEK","HNL","LSL","MDL","SZL","MUR","SCR","CNY","JPY","PKR","LKR"];class za extends Ka{constructor(e,t,n){super(e,t),this.donationCurrency=n}replaceCurrencyFilter(e){this.formatCurrency=e.formatCurrency,this.formatSymbol=e.formatSymbol,this.getCurrencyFormat=e.getCurrencyFormat}formatAmount(e){const t=this.isExplicitFormat(e);return super.formatAmount(Object.assign(Object.assign({},e),{forceExplicit:t}))}isExplicitFormat(e){if(!this.donationCurrency)return!1;if(!e.currency)return!1;const t=this.donationCurrency.guessCurrency(!1,!0);return!!e.forceExplicit&&t!==e.currency&&!!Ya.includes(e.currency)&&e.currencyFormat===Yt.SHORT}}var Wa;!function(e){e.SCREEN_CHANGED="screenChanged",e.FLOW_CHANGED="flowChanged",e.DONE="done",e.LOCKED="locked",e.UNLOCKED="unlocked",e.ERROR="error"}(Wa||(Wa={}));const $a=[$n.MONEY];class Xa{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S,E,A,C,b,P,N,D,T,k){this.eventEmitter=e,this.checkoutConfiguration=t,this.intl=n,this.tracker=i,this.sessionTokenService=s,this.debug=a,this.currencyService=o,this.suggestionsService=r,this.targetWindow=l,this.globalWindow=c,this.sentry=u,this.paymentMethods=d,this.stripeLoadingPromise=h,this.applePayStripeLoadingPromise=m,this.userSession=p,this.addressService=g,this.checkoutAPIBridge=y,this._experiments=f,this.flowFactoryMap=v,this.logger=S,this.sessionAPI=E,this.subscriptionPeriodLabelsService=A,this.mailingAddressModule=C,this.paymentMethodAvailabilityManagerRepository=b,this.mailingAddressCustomization=P,this.adaptiveDefaultFrequencyFetcher=N,this.adaptiveAmountPresetsFetcher=D,this.widgetSessionConsentService=T,this.params=k,this.currentFlow=null,this._checkoutService=null,this._checkoutState=null,this._flowType=null}get checkoutService(){if(!this._checkoutService)throw new Error("Checkout service is not defined");return this._checkoutService}get checkoutState(){if(!this._checkoutState)throw new Error("Checkout state is not defined");return this._checkoutState}get experiments(){if(!this._experiments)throw new Error("Checkout Experiments Controller is not defined");return this._experiments}get flowType(){if(!this._flowType)throw new Error("Flow is not initialized");return this._flowType}get questionsScreenPageCount(){return this._checkoutService?this._checkoutService.checkoutUIState.pagesOfQuestionsScreen:null}dispose(){var e,t;null===(e=this._checkoutService)||void 0===e||e.dispose(),null===(t=this.currentFlow)||void 0===t||t.dispose()}setInitialScreen(e){return this.initialScreen=e,this}getCurrentFlow(){if(!this.currentFlow)throw new Error("Start flow first");return this.currentFlow}onScreenChanged(e){return this.eventEmitter.on(Wa.SCREEN_CHANGED,e),()=>this.eventEmitter.removeListener(Wa.SCREEN_CHANGED,e)}onFlowChanged(e){return this.eventEmitter.on(Wa.FLOW_CHANGED,e),()=>this.eventEmitter.removeListener(Wa.FLOW_CHANGED,e)}startDefaultFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.start(this.checkoutConfiguration.defaultFlowType)}))}startFiatFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.start($n.MONEY)}))}startCryptoFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.start($n.CRYPTO)}))}restart(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.start(this.flowType)}))}canClose(e){if(this.checkoutConfiguration.company.blockedAt)return!0;if(!this.currentFlow)throw new Error("currentFlow is not defined");const t=this.checkoutService.isPaid;if(this.currentFlow.isLocked)return!1;if(this.checkoutConfiguration.infrastructureParams.showcase)return!1;if(this.checkoutConfiguration.isAbandonedDonationsEnabled&&e.isFinalAvailableScreen&&this.currentFlow.tryExit())return!1;if(!t&&(!e.isUnrestrictedExitScreen||e.isMobile&&e.isMobileExitScreen)&&this.currentFlow.tryExit())return!1;if(!this.checkoutConfiguration.isAbandonedDonationsEnabled&&!e.isUnrestrictedExitScreen&&!this.currentFlow.isExiting){const e=[this.intl.translate("confirmCloseDialog.question"),this.intl.translate("confirmCloseDialog.instructions")].join("\n\n");return confirm(e)}return!0}shouldNotifyAbandoned(e){var t,n,i;if(!$a.includes(this.flowType))return!1;if(!this.currentFlow)throw new Error("currentFlow is not defined");if(this.checkoutState.donation.dataPoint.isMultipleDonations)return!1;if(e)return!1;if(!(null===(t=this.checkoutConfiguration.company.abandonedDonations)||void 0===t?void 0:t.enabled))return!1;const s=this.checkoutService.isPaid,a=this.checkoutService.isPaymentStarted;if(s||a)return!1;const o=this.checkoutState.remindMeLater.dataPoint,r=this.checkoutState.privacy.donorEmailDataPoint,l=this.checkoutConfiguration.infrastructureParams.fromDonorPortal,c=r.email===(null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.supporter)||void 0===i?void 0:i.email);return!(l&&c&&!o.isEnabled)&&(!!this.currentFlow.isExiting||!o.isEnabled)}start(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n;yield null===(t=this._checkoutService)||void 0===t?void 0:t.dispose(),null===(n=this.currentFlow)||void 0===n||n.dispose();const{flow:i,checkoutService:s,checkoutState:a,adaptiveSuggestionsService:o}=yield this.initializeFlow(e);this.currentFlow=i,this._checkoutService=s,this._checkoutState=a,this._flowType=e,yield i.start(),this.eventEmitter.emit(Wa.FLOW_CHANGED,e),null==o||o.tryTrackSuggestion()}))}canNavigateBackward(e,t){var n,i,s,a,o;const r=e.getCurrentScreen().name,l=this.checkoutService.checkoutUIState.isCanNotGoBackScreen(r),c=e.previousScreenName&&e.previousScreenName===t.getPaymentScreen(e.previousScreenName,e.getHistoricalScreens())&&t.isPaid,u=e.previousScreenName===(null===(n=this.params.screenSet)||void 0===n?void 0:n.ukBacs)&&t.isPaid,d=e.previousScreenName===(null===(i=this.params.screenSet)||void 0===i?void 0:i.paymentOptions)&&t.isPaid,h=e.previousScreenName===(null===(s=this.params.screenSet)||void 0===s?void 0:s.fastTrackPaymentOptions)&&t.isPaid,m=r===(null===(a=this.params.screenSet)||void 0===a?void 0:a.paymentOptions)&&this.checkoutConfiguration.isRestoredByWidgetSession,p=null===(o=this.currentFlow)||void 0===o?void 0:o.isLocked;return!(l||c||u||d||h||m||p)}initializeFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){const{flow:t,checkoutService:n,checkoutState:i,initialScreenDecider:s,trackerCheckoutEventService:a,adaptiveSuggestionsService:o,designationsFetcher:c,externalParamsApplier:u}=yield this.createFlow(e);t.on(Wa.SCREEN_CHANGED,(e=>{const i=e;t.setCanGoBack(this.canNavigateBackward(t,n)),n.shouldFindMandatoryScreen=!1,n.checkoutUIState.setCloseButtonVisibility(t.getCurrentScreen().name,t.getHistoricalScreens()),this.eventEmitter.emit(Wa.SCREEN_CHANGED,i),n.setScreenHistoryToSession(i.screenHistory)})),t.on(Wa.LOCKED,(()=>{t.setCanGoBack(this.canNavigateBackward(t,n))})),t.on(Wa.UNLOCKED,(()=>{t.setCanGoBack(this.canNavigateBackward(t,n))})),t.on(Wa.ERROR,(e=>{this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.FORM_FLOW),e)))})),this.initializeTracker(t,a),yield this.initializeCheckoutState(i,c,u),yield n.initialize(),n.tryToCloneOnceFrequencyToAnnual();const d=void 0!==this.initialScreen?this.initialScreen:yield s.getInitialScreen();return t.setFirstScreen(d),t.setInitialHistory(s.getScreensHistoryForRestore()),{flow:t,checkoutService:n,checkoutState:i,adaptiveSuggestionsService:o}}))}initializeTracker(e,t){t.setCurrentScreenDataGetter((()=>({screenName:e.getCurrentScreen().name,screenData:e.getCurrentScreen().getScreenData()}))),this.tracker.setTrackerCheckoutEventService(t)}initializeCheckoutState(e,t,n){return(0,d.sH)(this,void 0,void 0,(function*(){e.synchronize(),this.tryFetchDesignationGoals(e,t),yield n.tryApply()}))}tryFetchDesignationGoals(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){yield t.tryFetchGoals(),e.synchronize()}))}createFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.flowFactoryMap[e],{formFlow:n,checkoutService:i,checkoutState:s,initialScreenDecider:a,trackerCheckoutEventService:o,adaptiveSuggestionsService:r,designationsFetcher:l,externalParamsApplier:c}=t({checkoutConfiguration:this.checkoutConfiguration,intl:this.intl,tracker:this.tracker,sessionTokenService:this.sessionTokenService,debug:this.debug,currencyService:this.currencyService,suggestionsService:this.suggestionsService,targetWindow:this.targetWindow,globalWindow:this.globalWindow,sentry:this.sentry,paymentMethods:this.paymentMethods,stripeLoadingPromise:this.stripeLoadingPromise,applePayStripeLoadingPromise:this.applePayStripeLoadingPromise,subscriptionPeriodLabelsService:this.subscriptionPeriodLabelsService,userSession:this.userSession,addressService:this.addressService,eventEmitter:this.eventEmitter,checkoutAPIBridge:this.checkoutAPIBridge,experiments:this.experiments,logger:this.logger,sessionAPI:this.sessionAPI,mailingAddressModule:this.mailingAddressModule,paymentMethodAvailabilityManagerRepository:this.paymentMethodAvailabilityManagerRepository,mailingAddressCustomization:this.mailingAddressCustomization,adaptiveDefaultFrequencyFetcher:this.adaptiveDefaultFrequencyFetcher,adaptiveAmountPresetsFetcher:this.adaptiveAmountPresetsFetcher,stripe:{elementsOptions:this.params.stripe.elementsOptions,elementStyles:this.params.stripe.elementStyles,elementClasses:this.params.stripe.elementClasses},params:{funEmbedRelease:this.params.funEmbedRelease,pendingRequests:this.params.pendingRequests},widgetSessionConsentService:this.widgetSessionConsentService});return{flow:n,checkoutService:i,checkoutState:s,initialScreenDecider:a,trackerCheckoutEventService:o,adaptiveSuggestionsService:r,designationsFetcher:l,externalParamsApplier:c}}))}}var Qa=n(6532),Za=JSON.parse('{"MD":7.64,"KM":189.824,"MY":1.401,"DZ":42.485,"SI":0.566,"GY":71.506,"FR":0.662,"DK":5.829,"KZ":170.765,"VU":136.387,"UA":12.662,"AT":0.727,"KW":0.18,"AD":0.604,"BW":5.095,"AE":2.226,"CM":197.238,"RU":29.754,"JM":98.279,"DJ":81.99,"KE":44.483,"BZ":1.082,"MM":523.036,"SG":0.794,"SK":0.531,"IS":154.872,"BT":20.485,"MK":19.166,"GN":3357.395,"HK":5.581,"MT":0.554,"AF":21.476,"US":1,"SR":11.1,"PG":2.8,"MW":603.924,"HU":187.435,"KH":1362.136,"EC":0.419,"CA":1.165,"NO":8.924,"ML":202.638,"WS":1.98,"FJ":0.912,"CO":1535.671,"TH":10.279,"MN":1251.428,"GW":216.51,"AR":532.381,"MX":10.453,"TM":1.675,"ET":32.001,"GA":216.218,"KR":775.488,"TG":192.623,"GH":4.849,"ZM":8.385,"NZ":1.485,"LA":4760.037,"BI":1421.359,"PK":69.052,"AM":146.064,"CZ":12.929,"SM":0.69,"ST":13.184,"BS":0.947,"FI":0.756,"GT":3.311,"SL":6118.479,"LU":0.856,"TV":1.486,"ER":14.319,"HN":11.612,"SN":209.202,"NP":34.889,"AG":1.923,"CV":47.228,"BD":32.129,"KG":27.791,"NG":200.261,"ES":0.594,"MH":1.057,"QA":2.145,"VE":55.815,"TN":0.971,"CF":253.932,"MO":4.551,"LV":0.508,"UZ":3710.272,"BR":2.502,"CY":0.587,"DM":1.361,"BA":0.694,"LK":55.699,"CG":217.658,"IL":3.75,"NA":7.054,"FM":1.11,"SS":1748.805,"RW":366.087,"UG":1267.867,"PT":0.557,"BO":2.682,"LS":6.318,"TD":209.064,"LT":0.501,"ME":0.373,"OM":0.174,"SD":954.072,"BN":0.489,"CD":1128.003,"GR":0.531,"AL":42.674,"TZ":784.705,"GE":0.894,"JP":92.638,"SA":1.823,"HR":0.463,"SB":7.342,"YE":588.938,"SO":0.4,"GD":1.569,"TO":1.701,"NI":12.132,"PY":2620.557,"IN":20.662,"GB":0.669,"SZ":6.344,"MG":1381.966,"GQ":244.103,"JO":0.302,"BY":0.809,"MV":7.669,"TL":0.303,"RS":48.116,"IE":0.755,"CL":464.988,"IQ":485.49,"PH":19.266,"ZA":7.491,"BJ":201.631,"BG":0.831,"ID":4720.371,"MR":11.279,"SC":7.744,"RO":2.027,"TR":16.45,"BF":226.317,"EG":7.308,"VN":7020.848,"PR":0.76,"TT":3.457,"AO":308.169,"CN":3.434,"CR":309.45,"UY":27.122,"MA":3.864,"EE":0.612,"LC":1.357,"TW":13.38,"HT":116.787,"TJ":2.616,"NE":218.302,"LB":949.837,"AU":1.423,"LR":0.453,"IT":0.605,"NR":1.769,"CH":0.947,"PE":1.767,"LY":1.881,"DE":0.715,"BH":0.16,"IR":165353.935,"PA":0.458,"KN":1.74,"GM":19.113,"NL":0.774,"SV":0.416,"CI":215.682,"KI":1.036,"AW":1.329,"PW":1.035,"VC":1.415,"PL":1.926,"BB":2.226,"ZW":12.247,"SE":8.386,"DO":23.898,"BE":0.707,"MZ":24.825,"MU":17.784,"AZ":0.493}');class Ja{constructor(e,t){this.rates=e,this.sentry=t}getDigits(e){return this.currencyData[e]?this.currencyData[e].digits:2}getRate(e){return this.rates[e]||1}setData(e,t,n){this._currencyData=e,t&&(this._countriesData=t),n&&(this._pppexData=n)}convertBase(e,t,n,i=!1,s){var a;if(!Number.isInteger(e)){const e=new Error("amount should be a finite number");return null===(a=this.sentry)||void 0===a||a.captureException(e),console.error(e),0}if(0===e)return 0;if(t===n)return e;const o=this.currencyData[t].type===Xt.Z.FIAT,r=this.currencyData[n].type===Xt.Z.FIAT,l=this.getDigits(t),c=this.getDigits(n),u=this.calcRate(t,n,o,r);if(i&&s&&o&&r){const n="USD"===t?e:this.convertBase(e,t,"USD",!1);e=this.toAiAmount(n,s)}return Math.ceil(e/Math.pow(10,l)*u*Math.pow(10,c))}calcRate(e,t,n,i){let s;const a=this.getRate(e),o=this.getRate(t);return s=n&&i?o/a:n&&!i?1/(a*o):!n&&i?a*o:a/o,s}toAiAmount(e,t){const n=this.pppexData[t]||1,i=this.rates[this.getCountryCurrency(t)]||1;return 1===n||1===i?e:e*n/i}getCountryCurrency(e){return this.countriesData[e]?this.countriesData[e][0]:"USD"}get currencyData(){if(!this._currencyData)throw new Error("Currency data was not set");return this._currencyData}get countriesData(){if(!this._countriesData)throw new Error("Countries data was not set");return this._countriesData}get pppexData(){if(!this._pppexData)throw new Error("Pppex data was not set");return this._pppexData}}class eo extends Ja{getCryptoCurrency(e){const t=this.currencyData[e];if(!t)throw new Error(`Currency ${e} was not found`);if(t.type!==Xt.Z.CRYPTO)throw new Error(`Currency ${e} is not a crypto`);return t}getSymbol(e){return this.currencyData[e]?this.currencyData[e].symbol:""}getName(e){return this.currencyData[e]?this.currencyData[e].name:""}getRate(e){return this.rates[e]||1}convert(e,t,n,i=!1,s){return this.convertBase(e,t,n,i,s)}round(e,t=2){const n=Math.ceil(Math.log10(e+1))-t,i=5*Math.pow(10,Math.max(n-3,0)+t);return Math.ceil(e/i)*i}toFloatUnformattedStr(e,t,n=2){const i=this.getDigits(t);return(e/Math.pow(10,i)).toFixed(n)}toFloat(e,t){const n=this.getDigits(t);return e/Math.pow(10,n)}fromFloat(e,t){const n=this.getDigits(t);return Math.round(e*Math.pow(10,n))}ceil(e,t){return this.fromFloat(Math.ceil(this.toFloat(e,t)),t)}getMinAmount(e){return this.convert(100,"USD",e)}toInt(e,t){if(!Number.isFinite(e))throw new Error("amount should be a finite number");const n=this.getDigits(t);return e*Math.pow(10,n)}getCurrencyCodesBySource(e){return Object.keys(this.currencyData).filter((t=>this.currencyData[t].sources.includes(e)))}isCrypto(e){return this.currencyData[e].type===Xt.Z.CRYPTO}}class to extends eo{constructor(e,t,n){super(t,n),this.currencyDataLoader=e,this.rates=t,this.sentry=n}loadFiat(e){const t=this.currencyDataLoader.loadFiat(e),n=Qa,i=Za,s={...t,...this._currencyData};this.setData(s,n,i)}async loadCrypto(){const e={...await this.currencyDataLoader.loadCrypto(),...this._currencyData};this.setData(e)}convertFeeCurrency(e,t,n,i){const s=Math.abs(i||1);return this.convertBase(e,t,n)*s}}function no(e){return!!e.campaign.config.donationTypes.crypto.enabled||e.checkoutType===Kn.PAGE&&e.showDonorImpactSection}const io={"US States":[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DC",name:"District of Columbia"},{code:"DE",name:"Delaware"},{code:"FL",name:"Florida"},{code:"GA",name:"Georgia"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"}],"US Territories":[{code:"AS",name:"American Samoa"},{code:"GU",name:"Guam"},{code:"MP",name:"Northern Mariana Islands"},{code:"PR",name:"Puerto Rico"},{code:"VI",name:"U.S. Virgin Islands"}],"US Military":[{code:"AA",name:"Armed Forces America"},{code:"AE",name:"Armed Forces"},{code:"AP",name:"Armed Forces Pacific"}]};var so,ao;!function(e){e.DEFAULT="default",e.POSTAL_CODE_FIRST="postalCodeFirst"}(so||(so={})),function(e){e.DEFAULT="default",e.ALTERNATIVE="alternative"}(ao||(ao={}));const oo={autocomplete:{enabled:[{option:!0}]},layout:{type:[{option:so.POSTAL_CODE_FIRST,countries:[Ci.UNITED_KINGDOM,Ci.IRELAND]},{option:so.DEFAULT}]},labels:{type:[{option:ao.ALTERNATIVE,countries:[Ci.UNITED_KINGDOM,Ci.IRELAND]},{option:ao.DEFAULT}]},region:{enabled:[{option:!1,countries:[Ci.UNITED_KINGDOM,Ci.ISRAEL,Ci.FRANCE,Ci.NETHERLANDS,Ci.GERMANY,Ci.NEW_ZEALAND,Ci.BELGIUM]},{option:!0}],required:[{option:!1,countries:[Ci.UNITED_KINGDOM,Ci.ISRAEL,Ci.FRANCE,Ci.NETHERLANDS,Ci.GERMANY,Ci.NEW_ZEALAND,Ci.BELGIUM]},{option:!0}],predefinedRegions:[{option:io,countries:[Ci.UNITED_STATES_OF_AMERICA]},{option:[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland and Labrador"},{code:"NS",name:"Nova Scotia"},{code:"NT",name:"Northwest Territories"},{code:"NU",name:"Nunavut"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewan"},{code:"YT",name:"Yukon"}],countries:[Ci.CANADA]},{option:[{code:"Carlow",name:"Carlow"},{code:"Cavan",name:"Cavan"},{code:"Clare",name:"Clare"},{code:"Cork",name:"Cork"},{code:"Donegal",name:"Donegal"},{code:"Dublin",name:"Dublin"},{code:"Galway",name:"Galway"},{code:"Kerry",name:"Kerry"},{code:"Kildare",name:"Kildare"},{code:"Kilkenny",name:"Kilkenny"},{code:"Laois",name:"Laois"},{code:"Leitrim",name:"Leitrim"},{code:"Limerick",name:"Limerick"},{code:"Longford",name:"Longford"},{code:"Louth",name:"Louth"},{code:"Mayo",name:"Mayo"},{code:"Meath",name:"Meath"},{code:"Monaghan",name:"Monaghan"},{code:"Offaly",name:"Offaly"},{code:"Roscommon",name:"Roscommon"},{code:"Sligo",name:"Sligo"},{code:"Tipperary",name:"Tipperary"},{code:"Waterford",name:"Waterford"},{code:"Westmeath",name:"Westmeath"},{code:"Wexford",name:"Wexford"},{code:"Wicklow",name:"Wicklow"}],countries:[Ci.IRELAND]}]},postalCode:{required:[{option:!1,countries:[Ci.HONG_KONG]},{option:!0}],visible:[{option:!1,countries:[Ci.HONG_KONG]},{option:!0}],autocomplete:{enabled:[{option:!0}]},validation:[{option:/^\d{5}(-\d{4})?$/,countries:[Ci.UNITED_STATES_OF_AMERICA]},{option:/^[A-Z]\d[A-Z]\s?\d[A-Z]\d$/i,countries:[Ci.CANADA]},{option:/^(?:[AC-FHKNPRTV-Y]\d{2}|D6W)\s?[A-Z0-9]{4}$/i,countries:[Ci.IRELAND]}]}};class ro{constructor(e){this._config=e}isLayoutPostalCodeFirst(e){return this.findOption(this._config.layout.type,e)===so.POSTAL_CODE_FIRST}isAlternativeLabels(e){return this.findOption(this._config.labels.type,e)===ao.ALTERNATIVE}isAutocompleteEnabled(e){return!!this.findOption(this._config.autocomplete.enabled,e)}isRegionEnabled(e){return!!this.findOption(this._config.region.enabled,e)}isRegionRequired(e){return!!this.findOption(this._config.region.required,e)}getPredefinedRegions(e){return this.findOption(this._config.region.predefinedRegions,e)}isPostalCodeRequired(e){return!!this.findOption(this._config.postalCode.required,e)}isPostalCodeAutocompleteEnabled(e){return!!this.findOption(this._config.postalCode.autocomplete.enabled,e)}getPostalCodeValidation(e){return this.findOption(this._config.postalCode.validation,e)}isPostalCodeVisible(e){return!!this.findOption(this._config.postalCode.visible,e)}findOption(e,t){var n;const i=e.find((e=>{var n,i;if(!e.countries&&!e.companies)return!0;const s=t.country&&(null===(n=e.countries)||void 0===n?void 0:n.includes(t.country)),a=t.company&&(null===(i=e.companies)||void 0===i?void 0:i.includes(t.company));return s||a}));return null!==(n=null==i?void 0:i.option)&&void 0!==n?n:null}}const lo=n(2073);class co{constructor(e,t){this.schema=e,this.config=t}validate(e){return this.schema.validate(e)}allowed(e,t){const n=this.schema.path(e);return!!n&&!n.validate(t,{[e]:t},e)}isRequired(e,t={}){const n=this.schema.path(e);return!!n&&!!n.validate(null,t,e)}getProvider(){return this.config.provider}}class uo{constructor(e,t){this.config=e,this.paymentMethodConfigParser=t,this.managersMap=new Map}createManager(e,t){const n=this.config[e],i=n[t],s=this.paymentMethodConfigParser.parse(i);return new co(s,{...i,name:n.name,provider:n.provider})}getManager(e,t){const n=e+"_"+t;let i=this.managersMap.get(n);return i||(i=this.createManager(e,t),this.managersMap.set(n,i),i)}}var ho=n(9901),mo=n.n(ho),po=n(8034),go=n.n(po),yo=n(3410),fo=n.n(yo),vo=n(496),So=n.n(vo),Eo=n(6942),Ao=n.n(Eo),Co=n(8858),bo=n.n(Co);const Po=(e,t,n)=>{const i=So()(t,"ibanCountry");return!i||!n.includes(i)||!!e&&!Ao()(e)},No=(e,t,n)=>!!bo()(e)||e>=n.size,Do=e=>!!bo()(e)||!!e;var To=n(4566),ko=n(2453),Io=n.n(ko);class _o extends Error{constructor(e,t){if(super(e),Oo(this,"path",t),Oo(this,"expose",!0),Oo(this,"status",400),Error.captureStackTrace)try{Error.captureStackTrace(this,_o)}catch{}}}const Oo=(e,t,n)=>{Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})},xo={type(e,t,n){return"function"==typeof n&&(n=n.name),`${e} must be of type ${n}.`},required(e){return`${e} is required.`},match(e,t,n){return`${e} must match ${n}.`},length(e,t,n){if("number"==typeof n)return`${e} must have a length of ${n}.`;const{min:i,max:s}=n;return i&&s?`${e} must have a length between ${i} and ${s}.`:s?`${e} must have a maximum length of ${s}.`:i?`${e} must have a minimum length of ${i}.`:void 0},size(e,t,n){if("number"==typeof n)return`${e} must have a size of ${n}.`;const{min:i,max:s}=n;return void 0!==i&&void 0!==s?`${e} must be between ${i} and ${s}.`:void 0!==s?`${e} must be less than ${s}.`:void 0!==i?`${e} must be greater than ${i}.`:void 0},enum(e,t,n){const i=n.slice(),s=i.pop();return`${e} must be either ${i.join(", ")} or ${s}.`},illegal(e){return`${e} is not allowed.`},default(e){return`Validation failed for ${e}.`}};var wo=xo,Ro=n(1740),Mo=n.n(Ro);function Lo(e,t,n){"string"!=typeof e?Object.keys(e).forEach((t=>n[t]=e[t])):n[e]=t}function Fo(e,t,n){const i=e.split(/\.\$(?=\.|$)/),s=i.shift(),a=To.get(t,s);if(!i.length)return n(s,a);if(Array.isArray(a))for(let e=0;e<a.length;e++)Fo(jo(e,s)+i.join(".$"),t,n)}function Uo(e,t,n,i){const s=Mo()(e);if("array"!==s){if("object"===s)for(const[s,a]of Object.entries(e)){const e=jo(s,n),o=jo(s,i);t(e,o)&&Uo(a,t,e,o)}}else e.forEach(((e,s)=>Uo(e,t,jo(s,n),jo("$",i))))}function jo(e,t){return t?`${t}.${e}`:e}class Bo{constructor(e,t){this.name=e,this.registry={},this._schema=t,this._type=null,this.messages={}}message(e){"string"==typeof e&&(e={default:e});const t=Object.entries(e);for(const[e,n]of t)this.messages[e]=n;return this}schema(e){return this._schema.path(this.name,e),this}use(e){return Object.keys(e).forEach((t=>{let n=e[t];Array.isArray(n)||(n=[n]);const i=n.shift();this._register(t,n,i)})),this}required(e=!0){return this._register("required",[e])}type(e){return this._type=e,this._register("type",[e])}string(){return this.type(String)}number(){return this.type(Number)}array(){return this.type(Array)}date(){return this.type(Date)}length(e){return this._register("length",[e])}size(e){return this._register("size",[e])}enum(e){return this._register("enum",[e])}match(e){return this._register("match",[e])}each(e){return this._schema.path(jo("$",this.name),e),this}elements(e){return e.forEach(((e,t)=>{this._schema.path(jo(t,this.name),e)})),this}properties(e){for(const[t,n]of Object.entries(e))this._schema.path(jo(t,this.name),n);return this}path(...e){return this._schema.path(...e)}typecast(e){const t=this._schema;let n=this._type;if(!n)return e;"function"==typeof n&&(n=n.name);const i=t.typecasters[n]||t.typecasters[n.toLowerCase()];if("function"!=typeof i)throw new Error(`Typecasting failed: No typecaster defined for ${n}.`);return i(e)}validate(e,t,n=this.name){const i=Object.keys(this.registry);for(const s of i){const i=this._run(s,e,t,n);if(i)return i}return null}_run(e,t,n,i){if(!this.registry[e])return;const s=this._schema,{args:a,fn:o}=this.registry[e];return(o||s.validators[e])(t,n,...a,i)?void 0:this._error(e,n,a,i)}_register(e,t,n){return this.registry[e]={args:t,fn:n},this}_error(e,t,n,i){const s=this._schema;let a=this.messages[e]||this.messages.default||s.messages[e]||s.messages.default;return"function"==typeof a&&(a=a(i,t,...n)),new _o(a,i)}}const Go={required(e,t,n){return!1===n||null!=e&&""!==e},type(e,t,n){return null==e||("function"==typeof n?e.constructor===n:Mo()(e)===n)},length(e,t,n){if(null==e)return!0;if("number"==typeof n)return e.length===n;const{min:i,max:s}=n;return!(i&&e.length<i||s&&e.length>s)},size(e,t,n){if(null==e)return!0;if("number"==typeof n)return e===n;const{min:i,max:s}=n;return!(null!=parseInt(i)&&e<i||null!=parseInt(s)&&e>s)},enum(e,t,n){return null==e||n.includes(e)},match(e,t,n){return null==e||n.test(e)}};var qo,Vo,Ho=Go;class Ko{constructor(e={},t={}){this.opts=t,this.hooks=[],this.props={},this.messages=Object.assign({},wo),this.validators=Object.assign({},Ho),this.typecasters=Object.assign({},Io()),Object.keys(e).forEach((t=>this.path(t,e[t])))}path(e,t){const n=e.split("."),i=n.pop(),s=n.join(".");if(s&&this.path(s),"$"===i&&this.path(s).type(Array),t instanceof Ko)return t.hook(((t,n)=>this.path(jo(t,e),n))),this.path(e,t.props);if(t instanceof Bo)return this.props[e]=t,this.propagate(e,t),t;const a=this.props[e]||new Bo(e,this);if(this.props[e]=a,this.propagate(e,a),!t)return a;if("string"==typeof t||"function"==typeof t)return a.type(t),a;if(Array.isArray(t))return a.type(Array),1===t.length?a.each(t[0]):a.elements(t),a;const o=Object.keys(t);let r=!1;for(const e of o)if("function"!=typeof a[e]){a.type(Object),r=!0;break}return o.forEach((n=>{const i=t[n];if(r)return this.path(jo(n,e),i);a[n](i)})),a}typecast(e){for(const[t,n]of Object.entries(this.props))Fo(t,e,((t,i)=>{if(null==i)return;const s=n.typecast(i);s!==i&&To.set(e,t,s)}));return this}strip(e){return Uo(e,((t,n)=>!!this.props[n]||(To.delete(e,t),!1))),this}enforce(e){const t=[];return Uo(e,((e,n)=>{if(this.props[n])return!0;const i=new _o(wo.illegal(e),e);return t.push(i),!1})),t}validate(e,t={}){t=Object.assign(this.opts,t);const n=[];t.typecast&&this.typecast(e),t.strict&&n.push(...this.enforce(e)),!1!==t.strip&&this.strip(e);for(const[t,i]of Object.entries(this.props))Fo(t,e,((t,s)=>{const a=i.validate(s,e,t);a&&n.push(a)}));return n}assert(e,t){const[n]=this.validate(e,t);if(n)throw n}message(e,t){return Lo(e,t,this.messages),this}validator(e,t){return Lo(e,t,this.validators),this}typecaster(e,t){return Lo(e,t,this.typecasters),this}hook(e){return this.hooks.push(e),this}propagate(e,t){return this.hooks.forEach((n=>n(e,t))),this}}Ko.ValidationError=_o;class Yo{constructor(e){this.validationMessagesService=e,this.props={},this.customValidations={requiredIfIbanCountry:Po,availableAll:Do,minAmount:No}}parse(e){return mo()(e,((e,t)=>this._parse(t,e))),new Ko(this.props,{strip:!1})}_parse(e,t){if("repeat"===e&&go()(t))return this.props.period={enum:fo()(t,qn.ONCE),message:{enum:(e,n)=>this.validationMessagesService.get("period")(e,n,fo()(t,qn.ONCE))}},void(this.props[e]={enum:t,message:{enum:(e,n)=>this.validationMessagesService.get("enum")(e,n,t)}});go()(t)?this.props[e]={enum:t,message:{enum:(e,n)=>this.validationMessagesService.get("enum")(e,n,t)}}:mo()(t,((t,n)=>{n in this.customValidations?this.props[e]={use:{[n]:(e,i)=>this.customValidations[n](e,i,t)},message:{[n]:(e,i)=>this.validationMessagesService.get(n)(e,i,t)}}:this.props[e]={[n]:t,message:{[n]:(e,i)=>this.validationMessagesService.get(n)(e,i,t)}}}))}}(Vo=qo||(qo={})).SHORT="short",Vo.ADVERB="adverb",Vo.NOUN="noun",Vo.ADJECTIVE="adjective",qo.SHORT,qo.ADVERB,qo.NOUN;const zo={daily:{short:"day",noun:"day",adverb:"daily",adjective:"daily"},weekly:{short:"w",noun:"week",adverb:"weekly",adjective:"weekly"},biweekly:{short:"2w",noun:"2 weeks",adverb:"biweekly",adjective:"biweekly"},every4weeks:{short:"4w",noun:"4 weeks",adverb:"every 4 weeks",adjective:"4-weekly"},monthly:{short:"mo",noun:"month",adverb:"monthly",adjective:"monthly"},bimonthly:{short:"2mo",noun:"2 months",adverb:"bimonthly",adjective:"bimonthly"},quarterly:{short:"qrt",noun:"quarter",adverb:"quarterly",adjective:"quarterly"},semiannual:{short:"6mo",noun:"6 months",adverb:"semiannually",adjective:"semiannual"},annual:{short:"yr",noun:"year",adverb:"annually",adjective:"annual"}};function Wo(e,t=qo.ADVERB){const n=zo[e];return n&&n[t]}class $o{constructor(e,t){this.currencyFormatter=e,this.translateServices=t}get(e){switch(e){case"enum":return this.enum.bind(this);case"minAmount":return this.minAmount.bind(this);case"required":case"requiredIfIbanCountry":return this.required.bind(this);case"period":return this.period.bind(this);default:return this.default.bind(this)}}enum(e,t,n){return this.translateServices?this.translateServices.intlService.translate("paymentMethodValidationMessages.enum",{enums:n.join(", ")}):`This value must be either ${n.join(", ")}`}period(e,t,n){if(this.translateServices){const e=this.translateServices.subscriptionPeriodLabelsService,t=n.map((t=>e.getLabel(t,qo.ADJECTIVE))).join(", ");return this.translateServices.intlService.translate("paymentMethodValidationMessages.period",{periods:t})}return`The chosen payment method only works with the following frequencies: ${n.map((e=>Wo(e,qo.ADJECTIVE))).join(", ")}`}minAmount(e,t,n){if(this.translateServices){const e=this.translateServices.intlService.formatCurrency(n.size,{currency:n.currency});return this.translateServices.intlService.translate("paymentMethodValidationMessages.minAmount",{minAmount:e})}return`This amount must be at least ${this.currencyFormatter.format(n.size,{currency:n.currency})} due to the payment method chosen.`}required(e){return this.translateServices?this.translateServices.intlService.translate("paymentMethodValidationMessages.required"):`${e} is required`}default(e){return this.translateServices?this.translateServices.intlService.translate("paymentMethodValidationMessages.default"):`Validation failed for ${e}`}}var Xo,Qo;!function(e){e[e.CHECKOUT=13]="CHECKOUT",e[e.PRODUCT=12]="PRODUCT"}(Xo||(Xo={})),function(e){e.EMBED_WORKER="embedWorker",e.EMBED="embed"}(Qo||(Qo={}));var Zo=n(3497),Jo=n.n(Zo);function er(e,t){return e.slice().filter((e=>null!==e)).sort(((e,t)=>e-t)).map((e=>(t-Number(e))/Math.abs(t-Number(e))||0)).reduce(((e,t)=>e+t),e.length)}class tr{constructor(e,t,n,i,a,o,r){this.tracker=e,this.checkoutConfiguration=t,this.sessionTokenService=n,this.sentry=i,this.debouncedRequestService=a,this.requestService=o,this.created=!1,this.latestUpdatePayload=null,this.latestUpdateResponse=null,this.sessionRestoreData=null,this.params={baseURL:s,embedVersion:r.embedVersion}}get sessionToken(){return this.sessionTokenService.token}get isCreated(){return this.created}get sessionStageInitial(){return this._sessionStageInitial}get(e,t,n){return(0,d.sH)(this,void 0,void 0,(function*(){const i={retries:5,delay:200};(null==n?void 0:n.retries)&&(null==n?void 0:n.delay)&&(i.retries=n.retries,i.delay=n.delay);const s=yield this.waitForCreated((()=>this.requestService.get({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/${e}`,headers:this.headers,params:t,cancelSimilar:!0,rejectOnInvalid:null==n?void 0:n.rejectsOnInvalid})),i);if(wn.isSuccess(s))return s.successResult;throw new Bs.gR}))}post(e,t,n){return(0,d.sH)(this,void 0,void 0,(function*(){const i=this.getPostPromise(e,t,n);return this.debouncedRequestService.request({promise:i,allowMerge:!1,allowDelay:!1})}))}update(e){this.sessionStageInitial||(this.sessionStageInitial=this.getSessionStageInitial(e));const t=Ys(Object.assign(Object.assign({},e),{initial:this.sessionStageInitial})),n=this.getUpdaterPromise(t);return this.debouncedRequestService.request({promise:n,allowMerge:!1,allowDelay:!1})}close(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.debouncedRequestService.request({promise:this.getClosePromise(),allowMerge:!1,allowDelay:!1})}))}updateConsent(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{yield this.debouncedRequestService.request({promise:this.getUpdateConsentPromise(e),allowMerge:!1,allowDelay:!1})}catch(t){throw this.sentry.captureException(new Error(`Update consent error: ${t}`),{tags:{session:this.sessionToken,marketingCookieConsent:e,scope:Qo.EMBED}}),t}}))}updateSessionWidgetDefaults(e,t){this.sessionStageInitial&&(this.sessionStageInitial.widgetDefaults=this.getWidgetDefaults(e,t))}abandon(e){return this.debouncedRequestService.request({promise:this.getAbandonPromise(e),allowMerge:!1,allowDelay:!1})}feedback(e){return this.debouncedRequestService.request({promise:this.getFeedbackPromise(e),allowMerge:!1,allowDelay:!1})}getNextScreen(e){const t=typeof e.clientHour,n=typeof e.clientWeekday;if("number"!==t||"number"!==n||void 0===e.clientHour||void 0===e.clientWeekday){const i=new Date;this.sentry.captureException(new Error("getNextScreen params clientHour or clientWeekday is not a number"),{extra:{params:e,dateForComparisonHour:i.getHours(),dateForComparisonWeekday:i.getDay(),clientHourType:t,clientWeekdayType:n}})}return this.requestService.post({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/v2/getNextScreen`,headers:this.headers,params:e,cancelSimilar:!0,rejectOnInvalid:!0})}getFeeCovering(e){return this.requestService.post({url:`${this.params.baseURL}/${Di}/getFeeCovering?token=${this.sessionToken}`,headers:this.headers,params:e,cancelSimilar:!0,rejectOnInvalid:!0})}getFeedbackPromise(e){return()=>(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.requestService.postWithStatus({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/feedback`,headers:this.headers,params:e});return wn.isSuccess(t)?t:this.handleSessionFeedbackFailure(t)}))}getPostPromise(e,t,n){return()=>(0,d.sH)(this,void 0,void 0,(function*(){var i;const s=null!==(i=null==n?void 0:n.sessionToken)&&void 0!==i?i:this.sessionToken;return this.requestService.post({url:`${this.params.baseURL}/${Di}/${s}/${e}`,headers:this.headers,params:t,rejectOnInvalid:null==n?void 0:n.rejectsOnInvalid,setCustomFingerprint:!0})}))}getUpdaterPromise(e){return()=>(0,d.sH)(this,void 0,void 0,(function*(){if(Jo()(e,this.latestUpdatePayload)&&this.latestUpdateResponse)return wn.success(this.latestUpdateResponse);const t=yield this.requestService.post({url:`${this.params.baseURL}/${Di}/${this.sessionToken}`,headers:this.headers,params:Object.assign(Object.assign({},e),{created:this.created}),setCustomFingerprint:!0});return wn.isSuccess(t)?(this.created=!0,this.latestUpdateResponse=t.successResult,this.latestUpdatePayload=e,t):this.handleSessionUpdateFailure(t)}))}getClosePromise(){return()=>this.requestService.post({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/close`,headers:this.headers,params:{},rejectOnInvalid:!0})}getUpdateConsentPromise(e){return()=>this.requestService.post({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/consent`,headers:this.headers,params:{marketingCookieConsent:e},rejectOnInvalid:!0})}getAbandonPromise(e){return()=>(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.requestService.post({url:`${this.params.baseURL}/${Di}/${this.sessionToken}/abandon`,headers:this.headers,params:e,rejectOnInvalid:!0});return wn.isSuccess(t)?t:this.handleSessionAbandonFailure(t)}))}setRestoreSessionData(e){this.sessionRestoreData=e,this.created=!0}get headers(){const e={"Content-Type":"text/plain; charset=utf-8","X-FRU-Embed-Version":this.params.embedVersion||"unknown"};return"on"===Jn("developmentMode")&&(e["X-FRU-DevelopmentMode"]="on"),e}set sessionStageInitial(e){this._sessionStageInitial=e}handleSessionUpdateFailure(e){var t;const n=!!(null===(t=e.failureResult.errors)||void 0===t?void 0:t.customerEmail);return n?wn.fail({customerEmailError:n}):wn.fail({})}handleSessionAbandonFailure(e){var t;const n=!!(null===(t=e.failureResult.errors)||void 0===t?void 0:t.customerEmail);return n?wn.fail({customerEmailError:n}):wn.fail({})}handleSessionFeedbackFailure(e){return wn.fail({status:e.failureResult.status})}getSessionStageInitial(e){var t,n,i,s,a,o,r,l;const c=window.location.href,u=gs(c);return{token:this.sessionToken,key:this.checkoutConfiguration.campaign.key,livemode:this.checkoutConfiguration.infrastructureParams.livemode,urlParams:u,widgetUrl:c,launcherParams:null!==(t=this.checkoutConfiguration.rawExternal.queryParams)&&void 0!==t?t:{},refererUrl:document.referrer,timezone:Bi(),trackerParams:{clientId:this.tracker.clientId,pageViewId:null!==(n=this.tracker.pageViewId)&&void 0!==n?n:"",checkoutViewId:this.sessionToken,clientLocale:this.tracker.clientLocale,uaWebdriver:Boolean(navigator.webdriver),tags:this.tracker.getTags()},widgetDefaults:this.getWidgetDefaults(e.donation.amount||0,e.checkoutDefaults),customFields:this.checkoutConfiguration.getInitialCustomFields(),elementKey:this.checkoutConfiguration.element.key,elementType:this.checkoutConfiguration.element.type,elementReminderKey:this.checkoutConfiguration.element.reminderKey||"",fundraisingPageKey:(null===(i=this.checkoutConfiguration.fundraisingPage)||void 0===i?void 0:i.key)||"",fundraisingPageCustomFields:(null===(s=this.checkoutConfiguration.fundraisingPage)||void 0===s?void 0:s.customFields)||[],startUrl:"",launcherUrl:"",checkoutV2:!0,checkoutType:this.checkoutConfiguration.checkoutType,checkoutIntentCustomFields:null!==(l=null===(r=null===(o=null===(a=this.checkoutConfiguration.rawExternal.intent)||void 0===a?void 0:a.checkoutSettings)||void 0===o?void 0:o.customFields)||void 0===r?void 0:r.filter((e=>e.name&&e.value)))&&void 0!==l?l:[],fromDonorPortal:Boolean(this.checkoutConfiguration.infrastructureParams.fromDonorPortal)}}getWidgetDefaults(e,t){var n,i,s,a,o,r;const l=null===(n=this.sessionRestoreData)||void 0===n?void 0:n.widgetDefaults,c={amount:t.defaultAmounts,frequency:t.frequency,amountOptions:t.amountOptions,currency:t.currency,relations:{amount:er([t.defaultAmount],e),amountOptions:er(t.frequencyAmountOptions,e)}};return l?{amount:null!==(i=l.amount)&&void 0!==i?i:c.amount,frequency:null!==(s=l.frequency)&&void 0!==s?s:c.frequency,amountOptions:null!==(a=l.amountOptions)&&void 0!==a?a:c.amountOptions,currency:null!==(o=l.currency)&&void 0!==o?o:c.currency,relations:null!==(r=l.relations)&&void 0!==r?r:c.relations}:c}waitForCreated(e,t){return(0,d.sH)(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function*(){if(n.isCreated)try{return yield e()}catch(s){if(i>=t.retries)throw n.sentry.captureException(s),s;return yield new Promise((e=>setTimeout(e,t.delay))),n.waitForCreated(e,t,++i)}return yield new Promise((e=>setTimeout(e,t.delay))),n.waitForCreated(e,t,++i)}()}))}}function nr(e=19){const t=window.crypto||window.msCrypto;let n="";if(t&&"function"==typeof t.getRandomValues){const i=new Uint8Array(e);t.getRandomValues(i),n=[].slice.call(i).map((e=>e%10)).join("")}else for(let t=0;t<e;t++)n+=Math.floor(10*Math.random()).toString();return"0"!==n[0]?n:nr(e)}tr.SESSION_UPDATE_DEBOUNCE=100;class ir{constructor(){this._token=this.generateToken()}get token(){return this._token}setToken(e){this._token=e}generateToken(){return`${e=nr().slice(0,-1)}${Ga(e)}`;var e}}class sr{get all(){return zo}}class ar{constructor(e){this.subscriptionPeriodLabelsProvider=e}getLabel(e,t=qo.ADVERB){if(!e)return;const n=this.subscriptionPeriodLabelsProvider.all[e];return n&&n[t]}getValueWithLabel(e,t,n=qo.SHORT){return function(e,t,n=qo.SHORT,i){if(!t)return e;let s;return s=i||Wo(t,n),s?`${e}/${s}`:e}(e,t,n,this.getLabel(t,n))}}class or{constructor(e){this.intl=e}get all(){return{daily:{short:this.intl.translate("widgetSubscriptionPeriodLabel.daily.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.daily.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.daily.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.daily.adjective")},weekly:{short:this.intl.translate("widgetSubscriptionPeriodLabel.weekly.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.weekly.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.weekly.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.weekly.adjective")},biweekly:{short:this.intl.translate("widgetSubscriptionPeriodLabel.biweekly.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.biweekly.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.biweekly.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.biweekly.adjective")},every4weeks:{short:this.intl.translate("widgetSubscriptionPeriodLabel.every4weeks.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.every4weeks.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.every4weeks.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.every4weeks.adjective")},monthly:{short:this.intl.translate("widgetSubscriptionPeriodLabel.monthly.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.monthly.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.monthly.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.monthly.adjective")},bimonthly:{short:this.intl.translate("widgetSubscriptionPeriodLabel.bimonthly.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.bimonthly.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.bimonthly.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.bimonthly.adjective")},quarterly:{short:this.intl.translate("widgetSubscriptionPeriodLabel.quarterly.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.quarterly.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.quarterly.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.quarterly.adjective")},semiannual:{short:this.intl.translate("widgetSubscriptionPeriodLabel.semiannual.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.semiannual.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.semiannual.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.semiannual.adjective")},annual:{short:this.intl.translate("widgetSubscriptionPeriodLabel.annual.short"),noun:this.intl.translate("widgetSubscriptionPeriodLabel.annual.noun"),adverb:this.intl.translate("widgetSubscriptionPeriodLabel.annual.adverb"),adjective:this.intl.translate("widgetSubscriptionPeriodLabel.annual.adjective")}}}}class rr{constructor(e,t,n){this.checkoutConfiguration=e,this.sessionTokenService=t,this.params=n,this.currentScreenDataGetter=null}getCommonEventPayload(){var e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g;return{widgetKey:this.checkoutConfiguration.campaign.key,checkoutCompanyKey:this.checkoutConfiguration.campaign.company,elementReminderKey:this.checkoutConfiguration.element.reminderKey,elementKey:this.checkoutConfiguration.element.key,elementType:this.checkoutConfiguration.element.type,elementLocale:this.checkoutConfiguration.element.locale,splitTestName:null!==(t=null===(e=this.checkoutConfiguration.external.element)||void 0===e?void 0:e.splitTestName)&&void 0!==t?t:"",splitTestVariant:null!==(i=null===(n=this.checkoutConfiguration.external.element)||void 0===n?void 0:n.splitTestVariant)&&void 0!==i?i:"",elementData:JSON.stringify(null===(s=this.checkoutConfiguration.external.element)||void 0===s?void 0:s.trackingData),fundraisingPageKey:null!==(o=null===(a=this.checkoutConfiguration.fundraisingPage)||void 0===a?void 0:a.key)&&void 0!==o?o:"",fundraisingPageCustomerKey:null!==(d=null!==(c=null===(l=null===(r=this.checkoutConfiguration.external.campaign)||void 0===r?void 0:r.fundraiser)||void 0===l?void 0:l.customerKey)&&void 0!==c?c:null===(u=this.checkoutConfiguration.fundraisingPage)||void 0===u?void 0:u.admin)&&void 0!==d?d:"",checkoutType:this.checkoutConfiguration.checkoutType,donationType:this.checkoutConfiguration.defaultFlowType,eventTags:null!==(p=null===(m=null===(h=this.checkoutConfiguration.external.tracker)||void 0===h?void 0:h.eventTags)||void 0===m?void 0:m.split(","))&&void 0!==p?p:[],eventComment:(null===(g=this.checkoutConfiguration.external.tracker)||void 0===g?void 0:g.embedClientId)?{embedClientId:this.checkoutConfiguration.external.tracker.embedClientId}:{},checkoutViewId:this.sessionTokenService.token,checkoutOpenTime:this.params.checkoutOpenTimestamp,checkoutLifetime:Date.now()-this.params.checkoutOpenTimestamp,checkoutLocale:this.params.checkoutLocale,funEmbedRelease:this.params.funEmbedRelease}}setCurrentScreenDataGetter(e){this.currentScreenDataGetter=e}getCurrentScreenData(){var e,t;try{return null!==(t=null===(e=this.currentScreenDataGetter)||void 0===e?void 0:e.call(this))&&void 0!==t?t:null}catch(e){if(e instanceof Error&&"Cannot identify current screen"===e.message)return null;throw e}}getOpeningTime(){switch(this.checkoutConfiguration.checkoutType){case Kn.PAGE:return Math.round(window.performance.now());case Kn.MODAL:return Date.now()-this.params.checkoutOpenTimestamp;default:throw new Bs.HP(this.checkoutConfiguration.checkoutType,"Unexpected checkout type")}}}class lr extends Error{constructor(e){super(`Method is not implemented: ${e}`)}}class cr extends rr{createCheckoutViewEvent(){throw new lr("createCheckoutViewEvent")}createCheckoutScreenViewEvent(){throw new lr("createCheckoutScreenViewEvent")}createCheckoutChargeEvent(){throw new lr("createCheckoutChargeEvent")}createCheckoutDonationCompleteEvent(){throw new lr("createCheckoutDonationCompleteEvent")}createCheckoutErrorEvent(){throw new lr("createCheckoutErrorEvent")}createCheckoutCloseEvent(){throw new lr("createCheckoutCloseEvent")}createCheckoutClickEvent(){throw new lr("createCheckoutClickEvent")}createCheckoutCustomEvent(){throw new lr("createCheckoutCustomEvent")}}class ur{constructor(e){this.targetWindow=e,this.isTrackingClicks=!1,this.clickHandler=this.handleClick.bind(this)}setTrackSender(e){this.trackSender=e}startTracking(){if(this.isTrackingClicks)throw new Error("Already tracking clicks");this.targetWindow.addEventListener("click",this.clickHandler,!0),this.isTrackingClicks=!0}stopTracking(){this.targetWindow.removeEventListener("click",this.clickHandler),this.isTrackingClicks=!1}handleClick(e){var t;const n=e.target;if(!n)return;if(n.closest("label")&&"INPUT"!==n.tagName)return;const i=ys(n,(e=>e&&e.hasAttribute&&e.hasAttribute(ur.ElementNameDataAttr)));null===(t=this.trackSender)||void 0===t||t.call(this,{target:n,elementName:null==i?void 0:i.getAttribute(ur.ElementNameDataAttr)})}}ur.ElementNameDataAttr="data-tracking-element-name";const dr=/#(.+?)(&|$)/,hr="fun_test";var mr,pr,gr,yr,fr;!function(e){e.REMINDER="reminder",e.DONATE_BUTTON="donateButton",e.STICKY_BUTTON="stickyButton",e.IMAGE_CARD="imageCard",e.TEXT_LINK="textLink",e.DONATION_FORM="donationForm",e.SIMPLE_FORM="simpleForm",e.GOAL_METER="goalMeter",e.STAT_COUNTER="statCounter",e.IMPACT_SLIDER="impactSlider",e.DONATION_LEVELS="donationLevels",e.BUTTON_GROUP="buttonGroup",e.FLOATING_BUTTON="floatingButton",e.MESSAGE_BAR="messageBar",e.TOP_SUPPORTERS="topSupporters",e.TOP_LOCATIONS="topLocations",e.SOCIAL_PROOF="socialProof",e.QR_CODE="qrCode",e.RECENT_DONATIONS="recentDonations",e.P2P_BUTTON="p2pButton",e.P2P_LINK="p2pLink",e.TOP_FUNDRAISERS="topFundraisers",e.DONOR_MAP="donorMap",e.LIGHTBOX="lightbox",e.FUNDRAISING_PAGE_LINK="fundraisingPageLink",e.FUNDRAISING_PAGE_INVITE_LINK="fundraisingPageInviteLink",e.LINK="link",e.DIRECT_LINK="direct",e.DEBUG_PANEL="debugPanel",e.TEST_MODE_PANEL="testModePanel",e.SPLIT_TESTING="splitTesting",e.JS_API="jsApi"}(mr||(mr={}));class vr{constructor(){this.payload={}}merge(e){const t={};for(const n in e)t[n]=e[n];for(const e in this.payload)t[e]=this.payload[e];var n;!e.elementType||(n=e.elementType)&&Object.values(mr).includes(n)||delete t.elementType,this.payload=t,e.eventComment&&this.mergeEventComment(e.eventComment)}validate(){return!(!this.payload.companyKey||8!==this.payload.companyKey.length||!this.payload.clientId||!this.eventType)}toObject(){const e={};for(const t in this.payload)e[t]=this.payload[t];return this.payload.eventComment&&(e.eventComment=JSON.stringify(this.payload.eventComment)),e.eventType=this.eventType,e}mergeEventComment(e){this.payload.eventComment||(this.payload.eventComment={}),Object.assign(this.payload.eventComment,e)}}class Sr extends vr{get eventType(){return"pageLeave"}}function Er(e,t=!0){if(!e)return{};const n=/([^=&#?]+)=([^=&#?]+)/gi,i={};for(;;){const s=n.exec(e);if(!s)break;const[,a,o]=s;try{t?i[decodeURIComponent(a)]=decodeURIComponent(o):i[a]=o}catch(e){console.error(e)}}return i}class Ar extends vr{constructor(e){super();const t=Er(location.href);t[hr]&&(this.payload.splitTestName=t[hr]),t.fun_variant&&(this.payload.splitTestVariant=t[hr]),e&&(this.payload.eventComment=Object.assign(Object.assign({},this.payload.eventComment),e))}get eventType(){return"pageView"}}class Cr extends vr{get eventType(){return"ping"}}!function(e){e.CHECKOUT="checkout"}(pr||(pr={}));class br{constructor(e){this.tags=new Set,this.tracker=e}get companyKey(){return this.tracker.companyKey}get clientId(){return this.tracker.clientId}get livemode(){return this.tracker.livemode}get clientLocale(){return this.tracker.clientLocale}get debug(){return this.tracker.debug}get page(){return this.tracker.page}get isPingAvailable(){return this.tracker.isPingAvailable}getTLD(){return this.tracker.getTLD()}getTags(){return Array.from(this.tags)}customTrack(e){return this.tracker.customTrack(e)}track(e,t){return this.tracker.track(e,t)}ping(e,t){const n=e||new Cr;this.tracker.ping(n,t)}initializePointerUsageTracking(){this.tracker.initializePointerUsageTracking()}subscribe(e,t){return this.tracker.subscribe(e,t)}setEventTags(e){e.forEach((e=>this.tags.add(e)))}removeEventTags(e){this.tags.forEach((t=>{e.some((e=>t.substring(0,e.length)===e))&&this.tags.delete(t)}))}mergeEventTags(e){let t=[];e.payload.eventTags&&(t=e.payload.eventTags.slice()),this.tags.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),e.payload.eventTags=t}}class Pr extends br{constructor(e,t,n,i){super(e),this.tracker=e,this.checkoutConfiguration=t,this.trackerClickInterception=n,this.params=i,this._trackerCheckoutEventService=null,this.trackerClickInterception.setTrackSender((e=>this.trackClick(e.elementName||"",e.target)))}get pageViewId(){var e;return null===(e=this.tracker.page)||void 0===e?void 0:e.pageViewId}get checkoutOpenTimestamp(){return this.params.checkoutOpenTimestamp}initialize(){this.tracker.initializePointerUsageTracking(this.params.targetWindow),this.trackerClickInterception.startTracking()}getTLD(){return this.tracker.getTLD()}dispose(){this.trackerClickInterception.stopTracking()}trackCheckoutView(){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutViewEvent()))}trackCheckoutScreenView(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutScreenViewEvent(e)))}trackCheckoutCharge(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutChargeEvent(e)))}trackCheckoutDonationComplete(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutDonationCompleteEvent(e)))}trackCheckoutError(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutErrorEvent(e)))}trackCheckoutClose(){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutCloseEvent()))}trackCheckoutCustomEvent(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutCustomEvent(e)))}trackClick(e,t){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutClickEvent({target:t,elementName:e})))}trackPageView(e){this.trackEvent((()=>new Ar(e)))}trackPageLeave(){this.trackEvent((()=>new Sr))}track(e){this.trackEvent((()=>e))}customTrack(e){this.trackEvent((()=>this.trackerCheckoutEventService.createCheckoutCustomEvent(e)))}ping(e){this.pingEvent(e||new Cr)}getTags(){return[...super.getTags(),...this.tracker.getTags()]}setTrackerCheckoutEventService(e){this._trackerCheckoutEventService=e}get trackerCheckoutEventService(){if(!this._trackerCheckoutEventService)throw new Error("TrackerCheckoutEventService should be set");return this._trackerCheckoutEventService}trackEvent(e){if(!this.checkoutConfiguration.infrastructureParams.showcase)try{const t=e();this.mergeEventPayload(t),this.tracker.track(t,{url:this.params.url,trackerType:pr.CHECKOUT})}catch(e){if(e instanceof lr)return;throw e}}pingEvent(e){this.checkoutConfiguration.infrastructureParams.showcase||this.tracker.isPingAvailable&&(this.mergeEventPayload(e),this.tracker.ping(e,{url:this.params.url}))}mergeEventPayload(e){const t=this.trackerCheckoutEventService.getCommonEventPayload();e.merge(t),this.mergeEventTags(e)}}!function(e){e.UPDATE="sessionConsentUpdate"}(gr||(gr={})),function(e){e.CANADA_QUEBEC="Quebec",e.US_CALIFORNIA="California",e.US_COLORADO="Colorado",e.US_OREGON="Oregon"}(yr||(yr={})),function(e){e.US_COLORADO="CO",e.US_OREGON="OR"}(fr||(fr={}));const Nr=[sn.AUSTRIA,sn.BELGIUM,sn.BULGARIA,sn.HUNGARY,sn.GERMANY,sn.GREECE,sn.DENMARK,sn.IRELAND,sn.SPAIN,sn.ITALY,sn.CYPRUS,sn.LATVIA,sn.LITHUANIA,sn.LUXEMBOURG,sn.MALTA,sn.NETHERLANDS,sn.POLAND,sn.PORTUGAL,sn.ROMANIA,sn.SLOVAKIA,sn.SLOVENIA,sn.FINLAND,sn.FRANCE,sn.CROATIA,sn.CZECH_REPUBLIC,sn.SWEDEN,sn.ESTONIA,sn.UNITED_KINGDOM,Ci.ICELAND,sn.NORWAY,sn.LIECHTENSTEIN,sn.SWITZERLAND];sn.CANADA,yr.CANADA_QUEBEC,sn.UNITED_STATES,yr.US_CALIFORNIA;class Dr{constructor(e,t,n,i){this.companyCountry=e,this.userCountry=t,this.eventEmitter=n,this.initialConsent=i,this.handleConsentUpdate=e=>{this.currentConsent=e.marketingCookieConsent,this.sendConsentToAPI(this.currentConsent)},this.currentConsent=this.determineInitialConsent(this.initialConsent),this.subscribeToConsentUpdates()}getCurrentConsent(){return this.currentConsent}setSessionAPI(e){this.sessionAPI=e}unsubscribeFromConsentUpdates(){this.eventEmitter.off(gr.UPDATE,this.handleConsentUpdate)}determineInitialConsent(e){const t=this.isEUCountry(this.companyCountry),n=this.isEUCountry(this.userCountry);return!(t||n)||e}isEUCountry(e){return Nr.includes(e.toUpperCase())}subscribeToConsentUpdates(){this.eventEmitter.on(gr.UPDATE,this.handleConsentUpdate)}sendConsentToAPI(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.sessionAPI)throw new Error("Must set Session API before emit update consent event");yield this.sessionAPI.updateConsent(e)}))}}var Tr,kr=n(2155);!function(e){e.SHOULD_SHOW="should-show",e.SHOULD_HIDE="should-hide",e.WAS_HIDDEN="was-hidden"}(Tr||(Tr={}));const Ir=(0,kr.createContext)(null);function _r(){const e=(0,kr.useContext)(Ir);if(!e)throw new Error("View event emitter was not provided");return e}class Or extends ii{tryStart(){this.isActive||super.start()}}class xr extends ii{}class wr extends ii{constructor(){super(...arguments),this._allowedFrequencies=[qn.ONCE,qn.MONTHLY],this._allowedLocales=[jt.D.EN_US,jt.D.EN_GB,jt.D.EN_CA]}get isTestGroup(){return this.isActive&&(this.isVariant(ge.TEST_1)||this.isVariant(ge.TEST_2))}get isTestGroup1(){return this.isActive&&this.isVariant(ge.TEST_1)}get isTestGroup2(){return this.isActive&&this.isVariant(ge.TEST_2)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!!this._allowedLocales.includes(e.locale)&&(!!e.isMobile&&(!!e.isAndroid&&(!!this._allowedFrequencies.every((t=>e.enabledFrequencies.includes(t)))&&!!e.isFontsLoaded)))}}class Rr extends ii{isTestGroup(){return this.isActive&&this.isVariant(ye.TEST)}tryStart(e){return!!this.canBeStarted(e)&&!this.isActive&&(super.start(),!0)}tryExposure(e){e.targetFrequency===qn.QUARTERLY&&this.exposure()}canBeStarted(e){return!!e.hasQuarterlyPlan&&!!e.hasMonthlyFrequency}}function Mr(e,t){if(t.length<3)return t;const n=(0,Oe.A)(e)%t.length,i=((0,Oe.A)(e+"_secondary")%t.length+n+1)%t.length;return[t[n],t[i]].sort(((e,t)=>null===e||null===t?0:e-t))}class Lr extends ii{get isTestGroup(){return this.isActive&&this.isVariant(O.TEST)}get upsellAmountsMap(){const e=this.tracker.clientId;return{[ya.UP_TO_25]:Mr(e,[1500,2e3]),[ya.UP_TO_35]:Mr(e,[2e3,2500,3e3]),[ya.UP_TO_55]:Mr(e,[2500,3e3,3500,4e3]),[ya.UP_TO_100]:Mr(e,[3500,4500,5500]),[ya.UP_TO_150]:Mr(e,[4e3,5e3,6e3]),[ya.UP_TO_200]:Mr(e,[5e3,7500,1e4])}}tryStart(e){this.active||this.canBeStarted(e)&&this.start(e)}canBeStarted(e){return!!e.preDonationUpsellIsEnabled}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}tryToExpose(e){e!==qn.MONTHLY&&e!==qn.EVERY_4_WEEKS||this.exposure()}}class Fr{constructor(e,t){this.translationProvider=e,this.translationLoader=t}changeLocale(e){return this.loadTranslation(e).then((t=>{this.translationProvider.locale(e),this.translationProvider.extend(t)}))}translate(e,t){return this.translationProvider.t(e,t)}safeTranslate(e,t){return this.translationProvider.safeT(e,t)}loadTranslation(e){return this.translationLoader.load(e)}}var Ur=n(2094),jr=n(1427);class Br{constructor(e,t){this.baseLocale=e,this.lingui=(0,Ur.sK)({locale:e,messages:{[e]:t||{}},localeData:{[e]:Br.makeLocaleData(e)}})}static extractLanguageFromLocale(e){const[t]=e.split("-");return t}static makeLocaleData(e){const t=this.extractLanguageFromLocale(e);return{plurals:jr[t]}}get defaultMessages(){return this.lingui._messages[this.baseLocale]}locale(e){if(void 0!==e){const t=Br.makeLocaleData(e);this.lingui.loadLocaleData(e,t),this.lingui.activate(e)}return this.lingui.locale}t(e,t){const n=this.lingui._(e,t,{formats:{number:{numberingSystem:"latn"}}});return n===e?"":n}safeT(e,t){const n=Object.fromEntries(Object.entries(t||{}).map((([e,t])=>[e,(0,Gt.ZD)(String(t))])));return this.t(e,n)}extend(e){const t=Object.assign({},this.defaultMessages,e);this.lingui.load(this.locale(),t)}}function Gr(e,t,n,i){return(Number(e)||0).toLocaleString(i||"en-US",{style:"decimal",currency:"USD",minimumFractionDigits:t||0,maximumFractionDigits:n||0,numberingSystem:"latn"})}class qr{constructor(e){this._locale=e}changeLocale(e){return this.locale=e,this.locale}get locale(){return this._locale}set locale(e){this._locale=e}}class Vr extends qr{constructor(e){super(e),this.formatNumber=Gr}format(e,t={minimumFractionDigits:0,maximumFractionDigits:0}){return this.formatNumber(e,t.minimumFractionDigits,t.maximumFractionDigits,this.locale)}}const Hr=[jt.D.DE_X_INFORMAL],Kr={[jt.D.DE]:jt.D.DE_X_INFORMAL},Yr={[jt.D.DE_X_INFORMAL]:jt.D.DE},zr=["HRMEIGNS"];class Wr{static initializeUserLocales(e,t){return e.map((e=>this.initializeUserLocale(e,t)))}static initializeUserLocale(e,t){const n=zr.includes(t.companyKey);if(Hr.includes(e))return n?e:Yr[e];const i=Kr[e];return i&&n?i:e}static getOriginalLocale(e){return e&&Yr[e]?Yr[e]:e}static isPrivateUseLocale(e){return Hr.includes(e)}}class $r{constructor(e,t,n){this.locale=e,this.widgetLocalizationConfig=t,this.companyLocalizationConfig=n}getDataLanguage(){const e=(0,Gt.Qk)(this.locale);return this.widgetLocalizationConfig.supportedLanguages.includes(e)?e:(0,Gt.Qk)(this.widgetLocalizationConfig.defaultLocale)}getUILocale(){const e=this.locale,t=this.widgetLocalizationConfig.useCompanyInterfaceLocales;if(Wr.isPrivateUseLocale(e)){const n=Wr.getOriginalLocale(e);if(n){const i=this.companyLocalizationConfig.interfaceLocales.includes(n),s=this.widgetLocalizationConfig.supportedLanguages.includes((0,Gt.Qk)(n));if(t&&i||!t&&s)return e}}const n=this.companyLocalizationConfig.interfaceLocales.includes(e),i=this.widgetLocalizationConfig.supportedLanguages.includes((0,Gt.Qk)(e));return t&&!n||!t&&!i?this.widgetLocalizationConfig.defaultLocale:e}}class Xr{constructor(e){this._locale=e}get intl(){if(!this._intl)throw new Error("Intl service is undefined in date formatter");return this._intl}set intl(e){this._intl=e}changeLocale(e){return this.locale=e,this.locale}get locale(){return this._locale}set locale(e){this._locale=e}}var Qr;!function(e){e.LONG="long",e.SHORT="short",e.LONG_WITH_YEAR="longWithYear",e.SHORT_WITH_YEAR="shortWithYear"}(Qr||(Qr={}));class Zr extends Xr{format(e,t={type:Qr.SHORT}){const n={numberingSystem:"latn"};switch(t.type){case Qr.LONG:n.month="long",n.day="numeric";break;case Qr.LONG_WITH_YEAR:n.month="long",n.day="numeric",n.year="numeric";break;case Qr.SHORT_WITH_YEAR:n.month="short",n.day="numeric",n.year="numeric";break;default:n.month="short",n.day="numeric"}return new Date(e).toLocaleString(this.locale,n)}}class Jr{load(e){const t=this.getTranslationFilename(e);return this.loadFile(t)}getTranslationFilename(e){return e.replace(/-/g,"_")}}class el extends Jr{loadFile(e){return(0,d.sH)(this,void 0,void 0,(function*(){return(yield n(3367)(`./${e}.json`)).default}))}}const tl=["common.screenAriaLabel","common.thankYouBadge","common.paymentNotAuthorizedError","confirmCloseDialog.question","confirmCloseDialog.instructions","paymentLoader.text","sharing.label","sharing.ariaLabel","tributeBadge.tooltipLabel","blockedScreen.description","mailingAddressScreen.onBehalfOfSubtitle","privacyScreen.titleFastTrackChoose","privacyScreen.donateAnonymously.label","privacyScreen.donateAnonymously.helpAriaLabel","privacyScreen.donateAsOrganization.label","privacyScreen.donateAsOrganization.input.helpAriaLabel","privacyScreen.donateAsOrganization.input.tooltipLabel","privacyScreen.donateAsOrganization.input.error.required","privacyScreen.donateAsOrganization.input.error.minLength","thankYouScreen.description.once","thankYouScreen.description.recurring.default","thankYouScreen.description.recurring.withEndDate","thankYouScreen.description.upsell","thankYouScreen.description.tribute.once","thankYouScreen.description.tribute.recurring.withEndDate","thankYouScreen.postDonationUpsell.description","thankYouScreen.postDonationUpsell.message","thankYouScreen.postDonationUpsell.error.min","thankYouScreen.postDonationUpsell.error.max","thankYouScreen.postDonationUpsell.button.confirm","thankYouScreen.share.emailSubject","thankYouScreen.makeAnotherTribute.button","payButton.label.annual","payButton.label.continue","payButton.label.once","payButton.label.daily","payButton.label.weekly","payButton.label.biweekly","payButton.label.every4weeks","payButton.label.monthly","payButton.label.bimonthly","payButton.label.quarterly","payButton.label.semiannual","donateForm.donationCurrency","donateForm.title","donateForm.frequencyAriaLabel","donateForm.donationCurrency","donateForm.donationAmountField.label","donateForm.donationAmountField.average.hint","donateForm.donationAmountField.error.required","donateForm.donationAmountField.error.min","donateForm.annualDonation.label","donateForm.dailyDonation.label","donateForm.tribute.label.dedication","donateForm.tribute.tooltipLabel","donateForm.donateButton.once","donateForm.donateButton.daily","donateForm.donateButton.weekly","donateForm.donateButton.biweekly","donateForm.donateButton.every4weeks","donateForm.donateButton.monthly","donateForm.donateButton.bimonthly","donateForm.donateButton.quarterly","donateForm.donateButton.semiannual","donateForm.donateButton.annual","doubleDonationScreen.description.desktop","doubleDonationScreen.description.mobile","doubleDonationScreen.tooltipLabel","doubleDonationScreen.nameMatch","doubleDonationScreen.message","doubleDonationScreen.matchedCompanyBlock.name","doubleDonationScreen.smallDonationAmountExperiment.name","doubleDonationScreen.button.donate.once","doubleDonationScreen.button.donate.recurring","fastTrackPaymentOptionsScreen.title","idealConfirmationScreen.nextStepOverview","idealConfirmationScreen.nextStep","idealConfirmationScreen.returnLabel","paymentMethodScreen.transactionCosts.tooltip.required","paymentOptions.donate","paymentOptions.donateWith","paymentOptions.donateWithAriaLabel","paymentMethodScreen.creditCardIsUnavailableInfo.part-1","paymentMethodScreen.creditCardIsUnavailableInfo.part-2","upsellScreen.questionShort","upsellScreen.questionShortEvery4Weeks","upsellScreen.description","upsellScreen.descriptionEvery4Weeks","upsellScreen.button.donate4Weeks","upsellScreen.button.donateMonthly","usBankAccountScreen.description.desktop","usBankAccountConfirmationScreen.button","usBankAccountGuideScreen.description.descriptorCode"];var nl=n(1755);const il={base:{color:"#222832",fontWeight:400,fontFamily:"'IBM Plex Sans', sans-serif",fontSize:"16px",lineHeight:"24px",fontSmoothing:"antialiased",":focus":{color:"#222832"},"::placeholder":{color:"#667080"},":focus::placeholder":{color:"#667080"}},invalid:{color:"#dA2243",":focus":{color:"#dA2243"},"::placeholder":{color:"#667080"},":focus::placeholder":{color:"#667080"}}},sl={focus:"focused",empty:"empty",invalid:"invalid"},al={fonts:[{family:"IBM Plex Sans",src:`url(${nl}) format('woff2')`,weight:"400",style:"normal"}]},ol=/#([\da-z_-]{1,25})(\?|&|$)/i,rl=e=>{var t,n,i;return"string"==typeof(null===(t=e.navigator)||void 0===t?void 0:t.userAgent)&&!!(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.userAgent)||void 0===i?void 0:i.match("CriOS"))},ll=/^X[\dA-Z]{7}/,cl=new RegExp("\\/-\\/(N[\\dA-Z]{7})");var ul,dl;new RegExp(`${cl.source}(?!\\/join)`),new RegExp(`${cl.source}\\/join`),function(e){e.type="type",e.recurring="recurring",e.amount="amount",e.modifyAmount="modifyAmount",e.designationId="designationId",e.fundraiser="fundraiser",e.modifyDesignation="modifyDesignation",e.firstName="firstName",e.lastName="lastName",e.email="email",e.fundraiseupLivemode="fundraiseupLivemode",e.restoreToken="restoreToken",e.clientId="clientId",e.paymentIntent="payment_intent",e.paymentIntentClientSecret="payment_intent_client_secret",e.redirectStatus="redirect_status"}(ul||(ul={})),function(e){e.fundraiser="fundraiser",e.element="element"}(dl||(dl={}));let hl=!1;class ml{constructor(e,t=window){this.keysKeeper=e,this._disabled=!1,this.originalQueryStringAndHash="",this.window=t}get disabled(){return this._disabled}set disabled(e){e!==this._disabled&&(this._disabled=e)}checkUrl(){if(this.disabled)return;if(!this.window.location.hash)return;if(!this.keysKeeper.exists("WIDGET",this.window.location.hash))return;hl=!1;const e=this.keysKeeper.getOriginalWidgetKey(this.window.location.hash),t=this.window.location.href.replace(this.window.location.hash,"#"+e);this.window.history.replaceState(null,this.window.document.title,t)}setUrl(e,t="",n="",i=!1){if(this.disabled)return;if(!this.keysKeeper.exists("WIDGET",e)&&!this.isModalKey(e))return;const s=this.getQueryString({keyOrHash:e,hrefParams:t,queryString:this.window.location.search,hash:this.window.location.hash,fundraisingPageKey:n}),a=this.cleanHash(this.window.location.hash);this.originalQueryStringAndHash=this.cleanQueryString(s,t,i)+a;const o=this.window.location.origin+this.normalizePathname(this.window.location.pathname)+s+a;this.window.history.replaceState(null,this.window.document.title,o),hl=!1}back(){rl(this.window)||this.window.history.go(-2),setTimeout((()=>{const e=gs(this.window.location.search,!1).form;if(this.keysKeeper.exists("WIDGET",e)||this.isModalKey(e))return hl?void this.window.history.back():this.clearUrl()}),150)}clearUrl(){if(this.disabled)return;const e=gs(this.window.location.search,!1).form;if(!this.keysKeeper.exists("WIDGET",e)&&!this.isModalKey(e))return;const t=this.window.location.origin+this.normalizePathname(this.window.location.pathname)+this.originalQueryStringAndHash;this.window.history.replaceState(null,this.window.document.title,t),hl=!0}isModalKey(e){return[Hn.P2P_BUTTON,Hn.P2P_LINK].some((t=>this.keysKeeper.checkElementType(t,e)))}getQueryString({keyOrHash:e,hrefParams:t,hash:n,queryString:i,fundraisingPageKey:s}){const a=gs(t,!0),o={form:e},r=gs(n,!1),l=gs(i,!1),c=function(e){const t=ol.exec(e);return t&&t[1]?t[1]:""}(n)||l.form||"",u=0!==c.length&&c.toLowerCase()!==e.toLowerCase();return s&&(o.fundraiser=s),Object.keys(r).forEach((e=>{u&&e in o||(o[e]=r[e])})),Object.keys(l).forEach((e=>{u&&e in o||(o[e]=l[e])})),Object.assign(o,a),o.form=e,o.element&&ll.test(o.element)&&delete o.element,"?"+fs(o,!1)}cleanHash(e){const t=e.split("&",1)[0];return this.keysKeeper.exists("WIDGET",t)||"#"===t||-1!==t.indexOf("=")?"":t}cleanQueryString(e,t,n){const i=gs(t,!1),s=gs(e,!1);delete s.form,Object.values(ul).forEach((e=>delete s[e])),Object.keys(dl).forEach((e=>delete s[e])),n||Object.keys(i).forEach((e=>delete s[e]));const a=fs(s,!1);return""===a?"":"?"+a}normalizePathname(e){return e.startsWith("//")?e.slice(1):e}}class pl{static forKey(e){return new pl(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.key=e,this.params=t,this.customParams=n}toString(){const e=[].concat(this.params,this.customParams);return["#"+this.key,e.map((e=>{let[t,n]=e;return t+"="+encodeURIComponent(n)})).join("&")].filter(Boolean).join("&")}addRecurring(e){return e&&this.params.push([ul.recurring,e]),this}addAmount(e){return e&&this.params.push([ul.amount,e.toString()]),this}addModifyAmount(e){return!1!==e&&"no"!==e||this.params.push([ul.modifyAmount,"no"]),this}addModifyDesignation(e){return!1!==e&&"no"!==e||this.params.push([ul.modifyDesignation,"no"]),this}addDesignation(e){return"no"===e?this.params.push(["designation",e]):e&&this.params.push([ul.designationId,e]),this}addFirstName(e){return e&&this.params.push([ul.firstName,e]),this}addLastName(e){return e&&this.params.push([ul.lastName,e]),this}addEmail(e){return e&&this.params.push([ul.email,e]),this}addFundraiseupLivemode(e){return!1!==e&&"no"!==e||this.params.push([ul.fundraiseupLivemode,"no"]),this}addCustomQueryParams(e){if(!e)return this;for(const[t,n]of Object.entries(e))n&&this.customParams.push([t,n]);return this}}var gl,yl,fl;!function(e){e.POP="popstate"}(gl||(gl={})),function(e){e.INITIAL="initial",e.LOOP="loop"}(yl||(yl={}));class vl{constructor(e){this.window=e,this.navigationHandlers=new Set,this.isLoop=!1,this.historyStateStack=[],this.historyApi=this.window.history,this._handleNavigation=this.handleNavigation.bind(this)}initialize(e){var t;this.historyStateStack=[],this.url=e;const n=(null===(t=this.historyApi.state)||void 0===t?void 0:t.state)||this.historyApi.state;return n!==yl.INITIAL&&this.setInitialNavigationState(n),this.window.addEventListener(gl.POP,this._handleNavigation),this}dispose(){this.historyStateStack.length&&(this.historyApi.go(-this.historyStateStack.length),this.historyStateStack=[]),this.window.removeEventListener(gl.POP,this._handleNavigation)}onNavigation(e){this.navigationHandlers.add(e)}activateLoop(){this.isLoop||(this.isLoop=!0,this.setNavigationState(yl.LOOP,{replace:!0}))}deactivateLoop(){this.isLoop&&(this.isLoop=!1,this.setNavigationState(yl.INITIAL,{replace:!0}))}callNavigationHandlers(){this.navigationHandlers.forEach((e=>{e()}))}handleNavigationInitialState(){this.historyApi.length>2?this.historyApi.back():this.setNavigationState(yl.INITIAL)}handleNavigation(e){var t;const n=(null===(t=e.state)||void 0===t?void 0:t.state)||e.state,i=null===n||""===n,s=n===yl.INITIAL;this.historyStateStack.pop(),this.isLoop&&(s||i)&&this.setNavigationState(yl.LOOP),this.isLoop||!s&&!i?this.callNavigationHandlers():this.handleNavigationInitialState()}setNavigationState(e,t){(null==t?void 0:t.replace)?this.historyApi.replaceState({state:e},"",this.url):(this.historyApi.pushState({state:e},"",this.url),this.historyStateStack.push(e))}setInitialNavigationState(e){const t=e===yl.LOOP;this.setNavigationState(yl.INITIAL,{replace:t})}}class Sl extends vl{handleNavigationInitialState(){this.callNavigationHandlers()}}!function(e){e.CHECKOUT_INTENT="checkoutIntent",e.TRIBUTE_SELECTED="tributeSelected",e.EMAIL_LOG="emailLog",e.EMAIL_LOG_ID="emailLogId",e.RESTORE_TOKEN="restoreToken",e.CLIENT_ID="clientId",e.PAYMENT_INTENT="payment_intent",e.PAYMENT_INTENT_CLIENT_SECRET="payment_intent_client_secret",e.REDIRECT_STATUS="redirect_status"}(fl||(fl={}));class El{constructor(e,t,n,i){this.globalWindow=e,this.keysKeeper=t,this.checkoutConfiguration=n,this.isOpenedFromUrl=i}initialize(){this.setUrl();const e=this.clearUrl();this.flowNavigationRouter.initialize(e)}dispose(){return(0,d.sH)(this,void 0,void 0,(function*(){this.flowNavigationRouter.dispose(),yield Ri(150),this.urlRouter.clearUrl()}))}onNavigation(e){this.flowNavigationRouter.onNavigation(e)}activateNavigationLoop(){this.flowNavigationRouter.activateLoop()}deactivateNavigationLoop(){this.flowNavigationRouter.deactivateLoop()}get fundraiserIdentifier(){var e,t,n,i;return null!==(i=(null===(t=null===(e=this.checkoutConfiguration.external.campaign)||void 0===e?void 0:e.fundraiser)||void 0===t?void 0:t.key)||(null===(n=this.checkoutConfiguration.fundraisingPage)||void 0===n?void 0:n.key))&&void 0!==i?i:""}get urlRouter(){return this._urlRouter||(this._urlRouter=new ml(this.keysKeeper,this.globalWindow)),this._urlRouter}get flowNavigationRouter(){return this._flowNavigationRouter||(this._flowNavigationRouter=new Sl(this.globalWindow)),this._flowNavigationRouter}clearUrl(){const e=gs(this.globalWindow.location.search,!1),t={},n=Object.values(fl);Object.keys(e).forEach((i=>{n.includes(i)||(t[i]=e[i])}));const i=fs(t,!1);return`${this.globalWindow.location.origin}${this.globalWindow.location.pathname}${i?`?${i}`:""}`}setUrl(){this.urlRouter.disabled=!!this.checkoutConfiguration.showcase;const e=pl.forKey("").addCustomQueryParams(this.checkoutConfiguration.rawExternal.queryParams);this.urlRouter.checkUrl(),this.urlRouter.setUrl(this.checkoutConfiguration.campaign.customHash||this.checkoutConfiguration.campaign.key,e.toString().slice(1),this.fundraiserIdentifier,this.isOpenedFromUrl)}}class Al extends ls{constructor(e,t,n,i,s,a,o,r,l,c,u,d){super(),this.embedTracker=e,this.debug=t,this.keysKeeper=n,this.checkoutViewEventEmitter=i,this.targetWindow=s,this.globalWindow=a,this.params=o,this.servicesFactoryMap=r,this.funSessionStorage=c,this.embedEventEmitter=u,this.isFontsLoaded=d,this.sentryInstance=l;const h=this.createCoreInstances();this.flowManager=h.flowManager,this.intl=h.intl,this.trackerCheckout=h.trackerCheckout,this.experiments=h.experiments,this.currencyService=h.currencyService,this.checkoutConfiguration=h.checkoutConfiguration,this.checkoutAPIBridge=h.checkoutAPIBridge,this.checkoutRouter=h.checkoutRouter,this.logger=h.logger,this.userInteraction=h.userInteraction,this.currencyFilter=h.currencyFilter,this.checkoutCurrencyFormatter=h.checkoutCurrencyFormatter}setLocale(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.intl.setLocale(e||this.intl.locale)}))}initializePublicJsApi(){}initializePageGuardManager(){}initializeIFrameRemover(){}initializeCookieConsent(){}initializeUserSession(){}initializeRouter(){this.checkoutConfiguration.infrastructureParams.showcase||this.checkoutRouter.initialize()}initializeTracker(){this.trackerCheckout.initialize()}initializeExperiments(){this.experiments.register(u.SMART_PDU_CHECKOUT_V_3_EXPERIMENT,gi),this.experiments.register(u.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT,pi),this.experiments.register(u.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT,vi),this.initializeAACheckoutExperiment(),this.initializeUpsellAmountsDatasetModalExperiment(),this.initializeNewFontForHintToRecurringExperiment(),this.initializeDonorRatingCheckoutExperiment(),this.initializeCheckoutStepsExperiments(),this.registerFastTrackExperiments(),this.initializeMultipleRecurringPlanCheckoutExperiment(),this.initializeStripeLinkCheckoutExperiment(),this.initializeFeeCoverageSelectionExperiments(),this.initializePreDonationAmounts100200USDExperiments(),this.initializeDonateByVoiceExperiment(),this.initializeQuarterlyUpsellExperiment()}initializeAACheckoutExperiment(){this.experiments.register(u.AA_CHECKOUT_EXPERIMENT,Or),this.experiments.get(u.AA_CHECKOUT_EXPERIMENT).tryStart()}initializeUpsellAmountsDatasetModalExperiment(){this.experiments.register(u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT,Lr);const e=this.experiments.get(u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT);e.tryStart({preDonationUpsellIsEnabled:this.checkoutConfiguration.campaign.config.showUpsell}),this.checkoutConfiguration.mergePreDonationUpsellSettings(this.getUpsellAmountsDatasetConfiguration(e))}initializeNewFontForHintToRecurringExperiment(){this.experiments.register(u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT,wr),this.experiments.get(u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT).tryStart({enabledFrequencies:this.checkoutConfiguration.enabledFrequencies,locale:this.params.localeCode,isMobile:this.params.isMobile,isFontsLoaded:this.checkoutConfiguration.infrastructureParams.isFontsLoaded,isAndroid:"Android"===this.params.browserData.os.name})}initializeMultipleRecurringPlanCheckoutExperiment(){this.experiments.register(u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT,di),this.experiments.get(u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT).tryStart({checkoutConfiguration:this.checkoutConfiguration})}initializeCheckoutStepsExperiments(){this.experiments.register(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT,ai),this.experiments.register(u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT,si)}initializeDonateByVoiceExperiment(){this.experiments.register(u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT,oi)}initializeCurrencyService(){return(0,d.sH)(this,void 0,void 0,(function*(){yield function(e,t,n){return(0,d.sH)(this,void 0,void 0,(function*(){e.loadFiat(n),no(t)&&(yield e.loadCrypto())}))}(this.currencyService,this.checkoutConfiguration,this.intl)}))}initializeCurrencyFilter(){return(0,d.sH)(this,void 0,void 0,(function*(){yield function(e,t,i){return(0,d.sH)(this,void 0,void 0,(function*(){if(function(){try{Intl.NumberFormat("fr-FR",{style:"currency",currency:"VND",currencyDisplay:"narrowSymbol",minimumFractionDigits:0,maximumFractionDigits:0}).format(8e3)}catch{return!1}return!0}())no(i)&&(yield e.loadCrypto());else{const e=yield async function(){const e=await n.e(173).then(n.bind(n,2216));return{formatCurrency:e.currencyFilter,formatAmount:()=>"",formatSymbol:(e,t)=>t===Ht.PREFIX?e:"",getCurrencyFormat:e.getCurrencyFormat,loadCrypto:()=>Promise.resolve()}}();t.replaceCurrencyFilter(e)}}))}(this.currencyFilter,this.checkoutCurrencyFormatter,this.checkoutConfiguration)}))}subscribeOnUserInteraction(){return this.userInteraction.subscribeOnUserInteraction((()=>{this.trackerCheckout.ping()}))}subscribeOnHistoryInteraction(){this.checkoutRouter.onNavigation((()=>{const e=this.flowManager.getCurrentFlow();e.isCurrentScreenFirst()||e.isCurrentScreenLast()?this.checkoutViewEventEmitter.emit(Tr.SHOULD_HIDE,{}):e.canGoBack&&e.prev()})),this.flowManager.onScreenChanged((()=>{const e=this.flowManager.getCurrentFlow();e.isCurrentScreenFirst()||e.isCurrentScreenLast()?this.checkoutRouter.deactivateNavigationLoop():this.checkoutRouter.activateNavigationLoop()}))}startFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.flowManager.setInitialScreen(e).startDefaultFlow()}))}createCoreInstances(){var e,t,n,i,a,o,r,l,c,d,m;const p=this.params.externalParams,g=(null===(t=null===(e=p.launcher)||void 0===e?void 0:e.element)||void 0===t?void 0:t.type)===Hn.DIRECT_LINK,y={livemode:this.params.livemode,env:this.params.env,isMobile:this.params.isMobile,showcase:this.params.showcase,isDevelopmentMode:Bn(),OS:this.params.browserData.os.name||"",browser:this.params.browserData.browser.name||"",browserVersion:this.params.browserData.browser.major||"",isInAppBrowser:this.params.browserData.isInAppBrowser,isSSLEnabled:"https:"===window.location.protocol,fromDonorPortal:this.params.fromDonorPortal,isFontsLoaded:this.isFontsLoaded},f=this.params.steplessCheckoutExperimentVariant===R.CONTROL,v=new Ha(this.params.resolvedConfig,p,y,this.params.integrations,{locale:this.params.localeCode},Object.assign(Object.assign({checkoutType:Kn.MODAL,donationSettings:{isAdaptiveDefaultFrequencySuggestionEnabled:!0},paymentOptionsSettings:{isNewIdealPaymentFlowEnabled:!0}},f?{preDonationUpsellSettings:{enabledForDonationFrequencies:[qn.ONCE,qn.MONTHLY],enabledTargetFrequencies:[qn.MONTHLY],isAdaptiveSuggestionEnabled:!1},paymentOptionsSettings:{disabledPaymentMethods:[Gn.US_BANK_ACCOUNT]},remindMeLaterSettings:{isEnabled:!1}}:{}),{currencySettings:{ratesId:this.params.currencyRates.id}}),this.params.infrastructureQueryParams),S=new El(this.globalWindow,this.keysKeeper,v,g),E=function(e,t,n){const i=function(e,t){return Object.assign(Object.assign({},e),Object.fromEntries(Object.entries(t).map((e=>{let[n]=e;var i;return[n,Number(null!==(i=t[n])&&void 0!==i?i:1)]}))))}(e,t.cryptoCurrencies),s=new on;return new to(s,i,n)}(this.params.currencyRates.rates,v,this.sentryInstance),A=new Un(E),C=ji({checkoutConfiguration:v}),b=new tn(new on),P=new za(qt.DEFAULT_LOCALE,b,C),N=function(e,t,n){const i=new $r(e,{defaultLocale:t.campaign.config.localization.defaultLocale,useCompanyInterfaceLocales:t.campaign.config.localization.useCompanyInterfaceLocales,supportedLanguages:[...t.campaign.config.localization.supportedLanguages]},{interfaceLocales:[...t.company.localization.interfaceLocales]}).getUILocale();return function({dateFormatter:e,currencyFormatter:t,numberFormatter:n,availableLocales:i=[qt.DEFAULT_LOCALE],translationLoader:s,locale:a=qt.DEFAULT_LOCALE,phrases:o,company:r="",donateToPayTokens:l=[]}){const c=new Br(a,o),u=new Fr(c,s);return new qt(u,e,t,n,r,l,{locale:a,availableLocales:i})}({dateFormatter:new Zr(qt.DEFAULT_LOCALE),currencyFormatter:n,numberFormatter:new Vr(qt.DEFAULT_LOCALE),availableLocales:Bt,translationLoader:new el,locale:i,company:t.campaign.company,donateToPayTokens:tl})}(this.params.localeCode,v,P),D=new ir,T=new Dr(v.company.country,v.user.address.countryCode,this.embedEventEmitter,this.params.initialMarketingCookieConsent),k=new ur(this.targetWindow),I=new Pr(this.embedTracker,v,k,{targetWindow:this.targetWindow,url:this.params.trackingUrls.checkout,checkoutOpenTimestamp:this.params.checkoutOpenTimestamp});I.setTrackerCheckoutEventService(new cr(v,D,{checkoutOpenTimestamp:I.checkoutOpenTimestamp,checkoutLocale:I.clientLocale,funEmbedRelease:this.params.embedVersion}));const _=function(e=""){return new Mn(e,xn.Em)}(),O=new Fi(tr.SESSION_UPDATE_DEBOUNCE),x=new tr(I,v,D,this.sentryInstance,O,_,{embedVersion:this.params.embedVersion}),w=(M={sentry:this.sentryInstance,requestService:_,createFundraiseupAddressProvider:(e,t)=>new wi(e,_,t,D),baseURL:s,locale:N.locale},new Vt(M.createFundraiseupAddressProvider,M.sentry,M.requestService,{locale:M.locale,baseURL:M.baseURL,fundraiseupAddressProviderHeaders:M.fundraiseupAddressProviderHeaders}));var M;const L=new Ot(this.funSessionStorage),F=v.company,U=this.params.livemode?Pe.LIVE:Pe.TEST,j=rs({publicKey:this.params.paymentMethods.stripePublicKey[U],targetWindow:this.targetWindow,locale:N.locale,stripeAccount:F.stripeAccount,showcase:this.params.showcase},this.sentryInstance),B=rs({publicKey:this.params.paymentMethods.stripePublicKey[U],targetWindow:this.globalWindow,locale:N.locale,stripeAccount:F.stripeAccount,showcase:this.params.showcase},this.sentryInstance),G=function(e,t){if(!Object.keys(Lt).find((e=>Lt[e]===t)))throw new Error(`UNSUPPORTED_TYPE_OF_STORAGE ${t}`);return new xt(e,((e,t=Ft.A)=>{function n(e,n){t.remove(e,n)}function i(e){return!!window.FUN_DO_NOT_TRACK||!!window.FUN_ONLY_STRICTLY_NECESSARY_COOKIES&&e!==kt.CID}return window.FUN_DO_NOT_TRACK&&Ut().forEach((e=>{n(kt.CID,{domain:e}),n(kt.SESSION,{domain:e}),n(kt.FUNC,{domain:e}),n(kt.PERFORMANCE,{domain:e})})),window.FUN_ONLY_STRICTLY_NECESSARY_COOKIES&&Ut().forEach((e=>{n(kt.SESSION,{domain:e}),n(kt.FUNC,{domain:e}),n(kt.PERFORMANCE,{domain:e})})),{get:function(n){if(i(n))return null;const s=t.get(n);if(!s)return null;if(e===Rt.OBJECT){let e=null;return e=JSON.parse(s),e}return s},set:function(n,s,a){i(n)||(e===Rt.OBJECT&&(s=JSON.stringify(s)),t.set(n,s,a))},remove:n}})(t))}(kt.EXPERIMENTS,Lt.OBJECT),q=new Ue({companyKey:F.key,parentCompanyKey:F.parentKey,widgetKey:v.campaign.key,tracker:I,experimentsSettings:[...(V=this.params.experimentsConfig.experiments,je([Ge,qe,Ve,He,Ke,Ye,ze,We,$e,Xe,Qe,Ze,Je,et,tt,nt,it,st,at,ot,rt]).map((e=>{const t=V.find((t=>t.experimentId===e.experimentId));return t?{experimentId:t.experimentId,enabledWidgets:t.enabledWidgets,disabledWidgets:t.disabledWidgets,scope:t.scope,name:t.name,enabled:t.enabled,variants:Be(t.variants),disabledAccounts:t.disabledAccounts,enabledAccounts:t.enabledAccounts}:e}))),..._t(this.params.experimentsConfig.experiments)],user:v.user,funStorage:G,infrastructureParams:v.infrastructureParams,sentry:this.sentryInstance,isDebugMode:this.params.isDebugMode,isFundraiseupVisitor:this.params.isFundraiseupVisitor,isAbTestMode:this.params.isAbTestMode,distributionId:I.clientId});var V;q.register(u.DUMMY_EXPERIMENT,xr),q.get(u.DUMMY_EXPERIMENT).start();const H=new De.A,K=new ps(v),Y=new ni({window:window,tracker:I,enabledByDefault:!0,sentry:this.sentryInstance,checkoutConfiguration:v,sessionTokenService:D}),z=function(e){return function(e){const t=e||new sr;return new ar(t)}(new or(e))}(N),W=new On({company:v.company,parentCompany:v.parentCompanyConfig,isDevelopmentMode:Bn()}),$=function(e,t,n){const i=new $o(e,{intlService:t,subscriptionPeriodLabelsService:n}),s=new Yo(i);return new uo(lo,s)}(P,N,z),X=new ro(oo),Q=new Ki({apiHost:s,isShowcase:this.params.showcase,isLighthouse:!1,sessionTokenService:D,embedVersion:this.params.embedVersion}),Z=_t(this.params.experimentsConfig.experiments).filter((e=>e.experimentId===h[u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT])),J=null===(n=this.embedTracker.page)||void 0===n?void 0:n.toObject(),ee=new Vi({sentry:this.sentryInstance,apiHost:s,companyKey:v.company.key,campaignKey:v.campaign.key,clientLocale:this.params.localeCode,currencyRates:this.params.currencyRates.rates,utmSource:null!==(o=null===(a=null===(i=v.external)||void 0===i?void 0:i.utm)||void 0===a?void 0:a.source)&&void 0!==o?o:"",currencyService:E,sessionTokenService:D,experimentSettings:Z,experimentsStorage:G,fundraiserKey:null===(r=v.fundraisingPage)||void 0===r?void 0:r.key,fundraiserMemberKey:null!==(d=null===(c=null===(l=v.external.campaign)||void 0===l?void 0:l.fundraiser)||void 0===c?void 0:c.customerKey)&&void 0!==d?d:null===(m=v.fundraisingPage)||void 0===m?void 0:m.admin,embedVersion:this.params.embedVersion,clientId:this.embedTracker.clientId,clientConnectionType:null==J?void 0:J.clientConnectionType,clientDeviceMemory:null==J?void 0:J.clientDeviceMemory,clientHardwareConcurrency:null==J?void 0:J.clientHardwareConcurrency,clientConnectionDownlink:null==J?void 0:J.clientConnectionDownlink,clientDoNotTrack:null==J?void 0:J.clientDoNotTrack,clientDevicePixelRatio:null==J?void 0:J.clientDevicePixelRatio,clientBatteryLevel:null==J?void 0:J.clientBatteryLevel,checkoutType:Kn.MODAL,elementType:v.element.type});return{flowManager:new Xa(H,v,N,I,D,this.debug,E,A,this.targetWindow,this.globalWindow,this.sentryInstance,this.params.paymentMethods,j,B,L,w,K,q,this.servicesFactoryMap,Y,x,z,W,$,X,Q,ee,T,{stripe:{elementsOptions:al,elementStyles:il,elementClasses:sl},screenSet:{ukBacs:Vn.UK_BACS,paymentOptions:Vn.PAYMENT_OPTIONS,fastTrackPaymentOptions:Vn.FAST_TRACK_PAYMENT_OPTIONS},funEmbedRelease:this.params.embedVersion,pendingRequests:this.params.pendingRequests}),intl:N,trackerCheckout:I,experiments:q,currencyService:E,checkoutConfiguration:v,checkoutAPIBridge:K,checkoutRouter:S,logger:Y,userInteraction:new Zn(this.targetWindow,this.sentryInstance),currencyFilter:b,checkoutCurrencyFormatter:P}}initializeDonorRatingCheckoutExperiment(){var e;this.experiments.register(u.DONOR_RATING_CHECKOUT_EXPERIMENT,li);const t=this.experiments.get(u.DONOR_RATING_CHECKOUT_EXPERIMENT),n={enabledFrequencies:this.checkoutConfiguration.enabledFrequencies,donorRating:this.checkoutConfiguration.company.donorRating};t.tryStart(n),this.experiments.register(u.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT,ri),this.experiments.get(u.DONOR_RATING_CAMPAIGN_PAGES_EXPERIMENT).tryStart(Object.assign(Object.assign({},n),{isMatchingEnabled:Boolean(null===(e=this.checkoutConfiguration.campaign.config.campaignPage)||void 0===e?void 0:e.rateMatching.show)}))}getUpsellAmountsDatasetConfiguration(e){const t={};return e.active&&(t.isAdaptiveSuggestionEnabled=!1),e.isEnabled({preDonationUpsellIsEnabled:this.checkoutConfiguration.campaign.config.showUpsell})&&(t.amountsMap=e.upsellAmountsMap),t}registerFastTrackExperiments(){this.experiments.register(u.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT,ci)}initializeStripeLinkCheckoutExperiment(){this.experiments.register(u.STRIPE_LINK_PAGES_EXPERIMENT,fi),this.experiments.register(u.STRIPE_LINK_CHECKOUT_EXPERIMENT,yi),this.experiments.get(u.STRIPE_LINK_CHECKOUT_EXPERIMENT).tryStart({isMobile:this.params.isMobile,browser:this.checkoutConfiguration.infrastructureParams.browser})}initializeFeeCoverageSelectionExperiments(){this.experiments.register(u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT,ui),this.experiments.get(u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT).tryStart()}initializePreDonationAmounts100200USDExperiments(){this.experiments.register(u.PRE_DONATION_AMOUNTS_100_200_USD_PAGES_EXPERIMENT,mi),this.experiments.register(u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT,hi),this.experiments.get(u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT).tryStart({isUpsellEnabled:this.checkoutConfiguration.campaign.config.showUpsell})}initializeQuarterlyUpsellExperiment(){var e;this.experiments.register(u.QUARTERLY_UPSELL_MODAL_EXPERIMENT,Rr);const t=this.experiments.get(u.QUARTERLY_UPSELL_MODAL_EXPERIMENT),n=t.tryStart({hasQuarterlyPlan:this.checkoutConfiguration.company.recurringPlans.quarterly,hasMonthlyFrequency:null===(e=this.checkoutConfiguration.campaign.config.frequencies.monthly)||void 0===e?void 0:e.enabled}),i=t.isTestGroup();n&&i&&this.checkoutConfiguration.mergePreDonationUpsellSettings({enabledTargetFrequencies:[...this.checkoutConfiguration.preDonationUpsellSettings.enabledTargetFrequencies,qn.QUARTERLY]})}}var Cl=n(5723),bl=n(8997);class Pl extends Error{constructor(){super("Checkout render aborted")}}var Nl=n(2753);const Dl=(0,kr.createContext)(null),Tl=e=>{let{children:t}=e;const n=(0,kr.useRef)(null),i=(0,kr.useRef)(null),s=(0,kr.useCallback)((e=>{n.current=e}),[]),a=(0,kr.useCallback)((()=>{i.current&&(clearTimeout(i.current),i.current=null),i.current=setTimeout((()=>{n.current&&(n.current.focus(),n.current=null),i.current=null}),100)}),[]);(0,kr.useEffect)((()=>()=>{i.current&&(clearTimeout(i.current),i.current=null)}),[]);const o={saveTriggerElement:s,returnFocusToTrigger:a};return(0,Cl.jsx)(Dl.Provider,{value:o,children:t})},kl=()=>{const e=(0,kr.useContext)(Dl);if(!e)throw new Error("useFocusReturn must be used within FocusReturnProvider");return e};var Il=n(7376);const _l=(0,kr.createContext)(null);function Ol(){const e=(0,kr.useContext)(_l);if(!e)throw new Error("SentryService is not provided");return e}class xl extends kr.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){if(!this.context)throw new Error("SentryService is not provided");this.context.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.UI_CRITICAL),e.setExtras({componentStack:t.componentStack}),e)))}render(){return this.state.hasError?(0,Cl.jsx)("h1",{children:this.props.fallback||"something went wrong"}):this.props.children}}var wl,Rl;xl.contextType=_l,function(e){e.COMMENT="comment",e.MAILING_ADDRESS="mailing-address",e.PRIVACY="privacy",e.THANK_YOU="thank-you",e.REMIND_ME="remind-me",e.QUESTIONS="questions",e.MANDATORY_QUESTIONS="mandatory-questions",e.BLOCKED="blocked"}(wl||(wl={})),function(e){e.CLICK_SHOWCASE="click-showcase"}(Rl||(Rl={}));var Ml=n(851),Ll=n(2994),Fl=n(2598);const Ul=(0,kr.createContext)({checkoutWrapperRef:void 0}),jl=()=>(0,kr.useContext)(Ul).checkoutWrapperRef;var Bl=n(5493);const Gl=(0,kr.createContext)(null);var ql=n(8548),Vl=n(8693);const Hl=Bn;function Kl(){const e=(0,Bl.P)(),t=(0,kr.useCallback)((t=>`${t} ${t}-${e?"mobile":"desktop"}`),[e]);return(0,kr.useCallback)((e=>e.split(" ").map(t).join(" ")),[t])}const Yl=["button","input","select","textarea","iframe","object","embed","a","[tabindex]","[href]","[contenteditable]"].join(", "),zl=e=>(0,kr.useCallback)((t=>{try{t(e)}catch(e){if(e instanceof Error&&"SecurityError"===e.name)return;throw e}}),[e]);var Wl,$l,Xl,Ql,Zl=n(322);function Jl(e,t){if(!e.current)throw new Error("Ref was not passed");e.current.addEventListener("transitionend",(function n(){e.current&&(e.current.removeEventListener("transitionend",n),t())}),!1)}function ec(e){return(0,kr.useCallback)((t=>{Jl(e,t)}),[e])}!function(e){e.DONOR_NAME="DonorName",e.DONOR_EMAIL="DonorEmail",e.MAILING_ADDRESS="MailingAddress",e.TRIBUTE="Tribute",e.DESIGNATION="Designation",e.DESIGNATIONS="Designations",e.QUESTIONS="Questions",e.PHONE_NUMBER="PhoneNumber",e.TERMS_AND_CONDITIONS="TermsAndConditions",e.REMIND_ME_LATER="RemindMeLater",e.ON_BEHALF_OF="OnBehalfOf",e.DONATE_ANONYMOUS="DonateAnonymous",e.CUSTOMER_TITLE="CustomerTitle",e.COMMENT="Comment",e.COMMUNICATION_CONSENT="CommunicationConsent",e.PROCESS="Process"}(Wl||(Wl={})),function(e){e.SHARING="Sharing",e.TRIBUTE="Tribute",e.DEFAULT="Default"}($l||($l={})),function(e){e.PENDING="pending",e.SUCCESS="success",e.ERROR="error",e.IDLE="idle"}(Xl||(Xl={})),function(e){e.FUNDRAISER="fundraiser",e.CAUSE="cause"}(Ql||(Ql={}));var tc=n(936),nc=n(7804);const ic=e=>{let{imageRef:t,className:n,children:i,ariaLabel:s}=e;const[a,o]=(0,kr.useState)(!0);return(0,kr.useLayoutEffect)((()=>{if(!t.current)return;function e(){o(!1)}const n=t.current;return n.addEventListener("load",e),()=>{n.removeEventListener("load",e)}}),[t]),(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-rel overflow-hidden",n),children:[a&&(0,Cl.jsx)("div",{className:"skeleton-media p-abs inset-0 bg-gray-10","aria-label":s,role:"status","aria-live":"polite"}),i]})},sc=e=>{let{imageUrl:t,imageAlt:n}=e;const i=(0,nc.t)(),s=(0,Bl.P)(),a=Kl(),o=(0,kr.useRef)(null);return(0,Cl.jsx)(ic,{imageRef:o,className:(0,Ml.A)({"border-top-radius-16":!s}),ariaLabel:i.translate("common.loading"),children:(0,Cl.jsx)("img",{className:(0,Ml.A)(a("campaign-image"),"d-block w-100"),ref:o,src:t,alt:n||i.translate("campaign.imageAlt"),width:516,height:289,"data-qa":"ask-image","data-testid":"campaign-preview"})})},ac=(0,kr.memo)(sc),oc=(0,kr.lazy)((()=>n.e(821).then(n.bind(n,3821)))),rc=e=>{let{askPageConfig:t,fundraisingPage:n,showCauseTab:i,tracker:s}=e;var a,o,r;const l=(0,nc.t)(),c=Kl(),u=(0,Il.M)(),[d,h]=(0,kr.useState)(!1),m=(0,kr.useCallback)((()=>{var e,n;h(!0),s&&(null===(e=t.mainVideo)||void 0===e?void 0:e.videoId)&&(null===(n=t.mainVideo)||void 0===n?void 0:n.provider)&&s.trackCheckoutCustomEvent({type:tc.f.ASK_VIDEO_SHOW_IMAGE_AS_FALLBACK,data:{videoId:t.mainVideo.videoId,videoProvider:t.mainVideo.provider}})}),[h,s,null===(a=t.mainVideo)||void 0===a?void 0:a.videoId,null===(o=t.mainVideo)||void 0===o?void 0:o.provider]),p=(null===(r=null==n?void 0:n.image)||void 0===r?void 0:r.alt)||"",g=t.fundraiserImage?t.fundraiserImage:t.mainImage,y=t.fundraiserImage?p:t.mainImageAltText,f=!g||i,v=f?t.mainImage:g,S=f?t.mainImageAltText:y,E=t.mainMediaProvider===sa.VIDEO&&!d,A=!E&&!!v;return(0,Cl.jsxs)(Cl.Fragment,{children:[E&&t.mainVideo&&(0,Cl.jsx)("div",{className:(0,Ml.A)(c("campaign-video"),"p-rel d-block w-100 bg-gray-10 overflow-hidden"),"data-qa":"campaign-video",children:(0,Cl.jsx)(kr.Suspense,{fallback:(0,Cl.jsx)("div",{className:"skeleton-media p-abs inset-0","aria-label":l.translate("common.loading")}),children:(0,Cl.jsx)(oc,{className:"p-abs inset-0 w-100 h-100",mainVideo:t.mainVideo,locale:l.locale,tracker:s,width:516,height:289,onInitError:m,onVideoBreakingError:m,targetWindow:u})})}),A&&v&&(0,Cl.jsx)(ac,{imageUrl:v,imageAlt:S})]})},lc=(0,kr.memo)(rc),cc=e=>{let{tab:t,setActiveTab:n}=e;const i=(0,nc.t)(),s=Kl();return(0,Cl.jsx)("div",{className:(0,Ml.A)(s("campaign-tabs-holder"),"p-abs inset-bottom-start inset-bottom-end d-flex pt-1 overflow-hidden z-index-1"),role:"tablist",children:(0,Cl.jsxs)("div",{className:"d-flex bg-gray-15 border-top-radius-8",children:[(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(s("campaign-tab"),"body-40-medium d-block border-0",t===Ql.FUNDRAISER?"is-active p-rel text-gray-100 bg-white pointer-events-none":"text-gray-80-hover-gray-100 bg-transparent"),role:"tab","aria-selected":t===Ql.FUNDRAISER,"data-qa":"fundraiser-component-button","data-tracking-element-name":"switchToFundraisingPageTab",onClick:()=>n(Ql.FUNDRAISER),children:(0,Cl.jsx)("span",{className:"text-truncate",children:i.translate("campaign.campaignTabs.fundraiser")})}),(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(s("campaign-tab"),"body-40-medium d-block border-0",t===Ql.CAUSE?"is-active p-rel text-gray-100 bg-white pointer-events-none":"text-gray-80-hover-gray-100 bg-transparent"),role:"tab","aria-selected":t===Ql.CAUSE,"data-qa":"ask-component-button","data-tracking-element-name":"switchToAskPageTab",onClick:()=>n(Ql.CAUSE),children:(0,Cl.jsx)("span",{className:"text-truncate",children:i.translate("campaign.campaignTabs.cause")})})]})})},uc=(0,kr.memo)(cc),dc=e=>{let{links:t,className:n}=e;const i=(0,Bl.P)(),s=Kl(),a=(0,nc.t)();return(0,Cl.jsx)("div",{className:(0,Ml.A)({"campaign-links-wrap":!i},n),children:(0,Cl.jsx)("div",{className:(0,Ml.A)(s("campaign-links"),"max-w-100 text-start",i?"body-40-regular":"body-20-regular"),children:t.map(((e,t)=>(0,Cl.jsxs)(kr.Fragment,{children:[!!t&&!i&&(0,Cl.jsx)("span",{className:"text-gray-60 mx-1-5","aria-hidden":!0,children:""}),(0,Cl.jsx)("a",{href:e.url,className:(0,Ml.A)(s("campaign-link"),"text-gray-60-hover-gray-80",{"max-w-100 py-1 text-ellipsis":i}),target:"_blank",rel:"noreferrer","data-tracking-element-name":"askPageLink","data-qa":"ask-link","aria-label":a.translate("common.externalLinkAriaLabel",{label:e.label}),children:e.label})]},t)))})})};var hc=(0,kr.memo)(dc);const mc=e=>{let{title:t,description:n,links:i,hideTitle:s,showText:a}=e;const o=(0,Bl.P)(),r=Kl(),l=!!i.length;return(0,Cl.jsxs)(Cl.Fragment,{children:[(t||n)&&(0,Cl.jsxs)("div",{className:"min-h-0","data-qa":"ask-component",children:[!s&&t&&(0,Cl.jsx)("h2",{className:(0,Ml.A)(r("campaign-title"),"title-50-semibold text-ellipsis text-noselect"),"data-qa":"ask-title",dangerouslySetInnerHTML:{__html:t},dir:"auto"}),a&&n&&(0,Cl.jsx)("p",{"data-qa":"ask-message",className:(0,Ml.A)(r("campaign-text"),"p-rel text-start overflow-hidden",{"mt-0":!t,"campaign-text-sm":l&&t,"campaign-text-md":l&&!t||!l&&t,"campaign-text-lg":!l&&!t}),dangerouslySetInnerHTML:{__html:n},dir:"auto"})]}),!o&&l&&(0,Cl.jsx)(hc,{links:i,className:"shrink-0"})]})};class pc{static calculateProgressData(e){const t=pc.round(e.currentAmount/e.targetAmount),n=e.increaseAmount?pc.round(e.increaseAmount/e.targetAmount):0,i=e.increaseAmount?pc.applyMinIncreasePercent(n):0,s=e.unlimitedProgress?t:pc.limitMaxPercent(t),a=e.unlimitedProgress?i:Math.min(i,pc.MAX_PROGRESS-s),o=t+n,r=e.currentAmount+(e.increaseAmount||0);return{progressPercent:s,progressIncreasePercent:a,totalProgressPercent:e.unlimitedProgress?o:Math.min(o,pc.MAX_PROGRESS),totalAmount:r,isDone:o>=pc.MAX_PROGRESS}}static round(e){return Math.round(1e3*e)/10}static limitMaxPercent(e){return Math.min(e,pc.MAX_PROGRESS)}static applyMinIncreasePercent(e){return Math.max(e,pc.MIN_INCREASE_PERCENT)}}pc.MAX_PROGRESS=100,pc.MIN_INCREASE_PERCENT=4;var gc=n(2455);const yc=e=>{let{as:t,id:n,className:i,style:s,token:a,params:o,role:r,dataQa:l,dataTestId:c}=e;const u=(0,nc.t)();Bn()&&!/<\/?[a-z][\s\S]*>/i.test(u.translate(a))&&console.warn('Use "intl.translate" for translations without HTML');const d=null!=t?t:"span";return(0,Cl.jsx)(d,{id:n,className:i,style:s,dangerouslySetInnerHTML:{__html:u.safeTranslate(a,o)},role:r,"data-qa":l,"data-testid":c})},fc=(0,kr.memo)(yc),vc=e=>{let{fundraiser:t,userAmount:n,isActualProgressShown:i}=e;const s=(0,nc.t)(),a=(0,gc.Q)(),o=(0,Vl.C)(),r=t.goalAmount||1,l=pc.calculateProgressData({currentAmount:t.donationsAmount||0,targetAmount:r,increaseAmount:n}),[c,u]=(0,kr.useState)(l.progressPercent);(0,kr.useEffect)((()=>{i&&u(l.totalProgressPercent)}),[l.totalProgressPercent,i]);const d=!!n,h=l.progressPercent>=100,m=l.isDone&&(i||h),p=o&&d?l.progressIncreasePercent:null,g=function(e,t,n){return(t?100-t-e:100)*(n?1:-1)}(l.progressPercent,p,a),y={translate:`${g}% 0 0`},f={width:`${c}%`,borderInlineEnd:c>0&&c<100?"1px solid #fff":void 0},v=i?l.totalAmount:t.donationsAmount,S=(0,kr.useMemo)((()=>s.formatAmount({amount:v||0,currency:t.currency||"USD",currencyFormat:Yt.SHORT,numberFormat:Kt.STANDARD,forceExplicit:!0})),[s,v,t.currency]),E=(0,kr.useMemo)((()=>s.formatAmount({amount:t.goalAmount||0,currency:t.currency||"USD",currencyFormat:Yt.SHORT,numberFormat:Kt.STANDARD,forceExplicit:!0})),[s,t.goalAmount,t.currency]);return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(fc,{as:"p",className:"compact-50-regular text-ellipsis",token:"campaign.campaignMeter.raisedAmountOfGoal",params:{amount:S,goal:E},dataQa:"fundraiser-goal-raised-amount",dataTestId:"raised-amount"}),(0,Cl.jsxs)("div",{className:"campaign-meter p-rel bg-blue-10 border-radius-2 overflow-hidden mt-2-5","data-qa":"fundraiser-goal-progress-bar",children:[(0,Cl.jsx)("div",{className:(0,Ml.A)("campaign-meter-progress-increase p-abs inset-top-start inset-bottom-start w-100 z-index-1",{"bg-green-80":m}),style:y,"data-testid":"progress-increase"}),(0,Cl.jsx)("div",{className:(0,Ml.A)("campaign-meter-progress p-abs inset-top-start inset-bottom-start bg-blue-60 z-index-2",{"campaign-meter-hidden":!o,"campaign-meter-done":m}),style:f,"data-testid":"progress","data-qa":"fundraiser-goal-progress-bar-progress"})]})]})},Sc=(0,kr.memo)(vc);var Ec=n(5284);const Ac={4:4,6:6,8:8,12:12,16:14,18:16,20:18,24:20,28:24,32:26,36:28,40:32,48:36,56:40,64:48,80:56},Cc=({className:e,size:t,sizeMin:n,isBreakpoint:i,notAdaptive:s})=>{const[a,o]=(0,kr.useState)(t);(0,kr.useEffect)((()=>{o(i&&!s?Ac[t]:t)}),[t,i,s]);const r=Object.assign({width:`${a}px`,height:`${a}px`},n&&{lineHeight:`${n}px`});return(0,Cl.jsx)("div",{className:(0,Ec.A)("opacity-0",e),style:r,"aria-hidden":"true","data-testid":"spacer-base",children:""})},bc=e=>{const{className:t,size:n,sizeMin:i}=e;return(0,Cl.jsx)(Cc,{className:t,size:n,sizeMin:i})};var Pc=n(1220);const Nc=(0,kr.createContext)(null);function Dc(){const e=(0,kr.useContext)(Nc);if(!e)throw new Error("FlowManager is not provided");return e}function Tc(e){const t=function(e){const t=Dc(),[n,i]=(0,kr.useState)((()=>t.getCurrentFlow().getScreen(e))),s=(0,Pc.a)();return(0,kr.useEffect)((()=>{let n=t.getCurrentFlow();const a=t.onScreenChanged((()=>{s.current&&i(n.getScreen(e))})),o=t.onFlowChanged((()=>{const i=t.getCurrentFlow();i.checkHasScreen(e)&&(n=i)}));return()=>{o(),a()}}),[t,e,s]),n}(e);return{controller:t,state:function(e){const[t,n]=(0,kr.useState)((()=>e.getScreenData()));return(0,kr.useEffect)((()=>{const t=()=>n(e.getScreenData());return t(),e.onUpdate(t),()=>e.removeUpdateListener(t)}),[e]),t}(t)}}function kc(){const e=Dc(),[t,n]=(0,kr.useState)((()=>e.getCurrentFlow().getCurrentScreen().name));return(0,kr.useEffect)((()=>e.onScreenChanged((()=>{n(e.getCurrentFlow().getCurrentScreen().name)}))),[e]),t}const Ic=e=>{let{fundraiser:t,userAmount:n,links:i,showAskLinks:s}=e;const{withoutGoal:a}=t,o=(0,Bl.P)(),r=Kl(),l=kc(),[c,u]=(0,kr.useState)(!1),d=!!i.length&&s;return(0,kr.useEffect)((()=>{l===wl.THANK_YOU&&u(!0)}),[l]),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("div",{className:"min-h-0","data-qa":"fundraiser-component",children:[(0,Cl.jsx)("h2",{className:(0,Ml.A)(r("campaign-title"),"title-50-semibold text-ellipsis text-noselect"),dir:"auto","data-qa":"fundraiser-display-name",children:t.name}),(0,Cl.jsx)("p",{className:(0,Ml.A)(r("campaign-text"),{"campaign-text-xs":d&&!a,"campaign-text-sm":d&&a||!d&&!a,"campaign-text-md":!d&&a}),dir:"auto","data-qa":"fundraiser-message",children:t.message})]}),(!a||!o&&d)&&(0,Cl.jsx)(bc,{size:16,className:"mt-auto"}),!a&&(0,Cl.jsx)(Sc,{isActualProgressShown:c,fundraiser:t,userAmount:n}),!o&&d&&(0,Cl.jsx)(hc,{links:i,className:(0,Ml.A)("shrink-0",{"mt-4":!a})})]})},_c=(0,kr.createContext)(!1),Oc=(0,kr.createContext)(null);function xc(){const e=(0,kr.useContext)(Oc);if(!e)throw new Error("currency service is not provided");return e}const wc=(0,kr.createContext)(null);function Rc(){const e=(0,kr.useContext)(wc);if(!e)throw new Error("Tracker is not provided");return e}function Mc(){const e=Dc(),[t,n]=(0,kr.useState)(e.checkoutService);return(0,kr.useEffect)((()=>e.onFlowChanged((()=>{n(e.checkoutService)}))),[e]),t}function Lc(){const e=Dc(),[t,n]=(0,kr.useState)(e.checkoutState),[,i]=(0,kr.useState)({});return(0,kr.useEffect)((()=>e.onFlowChanged((()=>n(e.checkoutState)))),[e]),(0,kr.useEffect)((()=>t.onStateUpdate((()=>i({})))),[t]),t}const Fc=(0,kr.createContext)(null);function Uc(){const e=(0,kr.useContext)(Fc);if(!e)throw new Error("Experiments is not provided");return e}const jc=()=>{const e=Uc(),t=Dc(),n=(0,Zl.$)(),i=kc(),s=(0,Nl.n)(),a=(0,Bl.P)(),o=e.get(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT);if(!a)return{isTestGroup:o.isTestGroup(),showProgressBar:!1};const r=s.getAskPageConfig().show,l=i===Vn.DONATE,c=i===wl.REMIND_ME,d=i===wl.COMMENT,h=((e,t)=>{const n=e.findIndex((e=>e===Vn.PAYMENT_OPTIONS)),i=t===Vn.PAYMENT_OPTIONS;return-1!==n&&!i})(t.getCurrentFlow().getHistoricalScreens(),i),m=!n&&r&&t.flowType===$n.MONEY&&!l&&!c&&!d&&!h&&o.isTestGroup();return{isTestGroup:o.isTestGroup(),showProgressBar:m}};function Bc(){const e=Mc(),[t,n]=(0,kr.useState)((()=>e.checkoutUIState));return(0,kr.useEffect)((()=>(n((t=>{const n=e.checkoutUIState;return e.checkoutUIState.askPageActiveTab=t.askPageActiveTab,n})),e.onStateUpdate((()=>{n(e.checkoutUIState)})))),[e]),t}const Gc=e=>window.matchMedia(`(min-width: ${e}px)`),qc={sm:536,lg:916};function Vc(e){return function(e){const t=(0,kr.useRef)(Gc(e)),[n,i]=(0,kr.useState)(Gc(e).matches);return(0,kr.useEffect)((()=>{const e=t.current,n=e=>{i(e.matches)};return e.addListener(n),()=>e.removeListener(n)}),[]),n}(qc[e])}const Hc=window.devicePixelRatio>1,Kc=()=>{const e=Kl(),t=xc(),n=Mc(),i=Bc(),s=kc(),a=Lc(),o=(0,Nl.n)(),r=Rc(),l=a.donation.dataPoint,c=(0,kr.useCallback)((e=>{i.askPageActiveTab=e,n.syncUpdateCheckoutState()}),[n,i]),u=(0,kr.useMemo)((()=>o.getAskPageConfig(Hc)),[o]),d=(0,Bl.P)(),h=Vc("lg"),{isTestGroup:m}=jc(),p=o.fundraisingPage,g=!!d&&i.isMobileScreenWithoutAskTitle(s)&&!m,y=!d||i.isMobileScreenWithAskText(s),f=y||!g,v=!g&&u.title||y&&u.text,S=!p||i.askPageActiveTab===Ql.CAUSE,E=p&&i.askPageActiveTab===Ql.FUNDRAISER;(0,kr.useEffect)((()=>{p&&u.show&&c(Ql.FUNDRAISER)}),[u.show,p,c]);const A=(0,kr.useMemo)((()=>p&&p.currency?t.convert(l.amount||0,l.currency,p.currency):0),[l.amount,l.currency,t,p]),C=(0,kr.useRef)(null),b=(0,kr.useRef)(null);!function(e,t){const n=(0,Il.M)(),i=(0,Bl.P)(),s=(0,kr.useContext)(_c),a=(0,kr.useCallback)((()=>{if(!i||s)return;const t=e.current;if(!t)throw new Error("scrollRef was not passed");const a=window.pageYOffset||n.pageYOffset;t.offsetTop>a||t.scrollIntoView(!0)}),[e,n,i,s]);(0,kr.useEffect)(a,[t,a])}(f?C:b,s);const[P,N]=(0,kr.useState)(!0),[D,T]=(0,kr.useState)(!1),k=(0,kr.useRef)(null);(0,kr.useEffect)((()=>{N(i.isScreenWithoutAskOverlay(s))}),[s,N,i]);const I=ec(k);return(0,Cl.jsxs)("div",{className:(0,Ml.A)(e("campaign"),"d-flex flex-column bg-white",{"p-rel":!P&&!d}),onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),ref:b,"data-qa":"campaign-info-section",children:[f&&(0,Cl.jsxs)("div",{className:(0,Ml.A)(e("campaign-image-holder"),"p-rel"),children:[(0,Cl.jsx)(lc,{askPageConfig:u,fundraisingPage:p,showCauseTab:S,tracker:r}),u.showTabs&&(0,Cl.jsx)(uc,{tab:i.askPageActiveTab,setActiveTab:c})]}),(0,Cl.jsx)("div",{className:(0,Ml.A)(e("campaign-header"),"d-flex items-center w-100 shrink-0"),"data-qa":"ask-company-name",children:u.logoImage?(0,Cl.jsx)("img",{src:u.logoImage,alt:u.logoAltText||u.companyName,className:(0,Ml.A)(e("campaign-header-logo"),"d-block max-w-100"),"data-testid":"campaign-logo"}):(0,Cl.jsx)("p",{className:(0,Ml.A)(e("campaign-header-name"),"title-30-medium text-ellipsis"),dir:"auto",title:u.companyName,"data-testid":"campaign-name",children:u.companyName})}),f&&(0,Cl.jsxs)("div",{ref:C,className:(0,Ml.A)(e("campaign-body"),"w-100 min-h-0 order-2",{"px-5 py-6":d&&(v||i.askPageActiveTab===Ql.FUNDRAISER)}),role:p?"tabpanel":"",children:[S&&(0,Cl.jsx)(mc,{title:u.title,description:u.text,links:u.links,hideTitle:g,showText:y}),E&&(0,Cl.jsx)(Ic,{fundraiser:p,userAmount:A,links:u.links,showAskLinks:!u.showTabs})]}),(0,Cl.jsx)(Ll.A,{classNames:"rtg-fade",nodeRef:k,in:!P&&!D&&!d&&h,addEndListener:I,mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)("div",{ref:k,className:"p-abs inset-0 bg-black opacity-30 border-radius-16 z-index-1"})})]})},Yc=[sn.UNITED_STATES,sn.CANADA,sn.MEXICO,sn.AUSTRALIA];var zc;function Wc(){return Wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Wc.apply(null,arguments)}var $c=function(e,t){return kr.createElement("svg",Wc({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),zc||(zc=kr.createElement("path",{d:"m9 18 6-6-6-6",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},Xc=(0,kr.forwardRef)($c),Qc=(0,kr.memo)(Xc),Zc=n(8809),Jc=n(1146);const eu=e=>{let{title:t,children:n,dataQa:i}=e;const s=(0,Bl.P)(),a=(0,gc.Q)(),o=Kl(),[r,l]=(0,kr.useState)(!1),c=(0,kr.useRef)(null),u=(0,kr.useRef)(null),d=(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("p",{className:"body-40-semibold",children:t}),(0,Cl.jsx)("div",{className:"body-40-regular mt-1",children:n})]});return(0,Jc.Q)(c,{shouldScroll:r&&s}),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Zc.S,{content:!s&&d,trigger:"click",placement:"top",maxWidth:"300px",hasPortal:!1,"data-qa":`${i}-popover`,children:(0,Cl.jsxs)("button",{ref:u,type:"button",className:(0,Ml.A)("btn-link text-nodecor",o("faq-link"),{"font-weight-600":r&&s}),"data-qa":i,"data-testid":i,"data-tracking-element-name":`faq-${i}`,onClick:()=>l(!r),children:[s&&(0,Cl.jsx)("span",{className:"icon-slot icon-slot-14 font-size-14 me-0-5 shrink-0","aria-hidden":!0,children:(0,Cl.jsx)(Qc,{className:(0,Ml.A)("icon p-abs inset-centered faq-link-icon",{"icon-rotate-90":!a&&r,"icon-rotate-180":a&&!r,"icon-rotate-270":a&&r})})}),(0,Cl.jsx)("span",{className:"grow-1 text-ellipsis",children:t})]})}),s&&(0,Cl.jsx)(Ll.A,{nodeRef:c,in:r,timeout:200,classNames:"rtg-fade",mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)("div",{ref:c,className:"body-40-regular py-2 ps-4 shrink-0","data-qa":`${i}-popover`,children:n})})]})},tu=(0,kr.memo)(eu);var nu,iu,su=n(8480);!function(e){e.CHECKOUT="checkout",e.CAMPAIGN_PAGE="campaignPage",e.DONOR="donor",e.EMAIL="email",e.UPGRADE_PAGE="upgradePage",e.UPGRADE_TO_RECURRING="upgradeToRecurring"}(nu||(nu={})),function(e){e.TECHNICAL_ISSUE="technical_issue",e.PAYMENT_ISSUE="payment_issue",e.UX_ISSUE="ux_issue",e.REFUND_OR_CHARGEBACK="refund_or_chargeback",e.DONATION_CHANGE="donation_change",e.PAYMENT_METHOD_REQUEST="payment_method_request",e.FEE_QUESTION="fee_question",e.MISSION_QUESTION="mission_question",e.PRAISE="praise",e.ORG_COMPLAINT="org_complaint",e.ABUSE_HATE="abuse_hate",e.OTHER="other"}(iu||(iu={}));const au=e=>{let{errorTitle:t,errorMessage:n,dataQa:i,dataTestId:s,dataTrackingElementName:a,onMessageClick:o}=e;return(0,Cl.jsxs)(Cl.Fragment,{children:[t&&(0,Cl.jsx)("p",{className:"body-40-semibold text-red-80 text-ellipsis","data-qa":i+"-error-title","data-testid":s+"-error-title",dangerouslySetInnerHTML:{__html:t}}),n&&(0,Cl.jsx)("p",{className:(0,Ml.A)("text-ellipsis",t?"body-40-regular text-gray-100 mt-1":"body-40-semibold text-red-80"),"data-qa":i+"-error-message","data-testid":s+"-error-message",dangerouslySetInnerHTML:{__html:n},"data-tracking-element-name":a,onClick:o})]})},ou=(0,kr.memo)(au);var ru,lu,cu=n(5275);!function(e){e.UNABLE_TO_PROCESS="unableToProcessYourRequest",e.EMPTY_FORM="emptyForm"}(ru||(ru={})),function(e){e.TOOLTIP="tooltip",e.ACCORDION="accordion"}(lu||(lu={}));const uu={minHeight:"248px"},du={minWidth:"72px"},hu=e=>{let{formType:t,handleFormClose:n}=e;const i=(0,nc.t)(),s=t===lu.TOOLTIP;return(0,Cl.jsxs)("div",{className:s?"d-flex grow-1 flex-column items-center justify-center py-1":"ps-4 py-2",style:s?uu:void 0,children:[s&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)("img",{className:"d-block mx-auto",src:cu,width:32,height:32,alt:"","aria-hidden":!0})]}),s&&(0,Cl.jsx)(bc,{size:12}),(0,Cl.jsxs)("h5",{className:(0,Ml.A)("text-ellipsis",s?"body-40-semibold":"body-40-regular",{"text-center":s}),children:[i.translate("feedback.success.title"),!s&&(0,Cl.jsxs)("span",{className:"text-nowrap",children:["",(0,Cl.jsx)("span",{className:"icon-slot icon-slot-12 d-inline-block font-size-12","aria-hidden":!0,children:(0,Cl.jsx)("img",{className:"p-abs inset-centered",src:cu,width:12,height:12,alt:""})})]})]}),(0,Cl.jsx)(bc,{size:4}),(0,Cl.jsx)("p",{className:(0,Ml.A)("body-40-regular text-ellipsis",{"text-center":s}),children:i.translate("feedback.success.description")}),s&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn btn-default w-auto",{"btn-xs":s}),style:du,"data-qa":"feedback-form-success-close","data-testid":"feedback-form-success-close","data-tracking-element-name":"feedback-close-button",onClick:n,children:i.translate("feedback.button.close")})]})]})},mu=(0,kr.memo)(hu);var pu;!function(e){e.DANGER="danger"}(pu||(pu={}));const gu=e=>{let{children:t,setRef:n,className:i,type:s,role:a,dataQa:o,dataTestId:r}=e;const l={[pu.DANGER]:"bg-red-20 border-red-40"}[s];return(0,Cl.jsx)("div",{ref:n,className:(0,Ml.A)("p-3 border border-radius-5",l,i),role:null!=a?a:"alert","data-qa":o,"data-testid":r,children:t})},yu=(0,kr.memo)(gu);var fu=n(1432);const vu={minWidth:"90px"},Su=e=>{let{message:t,formType:n,errorType:i,isSuccess:s,onChange:a,onSubmit:o,onFormClose:r,trackFormInputStartedEvent:l,isPending:c}=e;const u=(0,nc.t)(),d=(0,kr.useId)(),h=Vc("sm"),m=(0,kr.useRef)(null),p=(0,kr.useRef)(null),g=(0,kr.useRef)(null),y=i===ru.UNABLE_TO_PROCESS,f=i===ru.EMPTY_FORM,v=n===lu.TOOLTIP,[S,E]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{f&&p.current&&p.current.focus()}),[f]),(0,Jc.Q)(g,{shouldScroll:!v}),(0,Cl.jsx)(Cl.Fragment,{children:s?(0,Cl.jsx)(mu,{formType:n,handleFormClose:r}):(0,Cl.jsxs)("form",{className:v?h?"py-1":"px-2 py-3":"ps-4 py-2","data-testid":"feedback-form","data-qa":"feedback-form-block",onSubmit:o,ref:g,children:[v&&(0,Cl.jsx)("h5",{className:"body-40-semibold text-ellipsis",children:u.translate("feedback.title")}),v&&(0,Cl.jsx)(bc,{size:4}),(0,Cl.jsx)("label",{htmlFor:`feedback-textarea-${d}`,className:"body-40-regular d-block text-ellipsis","data-qa":"feedback-textarea-label",children:u.translate("feedback.description")}),(0,Cl.jsx)(bc,{size:v?8:12}),(0,Cl.jsxs)("div",{className:"p-rel",children:[(0,Cl.jsx)("textarea",{ref:p,id:`feedback-textarea-${d}`,className:(0,Ml.A)("form-control body-40-regular",{"has-error":f}),value:t,maxLength:3e3,rows:5,disabled:c,"aria-required":!0,"aria-describedby":`feedback-textarea-${d}-error`,"data-qa":"feedback-textarea",onFocus:()=>(E(!0),void l()),onBlur:()=>E(!1),onChange:a}),f&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-top-end z-index-5 mt-3 me-4",showTooltip:S,"data-qa":"feedback-error-required",children:(0,Cl.jsx)("p",{id:`feedback-textarea-${d}-error`,children:u.translate("feedback.error.required")})})]}),(0,Cl.jsx)(Ll.A,{nodeRef:m,in:y,timeout:200,classNames:"rtg-fade",mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)(yu,{setRef:m,type:"danger",className:"mt-3",children:(0,Cl.jsx)(ou,{errorTitle:u.translate("feedback.error.unableToProcess.title"),errorMessage:u.translate("feedback.error.unableToProcess.message"),dataQa:"feedback-unable-to-process"})})}),(0,Cl.jsx)(bc,{size:v?12:20}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex gap-3",v?"flex-row-reverse justify-start":"flex-column items-center"),children:[(0,Cl.jsx)("button",{type:"submit",className:(0,Ml.A)("btn btn-primary",{"btn-xs w-auto":v}),style:v?vu:void 0,"data-qa":"feedback-form-send","data-tracking-element-name":"feedback-form-send-button",disabled:c,children:u.translate("feedback.button.send")}),v&&(0,Cl.jsx)("button",{type:"button",className:v?"btn btn-default btn-xs w-auto":"btn-link",style:v?vu:void 0,"data-qa":"feedback-form-cancel","data-tracking-element-name":"feedback-form-cancel-button",disabled:c,onClick:r,children:u.translate("feedback.button.cancel")})]}),v&&(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-top-end font-size-20 text-gray-40-hover-gray-100 me-4 mt-4","aria-label":u.translate("common.closeDialogButtonAriaLabel"),"data-qa":"feedback-form-close-cross","data-testid":"feedback-form-close-cross","data-tracking-element-name":"feedback-form-close-button",disabled:c,onClick:r,children:(0,Cl.jsx)(su.A,{className:"icon-stroke d-block","aria-hidden":!0})})]})})},Eu=(0,kr.memo)(Su),Au=(0,kr.forwardRef)(((e,t)=>{let{isFormOpen:n,onClick:i}=e;const s=(0,nc.t)(),a=(0,gc.Q)(),o=(0,Bl.P)(),r=Kl();return(0,Cl.jsxs)("button",{ref:t,type:"button",className:(0,Ml.A)("btn-link text-nodecor",r("feedback-trigger"),{"font-weight-600":n&&o}),"data-qa":"feedback-button","data-testid":"feedback-button","data-tracking-element-name":"faq-report-problem-link",onClick:i,children:[o&&(0,Cl.jsx)("span",{className:"icon-slot icon-slot-14 font-size-14 me-0-5 shrink-0","aria-hidden":!0,children:(0,Cl.jsx)(Qc,{className:(0,Ml.A)("icon-stroke p-abs inset-centered faq-link-icon",{"icon-rotate-90":!a&&n,"icon-rotate-180":a&&!n,"icon-rotate-270":a&&n})})}),(0,Cl.jsx)("span",{className:"grow-1 text-ellipsis",children:s.translate("feedback.trigger")})]})}));Au.displayName="FeedbackTrigger";const Cu=(0,kr.memo)(Au);function bu(e,t,n){const{document:i}=(0,Il.M)();(0,kr.useEffect)((()=>{const s=n=>{if(!e.current)return;const i=n.target;i&&!ys(i,(t=>t===e.current))&&t(n)};return i.addEventListener("click",s,n),()=>i.removeEventListener("click",s,n)}),[i,e,t,n])}const Pu=()=>{const{isSuccess:e,isFormOpen:t,isPending:n,formType:i,feedbackFormTooltipRef:s,errorType:a,message:o,handleFormClose:r,handleFormOpen:l,handleChange:c,handleSubmit:u,trackFormInputStartedEvent:h}=function(){const e=Rc(),t=(0,Bl.P)(),n=Mc(),i=(0,Il.M)(),s=zl(i),[a,o]=(0,kr.useState)(""),[r,l]=(0,kr.useState)(null),[c,u]=(0,kr.useState)(!1),[h,m]=(0,kr.useState)(!1),[p,g]=(0,kr.useState)(!1),[y,f]=(0,kr.useState)(!1),[v,S]=(0,kr.useState)(!1),E=(0,kr.useRef)(null),A=(0,kr.useRef)(null),C=t?lu.ACCORDION:lu.TOOLTIP,b=C===lu.TOOLTIP?y:p,P=(0,kr.useCallback)((()=>{e.trackCheckoutCustomEvent({type:Ee.FEEDBACK_FORM_OPENED})}),[e]),N=(0,kr.useCallback)((()=>{v||(e.trackCheckoutCustomEvent({type:Ee.FEEDBACK_FORM_INPUT_STARTED}),S(!0))}),[v,e]),D=(0,kr.useCallback)((e=>{o(e.target.value),r&&l(null)}),[r]),T=(0,kr.useCallback)((()=>{l(null),u(!1),S(!1),m(!1)}),[]),k=(0,kr.useCallback)((()=>{f(!0),P()}),[P]),I=(0,kr.useCallback)((()=>{h||(f(!1),T())}),[T,h]),_=(0,kr.useCallback)((e=>{g(!0),P(),A.current=e.currentTarget}),[P]),O=(0,kr.useCallback)((()=>{var e;g(!1),T(),null===(e=A.current)||void 0===e||e.focus(),A.current=null}),[T]),x=(0,kr.useCallback)((e=>{C===lu.TOOLTIP?k():b?O():_(e)}),[C,b,k,O,_]),w=C===lu.TOOLTIP?I:O,R=(0,kr.useCallback)((e=>(0,d.sH)(this,void 0,void 0,(function*(){if(e.preventDefault(),a.trim()){l(null);try{m(!0),(yield n.sendFeedback({message:a}))?(o(""),u(!0)):l(ru.UNABLE_TO_PROCESS)}finally{m(!1)}}else l(ru.EMPTY_FORM)}))),[a,n]);return(0,kr.useEffect)((()=>{if(!b||C!==lu.TOOLTIP)return;const e=e=>{"Escape"===e.key&&(e.stopImmediatePropagation(),w())};return s((t=>t.document.addEventListener("keyup",e,!0))),()=>{s((t=>{var n;return null===(n=t.document)||void 0===n?void 0:n.removeEventListener("keyup",e,!0)}))}}),[b,C,w,s]),bu(E,I,{capture:!0}),{message:a,isSuccess:c,isPending:h,errorType:r,isFormOpen:b,formType:C,feedbackFormTooltipRef:E,trackFormInputStartedEvent:N,handleFormOpen:x,handleFormClose:w,handleChange:D,handleSubmit:R}}(),m=i===lu.TOOLTIP,p=t?(0,Cl.jsx)(Eu,{message:o,formType:i,errorType:a,isSuccess:e,onChange:c,onSubmit:u,onFormClose:r,trackFormInputStartedEvent:h,isPending:n}):null;return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Zc.S,{content:p,contentRef:s,trigger:"manual",manualOpen:t&&m,className:"w-100",placement:"top",maxWidth:"300px",hasPortal:!1,shouldTrapFocusInside:!0,children:(0,Cl.jsx)(Cu,{isFormOpen:t,onClick:l})}),t&&!m&&(0,Cl.jsx)(Cl.Fragment,{children:p})]})};Pu.displayName="Feedback";const Nu=(0,kr.memo)(Pu),Du=e=>{let{showAskPage:t}=e;const n=(0,nc.t)(),i=(0,Bl.P)(),s=Vc("lg"),a=Kl(),o=Mc(),r=(0,Nl.n)(),l=r.campaign.config.frequencies,c=r.company,u=(0,kr.useMemo)((()=>o.type===$n.MONEY),[o]),d=(0,kr.useMemo)((()=>o.type===$n.CRYPTO),[o.type]),h=(m=c.country,p=c.nonProfit,Yc.includes(m)&&p);var m,p;const g=u&&!Gs.isOnetimeOnly(l)&&c.donorPortal.canCancelSubscription,y=r.featureConfig.donorFeedbackForm&&Bn();return(0,Cl.jsxs)("ul",{className:(0,Ml.A)(a("faq-links"),"d-flex gap-y-2"),children:[(0,Cl.jsx)("li",{className:(0,Ml.A)("d-flex",{"flex-column text-start":i}),children:(0,Cl.jsxs)(tu,{title:n.translate("faq.isDonationSecure.title"),dataQa:"is-donation-secure",children:[(0,Cl.jsxs)("p",{className:"text-ellipsis",children:[u&&n.translate("faq.isDonationSecure.message.fiat.part-1"),d&&n.translate("faq.isDonationSecure.message.crypto.part-1")]}),(0,Cl.jsxs)("p",{className:"text-ellipsis mt-1",children:[u&&n.translate("faq.isDonationSecure.message.fiat.part-2"),d&&n.translate("faq.isDonationSecure.message.crypto.part-2")]}),u&&(0,Cl.jsx)("p",{className:"text-ellipsis mt-1",children:n.translate("faq.isDonationSecure.message.fiat.part-3")})]})}),h&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&!i&&s&&(0,Cl.jsx)("li",{className:"body-20-regular text-white opacity-80 shrink-0 mx-3","aria-hidden":!0,children:""}),(0,Cl.jsx)("li",{className:(0,Ml.A)("d-flex",{"flex-column text-start":i}),children:(0,Cl.jsxs)(tu,{title:n.translate("faq.isTaxDeductible.title"),dataQa:"is-tax-deductible",children:[(0,Cl.jsxs)("p",{className:"text-ellipsis",children:[u&&n.translate("faq.isTaxDeductible.message.fiat.part-1"),d&&n.translate("faq.isTaxDeductible.message.crypto.part-1")]}),(0,Cl.jsxs)("p",{className:"text-ellipsis mt-1",children:[u&&n.translate("faq.isTaxDeductible.message.fiat.part-2"),d&&n.translate("faq.isTaxDeductible.message.crypto.part-2")]}),d&&(0,Cl.jsx)("p",{className:"text-ellipsis mt-1",children:n.translate("faq.isTaxDeductible.message.crypto.part-3")})]})})]}),g&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&!i&&s&&(0,Cl.jsx)("li",{className:"body-20-regular text-white opacity-80 shrink-0 mx-3","aria-hidden":!0,children:""}),(0,Cl.jsx)("li",{className:(0,Ml.A)("d-flex",{"flex-column text-start":i}),children:(0,Cl.jsx)(tu,{title:n.translate("faq.cancelRecurringDonation.title"),dataQa:"cancel-recurring-donation",children:(0,Cl.jsx)("p",{className:"text-ellipsis",children:n.translate("faq.cancelRecurringDonation.message")})})})]}),y&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&!i&&s&&(0,Cl.jsx)("li",{className:"body-20-regular text-white opacity-80 shrink-0 mx-3","aria-hidden":!0,children:""}),(0,Cl.jsx)("li",{className:(0,Ml.A)("d-flex",{"flex-column text-start":i}),children:(0,Cl.jsx)(Nu,{})})]})]})},Tu=(0,kr.memo)(Du);var ku,Iu;!function(e){e[e.BACKWARD=1]="BACKWARD",e[e.FORWARD=2]="FORWARD"}(ku||(ku={})),function(e){e.TOP="top",e.LEFT="left",e.FOREGROUND="foreground"}(Iu||(Iu={}));var _u=n(4857);const Ou=e=>{var{className:t,progressBarPercent:n}=e,i=(0,d.Tt)(e,["className","progressBarPercent"]);const s={width:`${n}%`};return(0,Cl.jsx)("div",Object.assign({className:(0,Ml.A)("progress-bar",t)},i,{"data-qa":"progress-bar",children:(0,Cl.jsx)("span",{className:"progress-bar-fill",style:s,"data-qa":"progress-bar-line"})}))},xu=(0,kr.memo)(Ou);var wu;function Ru(){return Ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ru.apply(null,arguments)}var Mu=function(e,t){return kr.createElement("svg",Ru({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),wu||(wu=kr.createElement("path",{d:"M12 20C28.659 10.9628 18.2615 0.617428 12 6.95101C5.73851 0.617357 -4.659 10.9627 12 20Z",fill:"currentColor"})))},Lu=(0,kr.forwardRef)(Mu),Fu=(0,kr.memo)(Lu);const Uu=["bottom"],ju=e=>{let{name:t,className:n}=e;const i=(0,nc.t)(),s=(0,gc.Q)(),a=(0,Bl.P)(),o=(0,ql.wf)(),r=Kl(),l=(0,Nl.n)(),c=l.campaign.config.tribute.showAddress||l.campaign.config.tribute.showEmail;return(0,Cl.jsx)(Zc.S,{content:c&&i.translate("tributeBadge.tooltipLabel"),trigger:a?"click":"hover",placement:s?"left-start":"right-start",fallbackPlacements:Uu,maxWidth:"300px",rootContainer:o,children:(0,Cl.jsxs)("p",{className:(0,Ml.A)(r("tribute-badge"),"d-flex flex-wrap justify-center items-center bg-orange-10 text-center cursor-default",n),"data-qa":"tribute-badge","data-tracking-element-name":"tributeBadge",children:[(0,Cl.jsxs)("span",{className:"compact-50-regular d-flex",children:[(0,Cl.jsx)("span",{className:"icon-slot icon-slot-18 shrink-0 me-1","aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"p-abs inset-centered font-size-18 text-red-60",children:(0,Cl.jsx)(Fu,{className:"icon-fill d-block"})})}),(0,Cl.jsx)("span",{className:"text-truncate me-1",children:i.translate("tributeBadge.label")})]}),(0,Cl.jsx)("span",{className:(0,Ml.A)("body-60-medium",a?"text-ellipsis":"text-truncate"),dir:"auto",children:t})]})})},Bu=(0,kr.memo)(ju),Gu=[wl.THANK_YOU];class qu{constructor(){this.progress=0}calculateProgress(e){const t=e[e.length-1];if(!t)return void(this.progress=0);if(Gu.includes(t))return void(this.progress=100);const n=this.calculateProgressFromStepsCount(e);this.progress=Math.round(n>100?100:n)}getProgress(){return this.progress}calculateProgressFromStepsCount(e){let t=0,n=24;const i=e.length;for(let s=0;s<i;s++){const i=e[s];i!==Vn.DONATE&&(i===wl.PRIVACY&&t<40?(t=40,n*=.76):i===Vn.PAYMENT_OPTIONS&&t<100?(t=100,n=6):(t+=n,n*=.76))}return t}}const Vu=()=>{const e=Dc(),[t]=(0,kr.useState)(new qu),[n,i]=(0,kr.useState)(0),s=(0,Bl.P)(),[a,o]=(0,kr.useState)((()=>e.getCurrentFlow())),r=kc();return(0,kr.useEffect)((()=>{e.onFlowChanged((()=>{o(e.getCurrentFlow())}))}),[e]),(0,kr.useEffect)((()=>{const e=a.getHistoricalScreens();s&&(t.calculateProgress(e),i(t.getProgress()))}),[a,r,t,s]),n};function Hu(e,t,n){return!n.isShowcase&&!e.isScreenWithoutTributeBadge(n.currentScreen)&&t.isEnabled&&t.isActive&&!!t.tributeeName}function Ku(e){const t=(0,Nl.n)(),n=Lc(),i=Bc(),s=n.tribute.dataPoint;return{shouldShowTributeBadge:Hu(i,s,{isShowcase:t.infrastructureParams.showcase,currentScreen:e}),tributeeName:s.tributeeName}}const Yu=e=>{let{children:t,className:n}=e;const i=(0,Bl.P)(),s=(0,Il.M)(),a=Kl(),o=Vu(),{showProgressBar:r}=jc(),l=kc(),{shouldShowTributeBadge:c,tributeeName:u}=Ku(l),d=(0,kr.useRef)(null),[h,m]=(0,kr.useState)(0);(0,kr.useEffect)((()=>{const e=()=>{const e=i&&c&&d.current?d.current.offsetHeight:0;m(e)};return e(),s.addEventListener("resize",e),()=>s.removeEventListener("resize",e)}),[i,c,u,s]);const p={top:`${h}px`};return(0,Cl.jsxs)("div",{className:(0,Ml.A)(a("flow"),n),children:[r&&(0,Cl.jsxs)(Cl.Fragment,{children:[c&&(0,Cl.jsx)("div",{ref:d,className:"invisible p-abs inset-top-start w-100",children:(0,Cl.jsx)(Bu,{name:u})}),(0,Cl.jsx)(xu,{className:"p-abs z-index-3 inset-top-start",style:p,progressBarPercent:o})]}),t]})},zu=(0,kr.forwardRef)((function(e,t){const{children:n,hide:i,className:s}=e,a=Kl();return(0,Cl.jsx)("div",{className:(0,Ml.A)(a("flow-slide"),s,{"flow-slide-hidden":i}),ref:t,children:n})})),Wu=e=>{const{alwaysMount:t,show:n,Screen:i,screenDirection:s,animationDisabled:a,onScreenEntered:o}=e,r=(0,kr.useRef)(null),[l,c]=(0,kr.useState)(!n),u=!n&&l,d=(0,kr.useCallback)((()=>{c(!1)}),[]),h=(0,kr.useCallback)((()=>{o()}),[o]),m=(0,kr.useCallback)((()=>{c(!0)}),[]),p=ec(r);return(0,Cl.jsx)(Ll.A,{in:n,classNames:`rtg-${s}`,addEndListener:p,onEnter:d,onEntered:h,onExited:m,nodeRef:r,mountOnEnter:!t,unmountOnExit:!t,children:e=>(0,Cl.jsx)(zu,{ref:r,hide:u,className:a?"no-animation":"",children:(0,Cl.jsx)(kr.Suspense,{fallback:(0,Cl.jsx)("span",{}),children:(0,Cl.jsx)(i,{transitionEntered:"entered"===e})})})})};var $u,Xu;!function(e){e.CRYPTO_CURRENCY="crypto-currency",e.CRYPTO_WALLET="crypto-wallet"}($u||($u={})),function(e){e.DONATION="CryptoDonation",e.CRYPTO_WALLET="CryptoWallet"}(Xu||(Xu={}));var Qu=n(1819);function Zu(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=(0,kr.useRef)(null),n=Ol(),i=(0,Qu.k)(),s=(0,Zl.$)();return(0,kr.useEffect)((()=>{if(s)return;if(!e||!i)return;if(!t.current)return void n.captureException(new Error("ref is not provided"));const a=window.setTimeout((()=>{var e,n;null===(e=t.current)||void 0===e||e.setAttribute("tabindex","-1"),null===(n=t.current)||void 0===n||n.focus({preventScroll:!0})}),50);return()=>window.clearTimeout(a)}),[e,i,s,n]),t}const Ju=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:(0,Ml.A)(e.className),"aria-hidden":!!e.ariaHidden||void 0,fill:"none",viewBox:"0 0 56 56",height:null!==(t=e.height)&&void 0!==t?t:56,width:null!==(n=e.width)&&void 0!==n?n:56,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","data-qa":"attention-icon",children:[(0,Cl.jsxs)("filter",{id:`a-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"52",width:"43",x:"7",y:"2.5",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:".5",dy:".5"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.958333 0 0 0 0 0.345 0 0 0 0 0 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_8986_17752"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_8986_17752",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("filter",{id:`b-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"32",width:"14.7373",x:"21.1348",y:"11.5",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:".5",dy:".5"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.958333 0 0 0 0 0.345 0 0 0 0 0 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_8986_17752"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_8986_17752",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("linearGradient",{id:`c-${i}`,gradientUnits:"userSpaceOnUse",x1:"16.9167",x2:"54.2937",y1:"13.1351",y2:"54.7877",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffdc62"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ffdc62",stopOpacity:".15"})]}),(0,Cl.jsxs)("linearGradient",{id:`d-${i}`,gradientUnits:"userSpaceOnUse",x1:"23.3333",x2:"36.1947",y1:"26.1546",y2:"31.9633",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffeeb1"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ffeeb1",stopOpacity:"0"})]}),(0,Cl.jsx)("clipPath",{id:`e-${i}`,children:(0,Cl.jsx)("path",{d:"m0 0h56v56h-56z"})}),(0,Cl.jsxs)("g",{clipPath:`url(#e-${i})`,children:[(0,Cl.jsx)("path",{d:"m29.3957.519694c-.9003-.335221-1.8911-.335221-2.7915 0l-20.80207 7.745476c-.78289.2915-1.30213 1.03889-1.30213 1.87433v17.8605c0 17.5 18.4643 28 23.5 28s23.5-10.5 23.5-28v-17.8605c0-.83544-.5192-1.58283-1.3021-1.87433z",fill:"#ffa800"}),(0,Cl.jsxs)("g",{filter:`url(#a-${i})`,children:[(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m10.5 12.6455v15.205c0 6.6656 3.4432 12.2152 7.7738 16.2673 2.1476 2.0096 4.4134 3.549 6.3471 4.566.9661.5081 1.8026.8611 2.4565 1.0783.5577.1851.8514.2276.9186.2373l.004.0006.004-.0006c.0672-.0097.3609-.0522.9186-.2373.6539-.2172 1.4904-.5702 2.4565-1.0783 1.9337-1.017 4.1995-2.5564 6.3471-4.566 4.3306-4.0521 7.7738-9.6017 7.7738-16.2673v-15.205l-17.5-6.6455z",fill:"#ffa800",fillRule:"evenodd"}),(0,Cl.jsx)("path",{d:"m28.7178 49.1452c-.3645.121-.5992.1738-.7178.1961-.1187-.0223-.3533-.0751-.7178-.1961-.6142-.204-1.4178-.5419-2.3587-1.0367-1.8834-.9905-4.1014-2.4964-6.2056-4.4653-4.2479-3.9747-7.5679-9.3643-7.5679-15.7927v-14.7565l16.85-6.39871 16.85 6.39871v14.7565c0 6.4284-3.32 11.818-7.5679 15.7927-2.1042 1.9689-4.3222 3.4748-6.2056 4.4653-.9409.4948-1.7445.8327-2.3587 1.0367z",stroke:`url(#c-${i})`,strokeWidth:"1.3"})]}),(0,Cl.jsxs)("g",{filter:`url(#b-${i})`,children:[(0,Cl.jsx)("path",{d:"m30.3683 15c.6011 0 1.0662.5266.9968 1.1237-.548 4.7133-.8884 9.4483-1.5544 14.1405h-3.5607c-.6658-4.6909-1.0302-9.4239-1.6072-14.1342-.0734-.5992.3925-1.13.9962-1.13zm-4.7016 21.5342c0-.3397.0599-.663.1796-.9698.1307-.3069.3049-.5699.5227-.7891.2287-.2191.4954-.3945.8003-.526s.6316-.1972.98-.1972c.3376 0 .6588.0657.9637.1972s.5662.3069.784.526c.2287.2192.4083.4822.539.7891.1307.3068.196.6301.196.9698 0 .3507-.0653.6795-.196.9863-.1307.2959-.3103.5535-.539.7726-.2178.2192-.4791.3891-.784.5096-.3049.1315-.6261.1973-.9637.1973-.3484 0-.6751-.0658-.98-.1973-.3049-.1205-.5716-.2904-.8003-.5096-.2178-.2191-.392-.4767-.5227-.7726-.1197-.3068-.1796-.6356-.1796-.9863z",fill:"#ffe792"}),(0,Cl.jsx)("path",{d:"m29.631 35.0397h-.0001l.0066.0064c.1902.1822.3416.4025.4535.6652.1105.2595.166.5327.166.8229 0 .302-.0558.5798-.1651.8371-.1112.2511-.2624.4671-.4544.6511l-.0001-.0001-.0064.0065c-.1792.1803-.3961.3225-.6559.4252v-.0002l-.0106.0046c-.2572.1109-.5278.1666-.8152.1666-.2999 0-.5758-.0563-.8314-.1666v-.0002l-.0107-.0042c-.2598-.1027-.4838-.2456-.6754-.4284-.1806-.1826-.3272-.3979-.4391-.649-.0998-.2585-.151-.5383-.151-.8424 0-.2925.051-.5677.1519-.8282.1126-.2626.2592-.4821.4382-.6631.1941-.1853.4218-.3353.6861-.4492.2556-.1103.5315-.1666.8314-.1666.2874 0 .558.0556.8152.1666.2643.1139.4849.2632.6665.446zm.7373-19.6647c.3749 0 .6681.3291.6243.7054-.2146 1.8462-.3967 3.6864-.5783 5.5223-.2741 2.7698-.5471 5.5299-.9297 8.2865h-2.9086c-.3677-2.6452-.6417-5.2899-.9166-7.9435-.2019-1.9478-.4042-3.9003-.6444-5.8613-.0462-.3776.2475-.7094.624-.7094z",stroke:`url(#d-${i})`,strokeWidth:".75"})]})]})]})},ed=(0,kr.memo)(Ju),td=(0,kr.forwardRef)((function(e,t){return(0,Cl.jsx)("div",{ref:t,className:(0,Ml.A)("body",e.className),children:e.children})}));var nd;function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},id.apply(null,arguments)}var sd,ad=function(e,t){return kr.createElement("svg",id({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),nd||(nd=kr.createElement("path",{d:"m19 12h-14m0 0 7 7m-7-7 7-7",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},od=(0,kr.forwardRef)(ad),rd=(0,kr.memo)(od);function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ld.apply(null,arguments)}var cd=function(e,t){return kr.createElement("svg",ld({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),sd||(sd=kr.createElement("path",{d:"m15 18-6-6 6-6",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},ud=(0,kr.forwardRef)(cd),dd=(0,kr.memo)(ud),hd=n(1769);const md=e=>{let{type:t,className:n,disabled:i,isBackFlowDisabled:s,onClick:a}=e;const o=(0,nc.t)(),r=(0,gc.Q)(),l=(0,Bl.P)(),c=(0,ql.wf)(),[u,d]=(0,kr.useState)(!1),h=(0,hd.D)((e=>d(e))),m=(0,kr.useCallback)((()=>{if(s)return h.set([!0]),void h.set([!1],2e3);a()}),[s,h,a]);return(0,Cl.jsx)(Zc.S,{content:o.translate("common.backFlowDisabled"),trigger:"manual",manualOpen:u,placement:l?"bottom":"top",rootContainer:c,"data-qa":"back-checkout-tooltip",children:"header"===t?(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("back-btn btn-icon d-flex items-center justify-center font-size-24 border-radius-4",n,{"visually-disabled":s}),"aria-label":o.translate("common.backButton"),disabled:i,"data-qa":"back-checkout","data-testid":"back.checkout.header","data-tracking-element-name":"backButton",onClick:m,children:(0,Cl.jsx)(dd,{className:(0,Ml.A)("icon-stroke icon-stroke-2 d-block",{"icon-flip-horizontal":r}),"aria-hidden":!0,"data-testid":"back-icon"})}):(0,Cl.jsxs)("button",{type:"button",className:(0,Ml.A)("btn-link body-60-regular d-flex items-center justify-center",n),disabled:i,"data-qa":"back-checkout","data-testid":"back.checkout","data-tracking-element-name":"backButton",onClick:m,children:[(0,Cl.jsx)("span",{className:"icon-slot icon-slot-14 shrink-0 me-1","aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"p-abs inset-centered font-size-14",children:(0,Cl.jsx)(rd,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":r}),"data-testid":"back-icon"})})}),(0,Cl.jsx)("span",{className:"text-truncate",children:o.translate("common.backButton")}),(0,Cl.jsx)("span",{className:"icon-slot icon-slot-14 shrink-0 ms-1"})]})})},pd=(0,kr.memo)(md),gd=e=>{let{children:t,backButtonClass:n,forceShowBackButton:i,isBackFlowDisabled:s,backButtonClickHandler:a,className:o}=e;const r=(0,Bl.P)(),l=Kl(),c=Dc(),[u,d]=(0,kr.useState)((()=>c.getCurrentFlow())),[h,m]=(0,kr.useState)(u.isLocked),[p,g]=(0,kr.useState)((()=>u.canGoBack)),y=(0,_u.Q)();(0,kr.useEffect)((()=>{y&&g(c.getCurrentFlow().canGoBack)}),[c,y]),(0,kr.useEffect)((()=>{const e=u.on(Wa.LOCKED,(()=>{m(!0)})),t=u.on(Wa.UNLOCKED,(()=>{m(!1)}));return()=>{e(),t()}}),[u]),(0,kr.useEffect)((()=>c.onFlowChanged((()=>{d(c.getCurrentFlow())}))),[c]);const f=(0,kr.useCallback)((()=>{p&&u.prev()}),[u,p]),v=r&&(i||p);return(0,Cl.jsx)("div",{className:(0,Ml.A)(l("footer"),"p-rel min-h-0 shrink-0 z-index-3",o),children:(0,Cl.jsxs)("div",{className:"fixed-container p-rel",children:[t,v&&(0,Cl.jsx)("div",{className:(0,Ml.A)("d-flex justify-center",{"mt-6":t}),children:(0,Cl.jsx)(pd,{type:"footer",className:n,disabled:h,isBackFlowDisabled:s,onClick:a||f})})]})})},yd=()=>{const e=(0,nc.t)(),t=(0,Bl.P)(),n=_r(),i=Zu(!0);return(0,Cl.jsxs)("section",{className:"flow-screen",children:[(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body justify-center",t?"pt-8 pb-16":"pt-2"),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)(ed,{className:"d-block mx-auto",ariaHidden:!0}),(0,Cl.jsx)("p",{ref:i,className:"text-center text-ellipsis mt-6","data-qa":"blocked-message-text",children:e.translate("blockedScreen.description")})]})}),!t&&(0,Cl.jsx)(gd,{children:(0,Cl.jsx)("div",{className:"d-flex justify-center",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",onClick:()=>{n.emit(Tr.SHOULD_HIDE,{})},"data-qa":"close","data-tracking-element-name":"closeButton",children:e.translate("blockedScreen.button")})})})]})};var fd;!function(e){e[e.MAX_LENGTH=500]="MAX_LENGTH"}(fd||(fd={}));var vd=n(8983),Sd=n(7352);const Ed=window.devicePixelRatio>1,Ad=e=>{let{id:t,className:n,children:i,forceShowBackButton:s,titleFullWidth:a,title:o,titleTestId:r,titleQa:l,a11yAutoFocus:c=!1,screenTitle:u,isBackFlowDisabled:d,onBackButtonClick:h,backButtonClickHandler:m}=e;const p=(0,Bl.P)(),g=(0,nc.t)(),y=Kl(),f=kc(),{shouldShowTributeBadge:v,tributeeName:S}=Ku(f),E=Dc(),[A,C]=(0,kr.useState)((()=>E.getCurrentFlow())),[b,P]=(0,kr.useState)(A.isLocked),[N,D]=(0,kr.useState)((()=>A.canGoBack)),T=(0,_u.Q)(),k=(0,Nl.n)(),I=k.getAskPageConfig(Ed),_=I.show||!!k.fundraisingPage,O=I.show?I.logoImage:I.fallbackCompanyLogo,x=Zu(c);(0,kr.useEffect)((()=>{T&&D(E.getCurrentFlow().canGoBack)}),[E,T]),(0,kr.useEffect)((()=>{const e=A.on(Wa.LOCKED,(()=>{P(!0)})),t=A.on(Wa.UNLOCKED,(()=>{P(!1)}));return()=>{e(),t()}}),[A]),(0,kr.useEffect)((()=>E.onFlowChanged((()=>{const e=E.getCurrentFlow();C(e)}))),[E]);const w=(0,kr.useCallback)((()=>{N&&(null==h||h(),A.prev())}),[A,N,h]);return(0,Cl.jsxs)(Cl.Fragment,{children:[v&&(0,Cl.jsx)(Bu,{name:S}),(0,Cl.jsxs)("div",{className:(0,Ml.A)(y("header"),"p-rel min-h-0 shrink-0 d-flex",n),"data-qa":"header-block",children:[!p&&!a&&(0,Cl.jsx)("div",{className:"d-flex items-center ps-4 shrink-0",children:(0,Cl.jsx)("div",{className:"icon-slot icon-slot-24 shrink-0",children:(0,Cl.jsx)("div",{className:"p-abs inset-centered",children:(s||N)&&(0,Cl.jsx)(pd,{type:"header",disabled:b,isBackFlowDisabled:d,onClick:m||w})})})}),p&&!_&&(0,Cl.jsx)("div",{className:"header-company d-flex justify-center items-center bg-white border-bottom border-gray-20",children:O?(0,Cl.jsx)("img",{src:O,alt:I.logoAltText||I.companyName,className:"header-company-logo d-block max-w-100 h-auto",height:"32","data-qa":"campaign-logo-image"}):(0,Cl.jsx)("p",{className:"title-30-medium text-ellipsis text-center",title:I.companyName,children:I.companyName})}),(i||o)&&(0,Cl.jsx)("div",{ref:x,id:t,className:(0,Ml.A)(y("header-main"),"grow-1 text-center","focus-not-visible",{"h-auto p-4":!p&&a}),"aria-label":g.translate("common.screenAriaLabel",{screenTitle:o||u||""}),children:o?(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-30-medium",p?"text-ellipsis":"text-line-clamp-2"),"data-testid":r,"data-qa":l,children:o}):i}),!p&&!a&&(0,Cl.jsx)("div",{className:"shrink-0 pe-4",children:(0,Cl.jsx)("div",{className:"icon-slot icon-slot-24"})})]})]})},Cd={minHeight:"200px"},bd=e=>{const{state:t,controller:n}=Tc(wl.COMMENT),i=(0,nc.t)(),s=(0,Bl.P)(),a=(0,kr.useId)(),o=(0,kr.useRef)(null);(0,Sd.f)({ref:o,autoFocus:!0,mode:vd.Q.DESKTOP});const r=(0,kr.useCallback)((e=>{e.preventDefault(),n.submitComment()}),[n]),l=(0,kr.useCallback)((e=>{n.setComment(e.target.value)}),[n]);return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${a}`,"data-testid":"comment-form","data-qa":"active-screen-comment",onSubmit:r,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${a}`,title:i.translate("commentScreen.title"),a11yAutoFocus:s}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-8 pb-10":!s}),children:(0,Cl.jsx)("div",{className:(0,Ml.A)("fixed-container",{"grow-1 d-flex flex-column":!s}),children:(0,Cl.jsxs)("div",{className:(0,Ml.A)({"grow-1 d-flex flex-column":!s}),children:[(0,Cl.jsx)("label",{htmlFor:`comment-${a}`,className:"sr-only","data-qa":"comment-label",children:i.translate("commentScreen.textareaPlaceholder")}),(0,Cl.jsx)("textarea",{ref:o,id:`comment-${a}`,className:(0,Ml.A)("form-control",{"grow-1":!s}),style:Cd,onChange:l,value:t.comment,placeholder:i.translate("commentScreen.textareaPlaceholder"),"data-qa":"comment","data-testid":"comment-input",maxLength:fd.MAX_LENGTH})]})})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)("button",{type:"submit",className:"btn btn-primary","data-qa":"save-comment","data-tracking-element-name":"nextButton",children:i.translate("commentScreen.button")})})]})};var Pd;!function(e){e.CHECKBOX="checkbox",e.MULTIOPTION="multioption",e.RADIO="radio",e.DROPDOWN="dropdown",e.LINE="line",e.MULTILINE="multiline",e.DATE="date"}(Pd||(Pd={}));const Nd=e=>e.type===Pd.CHECKBOX,Dd=e=>e.type===Pd.DROPDOWN,Td=e=>e.type===Pd.MULTILINE,kd=e=>e.type===Pd.RADIO,Id=e=>e.type===Pd.LINE,_d=e=>e.type===Pd.MULTIOPTION,Od=e=>e.type===Pd.DATE;var xd;function wd(){return wd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},wd.apply(null,arguments)}var Rd=function(e,t){return kr.createElement("svg",wd({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),xd||(xd=kr.createElement("path",{d:"m20 6-11 11-5-5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},Md=(0,kr.forwardRef)(Rd),Ld=(0,kr.memo)(Md);const Fd=e=>{var{setRef:t,innerRef:n,className:i,customLabelClasses:s,customControlClasses:a,labelTruncated:o=!0,disabled:r,error:l,checked:c,checkboxValue:u,children:h,hint:m,dataQa:p,dataTestId:g,trackingElement:y,onChange:f}=e,v=(0,d.Tt)(e,["setRef","innerRef","className","customLabelClasses","customControlClasses","labelTruncated","disabled","error","checked","checkboxValue","children","hint","dataQa","dataTestId","trackingElement","onChange"]);const S=(0,kr.useRef)(null);return(0,kr.useImperativeHandle)(t,(()=>S.current),[]),(0,Cl.jsxs)("div",{ref:n,className:(0,Ec.A)("ui-checkbox",{"ui-checkbox-disabled":r},i),children:[(0,Cl.jsxs)("label",{className:(0,Ec.A)("ui-checkbox-label",s),"data-qa":p+"-label",children:[(0,Cl.jsxs)("span",{className:(0,Ec.A)("ui-checkbox-control",a),children:[(0,Cl.jsx)("input",Object.assign({ref:S,type:"checkbox",className:(0,Ec.A)("ui-checkbox-input",{"has-error":l}),disabled:r,checked:c,value:u,"aria-invalid":l,"data-qa":p,"data-tracking-element-name":y,"data-testid":g,onChange:()=>{r||f(!c)}},v)),(0,Cl.jsx)("span",{className:"ui-checkbox-icon","aria-hidden":!0,children:c&&(0,Cl.jsx)(Ld,{})})]}),h&&(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-checkbox-text",{"ui-checkbox-text-ellipsis":o}),children:h})]}),m&&(0,Cl.jsx)("div",{className:"ui-checkbox-hint",children:m})]})};var Ud=n(7001);const{useAddFieldToScroll:jd,useScrollToFieldsTrigger:Bd,ScrollToFieldsProvider:Gd}=(0,Ud.J)(),qd=e=>{let{id:t,className:n,question:i,answer:s,required:a,hasError:o,type:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),d=(0,kr.useCallback)((()=>{l(!s)}),[l,s]),h=(0,kr.useRef)(null);return jd(h,(e=>!!e[t])),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)(Fd,{setRef:h,className:n,checked:!!s,error:o,onChange:d,dataQa:"question-"+r,"aria-required":a,"aria-describedby":`question-${r}-${u}-error`,"data-testid":"question-checkbox-single",children:[(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:i},dir:"auto"}),!a&&(0,Cl.jsxs)("span",{className:"text-gray-60",children:[" (",c.translate("common.optional"),")"]})]}),o&&(0,Cl.jsx)("p",{id:`question-${r}-${u}-error`,className:"sr-only",children:c.translate("questionsScreen.error.required")})]})},Vd=(0,kr.memo)(qd);var Hd;!function(e){e[e.ANSWER_MAX_LENGTH=500]="ANSWER_MAX_LENGTH"}(Hd||(Hd={}));var Kd=n(6960);const Yd={marginBottom:"13px"},zd=e=>{let{id:t,className:n,question:i,answer:s,required:a,hasError:o,type:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),[d,h]=(0,kr.useState)(!1),m=(0,kr.useRef)(null);return jd(m,(e=>!!e[t])),(0,Cl.jsx)(Kd.t,{id:`oneline-${u}`,setRef:m,error:o,className:(0,Ml.A)({"pe-10":o}),formGroupClass:n,label:(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),labelOptional:a?"":c.translate("common.optional"),value:s||"",maxLength:Hd.ANSWER_MAX_LENGTH,"aria-required":a,"aria-describedby":`question-${r}-${u}-error`,onChange:e=>{l(e.target.value)},onFocus:()=>h(!0),onBlur:()=>h(!1),dataQa:"question-"+r,"data-testid":"question-oneline",children:o&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-bottom-end z-index-5 me-4",style:Yd,showTooltip:d,children:(0,Cl.jsx)("p",{id:`question-${r}-${u}-error`,children:c.translate("questionsScreen.error.required")})})})},Wd=(0,kr.memo)(zd);function $d(e,t){const[n,i]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{if(!t)return;i(!0);const e=setTimeout((()=>{i(!1)}),400);return()=>clearTimeout(e)}),[e,t]),n}const Xd=e=>{const t=Ol(),n=(0,kr.useCallback)((t=>{e.handleChange(e.id,t)}),[e]),i=$d(e.shakeKey,e.hasError);return Object.values(Pd).includes(e.type)?(0,Cl.jsxs)(Cl.Fragment,{children:[Nd(e)&&(0,Cl.jsx)(Vd,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:n,className:(0,Ml.A)({shake:i}),type:e.type}),Id(e)&&(0,Cl.jsx)(Wd,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:n,className:(0,Ml.A)({shake:i}),type:e.type})]}):(t.captureException(new Error(`Unknown type of question: "${e.type}"`)),null)},Qd=(0,kr.memo)(Xd),Zd=()=>{var e;const{state:t,controller:n}=Tc(wl.MANDATORY_QUESTIONS),i=Boolean(null===(e=t.mandatoryQuestions.retiredOrUnemployed)||void 0===e?void 0:e.answer),s=!i,a=!i,o=(0,nc.t)(),r=(0,kr.useId)(),l=(0,Bl.P)(),c=Bd(),u=(0,kr.useCallback)(((e,t)=>{n.answerMandatoryQuestion(e,t,"retiredOrUnemployed")}),[n]),d=(0,kr.useCallback)(((e,t)=>{n.answerMandatoryQuestion(e,t,"occupation")}),[n]),h=(0,kr.useCallback)(((e,t)=>{n.answerMandatoryQuestion(e,t,"employer")}),[n]),m=(0,kr.useCallback)((e=>{e.preventDefault(),n.leave(),c()}),[n,c]);return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${r}`,"data-qa":"mandatory-questions-form",onSubmit:m,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${r}`,title:o.translate("mandatoryQuestionsScreen.title"),a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-8":!l}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)(fc,{as:"p",className:l?"text-ellipsis":"text-line-clamp-6",token:"mandatoryQuestionsScreen.description"}),(0,Cl.jsx)(bc,{size:24}),t.mandatoryQuestions.retiredOrUnemployed&&(0,Cl.jsx)(Qd,{id:t.mandatoryQuestions.retiredOrUnemployed.key,type:t.mandatoryQuestions.retiredOrUnemployed.type,answer:t.mandatoryQuestions.retiredOrUnemployed.answer,options:t.mandatoryQuestions.retiredOrUnemployed.options,question:t.mandatoryQuestions.retiredOrUnemployed.question,required:t.mandatoryQuestions.retiredOrUnemployed.required,hasError:!!t.questionErrors[t.mandatoryQuestions.retiredOrUnemployed.key],handleChange:u,shakeKey:t.shakeKey},t.mandatoryQuestions.retiredOrUnemployed.key),s&&t.mandatoryQuestions.occupation&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)(Qd,{id:t.mandatoryQuestions.occupation.key,type:t.mandatoryQuestions.occupation.type,answer:t.mandatoryQuestions.occupation.answer,options:t.mandatoryQuestions.occupation.options,question:t.mandatoryQuestions.occupation.question,required:s,hasError:!!t.questionErrors[t.mandatoryQuestions.occupation.key],handleChange:d,shakeKey:t.shakeKey},t.mandatoryQuestions.occupation.key)]}),a&&t.mandatoryQuestions.employer&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)(Qd,{id:t.mandatoryQuestions.employer.key,type:t.mandatoryQuestions.employer.type,answer:t.mandatoryQuestions.employer.answer,options:t.mandatoryQuestions.employer.options,question:t.mandatoryQuestions.employer.question,required:a,hasError:!!t.questionErrors[t.mandatoryQuestions.employer.key],handleChange:h,shakeKey:t.shakeKey},t.mandatoryQuestions.employer.key)]})]})}),(0,Cl.jsx)(gd,{className:(0,Ml.A)({"pt-12":l}),children:(0,Cl.jsx)("button",{type:"submit",className:"btn btn-primary","data-qa":"mandatory-questions-button",children:o.translate("mandatoryQuestionsScreen.button")})})]})},Jd=(0,kr.memo)(Zd),eh=()=>{const{state:e}=Tc(wl.MANDATORY_QUESTIONS);return(0,Cl.jsx)(Gd,{state:e.questionErrors,children:(0,Cl.jsx)(Jd,{})})};function th(e,t,n){switch(n){case qn.ONCE:return e.translate("payButton.label.once",{amount:t});case qn.DAILY:return e.translate("payButton.label.daily",{amount:t});case qn.WEEKLY:return e.translate("payButton.label.weekly",{amount:t});case qn.BIWEEKLY:return e.translate("payButton.label.biweekly",{amount:t});case qn.EVERY_4_WEEKS:return e.translate("payButton.label.every4weeks",{amount:t});case qn.MONTHLY:return e.translate("payButton.label.monthly",{amount:t});case qn.BIMONTHLY:return e.translate("payButton.label.bimonthly",{amount:t});case qn.QUARTERLY:return e.translate("payButton.label.quarterly",{amount:t});case qn.SEMIANNUAL:return e.translate("payButton.label.semiannual",{amount:t});case qn.ANNUAL:return e.translate("payButton.label.annual",{amount:t});default:throw new Error(`Unknown frequency "${n}"`)}}function nh(e,t){switch(t){case qn.DAILY:return e.translate("paymentMethodScreen.perDay");case qn.WEEKLY:return e.translate("paymentMethodScreen.perWeek");case qn.BIWEEKLY:return e.translate("paymentMethodScreen.per2Weeks");case qn.EVERY_4_WEEKS:return e.translate("paymentMethodScreen.per4Weeks");case qn.MONTHLY:return e.translate("paymentMethodScreen.perMonth");case qn.BIMONTHLY:return e.translate("paymentMethodScreen.per2Months");case qn.QUARTERLY:return e.translate("paymentMethodScreen.perQuarter");case qn.SEMIANNUAL:return e.translate("paymentMethodScreen.per6Months");case qn.ANNUAL:return e.translate("paymentMethodScreen.perYear");default:return""}}function ih(e,t){switch(t){case qn.ONCE:return e.translate("donateForm.giveOnce");case qn.DAILY:return e.translate("donateForm.daily");case qn.WEEKLY:return e.translate("donateForm.weekly");case qn.EVERY_4_WEEKS:return e.translate("donateForm.every4weeks");case qn.BIWEEKLY:return e.translate("donateForm.biweekly");case qn.MONTHLY:return e.translate("donateForm.monthly");case qn.BIMONTHLY:return e.translate("donateForm.bimonthly");case qn.QUARTERLY:return e.translate("donateForm.quarterly");case qn.SEMIANNUAL:return e.translate("donateForm.semiannual");case qn.ANNUAL:return e.translate("donateForm.annual");default:throw new Bs.HP(t)}}var sh,ah;!function(e){e.EXTRA_SMALL="xs",e.SMALL="sm",e.MEDIUM="md",e.LARGE="lg",e.EXTRA_LARGE="xl"}(sh||(sh={})),function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.WHITE="white"}(ah||(ah={}));const oh=({size:e=sh.MEDIUM,variant:t=ah.PRIMARY,className:n})=>(0,Cl.jsx)("span",{className:(0,Ec.A)(`ui-spinner ui-spinner-${e} ui-spinner-${t}`,n),"aria-hidden":!0}),rh=(0,kr.forwardRef)(((e,t)=>{const{buttonType:n,type:i,processingState:s,className:a,spinnerColorDefault:o,children:r,errorTitle:l,errorMessage:c,disabled:u,testMode:d,dataQa:h,dataTestId:m,trackingElement:p,serverErrors:g,onClick:y}=e,f=(0,nc.t)(),v=(0,Bl.P)(),S=(0,kr.useRef)(null),E=(0,kr.useRef)(null),A=(0,ql.wf)(),C="link"===n,b=s===Xl.IDLE,P=s===Xl.PENDING,N=s===Xl.SUCCESS,D=s===Xl.ERROR,T=!b&&!D||u,k=D&&(!!l||!!c),[I,_]=(0,kr.useState)(D),[O,x]=(0,kr.useState)(k);(0,kr.useImperativeHandle)(t,(()=>E.current),[]);const w=!(null==g?void 0:g.email),R=(0,hd.D)((()=>{_(!1),x(!1)})),M=()=>{I&&_(!1),O&&x(!1)};return function(e){const{document:t}=(0,Il.M)();(0,kr.useEffect)((()=>{const n=()=>{e()};return t.addEventListener("stripeElementEvent",n),t.addEventListener("click",n),()=>{t.removeEventListener("click",n),t.removeEventListener("stripeElementEvent",n)}}),[t,e])}(M),function(e){const{document:t}=(0,Il.M)();(0,kr.useEffect)((()=>{const n=t=>{"Tab"===t.key&&e()};return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}}),[t,e])}(M),(0,kr.useEffect)((()=>{w&&(_(D),x(k))}),[D,k,w]),(0,kr.useEffect)((()=>{I?R.set([],$s):R.clear()}),[I,R]),(0,Cl.jsxs)(Cl.Fragment,{children:[v&&(0,Cl.jsx)(Ll.A,{nodeRef:S,in:O,timeout:200,classNames:"rtg-fade",mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)(yu,{setRef:S,type:"danger",className:"mb-3",children:(0,Cl.jsx)(ou,{errorTitle:l,errorMessage:c,dataQa:h,dataTestId:m})})}),(0,Cl.jsx)(Zc.S,{ref:E,content:(0,Cl.jsx)(ou,{errorTitle:l,errorMessage:c,dataQa:h,dataTestId:m}),trigger:"manual",manualOpen:!v&&O,placement:"top",maxWidth:"300px",rootContainer:A,children:(0,Cl.jsxs)("button",{type:null!=i?i:"button",className:(0,Ml.A)(C?"btn-link p-rel max-w-100":"btn",a,{"w-100":C&&!b,"btn-testmode":!C&&d,"btn-loading":P||N||I,"is-success":N,"has-error":I}),disabled:T,"aria-busy":P,"data-qa":h,"data-tracking-element-name":p,"data-testid":m,onClick:y,children:[C?(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("span",{className:(0,Ml.A)("text-truncate",{invisible:P||N||I}),"data-testid":"link-children-container",children:r}),(P||N)&&(0,Cl.jsxs)("span",{className:"p-abs inset-centered max-w-100 d-flex items-center justify-center",children:[(0,Cl.jsx)(oh,{size:"xs",className:"shrink-0 me-1"}),(0,Cl.jsx)("span",{className:"text-truncate",children:f.translate("payButton.processingShort")})]}),I&&(0,Cl.jsx)("span",{className:"p-abs inset-centered text-truncate text-red-80 max-w-100",children:f.translate("payButton.error")})]}):(0,Cl.jsxs)(Cl.Fragment,{children:[r,P&&(0,Cl.jsx)("span",{className:"p-abs inset-centered",children:(0,Cl.jsx)(oh,{size:"sm",variant:o?"secondary":"white"})}),(N||I)&&(0,Cl.jsxs)("span",{className:"btn-state",children:[N&&(0,Cl.jsx)(Ld,{className:"icon-stroke icon-stroke-2","data-testid":"pay-button-success-icon"}),I&&(0,Cl.jsx)(su.A,{className:"icon-stroke icon-stroke-2","data-testid":"pay-button-error-icon"})]})]}),(0,Cl.jsx)("span",{className:"sr-only",role:"status",children:P&&f.translate("payButton.processing")}),(0,Cl.jsx)("span",{className:"sr-only",role:"status",children:N&&f.translate("payButton.done")})]})})]})}));rh.displayName="RawPayButton";const lh=(0,kr.memo)(rh);var ch,uh;function dh(){return dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dh.apply(null,arguments)}!function(e){e.CARD="creditCard",e.APPLE_PAY="applePay",e.GOOGLE_PAY="googlePay",e.SEPA="sepa",e.PAYPAL="paypal",e.AU_BECS="auBecsDebit",e.UK_BACS="ukBacs",e.VENMO="venmo",e.ACSS="acss",e.IDEAL="ideal",e.US_BANK_ACCOUNT="usBankAccount",e.US_BANK_ACCOUNT_INSTANT="usBankAccountInstant",e.US_BANK_ACCOUNT_VERIFICATION="usBankAccountVerification"}(ch||(ch={}));var hh=function(e,t){return kr.createElement("svg",dh({fill:"none",height:26,viewBox:"0 0 51 26",width:51,xmlns:"http://www.w3.org/2000/svg",ref:t},e),uh||(uh=kr.createElement("g",{fill:"currentColor"},kr.createElement("path",{d:"m10.7677 6.37383c.5615-.70228.9425-1.64523.842-2.60882-.8219.04087-1.82492.54225-2.4056 1.24508-.52139.60186-.98286 1.5843-.86255 2.50749.92264.08003 1.84445-.46118 2.42615-1.14375z"}),kr.createElement("path",{d:"m11.5996 7.69773c-1.3399-.07981-2.47913.76045-3.119.76045-.64022 0-1.62007-.72023-2.67985-.70082-1.37938.02026-2.65929.80017-3.35926 2.0406-1.43973 2.48144-.37995 6.16234 1.02012 8.18334.6799.9999 1.4993 2.1008 2.57898 2.0612 1.02012-.04 1.41996-.6605 2.65996-.6605 1.23909 0 1.59925.6605 2.67915.6405 1.1198-.02 1.8199-1.0003 2.4998-2.0012.78-1.1398 1.0993-2.2403 1.1193-2.3007-.02-.02-2.1593-.8407-2.1792-3.3016-.0201-2.0604 1.6796-3.04053 1.7596-3.10131-.9599-1.41967-2.4596-1.57974-2.9796-1.61996z"}),kr.createElement("path",{d:"m23.2667 4.90918c2.9123 0 4.9402 2.00744 4.9402 4.93011 0 2.93311-2.0697 4.95101-5.0132 4.95101h-3.2244v5.1277h-2.3297v-15.00882zm-3.2974 7.92562h2.6731c2.0283 0 3.1827-1.092 3.1827-2.98508 0-1.89288-1.1544-2.97463-3.1723-2.97463h-2.6835z"}),kr.createElement("path",{d:"m28.8154 16.8081c0-1.914 1.4666-3.0892 4.0671-3.2349l2.9953-.1767v-.8425c0-1.2169-.8218-1.945-2.1945-1.945-1.3004 0-2.1117.6239-2.3091 1.6018h-2.1218c.1248-1.9764 1.8096-3.43248 4.514-3.43248 2.6522 0 4.3475 1.40418 4.3475 3.59878v7.5408h-2.1531v-1.7994h-.0517c-.6344 1.217-2.0179 1.9866-3.4532 1.9866-2.1426 0-3.6405-1.3313-3.6405-3.297zm7.0624-.9881v-.8633l-2.694.1663c-1.3418.0937-2.1009.6866-2.1009 1.6227 0 .9567.7904 1.5809 1.997 1.5809 1.5704 0 2.7979-1.0818 2.7979-2.5066z"}),kr.createElement("path",{d:"m40.1472 23.9432v-1.8202c.1661.0415.5405.0415.7279.0415 1.04 0 1.6017-.4368 1.9448-1.56 0-.0209.1978-.6657.1978-.6761l-3.9523-10.95245h2.4336l2.767 8.90345h.0413l2.767-8.90345h2.3714l-4.0984 11.51395c-.9357 2.6524-2.0174 3.5053-4.2849 3.5053-.1873 0-.7491-.0209-.9152-.052z"}))))},mh=(0,kr.forwardRef)(hh),ph=(0,kr.memo)(mh);const gh=e=>{let{disabled:t,onClick:n}=e;const i=(0,nc.t)();return(0,Cl.jsx)("button",{type:"button",className:"btn btn-black d-flex items-center justify-center",disabled:t,"aria-label":i.translate("paymentOptions.applePay.label"),onClick:n,"data-tracking-element-name":"payment-option-applePay","data-qa":"fast-track-apple-pay-button","data-testid":"fast-track-apple-pay-button",children:(0,Cl.jsx)(ph,{width:50,height:26,className:"shrink-0","aria-hidden":!0})})},yh=(0,kr.memo)(gh);var fh,vh,Sh,Eh,Ah;function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ch.apply(null,arguments)}var bh=function(e,t){return kr.createElement("svg",Ch({fill:"none",height:26,viewBox:"0 0 53 26",width:53,xmlns:"http://www.w3.org/2000/svg",ref:t},e),fh||(fh=kr.createElement("g",{fill:"#fff"},kr.createElement("path",{d:"m25.011 13.6095v5.8583h-1.8898v-14.48819h4.9134c1.1969 0 2.3307.44095 3.2126 1.25985.8819.7559 1.3228 1.88976 1.3228 3.08661 0 1.19683-.4409 2.26773-1.3228 3.08663s-1.9528 1.2598-3.2126 1.2598zm0-6.86611v5.03941h3.1496c.6929 0 1.3858-.252 1.8268-.7559 1.0078-.9449 1.0078-2.51973.0629-3.46461l-.0629-.06299c-.504-.50394-1.1339-.8189-1.8268-.75591z"}),kr.createElement("path",{d:"m36.9168 9.26294c1.3858 0 2.4567.37795 3.2756 1.13386.8189.7559 1.1968 1.7638 1.1968 3.0236v6.0473h-1.7638v-1.3859h-.063c-.7559 1.1339-1.8267 1.7008-3.0866 1.7008-1.0708 0-2.0157-.3149-2.7716-.9449-.6929-.6299-1.1339-1.5118-1.1339-2.4567 0-1.0078.378-1.8267 1.1339-2.4566.7559-.63 1.8267-.8819 3.0866-.8819 1.1338 0 2.0157.1889 2.7086.6299v-.441c0-.6299-.2519-1.2598-.7559-1.6378-.5039-.4409-1.1338-.6929-1.8267-.6929-1.0709 0-1.8898.441-2.4567 1.3229l-1.6378-1.0079c1.0079-1.32284 2.3307-1.95276 4.0945-1.95276zm-2.3937 7.18106c0 .504.2519.9449.6299 1.1969.4409.315.9449.5039 1.4488.5039.7559 0 1.5118-.3149 2.0787-.8819.63-.5669.9449-1.2598.9449-2.0157-.5669-.441-1.3858-.6929-2.4567-.6929-.7559 0-1.3858.189-1.8897.5669-.504.315-.7559.7559-.7559 1.3228z"}),kr.createElement("path",{d:"m51.5937 9.57788-6.2362 14.29922h-1.8897l2.3307-4.9764-4.0945-9.25983h2.0157l2.9607 7.11813h.0629l2.8977-7.11813h1.9527z"}))),vh||(vh=kr.createElement("path",{d:"m17.5146 12.3496c0-.5669-.0629-1.1339-.1259-1.7008h-7.87405v3.2126h4.47245c-.189 1.0079-.7559 1.9528-1.6378 2.5197v2.0787h2.7087c1.5748-1.4488 2.4566-3.5905 2.4566-6.1102z",fill:"#4285f4"})),Sh||(Sh=kr.createElement("path",{d:"m9.51486 20.4756c2.26774 0 4.15744-.7559 5.54334-2.0158l-2.7087-2.0787c-.7559.5039-1.7008.8189-2.83464.8189-2.14173 0-4.0315-1.4488-4.66142-3.4646h-2.77165v2.1417c1.44882 2.8347 4.28346 4.5985 7.43307 4.5985z",fill:"#34a853"})),Eh||(Eh=kr.createElement("path",{d:"m4.85386 13.7354c-.37795-1.0078-.37795-2.1417 0-3.2126v-2.1417h-2.77165c-1.196852 2.3307-1.196852 5.1024 0 7.4961z",fill:"#fbbc04"})),Ah||(Ah=kr.createElement("path",{d:"m9.51461 7.12126c1.19689 0 2.33069.44095 3.21259 1.25985l2.3937-2.3937c-1.5118-1.38583-3.5276-2.20473-5.5433-2.14174-3.1496 0-6.04724 1.76378-7.43307 4.59843l2.77165 2.1417c.56693-2.01572 2.4567-3.46454 4.59843-3.46454z",fill:"#ea4335"})))},Ph=(0,kr.forwardRef)(bh),Nh=(0,kr.memo)(Ph);const Dh=e=>{let{disabled:t,onClick:n}=e;const i=(0,nc.t)();return(0,Cl.jsx)("button",{type:"button",className:"btn btn-black p-rel d-flex items-center justify-center",disabled:t,"aria-label":i.translate("paymentOptions.googlePay.label"),onClick:n,"data-tracking-element-name":"payment-option-googlePay","data-qa":"fast-track-google-pay-button","data-testid":"fast-track-google-pay-button",children:(0,Cl.jsx)(Nh,{width:53,height:26,className:"shrink-0","aria-hidden":!0})})},Th=(0,kr.memo)(Dh);var kh,Ih;function _h(){return _h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_h.apply(null,arguments)}var Oh=function(e,t){return kr.createElement("svg",_h({height:32,preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 101 32",width:101,xmlns:"http://www.w3.org/2000/svg",ref:t},e),kh||(kh=kr.createElement("g",{fill:"#003087"},kr.createElement("path",{d:"m12.237 2.8h-7.8c-.5 0-1 .4-1.1.9l-3.1 20c-.1.4.2.7.6.7h3.7c.5 0 1-.4 1.1-.9l.8-5.4c.1-.5.5-.9 1.1-.9h2.5c5.1 0 8.1-2.5 8.9-7.4.3-2.1 0-3.8-1-5-1.1-1.3-3.1-2-5.7-2zm.9 7.3c-.4 2.8-2.6 2.8-4.6 2.8h-1.2l.8-5.2c0-.3.3-.5.6-.5h.5c1.4 0 2.7 0 3.4.8.5.4.7 1.1.5 2.1z"}),kr.createElement("path",{d:"m35.437 10h-3.7c-.3 0-.6.2-.6.5l-.2 1-.3-.4c-.8-1.2-2.6-1.6-4.4-1.6-4.1 0-7.6 3.1-8.3 7.5-.4 2.2.1 4.3 1.4 5.7 1.1 1.3 2.8 1.9 4.7 1.9 3.3 0 5.2-2.1 5.2-2.1l-.2 1c-.1.4.2.8.6.8h3.4c.5 0 1-.4 1.1-.9l2-12.8c.1-.2-.3-.6-.7-.6zm-5.1 7.2c-.4 2.1-2 3.6-4.2 3.6-1.1 0-1.9-.3-2.5-1s-.8-1.6-.6-2.6c.3-2.1 2.1-3.6 4.2-3.6 1.1 0 1.9.4 2.5 1 .5.7.7 1.6.6 2.6z"}),kr.createElement("path",{d:"m55.337 10h-3.7c-.4 0-.7.2-.9.5l-5.2 7.6-2.2-7.3c-.1-.5-.6-.8-1-.8h-3.7c-.4 0-.8.4-.6.9l4.1 12.1-3.9 5.4c-.3.4 0 1 .5 1h3.7c.4 0 .7-.2.9-.5l12.5-18c.3-.3 0-.9-.5-.9z"}))),Ih||(Ih=kr.createElement("g",{fill:"#009cde"},kr.createElement("path",{d:"m67.737 2.8h-7.8c-.5 0-1 .4-1.1.9l-3.1 19.9c-.1.4.2.7.6.7h4c.4 0 .7-.3.7-.6l.9-5.7c.1-.5.5-.9 1.1-.9h2.5c5.1 0 8.1-2.5 8.9-7.4.3-2.1 0-3.8-1-5-1.2-1.2-3.1-1.9-5.7-1.9zm.9 7.3c-.4 2.8-2.6 2.8-4.6 2.8h-1.2l.8-5.2c0-.3.3-.5.6-.5h.5c1.4 0 2.7 0 3.4.8.5.4.6 1.1.5 2.1z"}),kr.createElement("path",{d:"m90.937 10h-3.7c-.3 0-.6.2-.6.5l-.2 1-.3-.4c-.8-1.2-2.6-1.6-4.4-1.6-4.1 0-7.6 3.1-8.3 7.5-.4 2.2.1 4.3 1.4 5.7 1.1 1.3 2.8 1.9 4.7 1.9 3.3 0 5.2-2.1 5.2-2.1l-.2 1c-.1.4.2.8.6.8h3.4c.5 0 1-.4 1.1-.9l2-12.8c0-.2-.3-.6-.7-.6zm-5.2 7.2c-.4 2.1-2 3.6-4.2 3.6-1.1 0-1.9-.3-2.5-1s-.8-1.6-.6-2.6c.3-2.1 2.1-3.6 4.2-3.6 1.1 0 1.9.4 2.5 1 .6.7.8 1.6.6 2.6z"}),kr.createElement("path",{d:"m95.337 3.3-3.2 20.3c-.1.4.2.7.6.7h3.2c.5 0 1-.4 1.1-.9l3.2-19.9c.1-.4-.2-.7-.6-.7h-3.6c-.4 0-.6.2-.7.5z"}))))},xh=(0,kr.forwardRef)(Oh),wh=(0,kr.memo)(xh);const Rh=e=>{let{disabled:t,onClick:n}=e;const i=(0,nc.t)();return(0,Cl.jsx)("button",{type:"button",className:"btn btn-paypal-gold p-rel d-flex items-center justify-center",disabled:t,"aria-label":i.translate("paymentOptions.paypal.label"),onClick:n,"data-tracking-element-name":"payment-option-paypal","data-qa":"fast-track-paypal-button","data-testid":"fast-track-paypal-button",children:(0,Cl.jsx)(wh,{width:69,height:22,className:"shrink-0","aria-hidden":!0})})},Mh=(0,kr.memo)(Rh),Lh={[ch.APPLE_PAY]:yh,[ch.GOOGLE_PAY]:Th,[ch.PAYPAL]:Mh},Fh=e=>{let{option:t,show:n,disabled:i,onClick:s}=e;const a=Lh[t],o=(0,kr.useCallback)((()=>{s(t)}),[s,t]);return(0,Cl.jsx)("div",{className:(0,Ml.A)("w-100",{"d-none":!n}),children:(0,Cl.jsx)(a,{disabled:i,onClick:o})},t)},Uh=e=>{let{availableOptions:t,buttonOptions:n,disabled:i,onChoosePaymentOption:s}=e;return(0,Cl.jsx)("div",{className:"d-flex items-center gap-x-2","data-qa":"fast-track-payment-option-buttons",children:t.map((e=>{const{visible:t}=n[e];return(0,Cl.jsx)(Fh,{option:e,show:t,disabled:i,onClick:s},e)}))})},jh=(0,kr.memo)(Uh);var Bh=n(7998);const Gh=["top","bottom"],qh=e=>{let{anonymousChecked:t,locked:n,className:i,dataTestId:s,onToggle:a}=e;const o=(0,nc.t)(),r=(0,gc.Q)(),l=(0,ql.wf)();return(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:t,disabled:n,onChange:a,dataQa:"anonymously-checkbox",trackingElement:"anonymousCheckbox",dataTestId:s,children:(0,Cl.jsx)("span",{className:"text-truncate",children:o.translate("privacyScreen.donateAnonymously.label")})}),(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!n&&o.translate("privacyScreen.donateAnonymously.tooltipLabel"),trigger:"click",placement:r?"left-start":"right-start",fallbackPlacements:Gh,rootContainer:l,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:n,"aria-label":o.translate("privacyScreen.donateAnonymously.helpAriaLabel"),"data-qa":"anonymous-checkbox-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":r}),"aria-hidden":!0})})})})]})},Vh=(0,kr.memo)(qh);var Hh=n(984);const Kh=e=>{var t,{label:n,labelOptional:i,labelSrOnly:s,labelFloating:a,id:o,className:r,value:l,formGroupClass:c,formLabelClass:u,dataQa:h,dataTestId:m,options:p=[],groupedOptions:g,children:y,autoFocus:f,hasCustomValue:v,customPlaceholder:S,error:E,setRef:A,autoScroll:C}=e,b=(0,d.Tt)(e,["label","labelOptional","labelSrOnly","labelFloating","id","className","value","formGroupClass","formLabelClass","dataQa","dataTestId","options","groupedOptions","children","autoFocus","hasCustomValue","customPlaceholder","error","setRef","autoScroll"]);const P=(0,kr.useRef)(null),N=""===(null===(t=null==p?void 0:p[0])||void 0===t?void 0:t.value);return(0,kr.useImperativeHandle)(A,(()=>P.current),[]),(0,Sd.f)({ref:P,autoFocus:f,mode:vd.Q.DESKTOP}),(0,Jc.Q)(P,{shouldScroll:C,shouldFocus:!0}),(0,Cl.jsxs)(Hh.s,{htmlFor:o,label:n,labelOptional:i,labelSrOnly:s,labelFloating:a,formGroupClass:c,formLabelClass:(0,Ml.A)(u,{"has-error":E}),formControlValue:l,dataQa:h+"-label",children:[(0,Cl.jsxs)("select",Object.assign({id:o,ref:P,className:(0,Ml.A)("form-control form-control-select",r,{"has-label-floating":a,"has-error":E}),"aria-invalid":E,value:l,"data-qa":h,"data-testid":m},b,{children:[!N&&(0,Cl.jsx)("option",{value:"",disabled:!0}),p&&p.map((e=>{let{value:t,label:n}=e;return(0,Cl.jsx)("option",{value:t,children:n},t)})),g&&Object.entries(g).map((e=>{let[t,n]=e;return(0,Cl.jsx)("optgroup",{label:t,children:n.map((e=>{let{value:t,label:n}=e;return(0,Cl.jsx)("option",{value:t,children:n},t)}))},t)}))]})),(v||!a&&S)&&(0,Cl.jsx)("span",{className:(0,Ml.A)("form-control-placeholder p-abs inset-bottom-start inset-bottom-end text-truncate pointer-events-none z-index-4",{"text-gray-60":!l,"has-label-floating":a}),children:l||S}),y]})};var Yh=n(4010);const zh={minWidth:"100px",maxWidth:"170px",width:"auto"},Wh=e=>{let{validation:t,customerTitle:n,className:i,autoFocus:s,locked:a,dataTestId:o,onChange:r}=e;const l=(0,nc.t)(),c=(0,kr.useId)(),[u,d]=(0,kr.useState)(!1),h=!t.customerTitle.isValid,m=n.list.map((e=>({value:e,label:e}))),p=(0,kr.useRef)(null);return(0,Yh.FM)(p,(e=>!e.validation.customerTitle.isValid)),(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-rel",i),style:zh,children:[(0,Cl.jsx)(Kh,{setRef:p,id:`title-${c}`,label:l.translate("privacyScreen.customerTitle.label"),labelFloating:!0,formGroupClass:"p-abs inset-0",value:n.title,options:m,customPlaceholder:l.translate("privacyScreen.customerTitle.placeholder"),autoFocus:s,disabled:a,error:h,"aria-describedby":`customer-title-${c}-error`,dataTestId:o,onChange:e=>r(e.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),dataQa:"customer-title-select",children:h&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-10",showTooltip:u,children:(0,Cl.jsx)("p",{id:`customer-title-${c}-error`,children:l.translate("privacyScreen.customerTitle.error.required")})})}),(0,Cl.jsxs)("span",{className:"invisible form-control-placeholder has-label-floating d-flex","aria-hidden":!0,children:[l.translate("privacyScreen.customerTitle.placeholder"),(0,Cl.jsx)("span",{className:"icon-slot icon-slot-18 shrink-0 ms-2"})]})]})},$h=(0,kr.memo)(Wh);var Xh;!function(e){e[e.NAME_MIN_LENGTH=1]="NAME_MIN_LENGTH",e[e.NAME_MAX_LENGTH=100]="NAME_MAX_LENGTH",e[e.EMAIL_MAX_LENGTH=320]="EMAIL_MAX_LENGTH",e[e.ON_BEHALF_OF_MAX_LENGTH=60]="ON_BEHALF_OF_MAX_LENGTH"}(Xh||(Xh={}));const Qh=["top","bottom"],Zh=e=>{let{className:t,isDisabled:n}=e;const i=(0,nc.t)(),s=(0,gc.Q)(),a=(0,ql.wf)();return(0,Cl.jsx)(Zc.S,{content:!n&&i.translate("privacyScreen.emailInput.tooltipLabel"),trigger:"click",placement:s?"left-start":"right-start",fallbackPlacements:Qh,maxWidth:"260px",rootContainer:a,"data-qa":"privacy-email-consent-tooltip",children:(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn-icon font-size-18 text-gray-60",t),disabled:n,"aria-label":i.translate("privacyScreen.emailInput.helpAriaLabel"),"data-testid":"privacy-email-consent-tooltip-trigger","data-qa":"email-consent-tooltip-trigger",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":s}),"data-qa":"privacy-email-consent-tooltip-trigger","aria-hidden":!0})})})},Jh=e=>{let{validation:t,emailConsent:n,className:i,email:s,serverError:a,locked:o,dataTestId:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),d=!t.donorEmail.fields.email.isValid||a,h=t.donorEmail.fields.email.errors.required,m=t.donorEmail.fields.email.errors.email,p=(0,kr.useRef)(null),[g,y]=(0,kr.useState)(!1);return(0,Yh.FM)(p,(e=>!e.validation.donorEmail.fields.email.isValid||Boolean(e.serverErrors.email))),(0,Cl.jsx)(Kd.t,{id:`personal-email-${u}`,setRef:p,type:"text",label:c.translate("privacyScreen.emailInput.label"),labelFloating:!0,className:(0,Ml.A)({"pe-10":n.isEnabled&&!d||!n.isEnabled&&d,"pe-16":n.isEnabled&&d}),formGroupClass:i,formLabelClass:(0,Ml.A)({"pe-6":n.isEnabled&&!d||!n.isEnabled&&d,"pe-12":n.isEnabled&&d}),placeholder:c.translate("privacyScreen.emailInput.placeholder"),value:s,maxLength:Xh.EMAIL_MAX_LENGTH,inputMode:"email",autoComplete:"email",name:"email",error:d,disabled:o,"aria-required":!0,"aria-describedby":`personal-email-${u}-error`,onChange:e=>l(e.target.value),onFocus:()=>y(!0),onBlur:()=>y(!1),dataQa:"personal-email",dataTestId:r,children:(0,Cl.jsxs)("div",{className:"p-abs inset-centered-end d-flex items-center z-index-5 me-4",children:[d&&(0,Cl.jsx)(fu.U,{className:"shrink-0",dataQa:"personal-email",showTooltip:g,children:(0,Cl.jsxs)("p",{id:`personal-email-${u}-error`,children:[h&&c.translate("privacyScreen.emailInput.error.required"),!h&&m&&c.translate("privacyScreen.emailInput.error.invalid"),a&&(0,Cl.jsx)(fc,{token:"privacyScreen.emailInput.error.server"})]})}),n.isEnabled&&(0,Cl.jsx)(Zh,{className:(0,Ml.A)("shrink-0",{"ms-2":d}),isDisabled:o})]})})},em=(0,kr.memo)(Jh),tm=e=>e.fields.firstName.errors.required?"privacyScreen.firstNameInput.error.required":e.fields.firstName.errors.characters?"privacyScreen.firstNameInput.error.characters":e.fields.firstName.errors.minLength?"privacyScreen.firstNameInput.error.minLength":"privacyScreen.firstNameInput.error.required",nm=e=>{let{validation:t,className:n,firstName:i,locked:s,autoFocus:a,dataTestId:o,onChange:r}=e;const l=(0,nc.t)(),c=(0,kr.useId)(),[u,d]=(0,kr.useState)(!1),h=(0,kr.useRef)(null),m=!t.donorName.fields.firstName.isValid;return(0,Yh.FM)(h,(e=>!e.validation.donorName.fields.firstName.isValid)),(0,Cl.jsx)(Kd.t,{id:`personal-first-name-${c}`,setRef:h,label:l.translate("privacyScreen.firstNameInput.label"),labelFloating:!0,className:(0,Ml.A)({"pe-10":m}),formLabelClass:(0,Ml.A)({"pe-6":m}),formGroupClass:n,placeholder:l.translate("privacyScreen.firstNameInput.placeholder"),value:i,maxLength:Xh.NAME_MAX_LENGTH,autoComplete:"given-name",autoFocus:a,name:"firstName",disabled:s,error:m,"aria-required":!0,"aria-describedby":`personal-first-name-${c}-error`,onChange:e=>r(e.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),dataQa:"personal-first-name",dataTestId:o,children:m&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:u,children:(0,Cl.jsx)("p",{id:`personal-first-name-${c}-error`,children:l.translate(tm(t.donorName))})})})},im=(0,kr.memo)(nm),sm=["top","bottom"],am=e=>{let{generalConsent:t,locked:n,className:i,dataTestId:s,onToggle:a,onShowConsent:o}=e;const r=(0,nc.t)(),l=(0,gc.Q)(),c=(0,ql.wf)(),u=(0,Nl.n)(),{checkboxText:d}=u.campaign.config.consentText.general,{additionalInfoText:h}=u.campaign.config.consentText.general;return(0,kr.useEffect)((()=>{o()}),[o]),(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:t.isAccepted,disabled:n,onChange:a,dataQa:"general-consent-checkbox",trackingElement:"generalConsentCheckbox",dataTestId:s,children:(0,Cl.jsx)("span",{className:"text-truncate",dir:"auto",children:d?(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:d},"data-qa":"general-consent-text"}):r.translate("privacyScreen.generalConsent.label")})}),h&&(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!n&&(0,Cl.jsx)("p",{dangerouslySetInnerHTML:{__html:h},dir:"auto"}),trigger:"click",placement:l?"left-start":"right-start",fallbackPlacements:sm,maxWidth:"260px",maxHeight:"220px",rootContainer:c,"data-qa":"general-consent-checkbox-text-popover",children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:n,"aria-label":r.translate("privacyScreen.generalConsent.helpAriaLabel"),"data-qa":"general-consent-checkbox-help-button","data-testid":"general-consent-checkbox-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":l}),"aria-hidden":!0})})})})]})},om=(0,kr.memo)(am),rm=e=>e.fields.lastName.errors.required?"privacyScreen.lastNameInput.error.required":e.fields.lastName.errors.characters?"privacyScreen.lastNameInput.error.characters":e.fields.lastName.errors.minLength?"privacyScreen.lastNameInput.error.minLength":"privacyScreen.lastNameInput.error.required",lm=e=>{let{validation:t,className:n,lastName:i,locked:s,dataTestId:a,onChange:o}=e;const r=(0,nc.t)(),l=(0,kr.useId)(),c=(0,kr.useRef)(null),u=!t.donorName.fields.lastName.isValid,[d,h]=(0,kr.useState)(!1);return(0,Yh.FM)(c,(e=>!e.validation.donorName.fields.lastName.isValid)),(0,Cl.jsx)(Kd.t,{id:`personal-last-name-${l}`,setRef:c,label:r.translate("privacyScreen.lastNameInput.label"),labelFloating:!0,className:(0,Ml.A)({"pe-10":u}),formLabelClass:(0,Ml.A)({"pe-6":u}),formGroupClass:n,placeholder:r.translate("privacyScreen.lastNameInput.placeholder"),value:i,maxLength:Xh.NAME_MAX_LENGTH,autoComplete:"family-name",name:"lastName",disabled:s,error:u,"aria-required":!0,"aria-describedby":`personal-last-name-${l}-error`,onChange:e=>o(e.target.value),onFocus:()=>h(!0),onBlur:()=>h(!1),dataQa:"personal-last-name",dataTestId:a,children:u&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:d,children:(0,Cl.jsx)("p",{id:`personal-last-name-${l}-error`,children:r.translate(rm(t.donorName))})})})},cm=(0,kr.memo)(lm),um=["top","bottom"],dm=e=>{let{validation:t,onBehalfOf:n,className:i,locked:s,dataTestIdCheckbox:a,dataTestIdInput:o,onToggleOnBehalfOf:r,onChangeCompanyName:l}=e;var c;const u=(0,nc.t)(),d=(0,gc.Q)(),h=(0,kr.useId)(),m=(0,ql.wf)(),p=!t.onBehalfOf.isValid,g=t.onBehalfOf.fields.onBehalfOf.errors.required,y=t.onBehalfOf.fields.onBehalfOf.errors.minLength,[f,v]=(0,kr.useState)(!1),[S,E]=(0,kr.useState)(!1),A=(0,kr.useRef)(null);return(0,Yh.FM)(A,(e=>!e.validation.onBehalfOf.isValid)),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:n.isActive,disabled:s,dataQa:"behalf-company-button",trackingElement:"showBehalfOfInput",dataTestId:a,onChange:()=>{r(),v(!0)},children:(0,Cl.jsx)("span",{className:"text-truncate",children:u.translate("privacyScreen.donateAsOrganization.label")})}),(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!s&&u.translate("privacyScreen.donateAsOrganization.input.tooltipLabel"),trigger:"click",placement:d?"left-start":"right-start",fallbackPlacements:um,maxWidth:"220px",rootContainer:m,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:s,"aria-label":u.translate("privacyScreen.donateAsOrganization.input.helpAriaLabel"),"data-qa":"donate-as-organization-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":d}),"aria-hidden":!0})})})})]}),n.isActive&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8,sizeMin:4}),(0,Cl.jsx)(Kd.t,{id:`on-behalf-${h}`,setRef:A,label:u.translate("privacyScreen.donateAsOrganization.input.label"),labelFloating:!0,autoFocus:n.isActive&&f,autoFocusMode:vd.Q.ALL,className:(0,Ml.A)({"pe-10":p}),formLabelClass:(0,Ml.A)({"pe-6":p}),formGroupClass:"shrink-0",placeholder:u.translate("privacyScreen.donateAsOrganization.input.placeholder"),value:null!==(c=n.companyName)&&void 0!==c?c:"",maxLength:Xh.ON_BEHALF_OF_MAX_LENGTH,autoComplete:"organization",disabled:s,error:p,"aria-required":!0,"aria-describedby":`on-behalf-${h}-error`,dataQa:"behalf-company-field",dataTestId:o,onChange:e=>l(e.target.value),onFocus:()=>E(!0),onBlur:()=>E(!1),children:p&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:S,children:(0,Cl.jsxs)("p",{id:`on-behalf-${h}-error`,children:[g&&u.translate("privacyScreen.donateAsOrganization.input.error.required"),!g&&y&&u.translate("privacyScreen.donateAsOrganization.input.error.minLength")]})})})]})]})},hm=(0,kr.memo)(dm),mm=e=>{var t;const n=(0,Bl.P)(),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,kr.useRef)(null);return(0,Yh.FM)(a,(e=>!e.validation.isAccepted.isValid)),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Fd,{setRef:a,className:e.className,checked:null!==(t=e.termsAndConditions.isAccepted)&&void 0!==t&&t,error:!e.validation.isAccepted.isValid,disabled:e.locked,"aria-required":!0,"aria-describedby":`terms-checkbox-${s}-error`,onChange:e.onToggle,dataQa:"accept-terms-checkbox",trackingElement:"termsChecked",dataTestId:e.dataTestId,children:(0,Cl.jsx)("span",{className:(0,Ml.A)({"text-line-clamp-2":!n}),dir:"auto","data-qa":"accept-terms-text",children:e.termsAndConditions.text?(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:e.termsAndConditions.text},"data-qa":"accept-terms-link"}):(0,Cl.jsx)(fc,{token:"privacyScreen.terms.label"})})}),e.validation.isAccepted.fields.isAccepted.errors.required&&(0,Cl.jsx)("p",{id:`terms-checkbox-${s}-error`,className:"sr-only",children:i.translate("privacyScreen.terms.error.required")})]})},pm=(0,kr.memo)(mm),gm=(0,kr.lazy)((()=>Promise.all([n.e(624),n.e(842)]).then(n.bind(n,8842)))),ym=()=>{const{controller:e,state:t}=Tc(wl.PRIVACY),n=(0,Bl.P)(),i=(0,nc.t)(),s=(0,kr.useId)(),a=$d(t.shakeKey,0!==t.shakeKey),o=t.onBehalfOf.isEnabled||t.showAnonymous||t.termsAndConditions.isEnabled||t.generalConsent.isEnabled,r=(0,Yh.pv)(),l=(0,kr.useCallback)((t=>(0,d.sH)(void 0,void 0,void 0,(function*(){t.preventDefault(),yield e.leave(),r()}))),[e,r]),c=(0,kr.useCallback)((t=>e.changeCustomerTitle(t)),[e]),u=(0,kr.useCallback)((t=>e.changeFirstName(t)),[e]),h=(0,kr.useCallback)((t=>e.changeLastName(t)),[e]),m=(0,kr.useCallback)((t=>{e.clearEmailServerError(),e.changeEmail(t)}),[e]),p=(0,kr.useCallback)((t=>e.changePhone(t)),[e]),g=(0,kr.useCallback)((t=>e.changePlainPhone(t)),[e]),y=(0,kr.useCallback)((t=>e.changeCountryCode(t)),[e]),f=(0,kr.useCallback)((t=>e.changeCompanyName(t)),[e]),v=(0,kr.useCallback)((()=>e.toggleOnBehalfOf()),[e]),S=(0,kr.useCallback)((()=>e.toggleAnonymousChecked()),[e]),E=(0,kr.useCallback)((t=>e.toggleGeneralConsentChecked(t)),[e]),A=(0,kr.useCallback)((()=>e.toggleTermsAndConditionsAccepted()),[e]),C=(0,kr.useCallback)((()=>e.setGeneralConsentShown()),[e]),b=e.isFastTrackEnabled(),P=b?i.translate("privacyScreen.titleFastTrackChoose"):i.translate("privacyScreen.title"),N=(0,kr.useCallback)((t=>e.chooseFastTrackPaymentOptionOrProceedToNextScreen(t)),[e]);return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${s}`,"data-qa":"active-screen-privacy","data-testid":"form",onSubmit:l,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,title:P,titleTestId:"title",a11yAutoFocus:n}),(0,Cl.jsxs)(td,{className:(0,Ml.A)("px-body",{"pt-5":!n&&!b,"pt-8":!n&&b}),children:[b&&(0,Cl.jsxs)("div",{className:"fixed-container shrink-0",children:[(0,Cl.jsx)(jh,{availableOptions:t.availableFastTrackPaymentOptions,buttonOptions:t.fastTrackButtonOptions,disabled:t.locked,onChoosePaymentOption:N}),(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsxs)("div",{className:"p-rel d-flex items-center justify-center","data-qa":"fast-track-or-label",children:[(0,Cl.jsx)("hr",{className:"p-abs centered-left w-100"}),(0,Cl.jsx)("p",{className:"body-40-regular shrink-0 p-rel max-w-100 text-truncate text-gray-80 bg-white px-2-5",children:i.translate("common.or")})]}),(0,Cl.jsx)(bc,{size:24})]}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("fixed-container grow-1 min-h-0 d-flex flex-column",{shake:a}),children:[(0,Cl.jsxs)("div",{className:"group-stacked-vertical shrink-0",children:[(0,Cl.jsxs)("div",{className:"group-stacked-vertical group-stacked-item","data-testid":"privacy-personal-information-container",children:[(0,Cl.jsxs)("div",{className:(0,Ml.A)("group-stacked-item",{"group-stacked-horizontal":t.customerTitle.isEnabled}),children:[t.customerTitle.isEnabled&&(0,Cl.jsx)($h,{className:"group-stacked-item shrink-0",customerTitle:t.customerTitle,locked:t.locked,validation:t.validation,autoFocus:t.autoFocus.customerTitle,dataTestId:"privacy-customer-title-select",onChange:c}),(0,Cl.jsx)(im,{className:(0,Ml.A)({"group-stacked-item":t.customerTitle.isEnabled}),firstName:t.firstName,autoFocus:t.autoFocus.firstName,locked:t.locked,validation:t.validation,dataTestId:"privacy-first-name-input",onChange:u})]}),(0,Cl.jsx)(cm,{className:"group-stacked-item",lastName:t.lastName,locked:t.locked,validation:t.validation,dataTestId:"privacy-last-name-input",onChange:h})]}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("group-stacked-item",{"group-stacked-vertical":t.showPhone}),children:[(0,Cl.jsx)(em,{className:(0,Ml.A)({"group-stacked-item":t.showPhone}),email:t.email,emailConsent:t.emailConsent,locked:t.locked,validation:t.validation,serverError:Boolean(t.serverErrors.email),dataTestId:"privacy-email-input",onChange:m}),t.showPhone&&(0,Cl.jsx)(kr.Suspense,{fallback:(0,Cl.jsx)("span",{"data-testid":"privacy-phone-input-fallback"}),children:(0,Cl.jsx)(gm,{className:(0,Ml.A)({"group-stacked-item":t.showPhone}),phone:t.phone,phoneRequired:t.phoneRequired,userCountryCode:t.userCountryCode,showPhoneLegalText:t.showPhoneLegalText,phoneLegalText:t.phoneLegalText,locked:t.locked,validation:t.validation,isPhoneCountryCodeDisabled:t.isPhoneCountryCodeDisabled,dataTestId:"privacy-phone-input",onChange:p,onChangeCountryCode:y,onChangePlain:g})})]})]}),o&&(0,Cl.jsx)(bc,{size:16,sizeMin:8}),t.onBehalfOf.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(hm,{className:"shrink-0",onBehalfOf:t.onBehalfOf,locked:t.locked,validation:t.validation,dataTestIdCheckbox:"privacy-on-behalf-on-checkbox",dataTestIdInput:"privacy-on-behalf-on-input",onToggleOnBehalfOf:v,onChangeCompanyName:f}),t.onBehalfOf.isActive?(0,Cl.jsx)(bc,{size:16,sizeMin:8}):(0,Cl.jsx)(bc,{size:8,sizeMin:4})]}),t.showAnonymous&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Vh,{className:"shrink-0",anonymousChecked:t.anonymousChecked,locked:t.locked,dataTestId:"privacy-anonymous-checkbox",onToggle:S}),(0,Cl.jsx)(bc,{size:8,sizeMin:4})]}),t.generalConsent.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(om,{className:"shrink-0",generalConsent:t.generalConsent,locked:t.locked,dataTestId:"general-consent-checkbox",onToggle:E,onShowConsent:C}),(0,Cl.jsx)(bc,{size:8,sizeMin:4})]}),t.termsAndConditions.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(pm,{className:"shrink-0",termsAndConditions:t.termsAndConditions,locked:t.locked,validation:t.validation,dataTestId:"privacy-terms-checkbox",onToggle:A}),(0,Cl.jsx)(bc,{size:16,sizeMin:8})]})]})]}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:t.processingState,serverErrors:t.serverErrors,onClick:l,errorTitle:t.payErrorMessage||i.safeTranslate("common.errorOccurredText"),errorMessage:t.additionalPayErrorMessage,dataQa:"privacy-continue",trackingElement:t.isPaymentScreen?"payButton":"nextButton",dataTestId:"pay-button",children:t.isPaymentScreen?th(i,t.donation.formattedAmount,t.donation.frequency):i.translate("privacyScreen.button")})})]})},fm=e=>{const{state:t}=Tc(wl.PRIVACY);return(0,Cl.jsx)(Yh.rp,{state:{validation:t.validation,serverErrors:t.serverErrors},children:(0,Cl.jsx)(ym,Object.assign({},e))})},vm=(0,kr.memo)((({scrollContainerClass:e,children:t,className:n})=>{const[i,s]=(0,kr.useState)(!1),[a,o]=(0,kr.useState)(!1),[r,l]=(0,kr.useState)(!1),[c,u]=(0,kr.useState)(!1),d=(0,kr.useRef)(null),h=i||a||r||c,m=(0,kr.useCallback)((()=>{if(!d.current)return;const e=d.current.clientWidth<d.current.scrollWidth,t=d.current.clientHeight<d.current.scrollHeight,n=Math.ceil(d.current.offsetWidth+d.current.scrollLeft),i=Math.ceil(d.current.offsetHeight+d.current.scrollTop),a=0===d.current.scrollTop,r=n>=d.current.scrollWidth,c=i>=d.current.scrollHeight,h=0===d.current.scrollLeft;s(t&&!a),o(e&&!r),l(t&&!c),u(e&&!h)}),[d]);return(0,kr.useEffect)((()=>{if(!d.current)throw new Error("ScrollContainerRef is undefined");const e=(t=m,new ResizeObserver((e=>e.map(t))));var t;return null==e||e.observe(d.current),()=>null==e?void 0:e.disconnect()}),[d,m]),(0,Cl.jsx)("div",{className:(0,Ec.A)({"ui-scroll-shadow-wrapper":h},n),children:(0,Cl.jsxs)("div",{ref:d,className:(0,Ec.A)("ui-scroll-shadow",e),onScroll:()=>{m()},children:[t,h&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-scroll-shadow-top",{"is-active":i})}),(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-scroll-shadow-right",{"is-active":a})}),(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-scroll-shadow-bottom",{"is-active":r})}),(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-scroll-shadow-left",{"is-active":c})})]})]})})}));var Sm=n(316),Em=n(8994);const Am=(0,kr.createContext)(null);var Cm=n(3429);const bm=e=>{let{id:t,className:n,question:i,answer:s,required:a,hasError:o,type:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),d=(0,kr.useCallback)((()=>{l(!s)}),[l,s]),h=(0,kr.useRef)(null);return(0,Cm.FM)(h,(e=>!!e[t])),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)(Fd,{setRef:h,className:n,checked:!!s,error:o,onChange:d,dataQa:"question-"+r,"aria-required":a,"aria-describedby":`question-${r}-${u}-error`,"data-testid":"question-checkbox-single",children:[(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:i},dir:"auto"}),!a&&(0,Cl.jsxs)("span",{className:"text-gray-60",children:[" (",c.translate("common.optional"),")"]})]}),o&&(0,Cl.jsx)("p",{id:`question-${r}-${u}-error`,className:"sr-only",children:c.translate("questionsScreen.error.required")})]})},Pm=(0,kr.memo)(bm),Nm=e=>{let{question:t,required:n}=e;const i=(0,kr.useId)(),s=(0,nc.t)();return(0,Cl.jsx)(Kd.t,{id:`date-${i}`,type:"text",label:(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:t}}),labelOptional:n?"":s.translate("common.optional"),dataTestId:"question-date",dataQa:"question-date-fallback"})},Dm={marginBottom:"13px"},Tm=e=>{let{id:t,className:n,question:i,answer:s,options:a,required:o,hasError:r,type:l,onChange:c}=e;const u=(0,nc.t)(),d=(0,kr.useId)(),[h,m]=(0,kr.useState)(!1),p=(0,kr.useCallback)((e=>{c(e.target.value)}),[c]),g=a.map((e=>({value:e,label:e}))),y=(0,kr.useRef)(null);return(0,Cm.FM)(y,(e=>!!e[t])),(0,Cl.jsx)(Kh,{setRef:y,id:`dropdown-${d}`,label:(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),labelOptional:o?"":u.translate("common.optional"),options:g,className:(0,Ml.A)({"pe-16":r}),formLabelClass:(0,Ml.A)({"pe-12":r}),formGroupClass:n,error:r,value:s||"","aria-required":o,"aria-describedby":`question-${l}-${d}-error`,onChange:p,onFocus:()=>m(!0),onBlur:()=>m(!1),dataQa:"question-"+l,dataTestId:"question-dropdown",children:r&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-bottom-end z-index-5 me-10",style:Dm,showTooltip:h,children:(0,Cl.jsx)("p",{id:`question-${l}-${d}-error`,children:u.translate("questionsScreen.error.required")})})})},km=(0,kr.memo)(Tm),Im={marginTop:"13px"},_m=e=>{let{id:t,className:n,question:i,answer:s,required:a,hasError:o,type:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),[d,h]=(0,kr.useState)(!1),m=(0,kr.useRef)(null);return(0,Cm.FM)(m,(e=>!!e[t])),(0,Cl.jsxs)("div",{className:n,children:[(0,Cl.jsxs)("label",{htmlFor:`multiline-${u}`,className:"body-60-regular max-w-100","data-qa":"question-"+r+"-label",children:[(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),!a&&(0,Cl.jsxs)("span",{className:"text-gray-60",children:[" (",c.translate("common.optional"),")"]})]}),(0,Cl.jsxs)("div",{className:"p-rel",children:[(0,Cl.jsx)("textarea",{ref:m,id:`multiline-${u}`,className:(0,Ml.A)("form-control mt-3",{"has-error":o}),rows:7,value:s||"",maxLength:Hd.ANSWER_MAX_LENGTH,"aria-required":a,"aria-describedby":`question-${r}-${u}-error`,onChange:e=>{l(e.target.value)},onFocus:()=>h(!0),onBlur:()=>h(!1),"data-qa":"question-"+r,"data-testid":"question-multiline"}),o&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-top-end z-index-5 me-4",style:Im,showTooltip:d,dataQa:"question-multiline",children:(0,Cl.jsx)("p",{id:`question-${r}-${u}-error`,children:c.translate("questionsScreen.error.required")})})]})]})},Om=(0,kr.memo)(_m),xm=e=>{var t,{children:n,setRef:i,innerRef:s,className:a,customLabelClasses:o,checkedValues:r,checkboxValue:l,disabled:c,error:u,hint:h,dataQa:m,onChange:p}=e,g=(0,d.Tt)(e,["children","setRef","innerRef","className","customLabelClasses","checkedValues","checkboxValue","disabled","error","hint","dataQa","onChange"]);const y=null!==(t=null==r?void 0:r.includes(l))&&void 0!==t&&t,f=(0,kr.useCallback)((()=>{if(c)return;const e=!y,t=null!==r?new Set([...r]):new Set;e?t.add(l):t.delete(l),p([...t])}),[p,y,c,r,l]);return(0,Cl.jsx)(Fd,Object.assign({setRef:i,innerRef:s,className:a,customLabelClasses:o,checkboxValue:l,checked:y,disabled:c,error:u,hint:h,onChange:f,dataQa:m},g,{children:n}))},wm=e=>{let{id:t,className:n,question:i,answer:s,options:a,required:o,hasError:r,type:l,onChange:c}=e;const u=(0,nc.t)(),d=(0,kr.useId)(),h=(0,kr.useCallback)((e=>{c(e)}),[c]),m=(0,kr.useRef)(null);return(0,Cm.FM)(m,(e=>!!e[t])),(0,Cl.jsxs)("div",{className:n,role:"group","aria-labelledby":`checkbox-group-${d}`,"data-testid":"question-multioption",children:[(0,Cl.jsxs)("p",{id:`checkbox-group-${d}`,className:"body-60-regular",children:[(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),!o&&(0,Cl.jsxs)("span",{className:"text-gray-60",children:[" (",u.translate("common.optional"),")"]})]}),a.map(((e,t)=>{const n=0===t;return(0,Cl.jsx)(xm,{setRef:n?m:void 0,className:t?"mt-2":"mt-3",checkedValues:s,checkboxValue:e,error:r,"aria-required":o,"aria-describedby":`question-${l}-${d}-error`,onChange:h,dataQa:"question-"+l,children:e},`${e}-${t}`)})),r&&(0,Cl.jsx)("p",{id:`question-${l}-${d}-error`,className:"sr-only",children:u.translate("questionsScreen.error.required")})]})},Rm=(0,kr.memo)(wm),Mm={marginBottom:"13px"},Lm=e=>{let{id:t,className:n,question:i,answer:s,required:a,hasError:o,type:r,onChange:l}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),[d,h]=(0,kr.useState)(!1),m=(0,kr.useRef)(null);return(0,Cm.FM)(m,(e=>!!e[t])),(0,Cl.jsx)(Kd.t,{id:`oneline-${u}`,setRef:m,error:o,className:(0,Ml.A)({"pe-10":o}),formGroupClass:n,label:(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),labelOptional:a?"":c.translate("common.optional"),value:s||"",maxLength:Hd.ANSWER_MAX_LENGTH,"aria-required":a,"aria-describedby":`question-${r}-${u}-error`,onChange:e=>{l(e.target.value)},onFocus:()=>h(!0),onBlur:()=>h(!1),dataQa:"question-"+r,"data-testid":"question-oneline",children:o&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-bottom-end z-index-5 me-4",style:Mm,showTooltip:d,children:(0,Cl.jsx)("p",{id:`question-${r}-${u}-error`,children:c.translate("questionsScreen.error.required")})})})},Fm=(0,kr.memo)(Lm),Um=e=>{var{setRef:t,children:n,className:i,customLabelClasses:s,customInputClasses:a,labelTruncated:o=!0,disabled:r,radioName:l,radioValue:c,checked:u,error:h,hint:m,dataQa:p,trackingElement:g,onChange:y,onClick:f}=e,v=(0,d.Tt)(e,["setRef","children","className","customLabelClasses","customInputClasses","labelTruncated","disabled","radioName","radioValue","checked","error","hint","dataQa","trackingElement","onChange","onClick"]);const S=(0,kr.useRef)(null);return(0,kr.useImperativeHandle)(t,(()=>S.current),[]),(0,Cl.jsxs)("div",{className:(0,Ec.A)("ui-radio",{"ui-radio-disabled":r},i),children:[(0,Cl.jsxs)("label",{className:(0,Ec.A)(["ui-radio-label",s]),"data-qa":p+"-label",children:[(0,Cl.jsxs)("span",{className:"ui-radio-control",children:[(0,Cl.jsx)("input",Object.assign({type:"radio",ref:S,className:(0,Ec.A)("ui-radio-input",{"has-error":h},a),name:l,value:c,checked:u,disabled:r,"aria-invalid":h,"data-qa":p,"data-tracking-element-name":g,onChange:()=>{r||y(c)},onClick:()=>{f&&f()}},v)),(0,Cl.jsx)("span",{className:"ui-radio-icon"})]}),n&&(0,Cl.jsx)("span",{className:(0,Ec.A)("ui-radio-text",{"ui-radio-text-ellipsis":o}),children:n})]}),m&&(0,Cl.jsx)("div",{className:"ui-radio-hint",children:m})]})},jm=e=>{let{className:t,id:n,question:i,answer:s,options:a,required:o,hasError:r,type:l,onChange:c}=e;const u=(0,nc.t)(),d=(0,kr.useId)(),h=(0,kr.useRef)(null);return(0,Cm.FM)(h,(e=>!!e[n])),(0,Cl.jsxs)("div",{className:t,role:"radiogroup","aria-labelledby":`radio-group-${d}`,"data-testid":"question-radio",children:[(0,Cl.jsxs)("p",{id:`radio-group-${d}`,className:"body-60-regular",children:[(0,Cl.jsx)("span",{className:"text-break-word",dir:"auto",dangerouslySetInnerHTML:{__html:i}}),!o&&(0,Cl.jsxs)("span",{className:"text-gray-60",children:[" (",u.translate("common.optional"),")"]})]}),a.map(((e,t)=>{const i=0===t;return(0,Cl.jsx)(Um,{setRef:i?h:void 0,className:t?"mt-2":"mt-3",checked:e===s,radioValue:e,radioName:n,error:r,"aria-required":o,"aria-describedby":`question-${l}-${d}-error`,onChange:c,dataQa:"question-"+l,children:e},`${e}-${t}`)})),r&&(0,Cl.jsx)("p",{id:`question-${l}-${d}-error`,className:"sr-only",children:u.translate("questionsScreen.error.required")})]})},Bm=(0,kr.memo)(jm),Gm=(0,kr.lazy)((()=>Promise.all([n.e(806),n.e(91)]).then(n.bind(n,2091)))),qm=e=>{const{controller:t}=Tc(wl.QUESTIONS),n=Ol(),i=(0,kr.useCallback)((n=>{t.answerQuestion(e.id,n)}),[t,e.id]),s=$d(e.shakeKey,e.hasError);return Object.values(Pd).includes(e.type)?(0,Cl.jsxs)("div",{className:"py-3",children:[Nd(e)&&(0,Cl.jsx)(Pm,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),Dd(e)&&(0,Cl.jsx)(km,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),Td(e)&&(0,Cl.jsx)(Om,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),_d(e)&&(0,Cl.jsx)(Rm,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),Id(e)&&(0,Cl.jsx)(Fm,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),kd(e)&&(0,Cl.jsx)(Bm,{id:e.id,answer:e.answer,options:e.options,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type}),Od(e)&&(0,Cl.jsx)(kr.Suspense,{fallback:(0,Cl.jsx)(Nm,{question:e.question,required:e.required}),children:(0,Cl.jsx)(Gm,{id:e.id,answer:e.answer,question:e.question,required:e.required,hasError:e.hasError,onChange:i,className:(0,Ml.A)({shake:s}),type:e.type})})]}):(n.captureException(new Error(`Unknown type of question: "${e.type}"`)),null)},Vm=(0,kr.memo)(qm),Hm={borderTop:"0"},Km=()=>{const{state:e,controller:t}=Tc(wl.QUESTIONS),n=(0,nc.t)(),i=(0,kr.useId)(),s=(0,Bl.P)(),a=Kl(),o=(0,kr.useRef)(null),r=(0,kr.useRef)(null),[l,c]=(0,kr.useState)("next"),u=(0,Cm.pv)(),d=(0,kr.useContext)(Am)||null,{showProgressBar:h}=jc(),m=(0,kr.useCallback)((e=>{e.preventDefault(),(0,Sm.flushSync)((()=>{c("next")})),t.leave(),u()}),[t,u]),p=(0,kr.useCallback)((()=>{(0,Sm.flushSync)((()=>{c("previous")})),t.back()}),[t]),g=(0,kr.useMemo)((()=>e.isMeasuring?e.questions:e.questions.filter((t=>{let{page:n}=t;return n===e.page}))),[e.isMeasuring,e.page,e.questions]);(0,kr.useEffect)((()=>{if(!e.isMeasuring)return;if(!o.current)throw new Error("bodyRef was not provided");if(!r.current)throw new Error("questionsContainerRef was not provided");const n=[].slice.call(r.current.children),i=o.current.getBoundingClientRect(),a=s||d?455:i.height-20;setTimeout((()=>{var e;const i=t.completeMeasurement(function(e){const{height:t,children:n}=e,i=new Map;let s=1,a=0;return n.map((e=>e.offsetHeight)).forEach(((e,n)=>{a+e>t&&n>0&&(s+=1,a=0),a+=e,i.set(n,s)})),i}({height:a,children:n}));d&&(null===(e=d.updateQuestionsScreenPageCount)||void 0===e||e.call(d,i))}))}),[e.isMeasuring,s,t,r,d]);const y=(0,kr.useCallback)((e=>kr.cloneElement(e,{classNames:`rtg-${l}`})),[l]),f={minHeight:s?"200px":void 0};return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${i}`,"data-testid":"questions-form",onSubmit:m,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${i}`,title:n.translate("questionsScreen.title"),backButtonClickHandler:p,forceShowBackButton:t.showBackButton.header,a11yAutoFocus:!0}),(0,Cl.jsx)(td,{ref:o,children:(0,Cl.jsx)(Em.A,{childFactory:y,children:(()=>{const t=(0,kr.createRef)();return(0,Cl.jsx)(Ll.A,{classNames:`rtg-${l}`,nodeRef:t,addEndListener:e=>{Jl(t,e)},mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)("div",{ref:t,className:a("flow-slide"),style:Hm,children:(0,Cl.jsx)(vm,{className:(0,Ml.A)(s?"grow-1":"h-100"),scrollContainerClass:(0,Ml.A)("px-body",s?"my-minus-3":"h-100",{"pt-8":!s}),children:(0,Cl.jsx)("div",{ref:r,className:(0,Ml.A)("fixed-container",{"opacity-0":e.isMeasuring,"my-minus-3":!s}),style:f,children:g.map(((t,n)=>(0,Cl.jsx)(Vm,{id:t.key,type:t.type,answer:t.answer,options:t.options,question:t.question,required:t.required,hasError:!!e.questionErrors[t.key],shakeKey:e.shakeKey},t.key)))})})})},s||e.isShowcase||h?null:e.page)})()})}),(0,Cl.jsx)(gd,{className:(0,Ml.A)({"pt-7":!s}),backButtonClickHandler:p,forceShowBackButton:t.showBackButton.footer,children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:Xl.IDLE,dataQa:"questions-button",trackingElement:"nextButton",children:n.translate("questionsScreen.button")})})]})},Ym=(0,kr.memo)(Km),zm=()=>{const{state:e}=Tc(wl.QUESTIONS);return(0,Cl.jsx)(Cm.rp,{state:e.questionErrors,children:(0,Cl.jsx)(Ym,{})})},Wm=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":e.ariaHidden&&!0,fill:"none",height:null!==(t=e.height)&&void 0!==t?t:80,viewBox:"0 0 80 80",width:null!==(n=e.width)&&void 0!==n?n:80,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"61.5195",width:"68.5254",x:"6",y:"8.5",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"2.8107"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.7875 0 0 0 0 0.85975 0 0 0 0 1 0 0 0 0.24 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_248_1821"})]}),(0,Cl.jsxs)("filter",{id:`b-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"65.9294",width:"70.8122",x:"5.14271",y:"7.91224",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_248_1821",stdDeviation:"2.747"})]}),(0,Cl.jsxs)("filter",{id:`c-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"24.9624",width:"28.6284",x:"9.07347",y:"9.62816",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_248_1821",stdDeviation:"2.44178"})]}),(0,Cl.jsxs)("filter",{id:`d-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"43.3417",width:"56.1601",x:"12.4698",y:"31.1026",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_248_1821",stdDeviation:"3.05223"})]}),(0,Cl.jsxs)("radialGradient",{id:`e-${i}`,cx:"0",cy:"0",gradientTransform:"matrix(24.7229859 44.86886612 -67.71805502 37.31301155 21.6271 25.9168)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ff4747"}),(0,Cl.jsx)("stop",{offset:".621322",stopColor:"#e60202"}),(0,Cl.jsx)("stop",{offset:".962109",stopColor:"#ff4040"})]}),(0,Cl.jsxs)("linearGradient",{id:`f-${i}`,gradientUnits:"userSpaceOnUse",x1:"15.9153",x2:"33.2743",y1:"13.4062",y2:"50.0842",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffaeae"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ff4040",stopOpacity:"0"})]}),(0,Cl.jsxs)("radialGradient",{id:`g-${i}`,cx:"0",cy:"0",gradientTransform:"matrix(19.40170475 9.13574724 -3.49178952 7.41555864 24.9016 22.4695)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`h-${i}`,gradientUnits:"userSpaceOnUse",x1:"51.5894",x2:"42.6758",y1:"66.766",y2:"15.4326",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ff5252"}),(0,Cl.jsx)("stop",{offset:".518422",stopColor:"#e60202"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ff5252",stopOpacity:"0"})]}),(0,Cl.jsx)("g",{filter:`url(#a-${i})`,children:(0,Cl.jsx)("path",{d:"m37.3622 69.2005c1.7421 1.0931 4.0584 1.0931 5.8005 0 59.2853-37.1981 20.5641-78.53995-2.9003-52.5752-23.4643-25.96504-62.1856 15.3768-2.9002 52.5752z",fill:`url(#e-${i})`})}),(0,Cl.jsx)("g",{filter:`url(#b-${i})`,children:(0,Cl.jsx)("path",{d:"m40.5485 68.3463c55.3668-33.1004 20.8103-70.99196 0-47.7941-20.8103-23.19812-55.3667 14.6935 0 47.7941z",fill:`url(#f-${i})`})}),(0,Cl.jsx)("g",{filter:`url(#c-${i})`,opacity:".5",children:(0,Cl.jsx)("path",{d:"m32.5907 20.1894c.2684-.3893.3123-.8798.062-1.281-1.6815-2.6952-8.0251-6.4401-11.3305-3.0477-.0606.0622-.1255.124-.1925.1793-3.3897 2.7972-5.3696 6.1192-7.025 9.935-.508 1.1709.3605 2.4626 1.6329 2.5621 2.3377.1828 4.6623.5588 6.9308 1.1238.1549.0386.3148.064.4702.0275 2.1821-.5125 7.8492-7.1733 9.4521-9.499z",fill:`url(#g-${i})`,fillOpacity:".5"})}),(0,Cl.jsx)("g",{filter:`url(#d-${i})`,opacity:".6",children:(0,Cl.jsx)("path",{d:"m40.5502 68.3397c35.3589-20.8074 20.799-36.5915 6.3451-29.345-3.8981 1.9543-8.792 1.9543-12.6901 0-14.4539-7.2467-29.01388 8.5374 6.345 29.345z",fill:`url(#h-${i})`})})]})},$m=(0,kr.memo)(Wm),Xm=e=>{let{className:t,shouldAnimate:n}=e;return(0,Cl.jsx)("div",{className:(0,Ml.A)("beating-heart",t),"aria-hidden":!0,"data-qa":"beating-heart-icon",children:(0,Cl.jsx)($m,{className:(0,Ml.A)({"beating-heart-beat":n})})})},Qm=(0,kr.memo)(Xm);var Zm,Jm,ep,tp,np,ip,sp,ap,op,rp,lp,cp,up,dp,hp;function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mp.apply(null,arguments)}var pp,gp,yp=function(e,t){return kr.createElement("svg",mp({width:80,height:80,viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),kr.createElement("mask",{id:"mask0_248_1829",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:7,y:9,width:66,height:68},Zm||(Zm=kr.createElement("path",{d:"M38.054 9.94859L10.5577 24.2155C8.42711 25.321 7.08984 27.5215 7.08984 29.9218V58.3464C7.08984 60.4571 8.2768 62.3885 10.1599 63.3419L34.0584 75.4414C37.8326 77.3523 42.2917 77.3494 46.0635 75.4338L69.8685 63.3436C71.7481 62.3889 72.9322 60.4595 72.9322 58.3513V29.9161C72.9322 27.5188 71.5982 25.3206 69.4717 24.2137L42.0704 9.95118C40.812 9.29615 39.3133 9.29518 38.054 9.94859Z",fill:"url(#paint0_linear_248_1829)"}))),kr.createElement("g",{mask:"url(#mask0_248_1829)"},Jm||(Jm=kr.createElement("path",{d:"M38.054 9.94859L10.5577 24.2155C8.42711 25.321 7.08984 27.5215 7.08984 29.9218V58.3464C7.08984 60.4571 8.2768 62.3885 10.1599 63.3419L34.0584 75.4414C37.8326 77.3523 42.2917 77.3494 46.0635 75.4338L69.8685 63.3436C71.7481 62.3889 72.9322 60.4595 72.9322 58.3513V29.9161C72.9322 27.5188 71.5982 25.3206 69.4717 24.2137L42.0704 9.95118C40.812 9.29615 39.3133 9.29518 38.054 9.94859Z",fill:"url(#paint1_linear_248_1829)"})),ep||(ep=kr.createElement("g",{filter:"url(#filter0_f_248_1829)"},kr.createElement("path",{d:"M38.054 9.94859L10.5577 24.2155C8.42711 25.321 7.08984 27.5215 7.08984 29.9218V58.3464C7.08984 60.4571 8.2768 62.3885 10.1599 63.3419L34.0584 75.4414C37.8326 77.3523 42.2917 77.3494 46.0635 75.4338L69.8685 63.3436C71.7481 62.3889 72.9322 60.4595 72.9322 58.3513V29.9161C72.9322 27.5188 71.5982 25.3206 69.4717 24.2137L42.0704 9.95118C40.8119 9.29615 39.3133 9.29518 38.054 9.94859Z",fill:"url(#paint2_linear_248_1829)"}),kr.createElement("path",{d:"M38.054 9.94859L10.5577 24.2155C8.42711 25.321 7.08984 27.5215 7.08984 29.9218V58.3464C7.08984 60.4571 8.2768 62.3885 10.1599 63.3419L34.0584 75.4414C37.8326 77.3523 42.2917 77.3494 46.0635 75.4338L69.8685 63.3436C71.7481 62.3889 72.9322 60.4595 72.9322 58.3513V29.9161C72.9322 27.5188 71.5982 25.3206 69.4717 24.2137L42.0704 9.95118C40.8119 9.29615 39.3133 9.29518 38.054 9.94859Z",fill:"url(#paint3_linear_248_1829)"}))),kr.createElement("g",{filter:"url(#filter1_f_248_1829)"},kr.createElement("path",{d:"M73.0352 61.8106L42.5507 77.3392V44.1341L73.0352 28.6055V61.8106Z",fill:"url(#paint4_linear_248_1829)",style:{mixBlendMode:"lighten"}})),kr.createElement("g",{filter:"url(#filter2_f_248_1829)"},kr.createElement("path",{d:"M7.91992 60.74L39.0266 76.09V43.9661L7.91992 29.2305V60.74Z",fill:"url(#paint5_linear_248_1829)",style:{mixBlendMode:"color"}})),tp||(tp=kr.createElement("path",{d:"M61.9336 64.584C61.9336 64.5975 61.937 67.2722 60.9639 67.8662L59.5068 68.6084C56.9117 69.9199 51.6758 72.5684 51.6758 72.5684C51.6758 72.5684 52.7119 71.9785 52.7119 68.835V36.2041L61.9336 31.5078V64.584Z",fill:"url(#paint6_linear_248_1829)"})),kr.createElement("path",{d:"M61.9336 64.584C61.9336 64.5975 61.937 67.2722 60.9639 67.8662L59.5068 68.6084C56.9117 69.9199 51.6758 72.5684 51.6758 72.5684C51.6758 72.5684 52.7119 71.9785 52.7119 68.835V36.2041L61.9336 31.5078V64.584Z",fill:"url(#paint7_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),kr.createElement("path",{d:"M17.873 64.584C17.873 64.5975 17.8696 67.2722 18.8428 67.8662L20.2998 68.6084C22.8949 69.9199 28.1309 72.5684 28.1309 72.5684C28.1309 72.5684 27.0947 71.9785 27.0947 68.835V36.2041L17.873 31.5078V64.584Z",fill:"url(#paint8_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),np||(np=kr.createElement("path",{d:"M17.873 64.584C17.873 64.5975 17.8696 67.2722 18.8428 67.8662L20.2998 68.6084C22.8949 69.9199 28.1309 72.5684 28.1309 72.5684C28.1309 72.5684 27.0947 71.9785 27.0947 68.835V36.2041L17.873 31.5078V64.584Z",fill:"url(#paint9_linear_248_1829)"}))),ip||(ip=kr.createElement("g",{filter:"url(#filter3_d_248_1829)"},kr.createElement("path",{d:"M5.43164 26.5733V31.8164C5.43164 32.5867 5.85863 33.2936 6.54048 33.652L33.577 47.8646C37.4433 49.897 42.062 49.897 45.9282 47.8646L72.9648 33.652C73.6466 33.2936 74.0736 32.5867 74.0736 31.8164V26.5733C74.0736 24.1907 72.7559 22.0036 70.6497 20.89L41.7881 5.63085C40.5146 4.95756 38.9906 4.95756 37.7171 5.63085L8.85559 20.89C6.74931 22.0036 5.43164 24.1907 5.43164 26.5733Z",fill:"url(#paint10_linear_248_1829)"}))),sp||(sp=kr.createElement("g",{filter:"url(#filter4_f_248_1829)"},kr.createElement("path",{d:"M40.3035 43.2293L73.2085 26.113C73.2336 24.0394 72.9206 22.8266 70.9633 21.766L37.1408 38.9395C39.6292 38.9696 40.3161 42.1925 40.3035 43.2293Z",fill:"url(#paint11_linear_248_1829)",fillOpacity:.4}))),ap||(ap=kr.createElement("g",{filter:"url(#filter5_f_248_1829)"},kr.createElement("path",{d:"M40.2275 43.0775L6.71099 27.192C6.6091 25.1207 6.87692 23.8972 8.79362 22.7648L43.2291 38.6734C40.7435 38.7957 40.1765 42.0418 40.2275 43.0775Z",fill:"url(#paint12_linear_248_1829)"}))),op||(op=kr.createElement("g",{filter:"url(#filter6_f_248_1829)"},kr.createElement("path",{d:"M48.1504 45.8221L46.4952 46.7548C42.4911 49.0113 37.6046 49.0355 33.5783 46.8189L31.7676 45.8221L32.3897 36.5938L34.3026 37.4994C37.939 39.2212 42.1602 39.2004 45.7795 37.4429L47.5283 36.5938L48.1504 45.8221Z",fill:"url(#paint13_linear_248_1829)",fillOpacity:.7}))),kr.createElement("mask",{id:"mask1_248_1829",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:5,y:5,width:70,height:45},rp||(rp=kr.createElement("path",{d:"M5.43164 26.5733V31.8164C5.43164 32.5867 5.85863 33.2936 6.54048 33.652L33.577 47.8646C37.4433 49.897 42.062 49.897 45.9282 47.8646L72.9648 33.652C73.6466 33.2936 74.0736 32.5867 74.0736 31.8164V26.5733C74.0736 24.1907 72.7559 22.0036 70.6497 20.89L41.7881 5.63085C40.5146 4.95756 38.9906 4.95756 37.7171 5.63085L8.85559 20.89C6.74931 22.0036 5.43164 24.1907 5.43164 26.5733Z",fill:"url(#paint14_linear_248_1829)"}))),kr.createElement("g",{mask:"url(#mask1_248_1829)"},kr.createElement("g",{filter:"url(#filter7_f_248_1829)"},kr.createElement("path",{d:"M40.517 5.62525C40.2199 5.47305 39.8678 5.47313 39.5708 5.62549L9.71807 20.941C8.96665 21.3265 8.96663 22.4006 9.71804 22.7861L39.5901 38.113C39.8872 38.2654 40.2396 38.2654 40.5368 38.113L70.4078 22.7867C71.1594 22.401 71.1591 21.3266 70.4073 20.9414L40.517 5.62525Z",fill:"url(#paint15_linear_248_1829)",style:{mixBlendMode:"color"}}))),lp||(lp=kr.createElement("path",{d:"M46.3498 21.0605C49.3832 22.6276 52.3521 24.1672 54.8908 25.5C59.0383 27.6774 63.1856 28.7148 63.1857 34.7285C63.1857 36.8021 63.3935 38.5649 62.1496 39.3945C61.6519 39.7264 52.8496 44.2324 52.8381 44.2383C52.8421 44.2362 53.9571 43.6726 53.9572 40.5352C53.9572 36.5956 53.6024 34.1835 50.8469 32.6553C47.5117 30.8055 43.6158 28.7214 39.7063 26.6641C35.7972 28.7211 31.9013 30.8048 28.5666 32.6543C25.8114 34.1826 25.4563 36.5948 25.4563 40.5342C25.4563 43.6774 26.6652 44.2383 26.6652 44.2383C26.6652 44.2383 17.7629 39.7256 17.2648 39.3936C16.0208 38.564 16.2277 36.8012 16.2277 34.7275C16.2279 28.7142 20.3754 27.6772 24.5227 25.5C26.4794 24.4727 28.6882 23.3185 30.9816 22.1211C30.8981 22.078 30.8148 22.035 30.7316 21.9922L38.801 18.0449C39.7258 17.5637 40.634 17.0909 41.5148 16.6328L46.3498 21.0605Z",fill:"url(#paint16_linear_248_1829)"})),kr.createElement("path",{d:"M46.3498 21.0605C49.3832 22.6276 52.3521 24.1672 54.8908 25.5C59.0383 27.6774 63.1856 28.7148 63.1857 34.7285C63.1857 36.8021 63.3935 38.5649 62.1496 39.3945C61.6519 39.7264 52.8496 44.2324 52.8381 44.2383C52.8421 44.2362 53.9571 43.6726 53.9572 40.5352C53.9572 36.5956 53.6024 34.1835 50.8469 32.6553C47.5117 30.8055 43.6158 28.7214 39.7063 26.6641C35.7972 28.7211 31.9013 30.8048 28.5666 32.6543C25.8114 34.1826 25.4563 36.5948 25.4563 40.5342C25.4563 43.6774 26.6652 44.2383 26.6652 44.2383C26.6652 44.2383 17.7629 39.7256 17.2648 39.3936C16.0208 38.564 16.2277 36.8012 16.2277 34.7275C16.2279 28.7142 20.3754 27.6772 24.5227 25.5C26.4794 24.4727 28.6882 23.3185 30.9816 22.1211C30.8981 22.078 30.8148 22.035 30.7316 21.9922L38.801 18.0449C39.7258 17.5637 40.634 17.0909 41.5148 16.6328L46.3498 21.0605Z",fill:"url(#paint17_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),kr.createElement("g",{style:{mixBlendMode:"plus-darker"},filter:"url(#filter8_f_248_1829)"},kr.createElement("path",{d:"M61.5993 16.0296C56.3917 14.9131 50.8638 18.5962 47.1174 21.0922C45.7642 21.9937 46.1091 20.3325 44.1982 19.2316C43.1711 18.6399 41.693 18.4146 40.8815 18.4146C40.07 18.4146 37.8255 18.2436 36.4532 18.4145C35.0537 18.5887 34.8786 18.4139 33.6285 19.2316C32.2417 20.1388 31.8926 20.4743 30.8038 19.749C27.0574 17.253 22.164 15.1186 16.9565 16.2352C11.3626 17.4346 10.3584 23.2222 12.0348 25.1411C13.4238 26.7311 23.1366 27.2575 34.5699 23.2222C35.0606 23.6029 35.2553 25.2399 37.2602 25.2399H41.9681C43.1715 25.2399 43.591 23.7252 43.9857 23.2222C56.0916 27.2575 65.5073 26.1459 66.8524 24.5673C68.5716 22.5497 67.1933 17.229 61.5993 16.0296Z",fill:"#5200AE",fillOpacity:.2,style:{mixBlendMode:"plus-darker"}})),cp||(cp=kr.createElement("path",{d:"M17.2569 4.11946C25.3389 0.902245 34.1556 18.1143 36.5881 18.1141V22.8621C18.8723 25.2361 12.0603 22.9758 11.3795 21.492C10.3565 19.7115 11.3797 6.45908 17.2569 4.11946Z",fill:"url(#paint18_linear_248_1829)"})),kr.createElement("path",{d:"M17.2569 4.11946C25.3389 0.902245 34.1556 18.1143 36.5881 18.1141V22.8621C18.8723 25.2361 12.0603 22.9758 11.3795 21.492C10.3565 19.7115 11.3797 6.45908 17.2569 4.11946Z",fill:"url(#paint19_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),up||(up=kr.createElement("path",{d:"M61.2998 4.11946C53.2177 0.902245 44.401 18.1143 41.9686 18.1141V22.8621C59.6844 25.2361 66.4963 22.9758 67.1772 21.492C68.2002 19.7115 67.177 6.45908 61.2998 4.11946Z",fill:"url(#paint20_linear_248_1829)"})),kr.createElement("path",{d:"M61.2998 4.11946C53.2177 0.902245 44.401 18.1143 41.9686 18.1141V22.8621C59.6844 25.2361 66.4963 22.9758 67.1772 21.492C68.2002 19.7115 67.177 6.45908 61.2998 4.11946Z",fill:"url(#paint21_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),kr.createElement("path",{d:"M36.8575 18.3108C34.4283 18.311 25.3539 1.09985 17.2826 4.09143C12.1463 6.4848 31.4496 19.3488 36.8575 18.3108Z",fill:"url(#paint22_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),kr.createElement("path",{d:"M41.1924 18.8257C43.6216 18.8259 53.2035 0.83794 61.2749 4.12868C66.4112 6.76138 46.6002 19.9675 41.1924 18.8257Z",fill:"url(#paint23_linear_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),dp||(dp=kr.createElement("path",{d:"M34.2785 17.3696C34.3979 16.0778 35.5116 15.1523 36.8089 15.1523C38.6088 15.1523 40.8532 15.1523 42.4806 15.1524C43.7505 15.1524 44.8493 16.0409 44.9984 17.302C45.3166 19.9934 45.4173 24.2551 42.8632 24.2551C39.1304 24.2551 39.9799 24.2551 36.4345 24.2551C34.0287 24.2551 34.0294 20.0641 34.2785 17.3696Z",fill:"url(#paint24_linear_248_1829)"})),kr.createElement("path",{d:"M34.2785 17.3696C34.3979 16.0778 35.5116 15.1523 36.8089 15.1523C38.6088 15.1523 40.8532 15.1523 42.4806 15.1524C43.7505 15.1524 44.8493 16.0409 44.9984 17.302C45.3166 19.9934 45.4173 24.2551 42.8632 24.2551C39.1304 24.2551 39.9799 24.2551 36.4345 24.2551C34.0287 24.2551 34.0294 20.0641 34.2785 17.3696Z",fill:"url(#paint25_radial_248_1829)",fillOpacity:.15,style:{mixBlendMode:"plus-darker"}}),hp||(hp=kr.createElement("defs",null,kr.createElement("filter",{id:"filter0_f_248_1829",x:5.41083,y:7.78193,width:69.1998,height:70.7682,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:.839506,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter1_f_248_1829",x:38.5691,y:24.6238,width:38.4477,height:56.6977,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.99082,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter2_f_248_1829",x:3.93827,y:25.2488,width:39.0707,height:54.8227,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.99082,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter3_d_248_1829",x:4.39475,y:4.71024,width:70.7164,height:46.3394,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),kr.createElement("feOffset",{dy:.622133}),kr.createElement("feGaussianBlur",{stdDeviation:.518444}),kr.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),kr.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.243137 0 0 0 0 0.254902 0 0 0 0 1 0 0 0 0.4 0"}),kr.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_248_1829"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_248_1829",result:"shape"})),kr.createElement("filter",{id:"filter4_f_248_1829",x:35.0668,y:19.6918,width:40.2159,height:25.6124,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.03689,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter5_f_248_1829",x:4.61958,y:20.6918,width:40.6827,height:24.4601,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.03689,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter6_f_248_1829",x:29.6938,y:34.52,width:20.5304,height:16.0186,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.03689,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter7_f_248_1829",x:6.20954,y:2.56696,width:67.7059,height:38.6044,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.47238,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("filter",{id:"filter8_f_248_1829",x:8.60864,y:13.134,width:61.6265,height:15.8804,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},kr.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),kr.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),kr.createElement("feGaussianBlur",{stdDeviation:1.3451,result:"effect1_foregroundBlur_248_1829"})),kr.createElement("linearGradient",{id:"paint0_linear_248_1829",x1:56.5482,y1:74.9645,x2:27.8848,y2:19.568,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#9F0000"}),kr.createElement("stop",{offset:.59302,stopColor:"#E10000"})),kr.createElement("linearGradient",{id:"paint1_linear_248_1829",x1:56.5482,y1:74.9645,x2:27.8848,y2:19.568,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#3E41FF"}),kr.createElement("stop",{offset:.59302,stopColor:"#877DF7"})),kr.createElement("linearGradient",{id:"paint2_linear_248_1829",x1:26.4185,y1:70.9023,x2:50.6161,y2:19.2974,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#584EEA"}),kr.createElement("stop",{offset:.0278224,stopColor:"#584EEA",stopOpacity:0}),kr.createElement("stop",{offset:.895,stopColor:"#584EEA",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint3_linear_248_1829",x1:59.2581,y1:68.6801,x2:35.6043,y2:20.001,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#362BE7",stopOpacity:.8}),kr.createElement("stop",{offset:.0371922,stopColor:"#584EEA",stopOpacity:0}),kr.createElement("stop",{offset:.62,stopColor:"#584EEA",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint4_linear_248_1829",x1:68.7111,y1:60.0883,x2:48.8727,y2:40.1978,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#0C14E4",stopOpacity:.7}),kr.createElement("stop",{offset:1,stopColor:"#8385FF",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint5_linear_248_1829",x1:37.0362,y1:71.1503,x2:1.12055,y2:38.3657,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#A1BCFF",stopOpacity:.7}),kr.createElement("stop",{offset:1,stopColor:"#A8C1FE",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint6_linear_248_1829",x1:52.8824,y1:36.2135,x2:58.7659,y2:87.3144,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF9FE2"})),kr.createElement("linearGradient",{id:"paint7_linear_248_1829",x1:40.6782,y1:41.3582,x2:56.8055,y2:72.5679,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.295,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.499667,stopColor:"#FF78D7",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint8_linear_248_1829",x1:39.1285,y1:41.3582,x2:23.0012,y2:72.5679,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.295,stopColor:"#FF85DB"}),kr.createElement("stop",{offset:.499667,stopColor:"#FF78D7",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint9_linear_248_1829",x1:26.9243,y1:36.2135,x2:21.0407,y2:87.3144,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF9FE2"})),kr.createElement("linearGradient",{id:"paint10_linear_248_1829",x1:61.2341,y1:44.7326,x2:42.1931,y2:5.00786,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#3E41FF"}),kr.createElement("stop",{offset:.3,stopColor:"#5D5FFF"}),kr.createElement("stop",{offset:.59302,stopColor:"#898AFF"})),kr.createElement("linearGradient",{id:"paint11_linear_248_1829",x1:59.4538,y1:36.6972,x2:54.6841,y2:27.4689,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"white",stopOpacity:0}),kr.createElement("stop",{offset:.502191,stopColor:"#7A44FF",stopOpacity:.4}),kr.createElement("stop",{offset:1,stopColor:"white",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint12_linear_248_1829",x1:21.7362,y1:35.0686,x2:24.9415,y2:28.4744,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"white",stopOpacity:0}),kr.createElement("stop",{offset:.503023,stopColor:"#A1BCFF",stopOpacity:.5}),kr.createElement("stop",{offset:1,stopColor:"white",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint13_linear_248_1829",x1:47.5283,y1:44.2388,x2:31.975,y2:44.2388,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"white",stopOpacity:0}),kr.createElement("stop",{offset:.503023,stopColor:"#A1BCFF",stopOpacity:.7}),kr.createElement("stop",{offset:1,stopColor:"white",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint14_linear_248_1829",x1:56.9929,y1:48.7576,x2:42.9365,y2:6.43309,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#8385F9"}),kr.createElement("stop",{offset:.3,stopColor:"#B991FF"}),kr.createElement("stop",{offset:.59302,stopColor:"#D581F1"})),kr.createElement("linearGradient",{id:"paint15_linear_248_1829",x1:39.9992,y1:5.47251,x2:25.0131,y2:16.2613,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#A4BEFF",stopOpacity:.7}),kr.createElement("stop",{offset:1,stopColor:"#A1BCFF",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint16_linear_248_1829",x1:50.6158,y1:44.4556,x2:60.5892,y2:7.06824,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF9FE2"})),kr.createElement("linearGradient",{id:"paint17_linear_248_1829",x1:-27.4087,y1:21.5168,x2:-26.7712,y2:45.9713,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.243422,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.619079,stopColor:"#FF78D7",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint18_linear_248_1829",x1:14.0374,y1:6.03106,x2:14.6148,y2:31.4609,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF56CC"})),kr.createElement("linearGradient",{id:"paint19_linear_248_1829",x1:34.6062,y1:29.9171,x2:42.096,y2:8.50557,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.295,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.775,stopColor:"#FF78D7",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint20_linear_248_1829",x1:64.5193,y1:6.03106,x2:63.9418,y2:31.4609,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF56CC"})),kr.createElement("linearGradient",{id:"paint21_linear_248_1829",x1:43.9504,y1:29.9171,x2:36.4606,y2:8.50557,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.295,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.715,stopColor:"#FF78D7",stopOpacity:0})),kr.createElement("linearGradient",{id:"paint22_linear_248_1829",x1:-5.48754,y1:7.25144,x2:-4.19679,y2:21.2197,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.0428352,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.935943,stopColor:"#A40073"})),kr.createElement("linearGradient",{id:"paint23_linear_248_1829",x1:64.6919,y1:1.27575,x2:67.8375,y2:12.6963,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.0428352,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:.935943,stopColor:"#A40073"})),kr.createElement("linearGradient",{id:"paint24_linear_248_1829",x1:35.4645,y1:16.1956,x2:35.7378,y2:27.6678,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFD345"}),kr.createElement("stop",{offset:.435,stopColor:"#FFBD89"}),kr.createElement("stop",{offset:1,stopColor:"#FF9FE2"})),kr.createElement("radialGradient",{id:"paint25_radial_248_1829",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(39.5051 26.7086) rotate(-91.9979) scale(21.2475 14.2433)"},kr.createElement("stop",{offset:.295,stopColor:"#FF00B3"}),kr.createElement("stop",{offset:1,stopColor:"#FF78D7",stopOpacity:0})))))},fp=(0,kr.forwardRef)(yp),vp=(0,kr.memo)(fp);function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Sp.apply(null,arguments)}var Ep=function(e,t){return kr.createElement("svg",Sp({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),pp||(pp=kr.createElement("path",{d:"M12 0L14.5456 9.45442L24 12L14.5456 14.5456L12 24L9.45442 14.5456L0 12L9.45442 9.45442L12 0Z",fill:"url(#bouncing-gift-start-gradient)"})),gp||(gp=kr.createElement("defs",null,kr.createElement("linearGradient",{id:"bouncing-gift-start-gradient",x1:7.5,y1:17,x2:17,y2:6.5,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{stopColor:"#FFB900"}),kr.createElement("stop",{offset:1,stopColor:"#FFE55E"})))))},Ap=(0,kr.forwardRef)(Ep),Cp=(0,kr.memo)(Ap);const bp=e=>{let{className:t,shouldAnimate:n}=e;return(0,Cl.jsxs)("div",{className:(0,Ml.A)("bouncing-gift p-rel",t),"aria-hidden":!0,"data-qa":"bouncing-gift-icon",children:[(0,Cl.jsx)(vp,{className:(0,Ml.A)({"bouncing-gift-bounce":n})}),(0,Cl.jsx)(Cp,{className:(0,Ml.A)("bouncing-gift-star p-abs inset-bottom-start ms-minus-0-5 mb-2 z-index-1",{"bouncing-gift-star-bounce bouncing-gift-star-1-bounce":n})}),(0,Cl.jsx)(Cp,{className:(0,Ml.A)("bouncing-gift-star p-abs inset-top-end me-1 mt-minus-2 z-index-1",{"bouncing-gift-star-bounce bouncing-gift-star-2-bounce":n})})]})},Pp=(0,kr.memo)(bp);var Np=n(1253),Dp=n.n(Np);const Tp=e=>{let{className:t,shouldAnimate:n}=e;return(0,Cl.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"150",height:"150",viewBox:"0 0 150 150",fill:"none",className:(0,Ml.A)({"confetti-curves-bounce":n},t),children:[(0,Cl.jsx)("g",{className:"orange-wave-wrap",children:(0,Cl.jsx)("path",{className:"orange-wave",d:"M792.5 92.8804C749.91 178.05 707.33 178.05 664.74 92.8804C622.15 7.71043 579.57 7.71043 536.98 92.8804C494.39 178.05 451.81 178.05 409.22 92.8804C366.63 7.71043 324.05 7.71043 281.46 92.8804C238.87 178.05 196.29 178.05 153.7 92.8804",stroke:"#FF8B66",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"950",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{className:"orange-wave-wrap-final",children:(0,Cl.jsx)("path",{className:"orange-wave-final",d:"M792.5 92.8804C749.91 178.05 707.33 178.05 664.74 92.8804C622.15 7.71043 579.57 7.71043 536.98 92.8804C494.39 178.05 451.81 178.05 409.22 92.8804C366.63 7.71043 324.05 7.71043 281.46 92.8804C238.87 178.05 196.29 178.05 153.7 92.8804",stroke:"#FF8B66",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"950",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(123, 118) rotate(234) scale(0.075)",children:(0,Cl.jsx)("path",{className:"red-spiral",d:"M670.9 3.9502C692.71 162.58 422.44 386.09 232.04 291.51C105.6 228.7 234.74 103.94 305.91 190.7C377.07 277.46 223.9 500.17 7.28003 444.09",stroke:"#E74A6D",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"1350",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(123, 118) rotate(234) scale(0.075)",children:(0,Cl.jsx)("path",{className:"red-spiral-final",d:"M670.9 3.9502C692.71 162.58 422.44 386.09 232.04 291.51C105.6 228.7 234.74 103.94 305.91 190.7C377.07 277.46 223.9 500.17 7.28003 444.09",stroke:"#E74A6D",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"1350",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(43, 41) rotate(29) scale(0.075, -0.075)",children:(0,Cl.jsx)("path",{className:"purple-line",d:"M561.88 6.57031C512.52 218.64 180.6 518.81 23.72 295.91",stroke:"#6767F5",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"740",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(43, 41) rotate(29) scale(0.075, -0.075)",children:(0,Cl.jsx)("path",{className:"purple-line-final",d:"M561.88 6.57031C512.52 218.64 180.6 518.81 23.72 295.91",stroke:"#6767F5",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"740",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(65, 100) rotate(0) scale(0.075)",children:(0,Cl.jsx)("path",{className:"purple-wave",d:"M204.15 24.4502C204.15 24.4502 56.3 118.75 32.47 273.17C-11.85 560.45 383.07 -168.85 378.86 304.12C376.15 608.45 596.15 -159.55 745 420.28",stroke:"#6767F5",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"1570",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(35, 70) rotate(-120) scale(0.075)",children:(0,Cl.jsx)("path",{className:"red-wave",d:"M204.15 24.4502C204.15 24.4502 56.3 118.75 32.47 273.17C-11.85 560.45 383.07 -168.85 378.86 304.12C376.15 608.45 596.15 -159.55 745 420.28",stroke:"#E74A6D",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"1570",strokeDashoffset:"0",fill:"none"})}),(0,Cl.jsx)("g",{transform:"translate(-5, 65) rotate(-20) scale(0.075)",children:(0,Cl.jsx)("path",{className:"yellow-spiral",d:"M576.19 399.15C576.19 399.15 668.19 75.15 364.19 31.15C200.65 7.48003 16.14 183.6 84.06 340.99C134.19 457.15 295.59 413.61 234.89 266.38C199.41 180.32 95.16 155.5 13.05 196.86",stroke:"#F0C946",strokeWidth:"58",strokeLinecap:"butt",strokeDasharray:"1550",strokeDashoffset:"0",fill:"none"})})]})},kp=(0,kr.memo)(Tp),Ip=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":e.ariaHidden&&!0,fill:"none",height:null!==(t=e.height)&&void 0!==t?t:80,viewBox:"0 0 80 80",width:null!==(n=e.width)&&void 0!==n?n:80,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"39.6121",width:"26.3425",x:"6.04553",y:"29.1451",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_251_3312",stdDeviation:".714538"})]}),(0,Cl.jsxs)("linearGradient",{id:`b-${i}`,gradientUnits:"userSpaceOnUse",x1:"12.5577",x2:"55.119",y1:"38.0845",y2:"65.9012",children:[(0,Cl.jsx)("stop",{offset:".135247",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:".249813",stopColor:"#ffd87c"}),(0,Cl.jsx)("stop",{offset:".409209",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:".752403",stopColor:"#c57429"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#bf7c19"})]}),(0,Cl.jsxs)("linearGradient",{id:`c-${i}`,gradientUnits:"userSpaceOnUse",x1:"36.6435",x2:"31.0267",y1:"61.4175",y2:"49.3545",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#b25b0a"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#f3c352",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`d-${i}`,gradientUnits:"userSpaceOnUse",x1:"57.7848",x2:"60.6488",y1:"53.077",y2:"60.2946",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#f3c352",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ffe8b0"})]}),(0,Cl.jsxs)("linearGradient",{id:`e-${i}`,gradientUnits:"userSpaceOnUse",x1:"40.6584",x2:"42.8079",y1:"43.6421",y2:"86.2711",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffda82",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#a61840"})]}),(0,Cl.jsxs)("linearGradient",{id:`f-${i}`,gradientUnits:"userSpaceOnUse",x1:"-8.52904",x2:"25.4558",y1:"70.9171",y2:"76.1978",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`g-${i}`,gradientUnits:"userSpaceOnUse",x1:"5.46237",x2:"27.7636",y1:"70.4215",y2:"32.7753",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffecc0",stopOpacity:".6"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ffda82",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`h-${i}`,gradientUnits:"userSpaceOnUse",x1:"54.7555",x2:"45.9387",y1:"28.1659",y2:"36.11",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#8f4500"})]}),(0,Cl.jsxs)("linearGradient",{id:`i-${i}`,gradientUnits:"userSpaceOnUse",x1:"50.0855",x2:"41.2526",y1:"23.1149",y2:"31.8851",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#8f4500",stopOpacity:".5"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ffda82"})]}),(0,Cl.jsxs)("linearGradient",{id:`j-${i}`,children:[(0,Cl.jsx)("stop",{offset:".115167",stopColor:"#8385f9"}),(0,Cl.jsx)("stop",{offset:".972595",stopColor:"#f181bd"})]}),(0,Cl.jsx)("linearGradient",{id:`k-${i}`,gradientUnits:"userSpaceOnUse",x1:"50.0045",x2:"22.3004",xlinkHref:`#j-${i}`,y1:"62.3252",y2:"32.1713"}),(0,Cl.jsx)("linearGradient",{id:`l-${i}`,gradientUnits:"userSpaceOnUse",x1:"32.8147",x2:"11.5765",xlinkHref:`#j-${i}`,y1:"70.8432",y2:"47.7176"}),(0,Cl.jsx)("clipPath",{id:`m-${i}`,children:(0,Cl.jsx)("path",{d:"m0 0h80v80h-80z"})}),(0,Cl.jsxs)("mask",{id:`n-${i}`,height:"62",maskUnits:"userSpaceOnUse",width:"64",x:"5",y:"13",children:[(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#b-${i})`}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#c-${i})`,fillOpacity:".8"}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#d-${i})`}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#e-${i})`}),(0,Cl.jsx)("path",{d:"m6.52258 63.0712c-3.17889 6.416 3.26855 13.3554 9.90032 10.6554l51.0173-20.7711.695-2.8153-35.759-35.7933-1.3394-.7542z",fill:"none",stroke:`url(#f-${i})`,strokeOpacity:".6",strokeWidth:".357269"})]}),(0,Cl.jsx)("mask",{height:"68",maskUnits:"userSpaceOnUse",width:"76",x:"27",y:"-13",children:(0,Cl.jsx)("path",{d:"m43.7115 36.6806-.0047-.0048c-13.2118-13.2106-44.060846-69.2695 44.5233-41.23664 11.4375 9.6423 32.7599 67.65504-20.6572 57.94294-8.7493-1.5908-15.1125-7.9534-23.8614-16.7015z",fill:"#d9d9d9"})}),(0,Cl.jsxs)("g",{clipPath:`url(#m-${i})`,children:[(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#b-${i})`}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#c-${i})`,fillOpacity:".8"}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#d-${i})`}),(0,Cl.jsx)("path",{d:"m6.36222 62.9922c-3.25192 6.5634 3.34401 13.662 10.12818 10.9l51.1017-20.8048.7412-3.0027-35.8483-35.8824-1.5244-.8576z",fill:`url(#e-${i})`}),(0,Cl.jsx)("path",{d:"m6.52258 63.0712c-3.17889 6.416 3.26855 13.3554 9.90032 10.6554l51.0173-20.7711.695-2.8153-35.759-35.7933-1.3394-.7542z",stroke:`url(#f-${i})`,strokeOpacity:".6",strokeWidth:".357269"}),(0,Cl.jsx)("g",{filter:`url(#a-${i})`,children:(0,Cl.jsx)("path",{d:"m30.8376 38.3058-3.0181-6.8662c-.4815-1.0955-2.0002-1.1693-2.5531-.1081-3.3323 6.3959-11.4798 22.0852-17.61456 33.9021-.80506 1.5507 1.34712 2.9063 2.40706 1.5173l20.6065-27.0031c.3155-.4135.3815-.9658.1722-1.442z",fill:`url(#g-${i})`})}),(0,Cl.jsx)("path",{d:"m68.0914 53.3407c-2.9921 2.788-13.5417-3.6709-24.0687-14.9688-10.5271-11.298-16.4305-22.4969-13.4384-25.2849 2.9921-2.7879 13.7466 3.8909 24.2737 15.1889 10.527 11.298 16.2254 22.2769 13.2334 25.0648z",fill:"#c57429"}),(0,Cl.jsx)("path",{d:"m54.4658 28.6415c5.2411 5.6249 9.262 11.1582 11.5942 15.6148 1.168 2.2319 1.8973 4.1663 2.158 5.6897.2649 1.5477.0245 2.5212-.5244 3.0327-.5491.5116-1.537.6826-3.0623.3092-1.5012-.3675-3.3793-1.2315-5.5232-2.554-4.2809-2.6409-9.5168-7.0421-14.7579-12.6671-5.2413-5.6251-9.3142-11.2147-11.698-15.7277-1.1937-2.2598-1.9484-4.2221-2.2278-5.7674-.2845-1.5732-.0517-2.5547.493-3.0622s1.5409-.6712 3.0901-.2764c1.5216.3878 3.4253 1.2798 5.5951 2.6298 4.3335 2.6963 9.6219 7.1535 14.8632 12.7786z",fill:`url(#h-${i})`,stroke:`url(#i-${i})`,strokeWidth:"1.07181"}),(0,Cl.jsxs)("g",{mask:`url(#n-${i})`,strokeWidth:"9.54646",children:[(0,Cl.jsx)("path",{d:"m62.6579 62.2169c-4.2676 3.9763-17.7953-2.3864-29.4671-14.9129s-16.3861-25.7417-12.1185-29.7181",stroke:`url(#k-${i})`}),(0,Cl.jsx)("path",{d:"m42.3693 70.8978c-3.1799 2.9629-12.6644-2.0476-21.6141-11.6526-8.9497-9.6051-13.45271-19.6065-10.2728-22.5694",stroke:`url(#l-${i})`})]})]})]})},_p=(0,kr.memo)(Ip),Op=e=>{let{className:t,shouldAnimate:n}=e;return(0,Cl.jsx)("div",{className:(0,Ml.A)("party-popper",t),children:(0,Cl.jsx)(_p,{className:(0,Ml.A)({"party-popper-bounce":n})})})},xp=(0,kr.memo)(Op),wp=["#E74A6D","#F0C946","#6767F5"],Rp=["circle","square"],Mp=e=>{let{className:t,shouldAnimate:n}=e;const i=(0,kr.useRef)(null),[s,a]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{let e;return n?e=window.setTimeout((()=>{a(!0)}),174):a(!1),()=>{e&&window.clearTimeout(e)}}),[n]),(0,kr.useEffect)((()=>{s&&i.current&&i.current.shoot()}),[s]),(0,Cl.jsxs)("div",{className:(0,Ml.A)("confetti p-rel",t),"aria-hidden":!0,"data-qa":"confetti-icon",children:[(0,Cl.jsx)(xp,{className:"p-abs inset-centered",shouldAnimate:n}),(0,Cl.jsx)(kp,{className:"p-abs inset-centered",shouldAnimate:n}),(0,Cl.jsx)(Dp(),{width:360,height:360,className:"p-abs inset-centered",onInit:e=>{let{conductor:t}=e;i.current=t},globalOptions:{disableForReducedMotion:!0},decorateOptions:e=>Object.assign(Object.assign({},e),{colors:wp,shapes:Rp,particleCount:20,scalar:.9,spread:360,startVelocity:7,gravity:0,decay:.94,ticks:60,origin:{y:.5}})})]})},Lp=(0,kr.memo)(Mp);var Fp=n(3299),Up=n(6837),jp=n(5302);const Bp=/[.*+?^${}()|[\]\\]/g;var Gp;!function(e){e.MONEY="money",e.STOCK="stock",e.CRYPTO="crypto"}(Gp||(Gp={}));class qp{constructor({digits:e,withoutFraction:t,getCurrencyFormat:n,locale:i,donationType:s,setZeroOnBlur:a,sentry:o,enableCurrencySymbolPositioning:r=!1,showCurrencySymbolIfValueEmpty:l=!1}){this.formatterCache=null,this.digits=e,this.withoutFraction=t,this.locale=i,this.donationType=s,this.getCurrencyFormat=n,this.setZeroOnBlur=a,this.sentry=o,this.enableCurrencySymbolPositioning=r,this.showCurrencySymbolIfValueEmpty=l,this.groupSeparator=this.getCurrencyFormat().groupSeparator,this.decimalSeparator=this.getCurrencyFormat().decimalSeparator}get alternativeDecimalSeparator(){return"."===this.decimalSeparator?",":"."}parseAmountOrNull(e){return Number.isNaN(e)?null:e}formatValue({value:e,minimumFractionDigits:t=0,currencySymbol:n="",currency:i}){const s=null===e?"":Gr(e/Math.pow(10,this.digits),t,this.digits,this.locale),a=this.removeFractionZeroes(s,t),o=null!==e||this.showCurrencySymbolIfValueEmpty?n:"";return this.enableCurrencySymbolPositioning&&n&&i&&this.getCurrencySymbolPositionInternal(i,this.locale)===Ht.POSTFIX?`${a}${o}`:`${o}${a}`}convertStringToNumber(e,t){const n=this.toJsFloatFormat(e),i=this.parsePrice(n,t);return Math.round(Number.parseFloat(i)*Math.pow(10,this.digits))}handleKeyDown(e,t,n){if(!(this.withoutFraction?qp.DIGITS_REG_EXP:qp.DIGITS_WITH_DOT_COMMA_REG_EXP).test(e.key)&&e.key&&1===e.key.length&&!e.ctrlKey&&!e.metaKey)return e.preventDefault();const i=t.value;if(i.includes(this.decimalSeparator)&&(","===e.key||"."===e.key))return e.preventDefault();const s=i.split(this.decimalSeparator),a=s[0],o=a?a.length:0,r=s[1];if((r?r.length:0)>=this.digits&&e.key&&1===e.key.length&&t.selectionStart&&t.selectionStart===t.selectionEnd&&t.selectionStart>o&&!e.ctrlKey&&!e.metaKey)return e.preventDefault();n()}handlePaste(e,t){e.preventDefault(),t((e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData||window.clipboardData).getData("text"))}handleChange(e,t,n,i,s){let a=e.target.value;if(t){const e=this.getCommaPosition(n,a);-1!==e&&(a=a.substring(0,e)+this.decimalSeparator+a.substring(e+1))}const o=new RegExp(`\\${this.decimalSeparator}$`);(a.match(o)||n.match(o)&&!a.includes(this.decimalSeparator))&&i(a);const r=new RegExp(`[${this.decimalSeparator}][0-9]{0,${this.digits}}$`),l="0"===a[a.length-1]&&e.target.selectionStart===a.length,c="0"===n[n.length-1]&&n.length>a.length&&n.length===Number(e.target.selectionStart)+1;a.match(r)&&(l||c)&&i(a),s(a)}handleBlur(e,t){this.setZeroOnBlur&&""===e.target.value&&(e.target.value="0"),t(e)}getInputMode(){return this.withoutFraction?"numeric":"decimal"}calculateInitialCursorPosition(e,t){if(!this.enableCurrencySymbolPositioning){const n=e.slice(0,t),i=[...n].filter((e=>e===this.groupSeparator)).length;return n.length-i}const{prefixLength:n,valueWithoutSymbols:i,postfixLength:s}=this.extractSymbolInfo(e),a=n+i.length;let o=t-n;if(o=s>0&&t>a?i.length:Math.max(0,Math.min(o,i.length)),o===i.length)return i.length;const r=i.slice(0,o),l=[...r].filter((e=>e===this.groupSeparator)).length;return r.length-l}calculateFormattedCursorPosition(e,t,n){var i,s;if(!this.enableCurrencySymbolPositioning){let n=0,i=0;for(;i<t&&n<=e.length;)n<e.length&&e[n]!==this.groupSeparator&&i++,n++;return n}const{prefixLength:a,valueWithoutSymbols:o,postfixLength:r}=this.extractSymbolInfo(e);let l=0,c=0;for(;c<t&&l<o.length;)o[l]!==this.groupSeparator&&c++,l++;c<t&&(l=o.length);let u=l+a;return a>0&&0===u&&(u=null!==(i=null==n?void 0:n.length)&&void 0!==i?i:1),r>0&&u===e.length&&(u=e.length-(null!==(s=null==n?void 0:n.length)&&void 0!==s?s:1)),u}limitCryptoAmount(e){const t=e.split("."),n=t[0];if(n.length>qp.CRYPTO_MAXIMUM_INTEGER_LENGTH&&(e=e.replace(/^([0-9]*)/,n.slice(0,qp.CRYPTO_MAXIMUM_INTEGER_LENGTH))),e.includes(".")){const n=t[1];n.length>qp.CRYPTO_MAXIMUM_FRACTION_LENGTH&&(e=e.replace(/[.]([0-9]*)/,n.slice(0,qp.CRYPTO_MAXIMUM_FRACTION_LENGTH)))}return e}parsePrice(e,t){let n=e||"";if(n=n.replace(/[^\d.]/g,""),this.donationType===Gp.MONEY){const e=function(e){return"IDR"===e?12:8}(t);n=n.slice(0,e+2)}return this.donationType===Gp.CRYPTO&&(n=this.limitCryptoAmount(n)),Number.parseFloat(n).toFixed(this.withoutFraction?0:this.digits)}toJsFloatFormat(e){var t;try{let t=e;return this.groupSeparator&&(t=t.split(this.groupSeparator).join("")),this.decimalSeparator&&"."!==this.decimalSeparator&&(t=t.split(this.decimalSeparator).join(".")),t}catch(n){throw null===(t=this.sentry)||void 0===t||t.captureException(n,{extra:{value:e,locale:this.locale,groupSeparator:this.groupSeparator,decimalSeparator:this.decimalSeparator}}),n}}removeFractionZeroes(e,t){const n=new RegExp(`\\${this.decimalSeparator}0+$`);return 0!==t?e.replace(n,""):e}getCurrencySymbolPositionInternal(e,t){if(!e||!t)return Ht.PREFIX;this.formatterCache||(this.formatterCache=new Map);const n=`${t}-${e}`;let i=this.formatterCache.get(n);if(!i)try{i=new Intl.NumberFormat(t,{style:"currency",currency:e,minimumFractionDigits:0,maximumFractionDigits:0}),this.formatterCache.set(n,i)}catch(e){return Ht.PREFIX}try{return i.formatToParts(1).findIndex((e=>"currency"===e.type))>0?Ht.POSTFIX:Ht.PREFIX}catch(e){return Ht.PREFIX}}extractSymbolInfo(e){if(!e)return{prefixLength:0,valueWithoutSymbols:e,postfixLength:0};const t=this.getCurrencyFormat(),n=new RegExp(`[0-9${t.decimalSeparator}${t.groupSeparator}]+`),i=e.match(n);if(!i||void 0===i.index)return{prefixLength:0,valueWithoutSymbols:e,postfixLength:0};const s=i.index,a=s+i[0].length;return{prefixLength:s,valueWithoutSymbols:e.substring(s,a),postfixLength:e.length-a}}restoreCurrencySymbolIfNeeded({value:e,currencySymbol:t,currency:n,previousValue:i}){if(!e.includes(t)&&/[0-9]/.test(e)){if(!i)return e;if(i.includes(t))return this.enableCurrencySymbolPositioning&&n&&this.getCurrencySymbolPositionInternal(n,this.locale)===Ht.POSTFIX?`${e}${t}`:`${t}${e}`}return e}getCurrencySymbolPosition(e){return this.getCurrencySymbolPositionInternal(e,this.locale)}calculateCursorPositionAfterPaste(e,t,n){return this.getCurrencySymbolPositionInternal(n,this.locale)===Ht.POSTFIX?e.length-t.length:e.length}isValidInputKey(e){return(this.withoutFraction?qp.DIGITS_REG_EXP:qp.DIGITS_WITH_DOT_COMMA_REG_EXP).test(e)}calculateClampedCursorPosition({value:e,selectionStart:t,currencySymbol:n,currency:i}){const s=e.startsWith(n),a=e.endsWith(n);if(this.getCurrencySymbolPosition(i)===Ht.PREFIX){if(s&&t<n.length)return n.length}else{const i=a?Math.max(0,e.length-n.length):e.length;if(t>i)return i}return null}shouldPreventFractionalInput({inputValue:e,selectionStart:t,key:n,currencySymbol:i,currency:s}){if(!n||1!==n.length)return!1;let a=e;if(i&&s){const t=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");a=e.replace(new RegExp(t+"$"),"")}const o=a.split(this.decimalSeparator),r=o[0],l=r?r.length:0,c=o[1];return(c?c.length:0)>=this.digits&&t>l+(a.includes(this.decimalSeparator)?1:0)}shouldUpdateFormattedValueForDecimal({value:e,formattedValue:t,currencySymbol:n,currency:i}){if(!n||!i){const n=new RegExp(`\\${this.decimalSeparator}$`);return null!==e.match(n)||null!==t.match(n)&&!e.includes(this.decimalSeparator)}const s=this.getCurrencySymbolPositionInternal(i,this.locale),a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(s===Ht.PREFIX?`\\${this.decimalSeparator}$`:`\\${this.decimalSeparator}(?=${a}$)`);return null!==e.match(o)||null!==t.match(o)&&!e.includes(this.decimalSeparator)}shouldUpdateFormattedValueForZero({value:e,formattedValue:t,selectionStart:n}){const i=new RegExp(`[${this.decimalSeparator}][0-9]{0,${this.digits}}$`),s="0"===e[e.length-1]&&n===e.length,a="0"===t[t.length-1]&&t.length>e.length&&t.length===Number(n)+1;return null!==e.match(i)&&(s||a)}isLastCharIsDigit(e){return/[0-9]$/.test(e)}getCommaPosition(e,t){const n=e.length>=t.length?e:t,i=e.length>=t.length?t:e,s=n.split("");for(const e in s)if(s[e]===this.alternativeDecimalSeparator&&s[e]!==i.charAt(Number(e)))return Number(e);return-1}shouldPreventNonDigitInput({value:e,currencySymbol:t}){const n=t&&e===t,i=t&&e.endsWith(t)&&e!==t;return!this.isLastCharIsDigit(e)&&this.withoutFraction&&""!==e&&!n&&!i}normalizeDecimalSeparator({value:e,formattedValue:t,isCurrentCharAltDecimalSeparator:n}){if(n){const n=this.getCommaPosition(t,e);if(-1!==n)return e.substring(0,n)+this.decimalSeparator+e.substring(n+1)}return e}}qp.DIGITS_WITH_DOT_COMMA_REG_EXP=/[0-9.,]/,qp.DIGITS_REG_EXP=/[0-9]/,qp.CRYPTO_MAXIMUM_FRACTION_LENGTH=8,qp.CRYPTO_MAXIMUM_INTEGER_LENGTH=9;const Vp=(0,kr.forwardRef)((function(e,t){var{className:n,placeholder:i,disabled:s,inputMode:a,dataQa:o,currency:r,currencySymbol:l,withoutFraction:c,digits:u,donationType:h,value:m,trackingElement:p,hideCurrencySymbolOnEmpty:g=!1,onChange:y,onFocus:f,onBlur:v,onClick:S}=e,E=(0,d.Tt)(e,["className","placeholder","disabled","inputMode","dataQa","currency","currencySymbol","withoutFraction","digits","donationType","value","trackingElement","hideCurrencySymbolOnEmpty","onChange","onFocus","onBlur","onClick"]);const[A,C]=(0,kr.useState)(!1),[b,P]=(0,kr.useState)(null),[N,D]=(0,kr.useState)(r),[T,k]=(0,kr.useState)(l),[I,_]=(0,kr.useState)(!1),O=(0,kr.useRef)(!0),x=(0,nc.t)(),w=(0,kr.useMemo)((()=>x.getCurrencyFormat()),[x]),R=function(e){let{withoutFraction:t,digits:n,donationType:i,intl:s}=e;const a=Ol();return(0,kr.useMemo)((()=>new qp({withoutFraction:t,getCurrencyFormat:()=>s.getCurrencyFormat(),locale:s.locale,digits:n,donationType:i,sentry:a,enableCurrencySymbolPositioning:!0,showCurrencySymbolIfValueEmpty:!0})),[n,i,s,a,t])}({withoutFraction:c,digits:u,intl:x,donationType:h}),M=(0,kr.useMemo)((()=>"."===w.decimalSeparator?",":"."),[w]),L=(0,kr.useRef)(null),F=(0,kr.useMemo)((()=>!!l&&(h!==$n.CRYPTO&&(g?!(null===m||0===m)||I:null!==m))),[l,g,I,m,h]),U=(0,kr.useCallback)((e=>R.formatValue({value:e,minimumFractionDigits:A?0:u,currencySymbol:F&&null!=l?l:"",currency:r})),[R,A,u,F,r,l]),[j,B]=(0,kr.useState)(U(m)),[G,q]=(0,kr.useState)(!1);(0,kr.useEffect)((()=>{R.convertStringToNumber(j,N)!==m&&(D(r),k(l),B(U(m)))}),[m,U,j,N,r,l,R,I,F]),(0,kr.useEffect)((()=>{T!==l&&(k(l),B(U(m)))}),[r,N,T,l,m,U]),(0,kr.useEffect)((()=>{if(null===L.current||null===b)return;const e=L.current.value,t=R.calculateFormattedCursorPosition(e,b,l);L.current.selectionStart=t,L.current.selectionEnd=t}),[b,j,R,l]);const V=(0,kr.useCallback)((e=>{const t=R.convertStringToNumber(e,r);y(R.parseAmountOrNull(t))}),[y,R,r]),H=(0,kr.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(L.current&&l&&r){const n=R.getCurrencySymbolPosition(r),i=L.current.value.length;let s=0;s=!0===e?n===Ht.PREFIX?i:i-l.length:null!==(t=L.current.selectionStart)&&void 0!==t?t:0;const a=R.calculateClampedCursorPosition({value:L.current.value,selectionStart:s,currencySymbol:l,currency:r});null!==a?(L.current.selectionStart=a,L.current.selectionEnd=a):L.current.selectionStart!==s&&O.current&&(L.current.selectionStart=s,L.current.selectionEnd=s)}}),[R,l,r]);return(0,kr.useImperativeHandle)(t,(()=>L.current)),(0,Cl.jsx)("input",Object.assign({ref:L,type:"text",className:n,placeholder:i,autoComplete:"off",value:j,disabled:s,inputMode:R.getInputMode(),onChange:e=>{var t,n;let i=e.target.value;if(A||C(!0),R.shouldPreventNonDigitInput({value:i,currencySymbol:l}))return e.preventDefault();i=R.normalizeDecimalSeparator({value:i,formattedValue:j,isCurrentCharAltDecimalSeparator:G}),R.shouldUpdateFormattedValueForDecimal({value:i,formattedValue:j,currencySymbol:l,currency:r})&&B(i),R.shouldUpdateFormattedValueForZero({value:i,formattedValue:j,selectionStart:null!==(t=e.target.selectionStart)&&void 0!==t?t:0})&&B(i);const s=R.calculateInitialCursorPosition(i,null!==(n=e.target.selectionStart)&&void 0!==n?n:0);P(s),l&&r&&(i=R.restoreCurrencySymbolIfNeeded({value:i,currencySymbol:l,currency:r,previousValue:j})),V(i),""===i&&setTimeout((()=>{H()}),100)},onPaste:e=>{e.preventDefault();let t=(e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData||window.clipboardData).getData("text");l&&r&&setTimeout((()=>{if(L.current&&r){t=R.restoreCurrencySymbolIfNeeded({value:L.current.value,currencySymbol:l,currency:r,previousValue:j});const e=R.calculateCursorPositionAfterPaste(t,l,r);L.current.selectionStart=e,L.current.selectionEnd=e}}),100),V(t)},onKeyDown:e=>{var t,n,i,s,a,o,c,u;const d=R.isValidInputKey(e.key);if(!d&&e.key&&1===e.key.length&&!e.ctrlKey&&!e.metaKey)return e.preventDefault();const h=null!==(n=null===(t=L.current)||void 0===t?void 0:t.value)&&void 0!==n?n:"";if(h.includes(w.decimalSeparator)&&(","===e.key||"."===e.key))return e.preventDefault();if(R.shouldPreventFractionalInput({inputValue:h,selectionStart:null!==(s=null===(i=L.current)||void 0===i?void 0:i.selectionStart)&&void 0!==s?s:0,key:e.key,currencySymbol:l,currency:r}))return e.preventDefault();const m=(null!==(o=null===(a=L.current)||void 0===a?void 0:a.selectionEnd)&&void 0!==o?o:0)-(null!==(u=null===(c=L.current)||void 0===c?void 0:c.selectionStart)&&void 0!==u?u:0);!d&&l&&r&&m<=1&&setTimeout((()=>{H()}),0),q(e.key===M)},onFocus:()=>{if(L.current&&l&&r){const e=L.current.value,t=R.restoreCurrencySymbolIfNeeded({value:e,currencySymbol:l,currency:r,previousValue:j||""});t!==e&&(L.current.value=t,V(t)),H(!0)}_(!0),O.current=!1,f&&f()},onBlur:()=>{if(_(!1),v){const e=R.convertStringToNumber(j,r);v(Number.isNaN(e)?null:e)}},onMouseUp:()=>{H()},onClick:S,"data-qa":o,"data-tracking-element-name":p,"data-testid":"price-input"},E))})),Hp=(0,kr.memo)(Vp),Kp=(0,kr.forwardRef)(((e,t)=>{const{currencyService:n,withoutFraction:i=!0,trackingElement:s,placeholder:a,donationType:o,isCustomAmount:r,isPDUPriceInput:l,className:c,canModifyAmount:u,showDisabledInput:h,disabled:m,currency:p,currencyCodeNode:g,canSelectCurrency:y,amount:f,hasError:v,errorLabel:S,dataQa:E,onAmountChange:A,onAmountInputBlur:C,onAmountInputFocus:b,onAmountInputHide:P}=e,N=(0,d.Tt)(e,["currencyService","withoutFraction","trackingElement","placeholder","donationType","isCustomAmount","isPDUPriceInput","className","canModifyAmount","showDisabledInput","disabled","currency","currencyCodeNode","canSelectCurrency","amount","hasError","errorLabel","dataQa","onAmountChange","onAmountInputBlur","onAmountInputFocus","onAmountInputHide"]),D=(0,nc.t)(),T=(0,Bl.P)(),k=(0,kr.useId)(),I=n.getSymbol(p),_=Kl(),[O,x]=(0,kr.useState)(!1),w=(0,kr.useCallback)((e=>{A(e)}),[A]),R=(0,kr.useCallback)((()=>{C&&C(),x(!1),l&&null!==f&&0!==f&&!v&&P&&P()}),[C,l,f,v,P]),M=(0,kr.useCallback)((()=>{b&&b(),x(!0)}),[b]),L=n.getDigits(p),F=Gr((f||0)/Math.pow(10,L),0,2),U=(0,kr.useMemo)((()=>I?`[${I.replace(Bp,"\\$&")}\\d,.\\s]*`:"[\\d,.\\s]*"),[I]),j=(0,kr.useMemo)((()=>!!I&&o!==$n.CRYPTO),[I,o]),B=(0,kr.useMemo)((()=>null===f&&(!j||!O)&&(!r&&!l||r&&T)),[f,O,r,l,T,j]),G=(0,kr.useMemo)((()=>null===f&&(!j||!O)&&r&&!T),[f,O,r,T,j]);return(0,Cl.jsxs)("div",{className:(0,Ml.A)(c,{"text-white":h,"is-focused":O,"is-readonly":!u,"has-error":v}),"data-qa":"input-wrapper",children:[(0,Cl.jsxs)("label",{className:(0,Ml.A)("grow-1",{"p-rel":l}),"data-qa":E+"-label",children:[(0,Cl.jsxs)("span",{className:"sr-only",children:[D.translate("donateForm.donationAmountField.label")," ",p]}),l&&(0,Cl.jsxs)("span",{className:"price-control invisible","aria-hidden":"true","data-qa":E+"-value",children:[I,F]}),u?(0,Cl.jsx)(Hp,Object.assign({ref:t,className:(0,Ml.A)(_("price-control"),{"p-abs inset-0":l,"body-60-regular":B,"body-40-regular":G}),digits:n.getDigits(p),value:f,withoutFraction:i,pattern:U,placeholder:"string"==typeof a?a:D.translate("donateForm.donationAmountField.placeholder"),disabled:h||m,"aria-invalid":v,"aria-describedby":`price-control-${k}-error`,dataQa:E,trackingElement:s,donationType:o,currency:p,currencySymbol:I,hideCurrencySymbolOnEmpty:!0,onChange:w,onBlur:R,onFocus:M},N)):(0,Cl.jsx)("span",{className:(0,Ml.A)(_("price-control"),"text-gray-100 text-truncate"),"data-qa":`disabled-${E}`,children:D.formatCurrency(f||0,{currency:p,display:"floatcents"})})]}),v&&S&&(0,Cl.jsx)(Cl.Fragment,{children:l?(0,Cl.jsx)("p",{id:`price-control-${k}-error`,className:"sr-only",dangerouslySetInnerHTML:{__html:S},"data-testid":"amount-input-error"}):(0,Cl.jsx)(fu.U,{className:"shrink-0 self-center me-1",showTooltip:O,"data-testid":"price-control-error",children:(0,Cl.jsx)("p",{id:`price-control-${k}-error`,dangerouslySetInnerHTML:{__html:S}})})}),l?g:(0,Cl.jsxs)("div",{className:"shrink-0 self-center p-rel",children:[g,(0,Cl.jsxs)("span",{className:(0,Ml.A)("currency-select-label d-flex items-center",{"ps-2 pe-1-5 border-radius-6":y,"px-2-5":!y,"py-2":!r,"py-1":r}),"data-qa":"selected-currency","aria-hidden":"true",children:[p,y&&(0,Cl.jsx)(jp.A,{className:"currency-select-arrow icon-stroke font-size-16 shrink-0"})]})]})]})}));Kp.displayName="RawCurrencyInputSection";const Yp=(0,kr.memo)(Kp),{useAddFieldToScroll:zp,useScrollToFieldsTrigger:Wp,ScrollToFieldsProvider:$p}=(0,Ud.J)(),Xp={minHeight:"66px"},Qp=["bottom"],Zp=e=>{let{className:t}=e;const{state:n,controller:i}=Tc(wl.THANK_YOU),{postDonationUpsell:s}=n,a=(0,nc.t)(),o=(0,gc.Q)(),r=(0,kr.useRef)(null),l=(0,ql.wf)(),[c,u]=(0,kr.useState)(!s.isShowcase&&s.errors.min),[d,h]=(0,kr.useState)(!s.isShowcase&&s.errors.max),m=(0,kr.useCallback)((()=>c?a.translate("thankYouScreen.postDonationUpsell.error.min",{amount:a.formatCurrency(s.recurringMinAmount,{currency:n.currency,display:"round"})}):d?a.translate("thankYouScreen.postDonationUpsell.error.max",{amount:a.formatCurrency(s.upsellMaxAmount,{currency:n.currency,display:"round"})}):""),[a,d,c,n.currency,s.recurringMinAmount,s.upsellMaxAmount]);(0,Sd.f)({ref:r,autoFocus:s.showAmountInput,mode:vd.Q.ALL});const p=(0,kr.useCallback)((e=>{i.changePduAmount(e)}),[i]),g=xc(),y=(0,kr.useMemo)((()=>(0,Up.p)(n.currency,a.locale)),[a.locale,n.currency]),f=$d(s.shakeKey,0!==s.shakeKey),v=(0,kr.useCallback)((()=>{u(!s.isShowcase&&s.errors.min),h(!s.isShowcase&&s.errors.max)}),[s.isShowcase,s.errors.min,s.errors.max]);(0,kr.useEffect)((()=>{u(!s.isShowcase&&s.errors.min),h(!s.isShowcase&&s.errors.max)}),[s.isShowcase,s.errors.min,s.errors.max]);const S=(0,kr.useCallback)((()=>{i.makePduAmountInputVisible()}),[i]),E=(0,kr.useCallback)((()=>{i.hidePduAmountInput()}),[i]),A=(0,kr.useMemo)((()=>{const e=a.translate("widgetSubscriptionPeriodLabel.monthly.short");return`${y}/${e}`}),[y,a]),C=(0,kr.useMemo)((()=>(0,Cl.jsx)("div",{"data-qa":"post-donation-amount-input-currency-code",className:(0,Ml.A)("body-70-regular shrink-0 text-nowrap ms-1",{"text-gray-60":s.showAmountInput}),children:A})),[A,s.showAmountInput]);return zp(r,(e=>!e.postDonationUpsell.isAmountValid)),(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex flex-column items-center",t),style:Xp,children:[(0,Cl.jsx)(Zc.S,{content:(0,Cl.jsx)("p",{dangerouslySetInnerHTML:{__html:m()}}),trigger:"manual",manualOpen:c||d,placement:o?"left":"right",fallbackPlacements:Qp,maxWidth:"300px",rootContainer:l,"data-qa":"amount-error-popover",children:(0,Cl.jsx)("div",{className:"max-w-100",children:(0,Cl.jsx)(Yp,{ref:r,className:(0,Ml.A)("group-frequency-control",{"bg-white border-radius-base":s.showAmountInput,shake:f}),currency:n.currency,amount:s.amount,onAmountChange:p,onAmountInputHide:E,canModifyAmount:!0,currencyService:g,currencyCodeNode:C,isPDUPriceInput:!0,hasError:!s.isAmountValid,errorLabel:m(),onAmountInputBlur:v,showDisabledInput:!s.showAmountInput,dataQa:"post-donation-amount-input",trackingElement:"postDonationInput",placeholder:"",disabled:n.locked&&s.showAmountInput,donationType:n.flowType})})}),!s.showAmountInput&&(0,Cl.jsx)("button",{type:"button",className:"btn-link body-20-regular text-white-hover-white text-truncate max-w-100 opacity-75",disabled:n.locked,onClick:S,"data-qa":"post-donation-another-amount","data-tracking-element-name":"postDonationAnotherAmountButton",children:a.translate("thankYouScreen.postDonationUpsell.amount.link")})]})},Jp=(0,kr.memo)(Zp),eg=()=>{const{state:e,controller:t}=Tc(wl.THANK_YOU),{postDonationUpsell:n}=e,i=(0,nc.t)(),s=(0,Bl.P)(),a=(0,kr.useRef)(null),o=Wp();return(0,Cl.jsxs)(Cl.Fragment,{children:[s&&(0,Cl.jsx)(Ll.A,{nodeRef:a,in:n.confirmError,timeout:200,classNames:"rtg-fade",mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)(yu,{setRef:a,type:"danger",className:"text-center mb-3",children:(0,Cl.jsx)(ou,{errorTitle:i.safeTranslate("thankYouScreen.postDonationUpsell.error.service"),dataQa:"post-donation-upsell-confirm-error"})})}),(0,Cl.jsx)(Zc.S,{content:(0,Cl.jsx)(ou,{errorTitle:i.safeTranslate("thankYouScreen.postDonationUpsell.error.service"),dataQa:"post-donation-upsell-confirm-error"}),trigger:"manual",manualOpen:!s&&n.confirmError,placement:"top",maxWidth:"300px",hasPortal:!1,children:(0,Cl.jsx)("button",{type:"button",className:"btn pdu-confirm-btn",disabled:e.locked||n.confirmError,onClick:()=>{o(),t.pduAccept()},"data-qa":"post-donation-upsell-confirm","data-tracking-element-name":"confirmButton",children:i.translate("thankYouScreen.postDonationUpsell.button.confirm",{recurringType:t.periodLabelPdu})})}),(0,Cl.jsx)("button",{type:"button",className:"btn pdu-skip-btn mt-2",disabled:e.locked,onClick:()=>(0,d.sH)(void 0,void 0,void 0,(function*(){yield t.closePduScreen()})),"data-qa":"post-donation-not-this-time","data-tracking-element-name":"skipButton",children:i.translate("thankYouScreen.postDonationUpsell.button.cancel")})]})},tg=(0,kr.memo)(eg),ng=e=>{let{className:t}=e;const{state:n,controller:i}=Tc(wl.THANK_YOU),{postDonationUpsell:s}=n,a=(0,Bl.P)(),o=(0,nc.t)(),r=(0,kr.useMemo)((()=>(0,Cl.jsx)(fc,{token:"thankYouScreen.postDonationUpsell.message",params:{date:o.formatDate(s.startDate)}})),[o,s.startDate]);return(0,kr.useEffect)((()=>{i.pduSetShowedInSession()}),[i]),(0,Cl.jsx)("div",{className:(0,Ml.A)("text-white bg-blue-60 p-4 border-radius-12",t),"data-qa":"post-donation-upsell-block",children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)("h4",{className:(0,Ml.A)("body-60-medium text-center max-w-100",a?"text-ellipsis":"text-truncate"),children:o.translate("thankYouScreen.postDonationUpsell.title")}),(0,Cl.jsx)("p",{className:(0,Ml.A)("body-40-regular text-with-nowrap text-center max-w-100 mt-1",a?"text-ellipsis":"text-line-clamp-4"),children:r}),(0,Cl.jsx)(Jp,{className:"mt-3"}),(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)(tg,{})]})})},ig=(0,kr.memo)(ng);var sg;function ag(){return ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ag.apply(null,arguments)}var og=function(e,t){return kr.createElement("svg",ag({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),sg||(sg=kr.createElement("path",{clipRule:"evenodd",d:"m12 1c-6.07513 0-11 4.92487-11 11 0 6.0751 4.92487 11 11 11 6.0751 0 11-4.9249 11-11 0-6.07513-4.9249-11-11-11zm5.2071 8.70711c.3905-.39053.3905-1.02369 0-1.41422-.3905-.39052-1.0237-.39052-1.4142 0l-5.2929 5.29291-2.29289-2.2929c-.39053-.3905-1.02369-.3905-1.41422 0-.39052.3905-.39052 1.0237 0 1.4142l3 3c.39051.3905 1.02371.3905 1.41421 0z",fill:"currentColor",fillRule:"evenodd"})))},rg=(0,kr.forwardRef)(og),lg=(0,kr.memo)(rg);const cg=e=>{let{className:t}=e;const n=(0,nc.t)(),i=Kl();return(0,Cl.jsxs)("div",{className:(0,Ml.A)(i("thank-you-badge"),"p-rel d-flex items-center justify-center bg-green-10 px-8",t),"data-qa":"thank-you-badge",children:[(0,Cl.jsx)(lg,{className:"shrink-0 icon-fill font-size-20 text-green-90 me-1-5","aria-hidden":!0}),(0,Cl.jsx)("p",{className:"compact-50-regular text-truncate",children:n.translate("common.thankYouBadge")})]})},ug=(0,kr.memo)(cg),dg=e=>{let{transitionEntered:t,ThankYouAnimation:n,displayPDU:i,thankYouTitle:s,descriptionPDU:a,descriptionSharing:o,descriptionUpsell:r,handleCloseClick:l}=e;const c=(0,nc.t)(),u=(0,Bl.P)(),d=(0,Zl.$)(),h=t&&!d,m=(0,kr.useRef)(null),p=(0,kr.useRef)(null),g=(0,kr.useRef)(null),[y,f]=(0,kr.useState)(i),[v,S]=(0,kr.useState)(24);(0,kr.useEffect)((()=>{const e=setTimeout((()=>{f(i)}),150);return()=>{clearTimeout(e)}}),[i]),(0,kr.useEffect)((()=>{if(g.current&&i){const e=g.current.offsetHeight;S(e)}}),[i,a]);const E={height:`${v}px`};return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(ug,{className:(0,Ml.A)("shrink-0 border-radius-10 mt-2",u?"mx-3":"mx-2")}),(0,Cl.jsx)(bc,{size:u?40:32,sizeMin:24}),(0,Cl.jsx)(td,{className:"px-body shrink-0",children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 d-flex flex-column justify-center",children:[(0,Cl.jsx)(n,{className:"mx-auto",shouldAnimate:h}),(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-50-semibold text-center mt-4",{"text-ellipsis":u,"text-line-clamp-2":!u&&i,"text-line-clamp-4":!u&&!i}),"data-qa":"sharing-disable-thank-you-title",children:s}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:m,timeout:200,classNames:r&&!d?"rtg-thank-you-description":"",children:(0,Cl.jsx)("div",{ref:m,className:"p-rel mt-2",style:E,children:i?(0,Cl.jsx)("p",{ref:g,className:(0,Ml.A)("p-abs inset-top-start inset-top-end text-center",u?"text-ellipsis":"text-line-clamp-2"),"data-qa":"post-donation-upsell-title-label",children:a}):(0,Cl.jsx)("p",{className:(0,Ml.A)("p-abs inset-top-start inset-top-end text-with-nowrap text-center",u?"text-ellipsis":"text-line-clamp-5"),"data-qa":"sharing-disable-thank-you-text",dangerouslySetInnerHTML:{__html:r||o}})})},i?"before-pdu-label":"after-pdu-label")})]})}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:p,timeout:250,classNames:d?"":"rtg-pdu-display-default",children:(0,Cl.jsx)("div",{ref:p,className:"shrink-0",children:y?(0,Cl.jsx)(ig,{className:u?"mt-12 mx-3 mb-13":"mt-5 mx-1 mb-1"}):(0,Cl.jsxs)(gd,{className:u?"pt-12":"pt-8 pb-9",children:[(0,Cl.jsx)(bc,{size:48}),(0,Cl.jsx)("div",{className:"d-flex justify-center",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",onClick:l,"data-qa":"close","data-tracking-element-name":"closeButton",children:c.translate("thankYouScreen.button")})})]})})},y?"before-pdu":"after-pdu")})]})},hg=(0,kr.memo)(dg);var mg;function pg(){return pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},pg.apply(null,arguments)}var gg,yg=function(e,t){return kr.createElement("svg",pg({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),mg||(mg=kr.createElement("path",{d:"m2 7 8.1649 5.7154c.6612.4629.9918.6943 1.3514.7839.3176.0792.6498.0792.9674 0 .3596-.0896.6902-.321 1.3514-.7839l8.1649-5.7154m-15.2 13h10.4c1.6802 0 2.5202 0 3.162-.327.5645-.2876 1.0234-.7465 1.311-1.311.327-.6418.327-1.4818.327-3.162v-6.4c0-1.68016 0-2.52024-.327-3.16197-.2876-.56449-.7465-1.02343-1.311-1.31105-.6418-.32698-1.4818-.32698-3.162-.32698h-10.4c-1.68016 0-2.52024 0-3.16197.32698-.56449.28762-1.02343.74656-1.31105 1.31105-.32698.64173-.32698 1.48181-.32698 3.16197v6.4c0 1.6802 0 2.5202.32698 3.162.28762.5645.74656 1.0234 1.31105 1.311.64173.327 1.48181.327 3.16197.327z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},fg=(0,kr.forwardRef)(yg),vg=(0,kr.memo)(fg);function Sg(){return Sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Sg.apply(null,arguments)}var Eg,Ag=function(e,t){return kr.createElement("svg",Sg({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),gg||(gg=kr.createElement("path",{d:"m13 12c0 .5523-.4477 1-1 1m1-1c0-.5523-.4477-1-1-1m1 1h-2m1 1c-.5523 0-1-.4477-1-1m1 1v-2m-1 1c0-.5523.4477-1 1-1m8 1c0 .5523-.4477 1-1 1m1-1c0-.5523-.4477-1-1-1m1 1h-2m1 1c-.5523 0-1-.4477-1-1m1 1v-2m-1 1c0-.5523.4477-1 1-1m-13 1c0 .5523-.44772 1-1 1m1-1c0-.5523-.44772-1-1-1m1 1h-2m1 1c-.55228 0-1-.4477-1-1m1 1v-2m-1 1c0-.5523.44772-1 1-1",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},Cg=(0,kr.forwardRef)(Ag),bg=(0,kr.memo)(Cg);function Pg(){return Pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Pg.apply(null,arguments)}var Ng,Dg=function(e,t){return kr.createElement("svg",Pg({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),Eg||(Eg=kr.createElement("path",{d:"m24 12c0-6.6288-5.3712-12-12-12s-12 5.3712-12 12c0 5.6256 3.8736 10.3488 9.1008 11.6448v-7.9776h-2.4768v-3.6672h2.4768v-1.5792c0-4.0848 1.848-5.976 5.856-5.976.7584 0 2.0736.1488 2.6064.2976v3.3216c-.2832-.0288-.7728-.0432-1.3872-.0432-1.968 0-2.7264.744-2.7264 2.6832v1.296h3.9216l-.672 3.6672h-3.2448v8.2464c5.9424-.72 10.5456-5.7792 10.5456-11.9136z",fill:"#0866ff"})))},Tg=(0,kr.forwardRef)(Dg),kg=(0,kr.memo)(Tg);function Ig(){return Ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ig.apply(null,arguments)}var _g,Og=function(e,t){return kr.createElement("svg",Ig({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),Ng||(Ng=kr.createElement("g",{clipRule:"evenodd",fillRule:"evenodd"},kr.createElement("path",{d:"m2.66641 23.9977h18.66489c1.4726 0 2.6664-1.1938 2.6664-2.6664v-18.66489c0-1.47262-1.1938-2.66641-2.6664-2.66641h-18.66489c-1.47262 0-2.66641 1.19379-2.66641 2.66641v18.66489c0 1.4726 1.19379 2.6664 2.66641 2.6664z",fill:"#007ebb"}),kr.createElement("path",{d:"m20.6642 20.6647h-3.5611v-6.0654c0-1.663-.6319-2.5923-1.9481-2.5923-1.4319 0-2.18.9671-2.18 2.5923v6.0654h-3.43196v-11.55446h3.43196v1.55636s1.0319-1.90937 3.4838-1.90937c2.4508 0 4.2054 1.49657 4.2054 4.59187zm-15.21543-13.06743c-1.16899 0-2.11625-.95469-2.11625-2.13213s.94726-2.13213 2.11625-2.13213c1.16898 0 2.11568.95469 2.11568 2.13213s-.9467 2.13213-2.11568 2.13213zm-1.7721 13.06743h3.57861v-11.55446h-3.57861z",fill:"#fff"}))))},xg=(0,kr.forwardRef)(Og),wg=(0,kr.memo)(xg);function Rg(){return Rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Rg.apply(null,arguments)}var Mg,Lg,Fg=function(e,t){return kr.createElement("svg",Rg({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),_g||(_g=kr.createElement("path",{d:"m13.9139 10.4273 7.4524-8.6629h-1.766l-6.4709 7.52184-5.16835-7.52184h-5.96105l7.81552 11.3743-7.81552 9.0844h1.76609l6.83351-7.9433 5.4581 7.9433h5.9611l-8.1054-11.7958zm-2.4189 2.8117-.7919-1.1327-6.30067-9.01241h2.71261l5.08476 7.27331.7918 1.1326 6.6096 9.4543h-2.7127l-5.3935-7.7147z",fill:"#000"})))},Ug=(0,kr.forwardRef)(Fg),jg=(0,kr.memo)(Ug);!function(e){e.FACEBOOK="Facebook",e.TWITTER="Twitter",e.LINKEDIN="Linkedin",e.EMAIL="Email",e.MORE="More",e.LINK="Link"}(Mg||(Mg={})),function(e){e.PAGE="page_thankyou",e.MODAL="modal_thankyou",e.HEADER="top_sharing_button"}(Lg||(Lg={}));const Bg={width:"44px",height:"44px"},Gg=e=>{let{as:t,type:n,href:i,label:s,icon:a,className:o,trackingElement:r,dataQa:l,onClick:c}=e;const u=null!=t?t:"button";return(0,Cl.jsx)(u,{href:null!=i?i:void 0,type:null!=n?n:void 0,className:(0,Ml.A)("btn btn-default d-flex justify-center items-center py-0",o),style:Bg,"aria-label":s,onClick:()=>null==c?void 0:c(),"data-tracking-element-name":r,"data-qa":l,children:a})},qg=e=>{let{className:t,showFacebook:n,showTwitter:i,showLinkedin:s,showEmail:a,sharingText:o,share:r,getSharingLink:l}=e;const c=(0,nc.t)(),u=(0,Bl.P)(),h=(0,Zl.$)(),m=Rc(),{share:p,isAvailable:g}=((e,t)=>{const[n,i]=(0,kr.useState)(!1),[s,a]=(0,kr.useState)(!1),[o,r]=(0,kr.useState)(null);(0,kr.useEffect)((()=>{let t=!1;"function"==typeof navigator.share&&void 0!==navigator.canShare&&(t=navigator.canShare(e)),i(t)}),[e]);const l=(0,kr.useCallback)((()=>(0,d.sH)(void 0,void 0,void 0,(function*(){if(n){if(!s){a(!0);try{yield navigator.share(e)}catch(e){if(r(null==e?void 0:e.message),"AbortError"!==e.name||!t)throw e;t.trackCheckoutCustomEvent({type:Ee.WEB_SHARE_API_MORE_OPTIONS_ABORTED})}finally{a(!1)}}}else r("Web Share API is not available or disabled.")}))),[n,s,e,t]);return(0,kr.useMemo)((()=>({isAvailable:n,share:l,isSharing:s,errorMessage:o})),[n,l,s,o])})({text:o,url:l(Mg.MORE)},m),y=u&&g;return(0,Cl.jsx)("div",{className:(0,Ml.A)("text-center",t),role:"group","aria-label":c.translate("sharing.ariaLabel"),children:(0,Cl.jsxs)("div",{className:"d-flex justify-center item-center",children:[n&&(0,Cl.jsx)(Gg,{type:"button",label:c.translate("sharing.facebookAriaLabel"),icon:(0,Cl.jsx)(kg,{className:"icon font-size-20","aria-hidden":!0}),className:"shrink-0 mx-1",onClick:()=>r(Mg.FACEBOOK,Lg.MODAL),trackingElement:"shareOnFacebook",dataQa:"share-via-facebook"}),i&&(0,Cl.jsx)(Gg,{type:"button",label:c.translate("sharing.twitterAriaLabel"),icon:(0,Cl.jsx)(jg,{className:"icon font-size-20","aria-hidden":!0}),className:"shrink-0 mx-1",onClick:()=>r(Mg.TWITTER,Lg.MODAL),trackingElement:"shareOnTwitter",dataQa:"share-via-twitter"}),s&&(0,Cl.jsx)(Gg,{type:"button",label:c.translate("sharing.linkedinAriaLabel"),icon:(0,Cl.jsx)(wg,{className:"icon font-size-20","aria-hidden":!0}),className:"shrink-0 mx-1",onClick:()=>r(Mg.LINKEDIN,Lg.MODAL),trackingElement:"shareOnLinkedin",dataQa:"share-via-linkedin"}),a&&(0,Cl.jsx)(Gg,{as:"a",href:h?void 0:l(Mg.EMAIL),label:c.translate("sharing.emailAriaLabel"),icon:(0,Cl.jsx)(vg,{className:"icon font-size-20","aria-hidden":!0}),className:"shrink-0 mx-1",trackingElement:"shareOnEmail",dataQa:"share-via-email"}),y&&(0,Cl.jsx)(Gg,{type:"button",label:c.translate("sharing.moreOptionsAriaLabel"),icon:(0,Cl.jsx)(bg,{className:"icon font-size-20","aria-hidden":!0}),className:"shrink-0 mx-1",onClick:p,trackingElement:"shareOnMoreOptions",dataQa:"share-via-more-options"})]})})},Vg=(0,kr.memo)(qg),Hg={minHeight:"48px"},Kg=e=>{let{transitionEntered:t,ThankYouAnimation:n,displayPDU:i,thankYouTitle:s,descriptionPDU:a,descriptionSharing:o,descriptionUpsell:r,showFacebook:l,showTwitter:c,showLinkedin:u,showEmail:d,sharingText:h,share:m,getSharingLink:p,handleCloseClick:g}=e;const y=(0,nc.t)(),f=(0,Bl.P)(),v=(0,Zl.$)(),S=t&&!v,E=(0,kr.useRef)(null),A=(0,kr.useRef)(null),C=(0,kr.useRef)(null),[b,P]=(0,kr.useState)(i),[N,D]=(0,kr.useState)(24);(0,kr.useEffect)((()=>{const e=setTimeout((()=>{P(i)}),150);return()=>{clearTimeout(e)}}),[i]),(0,kr.useEffect)((()=>{if(C.current&&i){const e=C.current.offsetHeight;D(e)}}),[i,a]);const T={height:`${N}px`};return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(ug,{className:(0,Ml.A)("shrink-0 border-radius-10 mt-2",f?"mx-3":"mx-2")}),(0,Cl.jsx)(bc,{size:f?40:32,sizeMin:24}),(0,Cl.jsx)(td,{className:"px-body shrink-0",children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 d-flex flex-column justify-center",children:[(0,Cl.jsx)(n,{className:"mx-auto",shouldAnimate:S}),(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-50-semibold text-center mt-4",{"text-ellipsis":f,"text-line-clamp-2":!f&&i,"text-line-clamp-4":!f&&!i}),"data-qa":"thank-you-header-title",children:s}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:E,timeout:200,classNames:r&&!v?"rtg-thank-you-description":"",children:(0,Cl.jsx)("div",{ref:E,className:"p-rel mt-2",style:T,children:i?(0,Cl.jsx)("p",{ref:C,className:(0,Ml.A)("p-abs inset-top-start inset-top-end text-center",f?"text-ellipsis":"text-line-clamp-2"),"data-qa":"post-donation-upsell-title-label",children:a}):(0,Cl.jsx)("p",{className:(0,Ml.A)("p-abs inset-top-start inset-top-end text-with-nowrap text-center",f?"text-ellipsis":"text-line-clamp-5"),"data-qa":"thank-you-header-label",dangerouslySetInnerHTML:{__html:r||o}})})},i?"before-pdu-label":"after-pdu-label")})]})}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:A,timeout:250,classNames:v?"":"rtg-pdu-display-sharing",children:(0,Cl.jsx)("div",{ref:A,className:"shrink-0",children:b?(0,Cl.jsx)(ig,{className:f?"mt-12 mx-3 mb-13":"mt-5 mx-1 mb-1"}):(0,Cl.jsxs)(gd,{className:f?"pt-12":"pt-8 pb-9",children:[(0,Cl.jsx)("div",{className:"d-flex flex-column justify-end",style:Hg,children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-60-medium text-center",f?"text-ellipsis":"text-line-clamp-2"),children:y.translate("sharing.label")})}),(0,Cl.jsx)(Vg,{className:"mt-4",showFacebook:l,showTwitter:c,showLinkedin:u,showEmail:d,sharingText:h,share:m,getSharingLink:p}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-13",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",onClick:g,"data-qa":"close","data-tracking-element-name":"closeButton",children:y.translate("thankYouScreen.button")})})]})})},b?"before-pdu":"after-pdu")})]})},Yg=(0,kr.memo)(Kg),zg=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:(0,Ml.A)(e.className),"aria-hidden":!!e.ariaHidden||void 0,fill:"none",height:null!==(t=e.height)&&void 0!==t?t:48,viewBox:"0 0 48 48",width:null!==(n=e.width)&&void 0!==n?n:48,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"52.4762",width:"45",x:"1.5",y:"-9.47619",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feMorphology",{in:"SourceAlpha",operator:"erode",radius:"14.4762",result:"effect1_innerShadow_8986_17764"}),(0,Cl.jsx)("feOffset",{dy:"-14.4762"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"12.0635"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 0.439937 0 0 0 0 0.429167 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_8986_17764"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-9.65079"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"4.8254"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.941667 0 0 0 0 0.0293161 0 0 0 0 0.0117708 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"effect1_innerShadow_8986_17764",mode:"normal",result:"effect2_innerShadow_8986_17764"})]}),(0,Cl.jsxs)("filter",{id:`b-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"14",width:"14",x:"29.5",y:"26",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:"-1",dy:"-1"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.843137 0 0 0 0 0 0 0 0 0 0.14902 0 0 0 0.75 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_8986_17764"})]}),(0,Cl.jsxs)("linearGradient",{id:`c-${i}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ef5350"}),(0,Cl.jsx)("stop",{offset:".766418",stopColor:"#f00703"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#d90400"})]}),(0,Cl.jsx)("linearGradient",{id:`d-${i}`,gradientUnits:"userSpaceOnUse",x1:"13.5",x2:"26",xlinkHref:`#c-${i}`,y1:"9",y2:"40"}),(0,Cl.jsxs)("radialGradient",{id:`e-${i}`,cx:"0",cy:"0",gradientTransform:"matrix(8.99996281 14.49996639 -14.49996639 8.99996281 32.5 30)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:".674662",stopColor:"#e7e7e7"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#c4c4c4"})]}),(0,Cl.jsx)("linearGradient",{id:`f-${i}`,gradientUnits:"userSpaceOnUse",x1:"33.9667",x2:"38.7609",xlinkHref:`#c-${i}`,y1:"28.3684",y2:"38.4087"}),(0,Cl.jsx)("g",{filter:`url(#a-${i})`,children:(0,Cl.jsx)("path",{d:"m24 43c41.6475-22.8943 15.6537-49.10252 0-33.05744-15.65373-16.04526-41.6475 10.16294 0 33.05744z",fill:`url(#d-${i})`})}),(0,Cl.jsx)("circle",{cx:"37",cy:"33.5",fill:`url(#e-${i})`,r:"9.5"}),(0,Cl.jsx)("g",{filter:`url(#b-${i})`,children:(0,Cl.jsx)("path",{d:"m38.5 28.5c0-.8284-.6716-1.5-1.5-1.5s-1.5.6716-1.5 1.5v3.5h-3.5c-.8284 0-1.5.6716-1.5 1.5s.6716 1.5 1.5 1.5h3.5v3.5c0 .8284.6716 1.5 1.5 1.5s1.5-.6716 1.5-1.5v-3.5h3.5c.8284 0 1.5-.6716 1.5-1.5s-.6716-1.5-1.5-1.5h-3.5z",fill:`url(#f-${i})`})})]})},Wg=(0,kr.memo)(zg),$g=e=>{let{className:t,isMobileView:n,onMakeAnotherDonation:i}=e;return(0,Cl.jsxs)("button",{type:"button",className:(0,Ml.A)("btn btn-default h-auto d-flex items-center text-start text-wrap-normal px-6 py-4",t),onClick:i,"data-qa":"tribute-make-another","data-tracking-element-name":"makeAnotherTribute",children:[(0,Cl.jsx)(Wg,{className:"shrink-0 me-5",width:32,height:32,ariaHidden:!0}),(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-60-regular grow-1",n?"text-ellipsis":"text-line-clamp-2"),token:"thankYouScreen.makeAnotherTribute.button"})]})},Xg=(0,kr.memo)($g),Qg=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":e.ariaHidden&&!0,fill:"none",height:null!==(t=e.height)&&void 0!==t?t:48,viewBox:"0 0 48 48",width:null!==(n=e.width)&&void 0!==n?n:48,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("linearGradient",{id:`a-${i}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#afd9ff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#afd9ff",stopOpacity:"0"})]}),(0,Cl.jsx)("linearGradient",{id:`b-${i}`,gradientUnits:"userSpaceOnUse",x1:"50.5",x2:"31.9257",xlinkHref:`#a-${i}`,y1:"32",y2:"6.87716"}),(0,Cl.jsxs)("linearGradient",{id:`c-${i}`,gradientUnits:"userSpaceOnUse",x1:"16",x2:"20",y1:"39.5",y2:"40.5",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#8fbcff"}),(0,Cl.jsx)("stop",{offset:".208333",stopColor:"#8fbcff",stopOpacity:".813559"}),(0,Cl.jsx)("stop",{offset:".234375",stopColor:"#8fbcff",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`d-${i}`,gradientUnits:"userSpaceOnUse",x1:"67.2852",x2:"2.79451",y1:"17.1454",y2:"39.9202",children:[(0,Cl.jsx)("stop",{offset:".442708",stopColor:"#fff",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff"})]}),(0,Cl.jsx)("linearGradient",{id:`e-${i}`,gradientUnits:"userSpaceOnUse",x1:"25.5",x2:"40",xlinkHref:`#a-${i}`,y1:"20.5",y2:"27"}),(0,Cl.jsx)("path",{d:"m4.88359 25.1745h.00002l.05609-.0474h.00001l.03057-.0259c3.24586-2.7466 4.28803-3.6284 39.39632-18.14832l-33.4844 25.29342c-4.27204 1.4893-7.23131 1.0342-8.7118-.4983-.40047-.6047-.53429-1.5383-.16141-2.6895.37824-1.1677 1.27292-2.5289 2.8746-3.884z",fill:"#8fbcff",stroke:`url(#b-${i})`}),(0,Cl.jsx)("path",{d:"m47.7789 5.00045-36.6327 27.66835 3.9702 10.7136 2.3144-11.4342z",fill:"#5a9bfc"}),(0,Cl.jsx)("path",{d:"m24.7306 34.3642-8.8354 7.6768 1.9178-9.4742z",fill:"#2169d6",stroke:`url(#c-${i})`}),(0,Cl.jsx)("path",{d:"m17.9212 32.183 29.061-25.80479c-.2055.91261-.5316 2.26188-1.0254 4.07169-1.0305 3.7768-2.791 9.5588-5.7082 17.5634-2.6186 7.1853-6.5442 10.3049-10.3618 11.2275-3.8293.9254-7.6707-.3285-10.191-2.1484-.9843-1.0568-1.4305-2.3209-1.6277-3.3432-.0993-.5145-.134-.9608-.144-1.2765-.0036-.1154-.0039-.213-.0029-.2897z",fill:"#6ca7ff"}),(0,Cl.jsx)("path",{d:"m17.9212 32.183 29.061-25.80479c-.2055.91261-.5316 2.26188-1.0254 4.07169-1.0305 3.7768-2.791 9.5588-5.7082 17.5634-2.6186 7.1853-6.5442 10.3049-10.3618 11.2275-3.8293.9254-7.6707-.3285-10.191-2.1484-.9843-1.0568-1.4305-2.3209-1.6277-3.3432-.0993-.5145-.134-.9608-.144-1.2765-.0036-.1154-.0039-.213-.0029-.2897z",fill:`url(#d-${i})`,fillOpacity:".4"}),(0,Cl.jsx)("path",{d:"m17.9212 32.183 29.061-25.80479c-.2055.91261-.5316 2.26188-1.0254 4.07169-1.0305 3.7768-2.791 9.5588-5.7082 17.5634-2.6186 7.1853-6.5442 10.3049-10.3618 11.2275-3.8293.9254-7.6707-.3285-10.191-2.1484-.9843-1.0568-1.4305-2.3209-1.6277-3.3432-.0993-.5145-.134-.9608-.144-1.2765-.0036-.1154-.0039-.213-.0029-.2897z",stroke:`url(#e-${i})`})]})},Zg=(0,kr.memo)(Qg),Jg=e=>{let{tributeDonorPortalLink:t,isMobileView:n}=e;return(0,Cl.jsxs)("a",{href:t,className:"btn btn-default h-auto d-flex items-center text-start text-wrap-normal px-6 py-4",target:"_blank",rel:"noreferrer","data-qa":"tribute-send-card","data-tracking-element-name":"completeDedication",children:[(0,Cl.jsx)(Zg,{className:"shrink-0 me-5",width:32,height:32,ariaHidden:!0}),(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-60-regular grow-1",n?"text-ellipsis":"text-line-clamp-2"),token:"thankYouScreen.sendCard.button"})]})},ey=(0,kr.memo)(Jg),ty=e=>{let{transitionEntered:t,ThankYouAnimation:n,thankYouTitle:i,descriptionTribute:s,tributeDonorPortalLink:a,handleCloseClick:o,handleMakeAnotherDonationClick:r}=e;const l=(0,nc.t)(),c=(0,Bl.P)(),u=(0,Zl.$)(),d=t&&!u;return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(ug,{className:(0,Ml.A)("shrink-0 border-radius-10 mt-2",c?"mx-3":"mx-2")}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",c?"pt-10":"pt-8"),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 d-flex flex-column justify-center",children:[(0,Cl.jsx)(n,{className:"mx-auto",shouldAnimate:d}),(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-50-semibold text-center mt-4",c?"text-ellipsis":"text-line-clamp-3"),children:i}),(0,Cl.jsx)("p",{className:(0,Ml.A)("text-with-nowrap text-center mt-2",c?"text-ellipsis":"text-line-clamp-4"),dangerouslySetInnerHTML:{__html:s}})]})}),(0,Cl.jsxs)(gd,{className:c?"pt-12":"pt-8 pb-9",children:[(0,Cl.jsx)(ey,{tributeDonorPortalLink:a,isMobileView:c}),(0,Cl.jsx)(Xg,{className:"mt-3",isMobileView:c,onMakeAnotherDonation:r}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-8",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",onClick:o,"data-qa":"close","data-tracking-element-name":"closeButton",children:l.translate("thankYouScreen.button")})})]})]})},ny=(0,kr.memo)(ty),iy={[$l.SHARING]:Yg,[$l.TRIBUTE]:ny,[$l.DEFAULT]:hg},sy={[hs.SAD]:Qm,[hs.NEUTRAL]:Pp,[hs.HAPPY]:Lp},ay=e=>{let{transitionEntered:t}=e;const{state:n,controller:i}=Tc(wl.THANK_YOU),s=(0,Bl.P)(),a=(0,nc.t)(),o=_r(),r=iy[n.variant],l=sy[n.emotionalType],c=Rc(),u=(0,kr.useRef)(!1),d=(0,Nl.n)().getAskPageConfig().show,h=Zu(!0),m=(0,kr.useCallback)(((e,t)=>{i.share(e,t)}),[i]),p=(0,kr.useCallback)((e=>i.getSharingLink(e)),[i]);return(0,kr.useEffect)((()=>{u.current||(c.trackCheckoutCustomEvent({type:Ee.POST_DONATION_CELEBRATION_ANIMATION_SHOWN,data:i.postDonationCelebrationAnimationTrackingData}),u.current=!0)}),[c,i]),(0,Cl.jsxs)("section",{ref:h,className:"flow-screen","aria-label":a.translate("common.screenAriaLabel",{screenTitle:a.translate("thankYouScreen.screenTitle")}),"data-qa":"active-screen-thank-you",children:[s&&!d&&(0,Cl.jsx)(Ad,{}),(0,Cl.jsx)(r,{transitionEntered:t,ThankYouAnimation:l,thankYouTitle:i.thankYouTitle,descriptionSharing:i.descriptionSharing,descriptionUpsell:i.descriptionUpsell,descriptionPDU:i.descriptionPdu,descriptionTribute:i.descriptionTribute,displayPDU:n.postDonationUpsell.displayPduScreen,showFacebook:n.sharing.showFacebook,showTwitter:n.sharing.showTwitter,showLinkedin:n.sharing.showLinkedin,showEmail:n.sharing.showEmail,sharingText:n.sharing.sharingText,share:m,getSharingLink:p,tributeDonorPortalLink:n.tributeDonorPortalLink,handleCloseClick:()=>{o.emit(Tr.SHOULD_HIDE,{})},handleMakeAnotherDonationClick:()=>{o.emit(Tr.SHOULD_HIDE,{shouldReopen:!0,tributeSelected:!0})}})]})},oy=(0,kr.memo)(ay);var ry;function ly(){return ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ly.apply(null,arguments)}var cy=function(e,t){return kr.createElement("svg",ly({fill:"none",height:28,viewBox:"0 0 28 28",width:28,xmlns:"http://www.w3.org/2000/svg",ref:t},e),ry||(ry=kr.createElement("path",{clipRule:"evenodd",d:"m2 14c0-6.62742 5.37258-12 12-12 6.6274 0 12 5.37258 12 12 0 6.6274-5.3726 12-12 12-6.62742 0-12-5.3726-12-12zm12-14c-7.73199 0-14 6.26801-14 14 0 7.732 6.26801 14 14 14 7.732 0 14-6.268 14-14 0-7.73199-6.268-14-14-14zm-4.10223 5.74899c-.14294-.53346-.69128-.85004-1.22475-.7071-.53346.14294-.85005.69128-.7071 1.22474l.87766 3.27549c-1.42369 1.64968-2.03436 3.95478-1.42697 6.22158s2.2888 3.9578 4.34659 4.6746l.8777 3.2758c.143.5335.6913.85 1.2248.7071s.85-.6913.7071-1.2247l-.6378-2.3802c.6039.0055 1.2181-.0698 1.8287-.2334.3343-.0896.6565-.2027.965-.3371l.5933 2.214c.1429.5335.6913.8501 1.2247.7071.5335-.1429.8501-.6913.7071-1.2247l-.7558-2.8206c.8423-.7407 1.4859-1.6767 1.8788-2.7157.1953-.5166-.0651-1.0937-.5817-1.2891-.5166-.1953-1.0937.0651-1.2891.5817-.3369.8912-.9339 1.6736-1.7219 2.232-.452.3203-.9684.5679-1.538.7206-.8223.2203-1.649.214-2.417.0207-1.6417-.4133-3.01255-1.6788-3.48064-3.4257-.4681-1.747.08637-3.5283 1.30144-4.7071.5685-.55143 1.2813-.97021 2.1035-1.19054.5697-.15263 1.1407-.19634 1.6923-.14497.9617.08956 1.8698.46873 2.6072 1.07201.4275.3497 1.0575.2867 1.4072-.1408.3497-.42746.2867-1.05748-.1408-1.40719-.8597-.70339-1.885-1.19215-2.9848-1.41247l-.7557-2.82032c-.1429-.53347-.6913-.85005-1.2248-.70711-.5334.14294-.85.69128-.7071 1.22475l.5932 2.21369c-.3345.03787-.67.10099-1.0043.19056-.6106.1636-1.1801.40556-1.7004.71221z",fill:"currentColor",fillRule:"evenodd"})))},uy=(0,kr.forwardRef)(cy),dy=(0,kr.memo)(uy);const hy=e=>{let{prevContent:t,content:n,disabled:i,onAddComment:s,onHighlight:a,setRef:o}=e;const r=(0,nc.t)(),[l,c]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{if(t===n||!n)return void c(!1);a(),c(!0);const e=window.setTimeout((()=>{c(!1)}),400);return()=>{window.clearTimeout(e)}}),[n,t,a]),(0,Cl.jsxs)("button",{ref:o,type:"button",className:(0,Ml.A)("btn-reset body-40-regular p-rel self-start d-flex items-center max-w-100 border-radius-2 text-start",{"is-highlighted":l,"pointer-events-none":i}),dir:"auto",disabled:i,onClick:()=>s(),"data-qa":"comment-link","data-tracking-element-name":"navigateToComment",children:[(0,Cl.jsx)("span",{className:(0,Ml.A)("comment-highlight p-abs inset-0 border-radius-4",{"bg-blue-60":l})}),n?(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("span",{className:(0,Ml.A)("comment-btn-title p-rel shrink-0 pe-1",{"text-white":l}),children:r.translate("donateForm.comment.commentAdded")}),(0,Cl.jsx)("span",{className:(0,Ml.A)("comment-btn-link p-rel text-nowrap text-ellipsis text-gray-100-hover-gray-80 text-decor cursor-pointer",{"text-white":l}),title:n,dir:"auto",children:n})]}):(0,Cl.jsx)(Cl.Fragment,{children:(0,Cl.jsx)("span",{className:(0,Ml.A)("comment-btn-link p-rel text-nowrap text-ellipsis text-gray-100-hover-gray-80 text-decor cursor-pointer",{"text-white":l}),children:r.translate("donateForm.comment.label")})})]})},my=(0,kr.memo)(hy);var py,gy;function yy(){return yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},yy.apply(null,arguments)}!function(e){e[e.FORM_GROUP=0]="FORM_GROUP",e[e.BUTTON=1]="BUTTON"}(py||(py={}));var fy=function(e,t){return kr.createElement("svg",yy({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),gy||(gy=kr.createElement("path",{d:"m15.8 12.4009-6.66667 5c-.32962.2472-.8.012-.8-.4v-9.99999c0-.41203.47039-.64722.8-.4l6.66667 4.99999c.2667.2.2667.6 0 .8z",fill:"currentColor"})))},vy=(0,kr.forwardRef)(fy),Sy=(0,kr.memo)(vy);const Ey=(0,kr.createContext)({overflowContainerRef:null}),Ay=e=>{let{children:t,node:n,selectedKey:i,isGroup:s,level:a,expandedGroupKeys:o,highlightedKey:r,onSelect:l,onToggleGroup:c,onGoalClick:u}=e;const[d,h]=(0,kr.useState)(!1),m=(0,kr.useRef)(null),p=(0,kr.useRef)(!1),g=s?`cs-group-option-${n.id}`:`cs-option-${n.id}`,y=s&&d,f=n.key===i,v=n.name.length>120?n.name.slice(0,120)+"...":n.name,S=(0,kr.useMemo)((()=>{if(s&&o)return o.has(n.key)}),[o,s,n.key]);(0,kr.useEffect)((()=>{p.current=!1}),[i,n.key]),(0,kr.useEffect)((()=>{let e;void 0!==S&&(e=S),void 0!==e&&h(e)}),[S]),((e,t,n,i)=>{const{overflowContainerRef:s}=(()=>{const e=(0,kr.useContext)(Ey);if(!e)throw new Error("useDropdownContext must be used within DropdownContext.Provider");return e})();(0,kr.useEffect)((()=>{const a=setTimeout((()=>{if(e!==n||!i.current||!(null==s?void 0:s.current))return;const a=s.current;if(!(a.scrollHeight>a.clientHeight))return;const o=a.getBoundingClientRect(),r=i.current.getBoundingClientRect(),l=r.top-o.top+a.scrollTop,c=l+r.height,u=a.scrollTop,d=u+a.clientHeight,h=t===n?"smooth":"instant";l<u?a.scrollTo({top:l,behavior:h}):c>d&&a.scrollTo({top:c-a.clientHeight,behavior:h})}),0);return()=>clearTimeout(a)}),[e,t,n,i,s])})(r,i,n.key,m);const E=(0,kr.useCallback)((()=>{p.current=!0,null==c||c(n.key)}),[n,c]),A=(0,kr.useCallback)((()=>{l(n),null==u||u(n)}),[n,l,u]);return(0,Cl.jsxs)("li",{ref:m,role:"treeitem","aria-labelledby":g,"aria-selected":f,"aria-expanded":s?y:void 0,"data-testid":"goal-select-dropdown-option","data-qa":"goal-select-dropdown-option",children:[(0,Cl.jsxs)("p",{id:g,className:(0,Ml.A)(s?"cs-option-group-label":"cs-option-label",`is-level-${a}`,{"is-selected":f,"is-highlighted":r===n.key}),"data-testid":"goal-select-dropdown-option-content","data-qa":"goal-select-dropdown-option-content","data-tracking-element-name":s?"designationTreeGroup":"designationTreeGoal",onClick:s?E:A,children:[(0,Cl.jsx)("span",{className:"text-ellipsis","data-qa":"goal-select-dropdown-goal-option-label",children:v}),s&&(0,Cl.jsx)(Sy,{className:(0,Ml.A)("cs-option-arrow icon-fill font-size-18 ",{"is-group-open":y}),"data-testid":"goal-select-dropdown-option-group-icon","data-qa":"goal-select-dropdown-option-group-icon","aria-hidden":!0}),f&&(0,Cl.jsx)("span",{className:"icon-slot icon-slot-18 self-start shrink-0 font-size-18 text-blue-60 ms-auto","aria-hidden":!0,children:(0,Cl.jsx)(Ld,{className:"icon-stroke icon-stroke-2 p-abs inset-centered"})})]}),y&&t]})};Ay.displayName="OptionItem";const Cy=(0,kr.memo)(Ay),by=e=>{var{className:t,nodes:n,selectedKey:i,level:s,highlightedKey:a,expandedGroupKeys:o,overflowContainerRef:r,onSelect:l,onScroll:c,onToggleGroup:u,onGoalClick:h}=e,m=(0,d.Tt)(e,["className","nodes","selectedKey","level","highlightedKey","expandedGroupKeys","overflowContainerRef","onSelect","onScroll","onToggleGroup","onGoalClick"]);const p=(0,kr.useRef)(null);return(0,kr.useImperativeHandle)(r,(()=>p.current),[]),(0,Cl.jsx)("ul",Object.assign({ref:p,className:(0,Ml.A)("cs-option-list custom-scrollbar",t),"data-testid":"goal-select-dropdown-list","data-qa":"goal-select-dropdown-list",onScroll:c},m,{children:n.map((e=>{const t=e.nodes.length>0;return(0,Cl.jsx)(Cy,{node:e,selectedKey:i,isGroup:t,level:s,expandedGroupKeys:o,highlightedKey:a,onSelect:l,onGoalClick:h,onToggleGroup:u,children:t&&(0,Cl.jsx)(Py,{selectedKey:i,nodes:e.nodes,level:s+1,expandedGroupKeys:o,highlightedKey:a,role:"group",onSelect:l,onToggleGroup:u,onGoalClick:h})},e.id)}))}))};by.displayName="OptionList";const Py=(0,kr.memo)(by),Ny=e=>{var{width:t,height:n,contentHeight:i,className:s,isSkeletonAnimated:a=!0,dataTestId:o}=e,r=(0,d.Tt)(e,["width","height","contentHeight","className","isSkeletonAnimated","dataTestId"]);const l={width:t,height:n},c={height:i};return(0,Cl.jsx)("div",Object.assign({className:(0,Ml.A)("skeleton",s),style:l,"data-testid":null!=o?o:"skeleton"},r,{children:a&&(0,Cl.jsx)("div",{className:"skeleton-content",style:c})}))},Dy=(0,kr.memo)(Ny),Ty=e=>{let{labels:t}=e;return(0,Cl.jsxs)("div",{"aria-label":t.loading,role:"status","aria-live":"polite","data-testid":"goal-select-dropdown-loading",children:[(0,Cl.jsx)(Dy,{width:"100%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"81%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"100%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"89%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"80%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"96%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"75%",height:"36px",contentHeight:"20px","aria-hidden":!0}),(0,Cl.jsx)(Dy,{width:"91%",height:"36px",contentHeight:"20px","aria-hidden":!0})]})},ky=(0,kr.memo)(Ty);var Iy;function _y(){return _y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_y.apply(null,arguments)}var Oy=function(e,t){return kr.createElement("svg",_y({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),Iy||(Iy=kr.createElement("path",{d:"m21 21-4.35-4.35m2.35-5.65c0 4.4183-3.5817 8-8 8-4.41828 0-8-3.5817-8-8 0-4.41828 3.58172-8 8-8 4.4183 0 8 3.58172 8 8z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},xy=(0,kr.forwardRef)(Oy),wy=(0,kr.memo)(xy);const Ry=300,My=e=>{let{labels:t,debounceTimeMs:n=Ry,onChange:i,onReset:s,onKeyDown:a}=e;const o=(0,kr.useId)(),r=(0,Bl.P)(),[l,c]=(0,kr.useState)(""),u=(0,kr.useRef)(null),d=(0,kr.useRef)(null),h=(0,kr.useCallback)((e=>{c(e.target.value)}),[]),m=(0,kr.useCallback)((e=>{var t;e.preventDefault(),e.stopPropagation(),c(""),i(""),s(),r||null===(t=u.current)||void 0===t||t.focus()}),[i,s,r]),p=(0,kr.useCallback)((e=>{e.code!==Fl.J.ENTER&&e.code!==Fl.J.SPACE||(e.preventDefault(),m(e))}),[m]);(0,kr.useEffect)((()=>{const e=setTimeout((()=>{i(l)}),n);return()=>clearTimeout(e)}),[l,n,i,s]),(0,kr.useEffect)((()=>{var e;r||null===(e=u.current)||void 0===e||e.focus()}),[r]);const g=(0,kr.useCallback)((e=>{e.key!==Fl.J.DOWN&&e.key!==Fl.J.UP||(e.preventDefault(),a(e,!0))}),[a]);return(0,kr.useEffect)((()=>()=>s()),[s]),(0,Cl.jsxs)("div",{className:"p-rel shrink-0 mx-3 mt-3",children:[(0,Cl.jsx)("label",{htmlFor:`cs-search-input-${o}`,className:"sr-only","data-qa":"goal-select-search-label",children:t.select.inputSearch.placeholder}),(0,Cl.jsx)("input",{ref:u,id:`cs-search-input-${o}`,type:"text",className:"cs-search-input form-control",placeholder:t.select.inputSearch.placeholder,value:l,role:"combobox","aria-haspopup":"tree","aria-autocomplete":"list","data-qa":"goal-select-dropdown-search-input","data-testid":"goal-select-dropdown-search-input","data-tracking-element-name":"designationTreeSearch",onInput:h,onKeyDown:g}),(0,Cl.jsx)(wy,{className:"icon-stroke p-abs inset-centered-start ms-4","data-testid":"goal-select-dropdown-search-icon","aria-hidden":!0}),l&&(0,Cl.jsx)("button",{ref:d,type:"button",className:"cs-search-clear btn-icon p-abs inset-centered-end font-size-18 text-gray-40 me-2","aria-label":t.select.inputSearch.clearButtonAriaLabel,"data-qa":"goal-select-dropdown-search-clear-button","data-testid":"goal-select-dropdown-search-clear-button",onClick:m,onKeyDown:p,children:(0,Cl.jsx)(su.A,{className:"icon-stroke p-abs inset-centered","aria-hidden":!0})})]})};My.displayName="Search";const Ly=(0,kr.memo)(My),Fy=(e,t)=>{for(const n of e){if(n.key===t)return n;if(n.nodes.length>0){const e=Fy(n.nodes,t);if(e)return e}}return null};var Uy;!function(e){e.EXPAND="EXPAND",e.COLLAPSE="COLLAPSE",e.SELECT="SELECT"}(Uy||(Uy={}));const jy=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{value:0},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=[];for(const a of e){const e=a.nodes.length>0,o=t.has(a.key),r=n.value;n.value+=1;const l={key:a.key,flatIndex:r,isFolded:e?!o:null,hasChildren:e,parentIndex:i,nodes:[]};e&&o&&(l.nodes=jy(a.nodes,t,n,r)),s.push(l)}return s},By=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(const n of e)t.push(n),n.nodes.length>0&&By(n.nodes,t);return t},Gy=new Map,qy=new ResizeObserver((e=>{e.forEach((e=>{const t=Gy.get(e.target);t&&t()}))})),Vy=10,Hy=312,Ky=24,Yy=e=>{var{dropdownRef:t,labels:n,tree:i,selectedItems:s,selectedBranch:a,selectedKey:o,isLoading:r,style:l,searchValue:c,foldGroupsThreshold:u=Vy,onSelect:h,onSearchChange:m,onSearchReset:p,onOptionListScroll:g,onRequestClose:y,onSearchFinished:f,onOptionListScrollVisible:v,onOptionListSearchInputVisible:S,onGoalClick:E,onGroupOpen:A,onBlur:C}=e,b=(0,d.Tt)(e,["dropdownRef","labels","tree","selectedItems","selectedBranch","selectedKey","isLoading","style","searchValue","foldGroupsThreshold","onSelect","onSearchChange","onSearchReset","onOptionListScroll","onRequestClose","onSearchFinished","onOptionListScrollVisible","onOptionListSearchInputVisible","onGoalClick","onGroupOpen","onBlur"]);const P=(0,kr.useRef)(null),N=!r&&0===i.initialSize,D=i.initialSize>10&&!r&&!N,T=!N&&!r&&0===i.currentSize,k=i.currentSize!==i.initialSize&&!!c,I=i.initialSize<=u||k,{highlightedKey:_,expandedGroupKeys:O,onToggleGroup:x,handleKeyDown:w,handleKeyUp:R}=(e=>{let{tree:t,selectedKey:n,selectedBranch:i,searchValue:s,openGroupsByDefault:a,onGroupOpen:o,onSelect:r,onRequestClose:l}=e;const[c,u]=(0,kr.useState)(-1),[d,h]=(0,kr.useState)(null),[m,p]=(0,kr.useState)(0),g=(0,kr.useRef)(!1),y=(0,kr.useCallback)((e=>{g.current=!0,u(e)}),[]),{highlightedKey:f,flatKeysLength:v,expandedGroupKeys:S,onToggleGroup:E,initialVerticalIndex:A}=(e=>{let{tree:t,selectedKey:n,selectedBranch:i,searchValue:s,openGroupsByDefault:a,onGroupOpen:o,verticalNavigationIndex:r,horizontalNavigationAction:l,horizontalNavigationCounter:c,onSelect:u,onRequestClose:d,setVerticalNavigationIndex:h}=e;const[m,p]=(0,kr.useState)(n),[g,y]=(0,kr.useState)(new Set(i)),[f,v]=(0,kr.useState)(null),S=(0,kr.useRef)(c),E=(0,kr.useRef)(r),A=(0,kr.useMemo)((()=>jy(t.nodes,g)),[t.nodes,g]),C=(0,kr.useMemo)((()=>By(A)),[A]),b=(0,kr.useMemo)((()=>C.map((e=>e.key))),[C]),P=(0,kr.useCallback)((e=>{y((n=>{const i=new Set(n),s=Fy(t.nodes,e);return i.has(e)?(i.delete(e),v({node:s,isOpen:!1})):(i.add(e),v({node:s,isOpen:!0})),i}))}),[t.nodes]);(0,kr.useEffect)((()=>{f&&o&&(o(f.node,f.isOpen),v(null))}),[f,o]),(0,kr.useEffect)((()=>{if(r!==E.current&&(E.current=r,r>=0&&r<C.length)){const e=C[r];e&&e.key!==m&&p(e.key)}}),[r,C,m]),(0,kr.useEffect)((()=>{if(c===S.current)return;if(S.current=c,r<0||!l)return;const e=C[r];if(!e)return;const n=null!==e.isFolded;if(l!==Uy.SELECT)if(l!==Uy.EXPAND){if(l===Uy.COLLAPSE){if(n)return e.isFolded?void(null!==e.parentIndex&&h(e.parentIndex)):void P(e.key);if(null!==e.parentIndex){const t=C[e.parentIndex];t&&(t.isFolded||P(t.key),h(e.parentIndex))}}}else{if(!n)return;e.isFolded&&P(e.key)}else if(n)P(e.key);else{const n=t.allItems.get(e.key);if(!n)return;u(n),d()}}),[c,r,l,C,t.allItems,u,d,P,h]),(0,kr.useEffect)((()=>{m&&0!==b.length?b.includes(m)||p(b[0]):p(null)}),[b,m]),(0,kr.useEffect)((()=>{y(s?new Set(t.allGroupItems.keys()):new Set(i))}),[s,t.allGroupItems,i]),(0,kr.useEffect)((()=>{a&&y(new Set(t.allGroupItems.keys()))}),[a,t.allGroupItems]);const N=(0,kr.useMemo)((()=>m?b.indexOf(m):-1),[m,b]);return{highlightedKey:m,flatKeys:b,flatKeysLength:b.length,expandedGroupKeys:g,setHighlightedKey:p,onToggleGroup:P,enrichedTree:A,initialVerticalIndex:N}})({tree:t,selectedKey:n,selectedBranch:i,searchValue:s,openGroupsByDefault:a,onGroupOpen:o,verticalNavigationIndex:c,horizontalNavigationAction:d,horizontalNavigationCounter:m,onSelect:r,onRequestClose:l,setVerticalNavigationIndex:y}),{handleKeyDown:C,handleKeyUp:b,verticalNavigationIndex:P,horizontalNavigationAction:N,horizontalNavigationCounter:D}=(e=>{let{onRequestClose:t,searchValue:n,flatKeysLength:i,initialVerticalIndex:s}=e;const[a,o]=(0,kr.useState)(!1),[r,l]=(0,kr.useState)(s),[c,u]=(0,kr.useState)(null),[d,h]=(0,kr.useState)(0);(0,kr.useEffect)((()=>{o(!!n)}),[n]),(0,kr.useEffect)((()=>{l(s)}),[s]);const m=(0,kr.useCallback)((e=>{e.code===Fl.J.ESC&&(e.preventDefault(),e.stopPropagation(),t())}),[t]);return{handleKeyDown:(0,kr.useCallback)(((e,t)=>{const n=e.code,s=i-1;if(!a||t){if(n===Fl.J.DOWN){e.preventDefault();const t=-1===r?-1:r;return l(t+1>s?0:t+1),void o(!1)}if(n===Fl.J.UP){e.preventDefault();const t=-1===r?0:r;return l(t-1<0?s:t-1),void o(!1)}return n===Fl.J.ENTER||n===Fl.J.SPACE?(e.preventDefault(),u(Uy.SELECT),void h((e=>e+1))):n===Fl.J.RIGHT?(e.preventDefault(),u(Uy.EXPAND),h((e=>e+1)),void o(!1)):void(n===Fl.J.LEFT&&(e.preventDefault(),u(Uy.COLLAPSE),h((e=>e+1)),o(!1)))}}),[i,a,r]),handleKeyUp:m,verticalNavigationIndex:r,horizontalNavigationAction:c,horizontalNavigationCounter:d}})({onRequestClose:l,searchValue:s,flatKeysLength:v,initialVerticalIndex:A});return(0,kr.useEffect)((()=>{if(g.current)return g.current=!1,h(N),void p(D);u(P),h(N),p(D)}),[P,N,D]),{highlightedKey:f,expandedGroupKeys:S,onToggleGroup:E,handleKeyDown:C,handleKeyUp:b}})({tree:i,selectedKey:o,selectedBranch:a,searchValue:c,openGroupsByDefault:I,onGroupOpen:A,onSelect:h,onRequestClose:y});((e,t)=>{const n=(0,kr.useRef)("");(0,kr.useEffect)((()=>{const i=e.searchString;n.current!==i&&(null==t||t(i,{currentSize:e.currentSize,currentCounts:e.currentCounts}),n.current=i)}),[n,t,e])})(i,f),(0,kr.useEffect)((()=>(null==S||S(D),()=>null==S?void 0:S(!1))),[D,S]),((e,t)=>{const n=(0,kr.useRef)(!1),i=(0,kr.useCallback)((()=>{const n=e.current;if(!n)return;const i=n.scrollHeight>n.clientHeight;null==t||t(!!i)}),[e,t]);(0,kr.useEffect)((()=>{const s=e.current;if(s&&!n.current)return Gy.set(s,i),qy.observe(s),n.current=!0,()=>{n.current&&(qy.unobserve(s),Gy.delete(s),n.current=!1),null==t||t(!1)}}),[e,i,t])})(P,v);const M={overflowContainerRef:P};return(0,kr.useEffect)((()=>{var e;D||null===(e=null==t?void 0:t.current)||void 0===e||e.focus()}),[D,t]),(0,Cl.jsx)(Ey.Provider,{value:M,children:(0,Cl.jsxs)("div",Object.assign({ref:t,className:(0,Ml.A)("cs-dropdown p-abs d-flex flex-column bg-white",{"overflow-hidden":r}),style:l,"data-testid":"goal-select-dropdown",onKeyDown:w,onKeyUp:R,tabIndex:D?-1:0,onBlur:C},b,{children:[D&&(0,Cl.jsx)(Ly,{labels:n,onChange:m,onReset:p,onKeyDown:w}),T||N||r?(0,Cl.jsxs)("div",{className:"px-5 pt-3 pb-4",children:[T&&(0,Cl.jsx)("p",{className:"text-ellipsis",role:"alert","data-testid":"goal-select-dropdown-filtered-empty","data-qa":"goal-select-dropdown-filtered-empty",children:n.select.noResults}),N&&(0,Cl.jsx)("p",{className:"text-ellipsis",role:"alert","data-testid":"goal-select-dropdown-empty","data-qa":"goal-select-dropdown-empty",children:n.select.error.loading}),r&&(0,Cl.jsx)(ky,{labels:n})]}):(0,Cl.jsx)(Py,{overflowContainerRef:P,className:"pt-2 pb-3",role:"tree",nodes:i.nodes,selectedKey:o,level:1,expandedGroupKeys:O,highlightedKey:_,onSelect:h,onScroll:g,onToggleGroup:x,onGoalClick:E})]}))})};Yy.displayName="Dropdown";const zy=(0,kr.memo)(Yy),Wy=e=>{var{mode:t,setRef:n,className:i,labels:s,value:a,disabled:o,isLoading:r,hasError:l,errorNode:c,ariaDescribedby:u,onClick:h,onKeyDown:m,onFocus:p}=e,g=(0,d.Tt)(e,["mode","setRef","className","labels","value","disabled","isLoading","hasError","errorNode","ariaDescribedby","onClick","onKeyDown","onFocus"]);const y=(0,kr.useId)(),f=!r&&a,[v,S]=(0,kr.useState)(!1);(0,kr.useEffect)((()=>{const e=setTimeout((()=>{S(!0)}),300);return r?()=>clearTimeout(e):(S(!1),void clearTimeout(e))}),[r]);const E=(0,kr.useCallback)((()=>{r||o||h()}),[r,o,h]);return(0,Cl.jsx)(Cl.Fragment,{children:t===py.FORM_GROUP?(0,Cl.jsxs)("div",{className:"form-group",children:[(0,Cl.jsxs)("div",Object.assign({ref:n,tabIndex:o?void 0:0,className:(0,Ml.A)("cs-trigger form-control form-control-select has-label-floating",i,{"has-error":l}),role:"combobox","aria-labelledby":`cs-label-${y}`,"aria-haspopup":"tree","aria-autocomplete":"list","aria-invalid":l,"aria-required":l,"aria-describedby":u,"data-testid":"goal-select-input","data-qa":"goal-select-block","data-tracking-element-name":"designationSelect",onClick:E,onKeyDown:m,onFocus:p},g,{children:[f&&(0,Cl.jsx)("p",{className:"text-truncate","data-testid":"goal-select-value","data-qa":"goal-select-value",children:a}),r&&(0,Cl.jsx)(Dy,{width:"95%",height:"28px",contentHeight:"20px",isSkeletonAnimated:v,"aria-label":s.loading,role:"status","aria-live":"polite",dataTestId:"goal-select-skeleton"})]})),(0,Cl.jsx)("label",{id:`cs-label-${y}`,className:(0,Ml.A)("form-label is-floating",{"has-value":a||r}),"data-qa":"goal-select-label","data-testid":"goal-select-label",children:a||r?s.select.label:(0,Cl.jsx)("span",{"data-testid":"goal-select-placeholder",children:s.select.placeholder})}),l&&c]}):(0,Cl.jsx)("button",{type:"button",ref:n,className:"btn-link max-w-100 text-ellipsis text-start",disabled:o,"data-qa":"goal-select-add-designation-button","data-testid":"goal-select-add-designation-button","data-tracking-element-name":"addDonationItem",onClick:E,children:s.buttonAdd})})};Wy.displayName="Trigger";const $y=(0,kr.memo)(Wy);class Xy{constructor(e){this._searchString="",this._currentCounts=[],this._currentSize=0,this._nodes=[],this.allItemsMap=this.getItemsMap(e);const t=[...this.allItemsMap.values()];this.allGroupItemsMap=this.getGroupItemsMap(t),this.leafsKeysMap=this.getLeafsKeys(t);const[n,i,s]=this.getNodes(t),a=this.getCounts(n,s);this._initialNodes=n,this._initialSize=i,this._initialCounts=a,this._nodes=n,this._currentSize=i,this._currentCounts=a,this._excludedIds=new Set,this._excludedKeys=new Set}get allItems(){return this.allItemsMap}get allGroupItems(){return this.allGroupItemsMap}get leafsItems(){return this.leafsKeysMap}get initialSize(){return this._initialSize}get currentSize(){return this._currentSize}get nodes(){return this._nodes}get currentCounts(){return this._currentCounts}get searchString(){return this._searchString}setSearchString(e){const t=e.trim().toLowerCase();t!==this._searchString&&(this._searchString=t,this.filterNodes())}setExcludedIds(e){this._excludedIds.clear();for(const t of e)this._excludedIds.add(t);this.filterNodes()}setExcludedKeys(e){this._excludedKeys.clear();for(const t of e)this._excludedKeys.add(t);this.filterNodes()}filterNodes(){const e=new Map;if(!this._searchString&&0===this._excludedIds.size&&0===this._excludedKeys.size)return this._nodes=this._initialNodes,this._currentSize=this._initialSize,void(this._currentCounts=this._initialCounts);for(const[t,n]of this.leafsKeysMap.entries()){const i=this.allItemsMap.get(t),s=i.searchText.includes(this._searchString),a=this._excludedIds.has(i.id),o=this._excludedKeys.has(i.key);if(s&&!a&&!o)for(const t of n)e.set(t.key,t)}const[t,n,i]=this.getNodes(e.values()),s=this.getCounts(t,i);this._nodes=t,this._currentSize=n,this._currentCounts=s}getItemsMap(e){const t=new Map;for(const n of e)t.set(n.key,Object.assign(Object.assign({},n),{searchText:""}));for(const e of t.values()){let n=e.name.toLowerCase(),i=e.parentKey;for(;i;){const e=t.get(i);if(!e)break;n=`${e.name.toLowerCase()} ${n}`,i=e.parentKey}e.searchText=n}return t}getGroupItemsMap(e){const t=new Map;for(const n of e)n.parentKey&&t.set(n.parentKey,n);return t}getLeafsKeys(e){const t=new Set,n=new Map;for(const n of e)t.add(n.key);for(const n of e)n.parentKey&&t.delete(n.parentKey);for(const e of t){let t=this.allItemsMap.get(e);const i=[t];for(;t&&t.parentKey;)t=this.allItemsMap.get(t.parentKey),i.push(t);n.set(e,i)}return n}getNodes(e){const t=new Map;for(const n of e)t.set(n.key,Object.assign(Object.assign({},n),{nodes:[],isLeaf:this.leafsKeysMap.has(n.key),level:0}));for(const e of t.values())if(null!==e.parentKey){const n=t.get(e.parentKey);n&&n.nodes.push(e)}const n=new Map;let i=0,s=0;for(const e of t.values())if(this.leafsKeysMap.has(e.key)){++i;let a=e,o=1;for(;a.parentKey;){const e=t.get(a.parentKey);if(!e)break;a=e,o++}o>s&&(s=o),n.set(a.key,a)}return[Array.from(n.values()),i,s]}getCounts(e,t){if(0===e.length)return[{groups:0,leafs:0}];const n=[];for(let e=0;e<t;e++)n.push({groups:0,leafs:0});const i=(e,t)=>{let s=0;for(const n of e)n.level=t,0!==n.nodes.length&&(++s,i(n.nodes,t+1));n[t].groups+=s,n[t].leafs+=e.length-s};return i(e,0),n}}const Qy=e=>{let{setRef:t,dropdownRef:n,className:i,labels:s,items:a,selectedItems:o,disabled:r,hidden:l,hasError:c,errorNode:u,isValueLoading:d,isOptionsLoading:h,excludeSelections:m=!0,mode:p=py.FORM_GROUP,boundingElementRef:g,ariaDescribedby:y,onSelect:f,onOptionListScroll:v,onFocus:S,onBlur:E,onSearchFinished:A,isDropdownAbove:C=!1,onOptionListOpen:b,onOptionListScrollVisible:P,onOptionListSearchInputVisible:N,onGoalClick:D,onGroupOpen:T,onTreeUpdate:k}=e;var I,_;const O=(0,kr.useId)(),[x,w]=(0,kr.useState)(!1),[R,M]=(0,kr.useState)(""),L=(0,kr.useRef)(null),F=(e=>{let{boundingElementRef:t,selectWrapperRef:n,isDropdownOpen:i,isDropdownAbove:s}=e;return(0,kr.useMemo)((()=>{const e=n.current,a=null==t?void 0:t.current;if(!a||!e||!i)return;const o=e.getBoundingClientRect(),r=a.getBoundingClientRect();if(s){const e=o.top-r.top-Ky;return e>Hy?Hy:e}const l=r.bottom-o.bottom-Ky;return l>Hy?Hy:l}),[t,n,i,s])})({boundingElementRef:g,selectWrapperRef:L,isDropdownOpen:x,isDropdownAbove:C}),[U,j]=(0,kr.useMemo)((()=>{if(!m)return[[],[]];const e=[],t=[];for(const n of o)e.push(n.key),t.push(n.id);return[t,e]}),[o,m]),B=((e,t,n,i)=>{const s=(0,kr.useMemo)((()=>new Xy(e)),[e]),[a,o]=(0,kr.useState)({allItems:s.allItems,allGroupItems:s.allGroupItems,leafsItems:s.leafsItems,currentSize:s.currentSize,initialSize:s.initialSize,nodes:s.nodes,currentCounts:s.currentCounts,searchString:s.searchString});return(0,kr.useEffect)((()=>{s.setSearchString(t),s.setExcludedIds(n),s.setExcludedKeys(i),o({allItems:s.allItems,allGroupItems:s.allGroupItems,leafsItems:s.leafsItems,currentSize:s.currentSize,initialSize:s.initialSize,currentCounts:s.currentCounts,nodes:s.nodes,searchString:s.searchString})}),[t,n,i,s]),a})(a,R,U,j),G=((e,t)=>(0,kr.useMemo)((()=>{if(!e)return[];const{id:n,key:i}=e;let s=t.allItems.get(i);if(!s)for(const e of t.allItems.values())if(e.id===n){s=e;break}if(!s)return[];const a=t.leafsItems.get(s.key);if(!a)return[s.key];const o=a.map((e=>e.key)).reverse();return o}),[e,t]))(p===py.FORM_GROUP?null==o?void 0:o[0]:null,B),q=null!==(I=G[G.length-1])&&void 0!==I?I:null,V=(0,kr.useCallback)((e=>{w(!1),f(e)}),[f]),H=(0,kr.useCallback)((()=>{var e;w(!1),null===(e=null==t?void 0:t.current)||void 0===e||e.focus()}),[t]),K=(0,kr.useCallback)((()=>{w((e=>!e))}),[]),Y=(0,kr.useCallback)((e=>{M(e)}),[]),z=(0,kr.useCallback)((()=>{M("")}),[]),W=(0,kr.useMemo)((()=>o.map((e=>e.id)).join(",")),[o]);(0,kr.useEffect)((()=>{w(!1)}),[W]);const $=(0,kr.useCallback)((e=>{e.code!==Fl.J.ENTER&&e.code!==Fl.J.SPACE||(e.preventDefault(),w(!0))}),[]),X=(0,kr.useCallback)((e=>{w(!1),null==E||E(e)}),[E]);if(((e,t,n)=>{const i=(0,kr.useRef)(!1);(0,kr.useEffect)((()=>{i.current!==e&&(null==n||n(e,{currentSize:t.currentSize,currentCounts:t.currentCounts}),i.current=e)}),[e,n,t.currentSize,t.currentCounts])})(x,B,b),((e,t)=>{const n=(0,kr.useRef)(null);(0,kr.useEffect)((()=>{var i,s;(null===(i=n.current)||void 0===i?void 0:i.currentSize)===e.currentSize&&Jo()(null===(s=n.current)||void 0===s?void 0:s.nodes,e.nodes)||(null==t||t({currentSize:e.currentSize,currentCounts:e.currentCounts}),n.current=e)}),[e,t])})(B,k),bu(L,X),function(e,t,n){const{document:i}=(0,Il.M)();(0,kr.useEffect)((()=>{let s;const a=n=>{n.key===Fl.J.TAB&&e.current&&(s&&clearTimeout(s),s=setTimeout((()=>{if(void void 0)return;const s=i.activeElement;s?!ys(s,(t=>t===e.current))&&t(n):t(n)}),0))};return i.addEventListener("keydown",a,n),()=>{i.removeEventListener("keydown",a,n),s&&clearTimeout(s)}}),[i,e,t,n])}(L,X),l)return null;const Q=x&&!r,Z=null==o?void 0:o[0];return(0,Cl.jsxs)("div",{ref:L,className:(0,Ml.A)("p-rel",i,{"has-dropdown-above":C}),"data-testid":"goal-select-wrapper",children:[(0,Cl.jsx)($y,{mode:p,setRef:t,className:(0,Ml.A)({"has-dropdown-open":Q}),labels:s,value:null!==(_=null==Z?void 0:Z.name)&&void 0!==_?_:"",isLoading:d,disabled:r,hasError:c,errorNode:u,"aria-controls":`cs-dropdown-${O}`,"aria-expanded":Q,ariaDescribedby:y,onClick:K,onKeyDown:$,onFocus:S}),Q&&(0,Cl.jsx)(zy,{id:`cs-dropdown-${O}`,dropdownRef:n,labels:s,tree:B,selectedItems:o,selectedBranch:G,selectedKey:q,isLoading:h,style:F?{maxHeight:`${F}px`}:void 0,searchValue:R,onSearchChange:Y,onSearchReset:z,onSelect:V,onOptionListScroll:v,onRequestClose:H,onSearchFinished:A,onOptionListScrollVisible:P,onOptionListSearchInputVisible:N,onGoalClick:D,onGroupOpen:T})]})};Qy.displayName="GoalSelect";const Zy=(0,kr.memo)(Qy),Jy=e=>{let{availableGoals:t,selectedGoals:n,hasError:i=!1,shake:s=!1,isGoalsLoading:a=!1,isValueLoading:o=!1,setRef:r,locked:l,onGoalSelect:c,onListScroll:u,onSearchFinished:d,onListOpen:h,onListScrollVisible:m,onSearchInputVisible:p,onGoalClick:g,onGroupOpen:y,onTreeUpdate:f}=e;const v=(0,nc.t)(),S=(0,kr.useId)(),[E,A]=(0,kr.useState)(!1),[C,b]=(0,kr.useState)(!1),P=(0,kr.useRef)(null),{isDropdownAbove:N,iframeScrollContainerRef:D}=(e=>{let{triggerRef:t,isDropdownOpen:n,offset:i=Ky}=e;const[s,a]=(0,kr.useState)(!1),o=(0,kr.useRef)(!1),r=(0,Bl.P)(),l=(0,Il.M)(),c=zl(l),u=jl(),d=(0,kr.useCallback)((()=>{var e,s;if(n||o.current)return;if(!t.current)return;o.current=!0;const l=r?window.innerHeight:(null===(e=null==u?void 0:u.current)||void 0===e?void 0:e.clientHeight)||window.innerHeight,c=t.current.getBoundingClientRect(),d=null===(s=null==u?void 0:u.current)||void 0===s?void 0:s.getBoundingClientRect(),h=r?0:(null==d?void 0:d.top)||0,m=l-(c.bottom-h)-i;a(m<Hy),o.current=!1}),[t,n,i,r,u]);return(0,kr.useEffect)((()=>{d();const e=()=>{d()};return c((t=>{t.document.addEventListener("scroll",e)})),()=>{c((t=>{var n;null===(n=t.document)||void 0===n||n.removeEventListener("scroll",e)}))}}),[d,c]),{isDropdownAbove:s,calculatePosition:d,iframeScrollContainerRef:u}})({triggerRef:r,isDropdownOpen:C}),T=(0,kr.useCallback)((()=>{A(!0)}),[]),k=(0,kr.useCallback)((()=>{A(!1)}),[]),I=(0,kr.useCallback)(((e,t)=>{null==h||h(e,t),b(e)}),[h]),_=(0,kr.useMemo)((()=>({select:{label:v.translate("designations.select.label"),placeholder:v.translate("designations.select.placeholder"),noResults:v.translate("designations.select.noResults"),inputSearch:{placeholder:v.translate("designations.select.inputSearch.placeholder"),clearButtonAriaLabel:v.translate("designations.select.inputSearch.clearButtonAriaLabel")},error:{required:v.translate("designations.select.error.required"),loading:v.translate("designations.select.error.loading")}},loading:v.translate("common.loading")})),[v]),O=(0,kr.useMemo)((()=>(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-10",showTooltip:E,"data-testid":"goal-select-error",dataQa:"goal-select",children:(0,Cl.jsx)("p",{id:`goal-select-${S}-error`,role:"alert",children:_.select.error.required})})),[E,S,_.select.error.required]);return(0,Cl.jsx)(Zy,{mode:py.FORM_GROUP,setRef:r,dropdownRef:P,className:(0,Ml.A)("has-dropdown-attached",{shake:s}),labels:_,items:t,selectedItems:n,excludeSelections:!1,isOptionsLoading:a,isValueLoading:o,hasError:i,errorNode:O,boundingElementRef:D,ariaDescribedby:`goal-select-${S}-error`,isDropdownAbove:N,disabled:l,onSelect:c,onOptionListScroll:u,onSearchFinished:d,onFocus:T,onBlur:k,onOptionListOpen:I,onOptionListScrollVisible:m,onOptionListSearchInputVisible:p,onGoalClick:g,onGroupOpen:y,onTreeUpdate:f})};Jy.displayName="GoalSelectSection";const ef=(0,kr.memo)(Jy),tf=e=>{let{className:t,isLoading:n,availableGoals:i,selectedGoals:s}=e;var a;const o=(0,nc.t)();let r=null===(a=s[0])||void 0===a?void 0:a.name;r||1!==(null==i?void 0:i.length)||(r=i[0].name);const[l,c]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{const e=setTimeout((()=>{c(!0)}),300);return n?()=>clearTimeout(e):(c(!1),void clearTimeout(e))}),[n]),(0,Cl.jsx)(Cl.Fragment,{children:n?(0,Cl.jsx)(Dy,{width:"90%",height:"20px",contentHeight:"20px",className:t,isSkeletonAnimated:l,"aria-label":o.translate("common.loading"),role:"status"}):(0,Cl.jsx)("p",{className:(0,Ml.A)("body-40-regular text-line-clamp-2",t),"data-qa":"goal-single-goal-name-label","data-testid":"goal-single-goal-name-label",children:o.translate("designations.singleGoal",{goal:r})})})},nf={background:"rgba(255, 255, 255, 0.9)"},sf=["top","bottom"],af=e=>{const{className:t,label:n,labelOptional:i,labelFloating:s,selectedOption:a,options:o,value:r,placeholder:l,displayName:c,inputClasses:u,loading:h,showIcons:m,showArrow:p,hint:g,hintAriaLabel:y,allowClear:f,maxLength:v,hasError:S,errorLabel:E,disabled:A,SelectedIconToRender:C,ListItemToRender:b,filterRegex:P,autoComplete:N="new-password",dataQa:D,trackingElement:T,autoFocus:k,autoFocusMode:I,onChange:_,onSelect:O,onBlur:x,onClear:w,onFocus:R}=e,M=(0,d.Tt)(e,["className","label","labelOptional","labelFloating","selectedOption","options","value","placeholder","displayName","inputClasses","loading","showIcons","showArrow","hint","hintAriaLabel","allowClear","maxLength","hasError","errorLabel","disabled","SelectedIconToRender","ListItemToRender","filterRegex","autoComplete","dataQa","trackingElement","autoFocus","autoFocusMode","onChange","onSelect","onBlur","onClear","onFocus"]),L=(0,nc.t)(),F=(0,kr.useId)(),U=(0,gc.Q)(),j=(0,ql.wf)(),[B,G]=(0,kr.useState)(!1),[q,V]=(0,kr.useState)(!1),[H,K]=(0,kr.useState)(null),Y=B&&!!o.length,z=(0,kr.useRef)(null),W=(0,kr.useRef)(null),$=(0,kr.useRef)(null),X=(0,kr.useRef)(null),Q=e=>{const t=O(e);V(!1),t||Z()},Z=()=>{if(G(!1),!W.current)throw new Error("inputRef was not provided");W.current.blur(),x&&x()};(0,kr.useImperativeHandle)(e.inputRef,(()=>W.current),[]);const J=void 0!==c?c:r,ee=(null==r?void 0:r.length)>0;return(0,Cl.jsxs)("div",{ref:z,className:(0,Ml.A)("search-select",t),children:[(0,Cl.jsxs)(Kd.t,Object.assign({setRef:W,id:`search-select-${F}`,label:n,labelFloating:s,labelOptional:i?L.translate("common.optional"):"",placeholder:l,customPrefix:m&&C&&(0,Cl.jsx)(C,{option:a,value:r,options:o,disabled:A}),className:(0,Ml.A)("search-select-input",u,{"search-select-input-active":Y,"search-select-input-offset-start":m,"search-select-input-offset-end":f,"search-select-input-with-arrow":p,"pe-10":S}),formLabelClass:(0,Ml.A)({"search-select-label-offset-start":m,"pe-6":f||S}),value:J,autoComplete:N,maxLength:v,disabled:A,error:S,role:"combobox","aria-autocomplete":"list","aria-controls":`${F}-search-select-dropdown`,"aria-expanded":Y,"aria-activedescendant":`search-select-option-${H}`,"aria-describedby":`search-select-${F}-error`,dataQa:D,dataTestId:"search-input",dataTrackingElementName:T,onChange:e=>{return t=e.target.value,void(_&&_((n=t,void 0===P?n:n.split("").filter((e=>P.test(e))).join(""))));var t,n},onFocus:()=>{G(!0),R&&R()},onBlur:()=>!q&&Z(),onKeyDown:e=>{if(void 0!==P&&!P.test(e.key))return void e.preventDefault();if(!Y)return;const{currentOptionIdx:t,needSelectOption:n,closeDropdown:i}=(0,Fl.t)(e,H,o.length);i?Z():n&&null!==t?Q(o[t].id):null!==t&&K(t)},autoFocus:k,autoFocusMode:I},M,{children:[(!!g||f)&&(0,Cl.jsxs)("div",{className:"p-abs inset-centered-end d-flex items-center me-4",children:[!!g&&(0,Cl.jsx)(Cl.Fragment,{children:(0,Cl.jsx)(Zc.S,{content:!A&&g,trigger:"click",placement:U?"left":"right",fallbackPlacements:sf,maxWidth:"220px",rootContainer:j,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon btn-icon-round font-size-18 text-gray-40 shrink-0 ms-1-5",disabled:A,"aria-label":y,"data-qa":"search-select-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":U}),"aria-hidden":!0})})})}),(0,Cl.jsx)(Ll.A,{classNames:"rtg-clear-button",nodeRef:X,in:ee,timeout:100,mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)("button",{ref:X,type:"button",className:"btn-icon font-size-18 text-gray-60 shrink-0 ms-1-5",disabled:A,"aria-label":L.translate("common.clearButtonAriaLabel"),"data-qa":"search-select-clear-button",onClick:w,children:(0,Cl.jsx)(su.A,{className:"icon-stroke icon-stroke-2 d-block","aria-hidden":!0})})})]}),S&&E&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:B,children:(0,Cl.jsx)("p",{id:`search-select-${F}-error`,dangerouslySetInnerHTML:{__html:E}})})]})),Y&&(0,Cl.jsxs)("ul",{ref:$,id:`${F}-search-select-dropdown`,className:"search-select-dropdown custom-scrollbar",role:"listbox","data-testid":"menu",children:[h&&(0,Cl.jsx)("li",{className:"p-abs inset-0 d-flex items-center justify-center z-index-2",style:nf,"aria-label":L.translate("common.loading"),role:"status",children:(0,Cl.jsx)(oh,{size:"sm"})}),o.map(((e,t)=>(0,Cl.jsx)("li",{id:`search-select-option-${t}`,className:(0,Ml.A)("search-select-option",{"search-select-option-highlighted":t===H}),role:"option","aria-selected":t===H,"data-testid":"menuitem","data-tracking-element-name":T,"data-qa":D+"-item",onMouseDown:()=>V(!0),onClick:()=>Q(e.id),onMouseMove:()=>K(t),children:b?(0,Cl.jsx)(b,{option:e,showIcons:!0}):e.value},e.id)))]})]})};af.displayName="RawSearchManualSelect";const of=(0,kr.memo)(af),rf=e=>{const{options:t,selectedOption:n,className:i,label:s,labelOptional:a,labelFloating:o,placeholder:r,shouldSearchById:l,displayName:c,clearOnFocus:u,isDynamicOptions:h,showArrow:m=!0,showIcons:p,SelectedIconToRender:g,ListItemToRender:y,disabled:f,hasError:v,trackingElement:S,dataQa:E,filterRegex:A,autoFocus:C,autoFocusMode:b,onChange:P,onSelect:N,onBlur:D}=e,T=(0,d.Tt)(e,["options","selectedOption","className","label","labelOptional","labelFloating","placeholder","shouldSearchById","displayName","clearOnFocus","isDynamicOptions","showArrow","showIcons","SelectedIconToRender","ListItemToRender","disabled","hasError","trackingElement","dataQa","filterRegex","autoFocus","autoFocusMode","onChange","onSelect","onBlur"]),[k,I]=(0,kr.useState)((null==n?void 0:n.id)||""),[_,O]=(0,kr.useState)(c),x=void 0!==c;(0,kr.useEffect)((()=>{(null==n?void 0:n.id)&&I(null==n?void 0:n.id),x&&O(c)}),[c,x,n]);const w=(0,kr.useCallback)((e=>(N(e),!1)),[N]),R=(0,kr.useCallback)((e=>{I(e),P&&P(e),x&&O(e)}),[x,P]),M=(0,kr.useMemo)((()=>{if(!t.length)return[];if(h)return t;const e=t.find((e=>{let{id:t}=e;return t===(null==n?void 0:n.id)}));if(k===(null==e?void 0:e.id))return[...t];const i=k.toLowerCase();return l?t.filter((e=>{let{id:t,value:n}=e;return n.toLowerCase().includes(i)||t.toLowerCase().includes(i)})):t.filter((e=>{let{value:t}=e;return t.toLowerCase().includes(i)}))}),[t,h,k,l,n]),L=(0,kr.useCallback)((()=>{(null==n?void 0:n.id)?I(n.id):I(""),x&&O(c),null==D||D()}),[c,x,n,D]),F=(0,kr.useCallback)((()=>{u&&x&&O("")}),[u,x]);return(0,Cl.jsx)(of,Object.assign({options:M,value:k,onChange:R,onSelect:w,onBlur:L,onFocus:F,className:i,placeholder:r,label:s,labelOptional:a,labelFloating:o,displayName:_,isDynamicOptions:h,showArrow:m,showIcons:p,SelectedIconToRender:g,ListItemToRender:y,selectedOption:n,disabled:f,hasError:v,trackingElement:S,dataQa:E,filterRegex:A,autoFocus:C,autoFocusMode:b},T))};rf.displayName="RawSearchFilterSelect";const lf=(0,kr.memo)(rf);var cf;!function(e){e.IN_HONOR_MEMORY="inHonorMemory",e.DEDICATION="dedication"}(cf||(cf={}));const uf=e=>{let{inHonorOfMaxLength:t,isActive:n,sharingEnabled:i,labelType:s,name:a,disabled:o,onInputFocusChange:r,onToggleTribute:l,onChangeTributeName:c}=e;const u=(0,nc.t)(),d=(0,Zl.$)(),h=(0,gc.Q)(),m=(0,Bl.P)(),p=(0,kr.useId)(),g=(0,ql.wf)(),[y,f]=(0,kr.useState)(!1),[v,S]=(0,kr.useState)(!1),E=n&&!d&&v,A=(0,Nl.n)(),C=i?`${u.translate("donateForm.tribute.inputPlaceholder")}. ${u.translate("donateForm.tribute.tooltipLabel")}`:void 0,b=e=>{S(e),r&&r(e)};return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Fd,{className:"body-40-regular",customLabelClasses:"line-height-20",checked:null!=n&&n,disabled:o,dataQa:"tribute-give-checkbox",trackingElement:"tributeCheckbox",onChange:()=>{f(!0),l()},children:(0,Cl.jsx)("span",{className:"text-truncate body-40-regular","data-qa":"tribute-label",children:{[cf.IN_HONOR_MEMORY]:A.allowLegacyTributeLabel?u.translate("donateForm.tribute.label.inHonorMemory"):u.translate("donateForm.tribute.label.dedication"),[cf.DEDICATION]:u.translate("donateForm.tribute.label.dedication")}[s]})}),n&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Zc.S,{content:u.translate("donateForm.tribute.tooltipLabel"),trigger:"manual",manualOpen:E&&!m&&i,placement:h?"left":"right",maxWidth:"220px",returnFocus:!1,rootContainer:g,"data-qa":"tribute-hint",children:(0,Cl.jsx)("div",{children:(0,Cl.jsx)(Kd.t,{id:`tribute-${p}`,label:u.translate("donateForm.tribute.inputPlaceholder"),labelFloating:!0,formGroupClass:m?"mt-3":"mt-2",autoFocus:y,autoFocusMode:vd.Q.ALL,value:null!=a?a:"",maxLength:t,disabled:o,"aria-label":C,onFocus:()=>b(!0),onBlur:()=>b(!1),onChange:e=>c(e.target.value),dataQa:"tribute-name"})})}),i&&m&&(0,Cl.jsx)("p",{className:"body-40-regular text-ellipsis mt-1-5","data-qa":"tribute-hint",children:u.translate("donateForm.tribute.tooltipLabel")})]})]})},df=(0,kr.memo)(uf),hf=(0,kr.forwardRef)(((e,t)=>{if(void 0!==e.options){const n=e.options.find((t=>{let{id:n,value:i}=t;return n===e.name||i===e.name}));let i="";return n&&(i=n.id.toLowerCase()),i?(0,Cl.jsx)("span",{ref:t,className:(0,Ml.A)(`crypto-icon crypto-icon-${i} crypto-icon-${e.size}`,e.className),style:e.style,"aria-hidden":e.ariaHidden}):(0,Cl.jsx)(wy,{className:"icon-stroke font-size-20 text-gray-60","aria-hidden":!0})}const n=e.name.toLowerCase();return(0,Cl.jsx)("span",{ref:t,className:(0,Ml.A)(`crypto-icon crypto-icon-${n} crypto-icon-${e.size}`,e.className),style:e.style,"aria-hidden":e.ariaHidden})}));hf.displayName="RawCryptoIcon";const mf=(0,kr.memo)(hf),pf=e=>(0,Cl.jsxs)(Cl.Fragment,{children:[e.showIcons&&(0,Cl.jsx)(mf,{name:e.option.id,size:"sm",className:"shrink-0 me-2",ariaHidden:!0}),(0,Cl.jsx)("span",{className:"text-ellipsis",children:e.option.value})]}),gf=e=>(0,Cl.jsx)("div",{className:"search-select-input-icon","aria-hidden":!0,children:(0,Cl.jsx)(mf,{name:e.value,size:"md",options:e.options})}),yf=(0,kr.memo)(gf),{useAddFieldToScroll:ff,useScrollToFieldsTrigger:vf,ScrollToFieldsProvider:Sf}=(0,Ud.J)(),Ef=()=>{const{state:e,controller:t}=Tc($u.CRYPTO_CURRENCY),n=(0,nc.t)(),i=(0,Bl.P)(),s=(0,kr.useId)(),a=(0,Zl.$)(),o=(0,kr.useRef)(null),r=(0,kr.useRef)(null),l=(0,kr.useRef)(null),c=(0,kr.useRef)(null),u=(0,kr.useRef)(null),[d,h]=(0,kr.useState)(!1);(0,Sd.f)({ref:o,autoFocus:!0,mode:vd.Q.DESKTOP}),(0,Sd.f)({ref:o,autoFocus:d,mode:vd.Q.DESKTOP,preventScroll:!0}),(0,kr.useEffect)((()=>{d&&h(!1)}),[d]);const m=$d(e.designationShakeKey,0!==e.designationShakeKey),p=xc(),[g,y]=(0,kr.useState)(!1),[f,v]=(0,kr.useState)(!1),[S,E]=(0,kr.useState)(!1),A=(0,kr.useCallback)((()=>S?n.translate("donateForm.donationAmountField.error.crypto.required"):g?n.translate("donateForm.donationAmountField.error.crypto.min",{amount:n.formatCurrency(e.minAmount,{currency:"USD",display:"round"})}):f?n.translate("donateForm.donationAmountField.error.crypto.max",{amount:n.formatCurrency(e.maxAmount,{currency:"USD",display:"round"})}):""),[n,f,g,S,e.maxAmount,e.minAmount]),C=(0,kr.useMemo)((()=>g||f||S),[g,f,S]),b=(0,kr.useMemo)((()=>e.currencies.map((e=>{let{name:t,code:n}=e;return{id:n,value:t}}))),[e.currencies]),P=(0,kr.useMemo)((()=>({id:e.currencyCode,value:e.currencyName})),[e.currencyCode,e.currencyName]),N=(0,kr.useCallback)((e=>{t.changeCryptoCurrency(e),h(!0)}),[t,h]),D=(0,kr.useCallback)((e=>{t.changeAmount(e)}),[t]),T=(0,kr.useCallback)((()=>{t.validateAmount(),y(!a&&e.errors.amount.min),v(!a&&e.errors.amount.max),E(!a&&e.errors.amount.required)}),[t,a,e.errors.amount.min,e.errors.amount.max,e.errors.amount.required]);(0,kr.useEffect)((()=>{r.current&&(y(!a&&e.errors.amount.min),v(!a&&e.errors.amount.max),E(!a&&e.errors.amount.required))}),[r,a,e.errors.amount.min,e.errors.amount.max,e.errors.amount.required]);const k=(0,kr.useCallback)((()=>t.toggleTribute()),[t]),I=(0,kr.useCallback)((e=>{t.changeTributeName(e)}),[t]),_=(0,kr.useCallback)((()=>t.savePrevComment()),[t]),O=(0,kr.useCallback)((()=>t.addComment()),[t]),[x,w]=(0,kr.useState)(!1),R=(0,hd.D)((e=>w(e))),M=vf(),L=t.isDesignationReadOnly(),F=t.isDesignationEditable(),{handleGoalListOpen:U,handleGoalListScrollVisible:j,handleGoalSearchInputVisible:B,handleGoalClick:G,handleGoalGroupOpen:q,handleGoalTreeUpdate:V,handleGoalListScroll:H,handleGoalSearchFinished:K,handleGoalSelect:Y}=(e=>({handleGoalSelect:(0,kr.useCallback)((t=>{e.setDesignationsSelectedGoal(t)}),[e]),handleGoalListOpen:(0,kr.useCallback)(((t,n)=>e.setTrackingDesignationListOpen(t,n)),[e]),handleGoalListScrollVisible:(0,kr.useCallback)((t=>e.setTrackingDesignationListScrollVisible(t)),[e]),handleGoalSearchInputVisible:(0,kr.useCallback)((t=>e.setTrackingDesignationSearchInputVisible(t)),[e]),handleGoalClick:(0,kr.useCallback)((t=>e.setTrackingDesignationClickedGoal(t)),[e]),handleGoalGroupOpen:(0,kr.useCallback)(((t,n)=>e.setTrackingDesignationClickedGroup(t,n)),[e]),handleGoalTreeUpdate:(0,kr.useCallback)((t=>e.setTrackingDesignationItems(t)),[e]),handleGoalListScroll:(0,kr.useCallback)((()=>e.trackDesignationScrollUsed()),[e]),handleGoalSearchFinished:(0,kr.useCallback)(((t,n)=>e.trackDesignationSearchFinished(t,n)),[e])}))(t);return ff(o,(e=>e.amount.min||e.amount.max||e.amount.required)),ff(l,(e=>e.designation.required)),ff(u,(e=>e.designations.required)),(0,Cl.jsxs)("form",{ref:c,className:"flow-screen","aria-labelledby":`screen-header-${s}`,onSubmit:n=>{if(n.preventDefault(),M(),!e.livemode)return R.set([!0]),void R.set([!1],3e3);t.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,screenTitle:n.translate("cryptoCurrencyScreen.title"),className:"border-bottom-0",titleFullWidth:!0,a11yAutoFocus:i,children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex items-center justify-center",i?"pt-3 pb-2":"pt-6 pb-4"),children:[(0,Cl.jsx)(dy,{className:"icon-fill shrink-0 font-size-28 text-green-80 me-2","aria-hidden":!0}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-truncate","data-qa":"crypto-donation-header",children:n.translate("cryptoCurrencyScreen.title")})]})}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("fixed-container",{"grow-1 d-flex flex-column":!i}),children:[(0,Cl.jsx)(lf,{className:"search-select-crypto",label:n.translate("cryptoCurrencyScreen.selectCurrency.label"),labelFloating:!0,selectedOption:P,options:b,onSelect:N,displayName:e.currencyName,shouldSearchById:!0,clearOnFocus:!0,showIcons:!0,SelectedIconToRender:yf,ListItemToRender:pf,disabled:e.locked,dataQa:"currency"}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("mt-3",{shake:C}),children:[(0,Cl.jsx)("div",{ref:r,children:(0,Cl.jsx)(Yp,{ref:o,className:"group-price-control",currency:e.currencyCode,amount:e.amount,canModifyAmount:!0,withoutFraction:!1,disabled:e.locked,currencyService:p,donationType:$n.CRYPTO,hasError:C,errorLabel:A(),"aria-required":!0,"aria-invalid":C,"aria-describedby":`price-control-${s}-error`,dataQa:"amount",onAmountChange:D,onAmountInputBlur:T})}),(0,Cl.jsx)("p",{className:"body-40-regular text-sans-serif d-flex items-center text-gray-60 mt-2",children:e.amount?(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("span",{className:"text-truncate",children:["",n.formatCurrency(e.amountInDefaultFiat,{currency:e.defaultFiatCurrency})]}),(0,Cl.jsx)("span",{className:"shrink-0 ms-1",children:e.defaultFiatCurrency})]}):(0,Cl.jsx)("span",{children:""})})]}),F&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:20,sizeMin:4}),(0,Cl.jsx)(ef,{availableGoals:e.designations.availableGoals,selectedGoals:e.designations.selectedGoals,hasError:e.errors.designations.required,boundingElementRef:c,shake:m,setRef:u,isGoalsLoading:e.designations.isOptionsLoading,isValueLoading:e.designations.isValueLoading,locked:e.locked,onGoalSelect:Y,onListOpen:U,onListScrollVisible:j,onSearchInputVisible:B,onGoalClick:G,onGroupOpen:q,onTreeUpdate:V,onListScroll:H,onSearchFinished:K})]}),e.tribute.show&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:20,sizeMin:4}),(0,Cl.jsx)(df,{inHonorOfMaxLength:e.tribute.inHonorOfMaxLength,isActive:e.tribute.isActive,sharingEnabled:e.tribute.sharingEnabled,labelType:e.tribute.labelType,name:e.tribute.name,disabled:e.locked,onToggleTribute:k,onChangeTributeName:I})]}),(0,Cl.jsx)(bc,{size:12,sizeMin:4,className:"mt-auto"}),L&&(0,Cl.jsx)(tf,{isLoading:e.designations.isValueLoading,availableGoals:e.designations.availableGoals,selectedGoals:e.designations.selectedGoals}),e.comment.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[L&&(0,Cl.jsx)(bc,{size:12,sizeMin:4}),(0,Cl.jsx)(my,{prevContent:e.comment.prevContent,content:e.comment.content,disabled:e.locked,onAddComment:O,onHighlight:_})]}),!i&&(0,Cl.jsx)(bc,{size:20,sizeMin:16})]})}),(0,Cl.jsx)(gd,{children:e.isCryptoAccountConnected?(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:e.processingState,errorTitle:e.errors.payment.title,errorMessage:e.errors.payment.message,disabled:x,testMode:x,dataQa:"donate-button",trackingElement:"payButton",children:x?n.translate("cryptoCurrencyScreen.testModeButton"):n.translate("cryptoCurrencyScreen.button")}):(0,Cl.jsx)("p",{className:"body-60-medium text-center text-red-80 text-ellipsis",dangerouslySetInnerHTML:{__html:n.safeTranslate("cryptoCurrencyScreen.connectionInfo")}})})]})};var Af=n(1953),Cf=n.n(Af);const bf=["bottom-end"],Pf=()=>{const e=(0,nc.t)(),t=(0,gc.Q)(),n=Kl(),i=(0,ql.wf)(),{countdown:s,isActive:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const n=(0,kr.useRef)(Date.now()+e),i=(0,kr.useRef)(null),[s,a]=(0,kr.useState)(e),[o,r]=(0,kr.useState)(!0),l=(0,_u.Q)(),c=(0,kr.useCallback)((()=>{i.current&&(clearInterval(i.current),r(!1))}),[i]),u=(0,kr.useCallback)((()=>{const e=n.current-Date.now();a(e)}),[n]);return(0,kr.useEffect)((()=>{if(l)return r(!0),u(),i.current=setInterval(u,t),c}),[u,l,t,c]),(0,kr.useEffect)((()=>{s<t&&c()}),[t,c,s]),{countdown:s,isActive:o}}(9e5),[o,r]=(0,kr.useMemo)((()=>function(e){const t=new Date(e),[,n,i]=t.toISOString().slice(11,-5).split(":");return[n,i]}(s)),[s]),l=s<6e4;return(0,Cl.jsx)(Cl.Fragment,{children:a&&(0,Cl.jsx)(Zc.S,{content:e.translate("cryptoWalletScreen.cryptoTimer.tooltipLabel"),trigger:"click",placement:t?"left-start":"right-start",fallbackPlacements:bf,maxWidth:"220px",rootContainer:i,children:(0,Cl.jsxs)("button",{type:"button",className:(0,Ml.A)(n("crypto-timer"),{"crypto-timer-danger":l}),"aria-label":e.translate("cryptoWalletScreen.cryptoTimer.ariaLabel",{minutes:o,seconds:r}),"data-qa":"crypto-timer",children:[o,":",r]})})})},Nf=(0,kr.memo)(Pf),Df={src:"",height:40,width:40,excavate:!0},Tf={width:"168px",height:"168px"},kf={[$u.CRYPTO_CURRENCY]:()=>{const{state:e}=Tc($u.CRYPTO_CURRENCY);return(0,Cl.jsx)(Sf,{state:e.errors,children:(0,Cl.jsx)(Ef,{})})},[$u.CRYPTO_WALLET]:e=>{const{state:t}=Tc($u.CRYPTO_WALLET),n=(0,Bl.P)(),i=(0,nc.t)(),s=Kl(),a=(0,kr.useId)(),o=(0,Il.M)(),[r,l]=(0,kr.useState)(!1),c=(0,hd.D)((e=>l(e))),u=t.protocol?` (${t.protocol}) `:" ",d=`${t.networkName}${u}`;return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${a}`,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${a}`,screenTitle:i.translate("cryptoWalletScreen.title"),a11yAutoFocus:!0,children:(0,Cl.jsxs)("div",{className:s("crypto-timer-holder"),children:[(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-30-medium",n?"text-ellipsis":"text-line-clamp-2"),children:i.translate("cryptoWalletScreen.title")}),(0,Cl.jsx)(Nf,{})]})}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-6":!n}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center",n?"text-ellipsis":"text-line-clamp-4"),"data-qa":"crypto-wallet-screen",children:i.translate("cryptoWalletScreen.description")}),(0,Cl.jsxs)("p",{className:"text-center text-ellipsis mt-5",children:[(0,Cl.jsx)("span",{className:"body-90-regular d-inline-block text-sans-serif",children:t.formattedAmount}),(0,Cl.jsx)("span",{className:"body-70-regular d-inline-block ms-1-5",children:t.currencyCode})]}),(0,Cl.jsxs)("div",{className:"p-rel d-flex items-center justify-center bg-white border border-gray-20 border-radius-base mx-auto mt-2",style:Tf,"aria-hidden":!0,children:[(0,Cl.jsx)(Cf(),{value:t.walletAddress,renderAs:"svg",size:122,level:"H",imageSettings:Df}),(0,Cl.jsx)(mf,{name:t.currencyCode,size:"lg",className:"p-abs inset-centered"})]}),(0,Cl.jsxs)("button",{type:"button",className:"btn btn-default h-auto d-flex items-baseline text-left px-0 py-2-5 mt-8","aria-label":i.translate("cryptoWalletScreen.copyButtonAriaLabel"),disabled:r,"data-qa":"crypto-wallet-copy-button",onClick:()=>{if(c.set([!0]),c.set([!1],2e3),navigator.clipboard)navigator.clipboard.writeText(t.walletAddress);else{const e=o.document.createElement("textarea");e.value=t.walletAddress,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",o.document.body.appendChild(e),e.select(),o.document.execCommand("copy"),o.document.body.removeChild(e)}},children:[(0,Cl.jsx)("span",{className:"body-60-regular grow-1 text-nowrap ps-3 pe-2 overflow-x-auto invisible-scrollbar","aria-hidden":!0,children:t.walletAddress}),(0,Cl.jsxs)("span",{className:(0,Ml.A)("btn-copy-text compact-20-semibold shrink-0 d-flex items-center p-rel pe-3",r?"text-green-80":"text-blue-60"),children:[r&&(0,Cl.jsx)("span",{className:"shrink-0 icon-slot icon-slot-18 me-1","aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"p-abs inset-centered font-size-18 text-green-80",children:(0,Cl.jsx)(Ld,{className:"icon-stroke icon-stroke-2 d-block"})})}),(0,Cl.jsx)("span",{className:"p-rel","aria-live":r?"polite":"off",children:r?i.translate("cryptoWalletScreen.copyButtonCopied"):i.translate("cryptoWalletScreen.copyButton")})]})]}),(0,Cl.jsxs)("p",{className:"body-20-regular mt-2 text-center text-truncate",dir:"ltr",children:[(0,Cl.jsx)("span",{className:"font-weight-500",children:d}),i.translate("cryptoWalletScreen.network")]})]})}),(0,Cl.jsx)(gd,{className:(0,Ml.A)({"pt-8":n}),children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-40-regular text-center",n?"text-ellipsis":"text-line-clamp-2"),children:i.translate("cryptoWalletScreen.message")})})]})},[wl.COMMENT]:bd,[wl.PRIVACY]:fm,[wl.THANK_YOU]:oy,[wl.MANDATORY_QUESTIONS]:eh,[wl.QUESTIONS]:zm,[wl.BLOCKED]:yd};var If;!function(e){e.PERMISSIONS="PERMISSIONS",e.CONVERSATION_STARTING="CONVERSATION_STARTING",e.CONVERSATION_START="CONVERSATION_START",e.DONATION_AMOUNT="DONATION_AMOUNT",e.CUSTOMER_NAME="CUSTOMER_NAME",e.CUSTOMER_EMAIL="CUSTOMER_EMAIL",e.PAYMENT_CARD="PAYMENT_CARD",e.PAYMENT_APPLE_PAY="PAYMENT_APPLE_PAY",e.THANK_YOU="THANK_YOU"}(If||(If={}));class _f{constructor(e){this.options=e,this.status="initial",this.rtcConnection=null,this.rtcDataChannel=null,this.localMediaStream=null}init(){return(0,d.sH)(this,void 0,void 0,(function*(){try{this.log("voice conversation is initializing"),this.status="initializing",this.rtcConnection=new RTCPeerConnection,this.rtcDataChannel=this.rtcConnection.createDataChannel("conversation-events"),this.localMediaStream=yield navigator.mediaDevices.getUserMedia({audio:!0}),this.rtcConnection.addEventListener("track",(e=>{var t;this.log(`<-- media stream received: ${null===(t=e.streams[0])||void 0===t?void 0:t.id}`),this.options.handleMediaStream(e.streams[0])})),this.rtcDataChannel.addEventListener("open",(()=>{this.log("<-- data channel is opened"),this.sendEvent({instruction:this.getInstructionOpen()})})),this.rtcDataChannel.addEventListener("message",(e=>{this.log(`<-- data channel message: ${e.data}`),this.handleMessageEvent(e.data)})),this.localMediaStream.getTracks().forEach((e=>{var t;this.localMediaStream&&(this.log(`--\x3e local media stream track is added: ${e.id}`),null===(t=this.rtcConnection)||void 0===t||t.addTrack(e,this.localMediaStream))}));const e=yield this.rtcConnection.createOffer();this.log("--\x3e local connection description is set"),yield this.rtcConnection.setLocalDescription(e);const t=yield this.options.getConversationSession(e);this.log("--\x3e remote connection description is set"),yield this.rtcConnection.setRemoteDescription(t),this.log("voice conversation is active"),this.status="active",this.options.handleConversationStarted()}catch(e){this.log(`voice conversation init error: ${e}`),this.options.handleConversationError()}}))}destroy(){var e,t,n;this.log("voice conversation is destroying"),this.status="destroying",null===(e=this.localMediaStream)||void 0===e||e.getTracks().forEach((e=>{e.stop()})),this.localMediaStream=null,null===(t=this.rtcDataChannel)||void 0===t||t.close(),this.rtcDataChannel=null,null===(n=this.rtcConnection)||void 0===n||n.close(),this.rtcConnection=null,this.log("voice conversation is destroyed"),this.status="initial"}sendEvent(e){var t,n;try{if(e.functionCallId&&e.functionCallOutputMessage){const n=JSON.stringify({type:"conversation.item.create",item:{type:"function_call_output",call_id:e.functionCallId,output:e.functionCallOutputMessage}});this.log(`--\x3e function call output: ${n}`),"open"===(null===(t=this.rtcDataChannel)||void 0===t?void 0:t.readyState)&&this.rtcDataChannel.send(n)}const i=JSON.stringify({type:"response.create",response:e.instruction?{instructions:e.instruction}:void 0});this.log(`--\x3e next instruction: ${i}`),"open"===(null===(n=this.rtcDataChannel)||void 0===n?void 0:n.readyState)&&this.rtcDataChannel.send(i)}catch(e){}}handleMessageEvent(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;try{const n=JSON.parse(e);if(!((null==n?void 0:n.type)&&(null===(t=null==n?void 0:n.item)||void 0===t?void 0:t.type)&&["response.output_item.added","response.output_item.done"].includes(n.type)&&["function_call"].includes(n.item.type)))return;const i=JSON.parse(n.item.arguments);if("object"!=typeof i)return;switch(this.log(`<-- function call: ${n.item.name} with id ${n.item.call_id}, arguments ${n.item.arguments}`),n.item.name){case"store_donor_info":(yield this.options.handleStoreDonorInfoCommand(i.field,i.value))?this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"success"}):this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"invalid"});break;case"process_payment":(yield this.options.handleProcessCardPaymentCommand()).isSuccess?(this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"success",instruction:this.getInstructionPaymentCardSuccess()}),this.options.handleDonation()):this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"failure",instruction:this.getInstructionPaymentCardFailure()});break;case"process_apple_pay":this.sendEvent({instruction:this.getInstructionTapApplePayButton()}),(yield this.options.handleProcessApplePayPaymentCommand()).isSuccess?(this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"success",instruction:this.getInstructionPaymentApplePaySuccess()}),this.options.handleDonation()):this.sendEvent({functionCallId:n.item.call_id,functionCallOutputMessage:"failure",instruction:this.getInstructionPaymentApplePayFailure()});break;case"hang_up":yield Ri(5e3),this.options.handleHangUpCommand(),this.destroy()}}catch(e){}}))}getInstructionOpen(){return'Please speak English. Say: "Hello, this is Charley, AI assistant. How much would you like to contribute today?"'}getInstructionPaymentCardSuccess(){return"Credit card payment completed successfully! Please thank the donor warmly and end the call."}getInstructionPaymentCardFailure(){return"Credit card payment encountered an error. Please apologize briefly and offer to try again."}getInstructionTapApplePayButton(){return"Ask the user to tap the Apple Pay button and to follow the prompts to complete their donation"}getInstructionPaymentApplePaySuccess(){return"Apple Pay payment completed successfully! Please thank the donor warmly and end the call."}getInstructionPaymentApplePayFailure(){return"Apple Pay payment encountered an error. Please apologize briefly and offer to try again."}log(e){this.options.log(e)}}const Of=e=>{let{children:t}=e;const n=(0,Bl.P)();return(0,Cl.jsx)("div",{className:"fixed-container d-flex flex-column justify-center",style:{marginTop:n?"0":"120px"},children:t})},xf=(0,kr.memo)(Of),wf=()=>(0,Cl.jsx)("img",{src:n(7755),width:96}),Rf=(0,kr.memo)(wf);var Mf;function Lf(){return Lf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Lf.apply(null,arguments)}var Ff=function(e,t){return kr.createElement("svg",Lf({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),Mf||(Mf=kr.createElement("path",{d:"M8.01 9.9825C8.77114 10.7443 9.63136 11.4002 10.5675 11.9325L11.52 10.98C11.7239 10.7784 11.9814 10.6394 12.2618 10.5796C12.5423 10.5198 12.8341 10.5416 13.1025 10.6425C13.783 10.8964 14.49 11.0725 15.21 11.1675C15.5704 11.2184 15.9 11.3987 16.1374 11.6747C16.3747 11.9507 16.5036 12.3035 16.5 12.6675V14.9175C16.5008 15.1264 16.4581 15.3331 16.3744 15.5245C16.2907 15.7159 16.168 15.8877 16.0141 16.0289C15.8601 16.1701 15.6784 16.2776 15.4806 16.3445C15.2827 16.4114 15.073 16.4363 14.865 16.4175C12.5571 16.1667 10.3402 15.3781 8.3925 14.115C7.48895 13.5413 6.6514 12.8697 5.895 12.1125M3.8925 9.6075C2.62939 7.65975 1.84077 5.44287 1.59 3.135C1.57126 2.9276 1.59591 2.71857 1.66238 2.52122C1.72884 2.32387 1.83568 2.14252 1.97607 1.98872C2.11647 1.83491 2.28735 1.71203 2.47784 1.62789C2.66833 1.54375 2.87426 1.5002 3.0825 1.5H5.3325C5.69648 1.49642 6.04934 1.62531 6.32532 1.86265C6.6013 2.09999 6.78156 2.42959 6.8325 2.79C6.92747 3.51005 7.10359 4.21705 7.3575 4.8975C7.45841 5.16594 7.48025 5.45769 7.42043 5.73816C7.36061 6.01863 7.22165 6.27608 7.02 6.48L6.0675 7.4325M17.25 0.75L0.75 17.25",stroke:"#DA2243",strokeLinecap:"round",strokeLinejoin:"round"})))},Uf=(0,kr.forwardRef)(Ff),jf=(0,kr.memo)(Uf);const Bf=e=>{let{disabled:t=!1,onClick:n}=e;return(0,Cl.jsxs)("button",{type:"button",className:"btn btn-default d-flex items-center justify-center","data-qa":"conversation-end-call","data-tracking-element-name":"conversationEndCallButton",disabled:t,onClick:n,children:[(0,Cl.jsx)(jf,{className:"me-2","aria-hidden":!0}),(0,Cl.jsx)("span",{children:"End call"})]})},Gf=(0,kr.memo)(Bf),qf=e=>{let{onEndCallClick:t}=e;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsxs)("h2",{className:"mt-4 title-50-semibold text-center",children:["How much would you",(0,Cl.jsx)("br",{})," like to donate?"]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{onClick:t})})]})},Vf=(0,kr.memo)(qf),Hf=e=>{let{onEndCallClick:t}=e;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsx)("div",{className:"fixed-container grow-1 d-flex items-center justify-center",children:(0,Cl.jsx)(oh,{size:"lg"})})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{onClick:t})})]})},Kf=(0,kr.memo)(Hf),Yf=e=>{let{email:t,onEndCallClick:n}=e;const i=t;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsx)("p",{className:"mt-4 body-60-regular text-center",children:"Email"}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-center",children:i})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{onClick:n})})]})},zf=(0,kr.memo)(Yf),Wf=e=>{let{firstName:t,lastName:n,onEndCallClick:i}=e;const s=null===t?"":null===n||t===n?t:`${t} ${n}`;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsx)("p",{className:"mt-4 body-60-regular text-center",children:"Full name"}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-center",children:s})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{onClick:i})})]})},$f=(0,kr.memo)(Wf),Xf=e=>{let{donationAmount:t,donationFrequency:n,onEndCallClick:i}=e;const s=null===t?"":null===n?t:`${t}/${n}`;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsx)("p",{className:"mt-4 body-60-regular text-center",children:"Amount to donate"}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-center",children:s})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{onClick:i})})]})},Qf=(0,kr.memo)(Xf),Zf=e=>{let{disabled:t,onApplePayClick:n,onEndCallClick:i}=e;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsx)("p",{className:"mt-4 body-60-regular text-center",children:"Tap to donate"}),(0,Cl.jsx)("button",{type:"button",className:"btn btn-black d-flex justify-center items-center mt-2",dir:"ltr",disabled:t,onClick:n,"data-tracking-element-name":"paymentMethod-applePay","data-qa":"apple-pay-button",children:(0,Cl.jsx)(ph,{className:"shrink-0",width:50,height:26,"aria-hidden":!0})})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{disabled:t,onClick:i})})]})},Jf=(0,kr.memo)(Zf),ev=e=>{let{cardNumber:t,cardExpirationDate:n,cardCvc:i,disabled:s,onEndCallClick:a}=e;const o=null===t?"":t.replace(/(\d{4})(?=\d)/g,"$1 "),r=null===n?"":null===i?`Exp. ${n}`:`Exp. ${n}, ${i}`;return(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsx)("p",{className:"mt-4 body-60-regular text-center",children:"Credit card"}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-center",children:o}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-center",children:r})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(Gf,{disabled:s,onClick:a})})]})},tv=(0,kr.memo)(ev),nv=e=>{let{donationAmount:t,donationFrequency:n,firstName:i,onCloseClick:s}=e;return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("div",{className:"p-rel d-flex items-center justify-center bg-green-10 px-8 shrink-0 border-radius-10 mt-2 mx-2 py-2",children:[(0,Cl.jsx)(lg,{className:"shrink-0 icon-fill font-size-20 text-green-90 me-2","aria-hidden":!0}),(0,Cl.jsx)("p",{className:"compact-50-regular text-truncate",children:"Donation successful"})]}),(0,Cl.jsx)(bc,{size:32,sizeMin:24}),(0,Cl.jsx)(td,{className:"px-body shrink-0",children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 d-flex flex-column justify-center",children:[(0,Cl.jsx)(Pp,{shouldAnimate:!0,className:"mx-auto"}),(0,Cl.jsxs)("h2",{className:"title-50-semibold text-center mt-4",children:["Thanks for your support, ",i,"!"]}),(0,Cl.jsxs)("p",{className:"mt-4 body-60-regular text-center",children:["You've made a ",`${t}/${n}`," donation."]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)("div",{className:"d-flex justify-center",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",onClick:s,"data-qa":"close","data-tracking-element-name":"closeButton",children:"Close"})})})]})},iv=(0,kr.memo)(nv),sv=e=>{let{onMediaStream:t}=e;const{state:n,controller:i}=Tc(Vn.DONATE_BY_VOICE),s=_r(),a=Rc(),o=(0,kr.useCallback)((e=>i.getConversationSession(e)),[i]),r=(0,kr.useCallback)((e=>{i.log(e)}),[i]),l=(0,kr.useCallback)((e=>{t(e)}),[t]),c=(0,kr.useCallback)((()=>{i.handleConversationStarted(),a.customTrack({type:"DonateByVoiceConversationStarted"})}),[i,a]),u=(0,kr.useCallback)(((e,t)=>i.handleStoreDonorInfoCommand(e,t)),[i]),h=(0,kr.useCallback)((()=>i.handleProcessCardPaymentCommand()),[i]),m=(0,kr.useCallback)((()=>i.handleProcessApplePayPaymentCommand()),[i]),p=(0,kr.useCallback)((()=>{i.handleHangUpCommand()}),[i]),g=(0,kr.useCallback)((()=>{a.customTrack({type:"DonateByVoiceDonation"})}),[a]),y=(0,kr.useCallback)((()=>{i.handleConversationError()}),[i]),f=(0,kr.useCallback)((()=>{i.handleApplePayButtonClick()}),[i]),v=(0,kr.useCallback)((()=>{i.handleConversationEndCallButtonClick()}),[i]),S=(0,kr.useCallback)((()=>{s.emit(Tr.SHOULD_HIDE,{})}),[s]);return(e=>{const t=(0,kr.useRef)(null),n=(0,kr.useCallback)((()=>(0,d.sH)(void 0,void 0,void 0,(function*(){t.current&&"initial"!==t.current.status||(t.current=new _f(e),yield t.current.init())}))),[e]),i=(0,kr.useCallback)((()=>{t.current&&"active"===t.current.status&&(t.current.destroy(),t.current=null)}),[]);(0,kr.useEffect)((()=>(n(),()=>i())),[n,i])})((0,kr.useMemo)((()=>({getConversationSession:o,log:r,handleMediaStream:l,handleConversationStarted:c,handleStoreDonorInfoCommand:u,handleProcessCardPaymentCommand:h,handleProcessApplePayPaymentCommand:m,handleHangUpCommand:p,handleDonation:g,handleConversationError:y})),[o,r,l,c,u,h,m,p,g,y])),(0,kr.useEffect)((()=>{const e=()=>{i.handleCheckoutClosed()};return s.on(Tr.WAS_HIDDEN,e),window.addEventListener("beforeunload",e),()=>{s.removeListener(Tr.WAS_HIDDEN,e),window.removeEventListener("beforeunload",e)}}),[i,s]),(()=>{switch(n.step){case If.CONVERSATION_STARTING:return(0,Cl.jsx)(Kf,{onEndCallClick:v});case If.CONVERSATION_START:return(0,Cl.jsx)(Vf,{onEndCallClick:v});case If.DONATION_AMOUNT:return(0,Cl.jsx)(Qf,{donationAmount:n.donationAmount,donationFrequency:n.donationFrequency,onEndCallClick:v});case If.CUSTOMER_NAME:return(0,Cl.jsx)($f,{firstName:n.firstName,lastName:n.lastName,onEndCallClick:v});case If.CUSTOMER_EMAIL:return(0,Cl.jsx)(zf,{email:n.email,onEndCallClick:v});case If.PAYMENT_CARD:return(0,Cl.jsx)(tv,{cardNumber:n.cardNumber,cardExpirationDate:n.cardExpirationDate,cardCvc:n.cardCvc,disabled:n.locked,onEndCallClick:v});case If.PAYMENT_APPLE_PAY:return(0,Cl.jsx)(Jf,{disabled:n.locked,onApplePayClick:f,onEndCallClick:v});case If.THANK_YOU:return(0,Cl.jsx)(iv,{donationAmount:n.donationAmount,donationFrequency:n.donationFrequency,firstName:n.firstName,onCloseClick:S});default:return null}})()},av=(0,kr.memo)(sv),ov=()=>{const{controller:e}=Tc(Vn.DONATE_BY_VOICE),t=(0,Bl.P)(),n=(0,kr.useRef)(null),i=(0,kr.useCallback)((()=>{e.handlePermissionsEndCallButtonClick()}),[e]);return(0,kr.useEffect)((()=>{t&&n.current&&n.current.scrollIntoView(!0)}),[t,e]),(0,kr.useEffect)((()=>{e.askForMicrophonePermission()}),[e]),(0,Cl.jsxs)("div",{className:"p-rel flow-screen",children:[(0,Cl.jsx)(Ad,{title:"Give by voice"}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)(xf,{children:[(0,Cl.jsx)("div",{className:"text-center",children:(0,Cl.jsx)(Rf,{})}),(0,Cl.jsxs)("h2",{className:"mt-4 title-50-semibold text-center",children:["Please allow microphone",(0,Cl.jsx)("br",{})," access in your browser"]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)("button",{type:"button",className:"btn btn-default d-flex items-center justify-center","data-qa":"back-button","data-tracking-element-name":"backButton",onClick:i,children:(0,Cl.jsx)("span",{children:"Back"})})})]})},rv=(0,kr.memo)(ov),lv={title:"mailingAddressScreen.title",line1:"mailingAddressScreen.addressForm.line1",line2:"mailingAddressScreen.addressForm.line2",state:"mailingAddressScreen.addressForm.state",city:"mailingAddressScreen.addressForm.city",postcode:"mailingAddressScreen.addressForm.postcode",sublocality:void 0,administrativeArea:void 0,skipButton:"mailingAddressScreen.button.skip"},cv=[{country:Ci.UNITED_KINGDOM,values:{state:"mailingAddressScreen.addressForm.GB.state",postcode:"mailingAddressScreen.addressForm.GB.postcode"}},{country:Ci.CANADA,values:{state:"mailingAddressScreen.addressForm.CA.state",postcode:"mailingAddressScreen.addressForm.CA.postcode"}},{country:Ci.IRELAND,values:{state:"mailingAddressScreen.addressForm.IE.state",postcode:"mailingAddressScreen.addressForm.IE.postcode"}},{country:Ci.DENMARK,values:{state:"mailingAddressScreen.addressForm.DK.state",postcode:"mailingAddressScreen.addressForm.DK.postcode"}},{country:Ci.MEXICO,values:{line1:"mailingAddressScreen.addressForm.MX.line1",line2:"mailingAddressScreen.addressForm.MX.line2",sublocality:"mailingAddressScreen.addressForm.MX.sublocality",administrativeArea:"mailingAddressScreen.addressForm.MX.administrativeArea"}}];class uv{constructor(e){this.intl=e}getLabels(e){const{countryCode:t,isOnBehalfOf:n,isAlternativeLabels:i,isBenefitDeliveryAddressRequired:s=!1}=e;let a=Object.assign({},lv);n&&(a.title="mailingAddressScreen.onBehalfOfTitle"),i&&(a.line1="mailingAddressScreen.addressForm.zipFirst.line1",a.line2="mailingAddressScreen.addressForm.zipFirst.line2"),s&&(a.skipButton="mailingAddressScreen.button.skipWithoutGift");const o=this.getCustomizeLabelKeysByCountry(t);return o&&(a=Object.assign(Object.assign({},a),o)),{title:this.translateSafely(a.title),state:this.translateSafely(a.state),city:this.translateSafely(a.city),postcode:this.translateSafely(a.postcode),line1:this.translateSafely(a.line1),line2:this.translateSafely(a.line2),sublocality:this.translateSafely(a.sublocality),administrativeArea:this.translateSafely(a.administrativeArea),skipButton:this.translateSafely(a.skipButton)}}translateSafely(e){return e?this.intl.translate(e):""}getCustomizeLabelKeysByCountry(e){var t;return null===(t=cv.find((t=>t.country===e)))||void 0===t?void 0:t.values}}const dv=e=>{const{onChange:t,onSearch:n,onSelect:i,onClear:s,value:a,options:o,className:r,inputClasses:l,loading:c,placeholder:u,label:h,labelOptional:m,disabled:p,debounce:g=500,allowClear:y,hint:f,hintAriaLabel:v,hasError:S,errorLabel:E,dataQa:A,dataTestId:C,trackingElement:b,maxLength:P,selectedOption:N,ListItemToRender:D,SelectedIconToRender:T,showIcons:k,labelFloating:I,autoComplete:_,inputRef:O,autoFocus:x,autoFocusMode:w}=e,R=(0,d.Tt)(e,["onChange","onSearch","onSelect","onClear","value","options","className","inputClasses","loading","placeholder","label","labelOptional","disabled","debounce","allowClear","hint","hintAriaLabel","hasError","errorLabel","dataQa","dataTestId","trackingElement","maxLength","selectedOption","ListItemToRender","SelectedIconToRender","showIcons","labelFloating","autoComplete","inputRef","autoFocus","autoFocusMode"]),{set:M,clear:L}=(0,hd.D)((e=>{n(e)})),F=(0,kr.useCallback)((e=>{t(e),L(),M([e],g)}),[t,M,L,g]);return(0,Cl.jsx)(of,Object.assign({inputRef:O,options:o,value:a,onChange:F,onSelect:i,className:r,inputClasses:l,placeholder:u,label:h,labelOptional:m,disabled:p,loading:c,hint:f,hintAriaLabel:v,allowClear:y,onClear:s,selectedOption:N,dataQa:A,dataTestId:C,hasError:S,errorLabel:E,trackingElement:b,ListItemToRender:D,SelectedIconToRender:T,showIcons:k,maxLength:P,labelFloating:I,autoComplete:_,autoFocus:x,autoFocusMode:w},R))};dv.displayName="RawAutocomplete";const hv=(0,kr.memo)(dv),mv=e=>{let{className:t,isCountryFieldDisabled:n}=e;const{state:i,controller:s}=Tc(wl.MAILING_ADDRESS),a=(0,nc.t)(),o=(0,kr.useId)(),[r,l]=(0,kr.useState)(!1),c=(0,kr.useCallback)((e=>{s.changeSelectedCountry(e.target.value)}),[s]),u=!i.validation.fields.countryCode.isValid,d=a.translate("mailingAddressScreen.addressForm.country"),h=i.countries.map((e=>{let{countryCode:t,countryName:n}=e;return{value:t,label:n}}));return(0,Cl.jsx)(Kh,{id:`country-${o}`,label:d,labelFloating:!0,className:(0,Ml.A)({"pe-16":u,"is-visually-disabled":n}),formLabelClass:(0,Ml.A)({"pe-12":u}),formGroupClass:t,value:i.countryCode,disabled:i.locked||n,error:u,dataQa:"country-selector",options:h,autoComplete:"country-name","aria-required":!0,"aria-describedby":`country-${o}-error`,onChange:c,onFocus:()=>l(!0),onBlur:()=>l(!1),children:u&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-10",showTooltip:r,children:(0,Cl.jsx)("p",{id:`country-${o}-error`,className:"sr-only",children:s.getAriaErrorMessage(d)})})})},pv=(0,kr.memo)(mv),gv=e=>{let{setSelectRef:t,setInputRef:n,label:i,className:s}=e;const{state:a,controller:o}=Tc(wl.MAILING_ADDRESS),r=(0,kr.useId)(),[l,c]=(0,kr.useState)(!1),[u,d]=(0,kr.useState)(!1),h=o.getStates(a.countryCode),m=!a.validation.fields.region.isValid,p=Array.isArray(h)?h.map((e=>{let{code:t,name:n}=e;return{value:t,label:n}})):[],g={};if(h&&!Array.isArray(h))for(const[e,t]of Object.entries(h))g[e]=t.map((e=>{let{code:t,name:n}=e;return{value:t,label:n}}));return(0,Cl.jsx)(Cl.Fragment,{children:h?(0,Cl.jsx)(Kh,{id:`select-region-${r}`,setRef:t,label:i,labelFloating:!0,className:(0,Ml.A)({"pe-16":m}),formLabelClass:(0,Ml.A)({"pe-12":m}),formGroupClass:s,value:a.region,hasCustomValue:Boolean(a.region),customPlaceholder:i,options:p,groupedOptions:g,autoComplete:"address-level1",disabled:a.locked,error:m,"aria-required":!0,"aria-describedby":`region-${r}-error`,dataQa:"state-selector",dataTestId:"state-selector",onChange:e=>o.changeRegion(e.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),children:m&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end me-10 z-index-5",showTooltip:u,children:(0,Cl.jsx)("p",{id:`region-${r}-error`,children:o.getAriaErrorMessage(i)})})}):(0,Cl.jsx)(Kd.t,{id:`input-region-${r}`,setRef:n,label:i,labelFloating:!0,className:(0,Ml.A)({"pe-10":m}),formLabelClass:(0,Ml.A)({"pe-6":m}),formGroupClass:s,value:a.region,placeholder:i,autoComplete:"address-level1",disabled:a.locked,error:m,"aria-required":!0,"aria-describedby":`region-${r}-error`,dataQa:"state-field",dataTestId:"state-field",onChange:e=>o.changeRegion(e.target.value),onFocus:()=>c(!0),onBlur:()=>c(!1),children:m&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end me-4 z-index-5",showTooltip:l,children:(0,Cl.jsx)("p",{id:`region-${r}-error`,children:o.getAriaErrorMessage(i)})})})})},yv=(0,kr.memo)(gv),{useAddFieldToScroll:fv,useScrollToFieldsTrigger:vv,ScrollToFieldsProvider:Sv}=(0,Ud.J)(),Ev=e=>{const{state:t,controller:n}=Tc(wl.MAILING_ADDRESS),i=(0,nc.t)(),s=(0,Bl.P)(),a=(0,Zl.$)(),o=(0,kr.useId)(),[r,l]=(0,kr.useState)(!1),[c,u]=(0,kr.useState)(!1),[d,h]=(0,kr.useState)(!1),[m,p]=(0,kr.useState)(!1),[g,y]=(0,kr.useState)(!1),f=vv(),v=(0,kr.useCallback)((e=>{e.preventDefault(),f(),n.leave()}),[n,f]),S=(0,kr.useMemo)((()=>(e=>new uv(e))(i)),[i]),E=(0,kr.useMemo)((()=>S.getLabels({countryCode:t.countryCode,isOnBehalfOf:n.isOnBehalfOf,isAlternativeLabels:t.isAlternativeLabels})),[S,t.countryCode,n.isOnBehalfOf,t.isAlternativeLabels]),A=$d(t.shakeKey,0!==t.shakeKey),C=!t.validation.fields.postal.isValid,b=!t.validation.fields.line1.isValid,P=!t.validation.fields.line2.isValid,N=!t.validation.fields.city.isValid,D=!t.validation.fields.sublocality.isValid,T=!t.validation.fields.administrativeArea.isValid,k=(0,kr.useCallback)((e=>{a||n.search(e)}),[n,a]),I=(0,kr.useCallback)((e=>n.changeLine1(e)),[n]),_=(0,kr.useCallback)((e=>n.changeLine2(e.target.value)),[n]),O=(0,kr.useCallback)((e=>n.changePostalCode(e)),[n]),x=(0,kr.useCallback)((e=>n.changePostalCode(e.target.value)),[n]),w=(0,kr.useCallback)((e=>n.changeCity(e.target.value)),[n]),R=(0,kr.useCallback)((e=>n.changeSublocality(e.target.value)),[n]),M=(0,kr.useCallback)((e=>n.changeAdministrativeArea(e.target.value)),[n]),L=(0,kr.useCallback)(((e,t)=>{const i=n.getPlaceById(e),s=n.shouldFindSubplaces(i);return s?n.retrieveSubplaces(i,t):n.retrieveDetails(i),"postal"===t&&X(!0),"line1"===t&&Z(!0),s}),[n]),F=(0,kr.useCallback)((e=>L(e,"line1")),[L]),U=(0,kr.useCallback)((e=>L(e,"postal")),[L]),j=(0,kr.useMemo)((()=>t.places.map((e=>{let{description:t,innerId:n}=e;return{id:n,value:t}}))),[t.places]),B=(0,kr.useRef)(null),G=(0,kr.useRef)(null),q=(0,kr.useRef)(null),V=(0,kr.useRef)(null),H=(0,kr.useRef)(null),K=(0,kr.useRef)(null),Y=(0,kr.useRef)(null),z=(0,kr.useRef)(null),W=(0,kr.useRef)(null),[$,X]=(0,kr.useState)(!1),[Q,Z]=(0,kr.useState)(!1);(0,Sd.f)({ref:t.isLayoutPostalCodeFirst?G:B,autoFocus:!0,mode:vd.Q.DESKTOP}),(0,Sd.f)({ref:B,autoFocus:$,mode:vd.Q.DESKTOP,preventScroll:!0}),(0,Sd.f)({ref:q,autoFocus:Q,mode:vd.Q.DESKTOP,preventScroll:!0}),(0,kr.useEffect)((()=>{Q&&Z(!1)}),[Q]),(0,kr.useEffect)((()=>{$&&X(!1)}),[$]);const J=t.isLayoutPostalCodeFirst;return fv(G,(e=>J&&!e.fields.postal.isValid)),fv(B,(e=>!e.fields.line1.isValid)),fv(V,(e=>!e.fields.sublocality.isValid)),fv(H,(e=>!e.fields.administrativeArea.isValid)),fv(K,(e=>!e.fields.city.isValid)),fv(Y,(e=>!e.fields.region.isValid)),fv(z,(e=>!e.fields.region.isValid)),fv(W,(e=>!J&&!e.fields.postal.isValid)),(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${o}`,"data-qa":"active-screen-mailing-address","data-testid":"active-screen-mailing-address",onSubmit:v,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${o}`,title:E.title,a11yAutoFocus:s}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-8":!s,shake:A}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[n.isOnBehalfOf&&(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center mb-5",s?"text-ellipsis":"text-line-clamp-3"),children:i.translate("mailingAddressScreen.onBehalfOfSubtitle")}),t.isLayoutPostalCodeFirst&&(0,Cl.jsx)("div",{className:"mb-4",children:(0,Cl.jsx)(hv,{labelFloating:!0,inputRef:G,inputClasses:"text-sans-serif",options:j,value:t.postal,onChange:O,onSelect:U,onSearch:k,hasError:C,errorLabel:i.translate("mailingAddressScreen.addressForm.error.valid",{field:E.postcode}),placeholder:E.postcode,label:E.postcode,disabled:t.locked,loading:t.isLoadingPlaces,dataQa:"post-code",maxLength:Ai.ZIP,autoComplete:"postal-code","aria-required":!0})}),(0,Cl.jsxs)("div",{className:"group-stacked-vertical",children:[(0,Cl.jsx)(hv,{inputRef:B,labelFloating:!0,label:E.line1,className:"group-stacked-item",value:t.line1,placeholder:E.line1,options:j,maxLength:Ai.STREET,loading:t.isLoadingPlaces,disabled:t.locked,hasError:b,errorLabel:n.getAriaErrorMessage(E.line1),"aria-required":!0,onChange:I,onSelect:F,onSearch:k,dataQa:"street",dataTestId:"street",autoComplete:"address-line1"}),(0,Cl.jsx)(Kd.t,{id:`address-line2-${o}`,setRef:q,label:E.line2,labelFloating:!0,className:(0,Ml.A)({"pe-10":P}),formLabelClass:(0,Ml.A)({"pe-6":P}),formGroupClass:"group-stacked-item",value:t.line2,onChange:_,error:P,disabled:t.locked,autoComplete:"address-line2",placeholder:E.line2,dataQa:"apartment-field",maxLength:Ai.APARTMENT,"aria-describedby":`line-2-${o}-error`,onFocus:()=>l(!0),onBlur:()=>l(!1),children:P&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:r,children:(0,Cl.jsx)("p",{id:`line-2-${o}-error`,children:n.getAriaErrorMessage(E.line2)})})}),t.isSublocalityVisible&&(0,Cl.jsx)(Kd.t,{id:`sublocality-${o}`,setRef:V,label:E.sublocality,labelFloating:!0,className:(0,Ml.A)({"pe-10":D}),formLabelClass:(0,Ml.A)({"pe-6":D}),formGroupClass:"group-stacked-item",value:t.sublocality,placeholder:E.sublocality,disabled:t.locked,maxLength:Ai.SUBLOCALITY,error:D,autoComplete:"address-level4","aria-required":!0,"aria-describedby":`sublocality-${o}-error`,dataQa:"sublocality",dataTestId:"sublocality",onChange:R,onFocus:()=>p(!0),onBlur:()=>p(!1),children:D&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:m,children:(0,Cl.jsx)("p",{id:`sublocality-${o}-error`,children:n.getAriaErrorMessage(E.sublocality)})})}),t.isAdministrativeAreaVisible&&(0,Cl.jsx)(Kd.t,{id:`administrative-area-${o}`,setRef:H,label:E.administrativeArea,labelFloating:!0,className:(0,Ml.A)({"pe-10":T}),formLabelClass:(0,Ml.A)({"pe-6":T}),formGroupClass:"group-stacked-item",value:t.administrativeArea,placeholder:E.administrativeArea,autoComplete:"address-level3",disabled:t.locked,maxLength:Ai.ADMINISTRATIVE_AREA,error:T,"aria-required":!0,"aria-describedby":`administrative-area-${o}-error`,dataQa:"administrative-area",dataTestId:"administrative-area",onChange:M,onFocus:()=>y(!0),onBlur:()=>y(!1),children:T&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:g,children:(0,Cl.jsx)("p",{id:`administrative-area-${o}-error`,children:n.getAriaErrorMessage(E.administrativeArea)})})}),(0,Cl.jsx)(Kd.t,{label:E.city,labelFloating:!0,id:`city-${o}`,setRef:K,className:(0,Ml.A)({"pe-10":N}),formLabelClass:(0,Ml.A)({"pe-6":N}),formGroupClass:"group-stacked-item",value:t.city,placeholder:E.city,autoComplete:"address-level2",maxLength:Ai.CITY,disabled:t.locked,error:N,"aria-required":!0,"aria-describedby":`city-${o}-error`,dataQa:"city",dataTestId:"city",onChange:w,onFocus:()=>u(!0),onBlur:()=>u(!1),children:N&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:c,children:(0,Cl.jsx)("p",{id:`city-${o}-error`,children:n.getAriaErrorMessage(E.city)})})})]}),(0,Cl.jsxs)("div",{className:"group-stacked-vertical mt-4",children:[!t.isLayoutPostalCodeFirst&&(0,Cl.jsxs)("div",{className:"group-stacked-horizontal group-stacked-item",children:[t.isRegionEnabled&&(0,Cl.jsx)(yv,{label:E.state,className:(0,Ml.A)("group-stacked-item w-50",{"me-1":t.isPostalCodeVisible}),setInputRef:Y,setSelectRef:z}),t.isPostalCodeVisible&&(0,Cl.jsx)(Kd.t,{id:`postal-${o}`,setRef:W,label:E.postcode,labelFloating:!0,className:(0,Ml.A)("text-sans-serif",{"pe-10":C}),formLabelClass:(0,Ml.A)({"pe-6":C}),formGroupClass:(0,Ml.A)("group-stacked-item",t.isRegionEnabled?"w-50 ms-1":"w-100"),value:t.postal,error:C,disabled:t.locked,autoComplete:"postal-code",placeholder:E.postcode,dataQa:"zip-code",dataTestId:"zip-code",maxLength:Ai.ZIP,"aria-required":!0,"aria-describedby":`postcode-${o}-error`,onChange:x,onFocus:()=>h(!0),onBlur:()=>h(!1),children:C&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:d,children:(0,Cl.jsx)("p",{id:`postcode-${o}-error`,children:i.translate("mailingAddressScreen.addressForm.error.valid",{field:E.postcode})})})})]}),t.isLayoutPostalCodeFirst&&t.isRegionEnabled&&(0,Cl.jsx)(yv,{label:E.state,className:"group-stacked-item",setInputRef:Y,setSelectRef:z}),(0,Cl.jsx)(pv,{className:"group-stacked-item",isCountryFieldDisabled:n.isCountryFieldDisabled})]})]})}),(0,Cl.jsxs)(gd,{children:[(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:t.processingState,errorTitle:t.hasServerValidationError?i.safeTranslate("mailingAddressScreen.validationError.title"):t.payErrorMessage||i.safeTranslate("common.errorOccurredText"),errorMessage:t.additionalPayErrorMessage,dataQa:"mailing-continue",trackingElement:t.isPaymentScreen&&t.isRequired?"payButton":"nextButton",dataTestId:"mailing-continue-button",children:t.isPaymentScreen&&t.isRequired?th(i,t.formattedAmount,t.frequency):i.translate("mailingAddressScreen.button.continue")}),!t.isRequired&&(0,Cl.jsx)("div",{className:"d-flex justify-center mt-5",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",disabled:t.locked,onClick:()=>n.skip(),"data-qa":"skip-button","data-tracking-element-name":"skipButton","data-testid":"mailing-skip-button",children:E.skipButton})})]})]})},Av=(0,kr.memo)(Ev),Cv=e=>{let{disabled:t,onClose:n,onSave:i,processingState:s,serverErrors:a}=e;const o=(0,nc.t)();return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",disabled:t,onClick:i,trackingElement:"remindMeLaterConfirmButton",processingState:s,serverErrors:a,errorTitle:o.safeTranslate("common.errorOccurredText"),dataQa:"remind-me-later-confirm-button",children:o.translate("remindMeScreen.button.confirm")}),(0,Cl.jsx)("button",{type:"button",className:"btn btn-default mt-2",disabled:t,onClick:n,"data-tracking-element-name":"remindMeLaterCloseButton","data-qa":"remind-me-later-no-thanks-button",children:o.translate("remindMeScreen.button.close")})]})},bv=(0,kr.memo)(Cv),Pv=e=>{let{onTermsAcceptionChange:t,checked:n,isValid:i,className:s,locked:a,text:o,setRef:r}=e;const l=(0,nc.t)(),c=(0,Bl.P)(),u=(0,kr.useRef)(null);return(0,kr.useImperativeHandle)(r,(()=>u.current),[]),(0,Cl.jsx)(Fd,{setRef:u,className:s,checked:n,error:!i,disabled:a,onChange:t,dataQa:"remind-me-later-accept-terms-checkbox",children:(0,Cl.jsx)("span",{className:(0,Ml.A)({"text-line-clamp-2":!c}),dir:"auto",children:void 0===o||""===o?l.translate("remindMeScreen.termsText"):(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:o}})})})},Nv=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":!!e.ariaHidden||void 0,height:e.height||24,width:e.width||22,fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("radialGradient",{id:`a-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(2.74225404 11.29096326 -11.5614986 2.80795938 12 10.9506)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#4cadf4"}),(0,Cl.jsx)("stop",{offset:".816847",stopColor:"#44b8f0"}),(0,Cl.jsx)("stop",{offset:".861287",stopColor:"#409ff2"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#1f6fef"})]}),(0,Cl.jsxs)("radialGradient",{id:`b-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-2.81274751 -9.14752313 9.64618176 -2.96607873 12 11.4004)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:".561045",stopColor:"#4dd0f0",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:".868337",stopColor:"#4dd0f0",stopOpacity:".754177"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#4dd0f0",stopOpacity:"0"})]}),(0,Cl.jsxs)("radialGradient",{id:`c-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-4.76432055 -9.71917643 20.58418864 -10.09032748 13.0442 14.6319)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:".0102742",stopColor:"#4c9ef6"}),(0,Cl.jsx)("stop",{offset:".885024",stopColor:"#4b9ef6",stopOpacity:"0"})]}),(0,Cl.jsxs)("radialGradient",{id:`d-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(3.31321384 4.86948528 -10.57415853 7.19469231 8.68678 7.00844)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:".173971",stopColor:"#4bcdf0"}),(0,Cl.jsx)("stop",{offset:".885024",stopColor:"#4ccef1",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`e-${t}`,gradientUnits:"userSpaceOnUse",x1:"11.9996",x2:"13.77",y1:"6.09863",y2:"23.2126",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsxs)("radialGradient",{id:`f-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(0 6.71448 -11.4928 0 11.9996 11.1869)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:".91",stopColor:"#fff"})]}),(0,Cl.jsx)("circle",{cx:"12",cy:"11.8779",fill:`url(#a-${t})`,r:"11"}),(0,Cl.jsx)("circle",{cx:"12",cy:"11.8779",fill:`url(#b-${t})`,fillOpacity:".3",r:"11"}),(0,Cl.jsx)("circle",{cx:"12",cy:"11.8779",fill:`url(#c-${t})`,r:"11"}),(0,Cl.jsx)("circle",{cx:"12",cy:"11.8779",fill:`url(#d-${t})`,fillOpacity:".8",r:"11"}),(0,Cl.jsx)("path",{d:"m11.2885 8.33683.7111.71934.7112-.71934c2.0415-2.06503 4.4425-1.26364 5.1381.30145.3554.79955.3807 1.98542-.4866 3.44802-.8318 1.4027-2.4787 3.034-5.3627 4.6715-2.88397-1.6375-4.53087-3.2689-5.36268-4.6716-.8673-1.4626-.84197-2.64841-.48661-3.44797.69559-1.56507 3.09662-2.36647 5.13819-.3014z",stroke:"#fff",strokeWidth:"2"}),(0,Cl.jsx)("path",{d:"m11.9996 17.9014c13.1081-7.111 4.9269-15.25119 0-10.26762-4.92684-4.98363-13.10811 3.15662 0 10.26762z",fill:"#6bb1d4",fillOpacity:".6"}),(0,Cl.jsx)("path",{d:"m11.9996 17.9014c13.1081-7.111 4.9269-15.25119 0-10.26762-4.92684-4.98363-13.10811 3.15662 0 10.26762z",fill:`url(#e-${t})`,fillOpacity:".8"}),(0,Cl.jsx)("path",{d:"m11.9996 17.9014c13.1081-7.111 4.9269-15.25119 0-10.26762-4.92684-4.98363-13.10811 3.15662 0 10.26762z",fill:`url(#f-${t})`}),(0,Cl.jsx)("path",{d:"m11.644 7.98531.3556.35967.3556-.35967c2.2525-2.27841 5.0915-1.48313 5.9506.4499.4334.97502.4199 2.33219-.5134 3.90609-.9147 1.5424-2.71 3.2801-5.7928 4.9898-3.08277-1.7097-4.8781-3.4474-5.79275-4.9898-.93333-1.574-.94679-2.93111-.51345-3.90614.85913-1.93302 3.69816-2.72829 5.9506-.44985z",stroke:"#3398f1"})]})},Dv=(0,kr.memo)(Nv),Tv=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":!!e.ariaHidden||void 0,height:e.height||46,width:e.width||41,viewBox:"0 0 41 46",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"38",width:"40.3477",x:"0",y:"7",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:"-1",dy:"-1"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:".5"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.722448 0 0 0 0 0.424883 0 0 0 0 0.0858854 0 0 0 0.59 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_35866_79093"})]}),(0,Cl.jsxs)("radialGradient",{id:`b-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(4.80000386 4.99999715 -4.99583475 4.79600795 18.6719 3.5)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:".394249",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#d97922"})]}),(0,Cl.jsxs)("linearGradient",{id:`c-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsx)("linearGradient",{id:`d-${t}`,gradientUnits:"userSpaceOnUse",x1:"17.6719",x2:"19.9748",xlinkHref:`#c-${t}`,y1:"2.66667",y2:"5.77561"}),(0,Cl.jsxs)("linearGradient",{id:`e-${t}`,gradientUnits:"userSpaceOnUse",x1:"1.17334",x2:"41.6738",y1:"34",y2:"34",children:[(0,Cl.jsx)("stop",{offset:".135247",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:".249813",stopColor:"#ffd87c"}),(0,Cl.jsx)("stop",{offset:".409209",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:".752403",stopColor:"#c57429"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#bf7c19"})]}),(0,Cl.jsxs)("linearGradient",{id:`f-${t}`,gradientUnits:"userSpaceOnUse",x1:"40.6738",x2:"32.1738",y1:"28.5",y2:"31.5",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#f3c352",stopOpacity:"0"})]}),(0,Cl.jsx)("linearGradient",{id:`g-${t}`,gradientUnits:"userSpaceOnUse",x1:"4.67334",x2:"28.1733",xlinkHref:`#c-${t}`,y1:"20.5",y2:"40.5"}),(0,Cl.jsx)("path",{d:"m17.1719 5c0-1.933 1.567-3.5 3.5-3.5s3.5 1.567 3.5 3.5v5.5h-7z",fill:`url(#b-${t})`,stroke:`url(#d-${t})`}),(0,Cl.jsxs)("g",{filter:`url(#a-${t})`,children:[(0,Cl.jsx)("path",{d:"m20.6737 8c-8.8365 0-14.99999 7.1634-14.99999 16l-1 9.4441c0 1.9793-2.03499 3.6492-2.72998 5.5025l-.75 2c-.735473 1.9613.71437 4.0534 2.80899 4.0534h33.34198c2.0946 0 3.5445-2.0921 2.809-4.0534l-.75-2c-.695-1.8533-2.73-3.5232-2.73-5.5025l-1-9.4441c0-8.8366-6.1634-16-15-16z",fill:`url(#e-${t})`}),(0,Cl.jsx)("path",{d:"m20.6737 8c-8.8365 0-14.99999 7.1634-14.99999 16l-1 9.4441c0 1.9793-2.03499 3.6492-2.72998 5.5025l-.75 2c-.735473 1.9613.71437 4.0534 2.80899 4.0534h33.34198c2.0946 0 3.5445-2.0921 2.809-4.0534l-.75-2c-.695-1.8533-2.73-3.5232-2.73-5.5025l-1-9.4441c0-8.8366-6.1634-16-15-16z",fill:`url(#f-${t})`,fillOpacity:".8"})]}),(0,Cl.jsx)("path",{d:"m5.92232 24.0263.00139-.0131v-.0132c0-8.7202 6.07229-15.75 14.74999-15.75s14.75 7.0298 14.75 15.75v.0132l.0014.0131.9986 9.4313c.0046 1.0662.5526 2.0299 1.1461 2.9233.1312.1975.2644.3913.3959.5828.4816.7012.9414 1.3706 1.2039 2.0707l.75 2c.6742 1.7978-.6548 3.7156-2.5749 3.7156h-33.34198c-1.92007 0-3.249092-1.9178-2.57491-3.7156l.75-2c.26254-.7001.72236-1.3696 1.20396-2.0707.1315-.1915.26463-.3853.39581-.5828.59354-.8934 1.14152-1.8571 1.1461-2.9234z",stroke:`url(#g-${t})`,strokeOpacity:".6",strokeWidth:".5"})]})},kv=(0,kr.memo)(Tv),Iv=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":!!e.ariaHidden||void 0,height:e.height||80,width:e.width||80,fill:"none",viewBox:"0 0 80 80",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"67",width:"81",x:"-.972656",y:"30",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"3",result:"effect1_dropShadow_35224_19304"}),(0,Cl.jsx)("feOffset",{dy:"4"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_35224_19304"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_35224_19304",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("filter",{id:`b-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"52.8696",width:"72.2329",x:"8.26211",y:"35.5863",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:"-.695652",dy:"-.695652"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:".57971"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_35224_19304"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_35224_19304",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("filter",{id:`c-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"52.8696",width:"72.2329",x:"-.432518",y:"35.5863",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:".695652",dy:"-.695652"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:".57971"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_35224_19304"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_35224_19304",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("filter",{id:`d-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"29.7837",width:"82.3188",x:"-1.13208",y:"58.664",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-.695652"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:".57971"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_35224_19304"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_35224_19304",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("linearGradient",{id:`e-${t}`,gradientUnits:"userSpaceOnUse",x1:"40.0273",x2:"40.0273",y1:"44.5256",y2:"88.0038",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#2c3440"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#2c2d31"})]}),(0,Cl.jsxs)("radialGradient",{id:`f-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(0 -24 33.5 0 39.5273 57)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#eba837"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#915b00",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`g-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#151518"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#313b48"})]}),(0,Cl.jsx)("linearGradient",{id:`h-${t}`,gradientUnits:"userSpaceOnUse",x1:"62",x2:"62",xlinkHref:`#g-${t}`,y1:"88",y2:"51"}),(0,Cl.jsxs)("linearGradient",{id:`i-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#cf8413"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#2d3541",stopOpacity:"0"})]}),(0,Cl.jsx)("radialGradient",{id:`j-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(27.50001912 27.50001912 -27.50001912 27.50001912 49.5352 60)",gradientUnits:"userSpaceOnUse",r:"1",xlinkHref:`#i-${t}`}),(0,Cl.jsxs)("radialGradient",{id:`k-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(20.50001554 20.50001554 -20.50001554 20.50001554 52.5273 57)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#f1bf51"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#cd8131",stopOpacity:"0"})]}),(0,Cl.jsx)("linearGradient",{id:`l-${t}`,gradientUnits:"userSpaceOnUse",x1:"18.0625",x2:"18.0625",xlinkHref:`#g-${t}`,y1:"88",y2:"51"}),(0,Cl.jsx)("radialGradient",{id:`m-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-27.50001912 27.50001912 -27.50001912 -27.50001912 30.5273 60)",gradientUnits:"userSpaceOnUse",r:"1",xlinkHref:`#i-${t}`}),(0,Cl.jsxs)("radialGradient",{id:`n-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-17.4999736 17.4999736 -17.4999736 -17.4999736 23.5273 55)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:".0001",stopColor:"#ffe24b"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsxs)("radialGradient",{id:`o-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(0 24.5 -24.5 0 40.0273 61.5)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#e4a946"}),(0,Cl.jsx)("stop",{offset:".542849",stopColor:"#b37c20",stopOpacity:".7"}),(0,Cl.jsx)("stop",{offset:"1",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`p-${t}`,gradientUnits:"userSpaceOnUse",x1:"40.0273",x2:"40.0273",y1:"60.5",y2:"86.5",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffd267"}),(0,Cl.jsx)("stop",{offset:"1",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`q-${t}`,gradientUnits:"userSpaceOnUse",x1:"65.0273",x2:"65.0273",y1:"80",y2:"51",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#222832"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#31373f",stopOpacity:"0"})]}),(0,Cl.jsx)("clipPath",{id:`r-${t}`,children:(0,Cl.jsx)("rect",{height:"80",rx:"2",width:"80"})}),(0,Cl.jsx)("clipPath",{id:`s-${t}`,children:(0,Cl.jsx)("rect",{height:"80",rx:"1.3913",width:"80",x:".027344"})}),(0,Cl.jsx)("g",{clipPath:`url(#r-${t})`,children:(0,Cl.jsxs)("g",{clipPath:`url(#s-${t})`,children:[(0,Cl.jsx)("path",{d:"m.027344 37.4531h80v50.5507h-80z",fill:`url(#e-${t})`}),(0,Cl.jsx)("path",{d:"m.0273438 37.4531h79.9999562l-36.7516-26.4186c-1.9409-1.39512-4.5558-1.39513-6.4967 0z",fill:"#2c3440"}),(0,Cl.jsx)("path",{d:"m6.48047 37.4591h67.09683l-30.3001-21.7809c-1.9409-1.3952-4.5558-1.3952-6.4967 0z",fill:"#222832"}),(0,Cl.jsxs)("g",{filter:`url(#a-${t})`,children:[(0,Cl.jsx)("rect",{fill:"#4a4a4d",height:"53",rx:"1.15942",width:"67",x:"6.02734",y:"33"}),(0,Cl.jsx)("rect",{fill:`url(#f-${t})`,fillOpacity:".3",height:"53",rx:"1.15942",width:"67",x:"6.02734",y:"33"})]}),(0,Cl.jsxs)("g",{filter:`url(#b-${t})`,children:[(0,Cl.jsx)("path",{d:"m80.0312 37.4414-69.913 50.5507h69.913z",fill:`url(#h-${t})`}),(0,Cl.jsx)("path",{d:"m80.0312 37.4414-69.913 50.5507h69.913z",fill:`url(#j-${t})`,fillOpacity:".3"}),(0,Cl.jsx)("path",{d:"m79.7812 87.7421v-49.8114l-68.8906 49.8114z",stroke:`url(#k-${t})`,strokeOpacity:".5",strokeWidth:".5"})]}),(0,Cl.jsxs)("g",{filter:`url(#c-${t})`,children:[(0,Cl.jsx)("path",{d:"m.03125 37.4414 69.91305 50.5507h-69.91305z",fill:`url(#l-${t})`}),(0,Cl.jsx)("path",{d:"m.03125 37.4414 69.91305 50.5507h-69.91305z",fill:`url(#m-${t})`,fillOpacity:".3"}),(0,Cl.jsx)("path",{d:"m.28125 87.7421v-49.8114l68.89065 49.8114z",stroke:`url(#n-${t})`,strokeOpacity:".5",strokeWidth:".5"})]}),(0,Cl.jsxs)("g",{filter:`url(#d-${t})`,children:[(0,Cl.jsx)("path",{d:"m.0273438 87.9839h79.9999562l-36.7516-26.4186c-1.9409-1.3952-4.5558-1.3952-6.4967 0z",fill:"#1e2736"}),(0,Cl.jsx)("path",{d:"m.0273438 87.9839h79.9999562l-36.7516-26.4186c-1.9409-1.3952-4.5558-1.3952-6.4967 0z",fill:`url(#o-${t})`,fillOpacity:".3"}),(0,Cl.jsx)("path",{d:"m36.9249 61.7683-36.121461 25.9656h78.447861l-36.1215-25.9656c-1.8537-1.3325-4.3512-1.3325-6.2049 0z",stroke:`url(#p-${t})`,strokeWidth:".5"})]}),(0,Cl.jsx)("path",{d:"m.027344 51h80v29h-80z",fill:`url(#q-${t})`})]})})]})},_v=(0,kr.memo)(Iv),Ov=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":!!e.ariaHidden||void 0,height:e.height||61,width:e.width||60,viewBox:"0 0 60 61",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"62",width:"62",x:"0",y:"1",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_35868_79127",stdDeviation:"4.5"})]}),(0,Cl.jsx)("clipPath",{id:`b-${t}`,children:(0,Cl.jsx)("path",{d:"m0 0h60v61h-60z"})}),(0,Cl.jsx)("g",{clipPath:`url(#b-${t})`,children:(0,Cl.jsx)("g",{filter:`url(#a-${t})`,children:(0,Cl.jsx)("path",{d:"m26.6492 13.8261c0-2.1131 1.7248-3.8261 3.8524-3.8261 2.1277 0 3.8525 1.713 3.8525 3.8261v3.3681c6.3974 1.7208 10.5959 7.6973 10.5959 14.8058l.9631 9.0335c0 1.1458.718-1.6428 1.4332-.6092.4665.6741.9319 1.3466 1.1961 2.0464l.7223 1.913c.7084 1.876 5.2393 9.6163 3.2219 9.6163l-15.3115-5.7391c-.4673 3.2448-2.962 3.8261-6.3584 3.8261s-6.5212-.5813-6.9886-3.8261l-14.19963 5.2608c-2.01735 0 1.40523-7.262 2.11353-9.138l.7224-1.913c.2642-.6998.7296-1.3723 1.1961-2.0464.7152-1.0336 1.4331 1.755 1.4331.6092l.9632-9.0335c0-7.1072 4.1969-13.0828 10.5924-14.8049z",fill:"#252525",fillOpacity:".7"})})})]})},xv=(0,kr.memo)(Ov),wv=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":!!e.ariaHidden||void 0,height:e.height||14,width:e.width||14,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("radialGradient",{id:`a-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-2.50005399 6.4999748 -9.01804898 -3.46856872 7 7)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#f3c352"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#e38937"})]}),(0,Cl.jsxs)("radialGradient",{id:`b-${t}`,cx:"0",cy:"0",gradientTransform:"matrix(-1.99995166 7.00001393 -7.00001393 -1.99995166 5.5 14)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:".0899711",stopColor:"#f3c352",stopOpacity:"0"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#b25b0a"})]}),(0,Cl.jsxs)("linearGradient",{id:`c-${t}`,gradientUnits:"userSpaceOnUse",x1:"4.5",x2:"9.5",y1:"19.5",y2:"8",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ffeab4"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#eaaf6a",stopOpacity:"0"})]}),(0,Cl.jsx)("circle",{cx:"7",cy:"7",fill:`url(#a-${t})`,r:"7"}),(0,Cl.jsx)("circle",{cx:"7",cy:"7",fill:`url(#b-${t})`,fillOpacity:".7",r:"7"}),(0,Cl.jsx)("circle",{cx:"7",cy:"7",r:"6.75",stroke:`url(#c-${t})`,strokeOpacity:".6",strokeWidth:".5"})]})},Rv=(0,kr.memo)(wv),{useAddFieldToScroll:Mv,useScrollToFieldsTrigger:Lv,ScrollToFieldsProvider:Fv}=(0,Ud.J)(),Uv={maxWidth:"260px"},jv=()=>{const{state:e,controller:t}=Tc(wl.REMIND_ME),n=(0,nc.t)(),i=(0,kr.useId)(),s=(0,Bl.P)(),a=Dc(),o=(0,kr.useRef)(null),r=(0,kr.useRef)(null),l=!e.email.isValid||e.serverErrors.email,[c,u]=(0,kr.useState)(!1),h=$d(e.shakeKey,0!==e.shakeKey),m=_r(),p=Lv(),g=(0,kr.useCallback)((()=>{t.updateIsTermsAndConditionsAccepted(!e.termsAndConditions.isAccepted)}),[t,e]),y=(0,kr.useCallback)((e=>{t.clearEmailServerError(),t.updateEmail(e.target.value)}),[t]),f=(0,kr.useCallback)((()=>(0,d.sH)(void 0,void 0,void 0,(function*(){(yield t.save())&&m.emit(Tr.SHOULD_HIDE,{isManualCall:!0}),p()}))),[t,m,p]),v=(0,kr.useCallback)((()=>{t.saveOnClose(),a.getCurrentFlow().isCurrentScreenLast()?m.emit(Tr.SHOULD_HIDE,{isManualCall:!0}):t.leave()}),[t,m,a]);return Mv(o,(e=>{var t;return!e.validation.email.isValid||Boolean(null===(t=e.serverErrors)||void 0===t?void 0:t.email)})),Mv(r,(e=>!e.validation.termsAndConditions.isValid)),(0,Cl.jsxs)("section",{className:"flow-screen dark-mode-screen","aria-labelledby":`screen-header-${i}`,"data-qa":"remind-me-later-screen",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${i}`,screenTitle:n.translate("remindMeScreen.title"),a11yAutoFocus:s,backButtonClickHandler:()=>{t.resetToDefaultState(),a.getCurrentFlow().prev()},children:(0,Cl.jsx)("h2",{className:(0,Ml.A)(s?"title-50-semibold text-ellipsis":"title-30-medium text-line-clamp-2"),children:n.translate("remindMeScreen.title")})}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body py-8",{shake:h}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsxs)("div",{className:"bell-wrap","aria-hidden":!0,children:[(0,Cl.jsx)(_v,{className:"d-block mx-auto"}),(0,Cl.jsx)(xv,{className:"bell-shadow"}),(0,Cl.jsx)(Rv,{className:"bell-tongue"}),(0,Cl.jsx)(kv,{className:"bell"}),(0,Cl.jsx)(Dv,{className:"bell-heart"})]}),(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center mx-auto mt-6",s?"text-ellipsis":"text-line-clamp-5"),style:Uv,children:n.translate("remindMeScreen.description")}),(0,Cl.jsxs)("div",{className:(0,Ml.A)(s?"mt-6":"mt-8",{shake:l}),children:[(0,Cl.jsx)(Kd.t,{id:`remind-email-input-${i}`,setRef:o,name:"email",autoComplete:"email",autoFocus:!0,label:n.translate("remindMeScreen.emailInput.label"),labelFloating:!0,placeholder:n.translate("remindMeScreen.emailInput.placeholder"),className:(0,Ml.A)({"pe-10":l}),formLabelClass:(0,Ml.A)({"pe-6":l}),error:l,value:e.email.value,disabled:e.locked,dataQa:"remind-me-later-email-input","data-testid":"remind-me-later-email-input",inputMode:"email","aria-required":!0,"aria-describedby":`remind-email-input-${i}-error`,onChange:y,onFocus:()=>u(!0),onBlur:()=>u(!1),children:l&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:c,children:(0,Cl.jsxs)("p",{id:`remind-email-input-${i}-error`,children:[!e.email.isValid&&n.translate("remindMeScreen.emailInput.error.required"),e.serverErrors.email&&(0,Cl.jsx)(fc,{token:"remindMeScreen.emailInput.error.server"})]})})}),e.isTermsAndConditionsEnabled&&(0,Cl.jsx)(Pv,{className:"mt-4",text:e.termsAndConditions.text,checked:e.termsAndConditions.isAccepted,isValid:e.termsAndConditions.isValid,onTermsAcceptionChange:g,setRef:r})]})]})}),(0,Cl.jsx)(gd,{backButtonClass:"text-white-hover-white",children:(0,Cl.jsx)(bv,{disabled:e.locked,onClose:v,onSave:f,processingState:e.processingState,serverErrors:e.serverErrors})})]})};var Bv,Gv,qv=n(3488);!function(e){e.CARD_NUMBER="cardNumber",e.CARD_EXPIRY="cardExpiry",e.CARD_CVC="cardCvc",e.AU_BANK_ACCOUNT="auBankAccount",e.IBAN="iban",e.IDEAL_BANK="idealBank"}(Bv||(Bv={})),function(e){e.CARD="card",e.PAYMENT_OPTIONS="paymentOptions"}(Gv||(Gv={}));var Vv=n(6758);class Hv extends Error{constructor(){super("Paypal SDK is not ready"),this.name="PaypalSDKNotReadyError"}}class Kv extends Error{constructor(){super("Stripe SDK is not ready"),this.name="StripeSDKNotReadyError"}}const Yv=e=>{const t=(0,Il.M)(),n=(0,Bl.P)(),i=Ol(),s=(0,kr.useRef)(!1);return()=>{e.paymentSdkProperty in t||n||s.current||(s.current=!0,i.captureException(e.paymentSdkError,(t=>(t.setTag(r.ERROR_TYPE,e.paymentSdkSentryErrorType),t.setTag(r.PAYMENT_METHOD,e.paymentMethod),t.setFingerprint([e.paymentSdkSentryErrorFingerprint]),t))))}},zv=e=>Yv({paymentSdkProperty:"Stripe",paymentSdkError:new Kv,paymentSdkSentryErrorType:l.STRIPE_SDK_INITIALIZATION,paymentSdkSentryErrorFingerprint:"stripe-sdk-is-not-ready",paymentMethod:e.paymentMethod});var Wv=n(5200);const $v={isEmpty:!0,error:null,isFocused:!1,isReady:!1};function Xv(){const[e,t]=(0,kr.useState)($v);return{stripeElementState:e,setStripeElementState:t}}const Qv={boxShadow:"0 0 0 4px rgba(51, 113, 230, 0.5)"},Zv={maxWidth:"266px",boxShadow:"0 1px 3px rgba(109, 141, 177, 0.5)"},Jv=e=>{let{className:t,firstNumber:n,secondNumber:i,firstNumberHighlighted:s,secondNumberHighlighted:a}=e;const o=(0,kr.useId)();return(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-rel w-100 border-radius-4",t),style:Zv,"aria-hidden":"true",children:[(0,Cl.jsxs)("svg",{className:"d-block",width:266,height:104,viewBox:"0 0 266 104",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,Cl.jsx)("rect",{width:"266",height:"104",rx:"4",fill:"#F5FAFF"}),(0,Cl.jsx)("rect",{width:"266",height:"104",rx:"4",fill:`url(#${o}-paint0_linear_12221_26907)`}),(0,Cl.jsx)("rect",{x:"4.5",y:"4.5",width:"257",height:"95",rx:"0.5",stroke:`url(#${o}-paint1_linear_12221_26907)`}),(0,Cl.jsx)("path",{d:"M213.213 36.3C213.513 40.8 213.813 45.2 214.113 49.7C214.313 51.9 214.513 54.1 214.513 56.2C214.513 56.6 214.513 57.5 214.213 57.2C212.813 55.8 212.013 53 211.313 51.2C210.413 49.1 209.913 47 210.013 44.6C210.113 41 212.713 37.4 216.513 36.4C218.513 35.9 220.013 37 220.113 39C220.313 41.2 218.713 43.5 217.313 45.1C217.013 45.5 210.613 51.6 213.013 52.3C214.613 52.7 217.113 51.6 218.313 50.7C219.113 50.1 218.613 50.4 218.513 51.2C218.313 52.4 218.913 57.7 221.013 56.7C222.613 55.9 225.513 51.3 223.413 49.7C222.713 49.2 222.013 49.5 221.413 49.9C220.213 50.7 220.313 51.6 221.213 52.6C222.413 53.8 224.313 55.1 226.013 54C228.413 52.5 229.813 49.8 230.413 47.2C231.013 44.9 229.213 48 229.013 48.7C228.813 49.3 228.613 50.2 228.913 50.8C229.713 52.3 232.213 48.8 232.513 48.4C233.013 47.7 233.513 46.8 233.913 46.1C234.113 45.7 234.813 44.8 234.413 44.9C233.313 45.4 232.813 47.4 232.713 48.4C232.613 49.2 232.213 50.8 233.013 51.5C234.813 52.9 237.313 47.7 237.813 46.7C238.013 46.4 238.313 45.7 238.413 45.3C238.513 45 238.313 44.8 238.113 45.1C237.513 46 236.213 49.7 238.213 50C239.113 50.1 239.613 49.3 240.013 48.7C241.813 46.3 243.013 43.5 244.413 41C246.013 38.2 247.513 35.2 249.913 33",stroke:"#A6C2DD",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Cl.jsx)("path",{d:"M20 14.5H48C50.2 14.5 52 16.3 52 18.5C52 20.7 50.2 22.5 48 22.5H20C17.8 22.5 16 20.7 16 18.5C16 16.3 17.8 14.5 20 14.5Z",fill:"#A4CDF3",fillOpacity:"0.5"}),(0,Cl.jsx)("path",{d:"M59 14.5H68C70.2 14.5 72 16.3 72 18.5C72 20.7 70.2 22.5 68 22.5H59C56.8 22.5 55 20.7 55 18.5C55 16.3 56.8 14.5 59 14.5Z",fill:"#A4CDF3",fillOpacity:"0.5"}),(0,Cl.jsx)("path",{d:"M19 32.5H118C119.7 32.5 121 33.8 121 35.5C121 37.2 119.7 38.5 118 38.5H19C17.3 38.5 16 37.2 16 35.5C16 33.8 17.3 32.5 19 32.5Z",fill:"#A4CDF3",fillOpacity:"0.5"}),(0,Cl.jsx)("path",{d:"M227 16.5H247C248.7 16.5 250 17.8 250 19.5C250 21.2 248.7 22.5 247 22.5H227C225.3 22.5 224 21.2 224 19.5C224 17.8 225.3 16.5 227 16.5Z",fill:"#A4CDF3",fillOpacity:"0.5"}),(0,Cl.jsx)("path",{d:"M19 42.5H100C101.7 42.5 103 43.8 103 45.5C103 47.2 101.7 48.5 100 48.5H19C17.3 48.5 16 47.2 16 45.5C16 43.8 17.3 42.5 19 42.5Z",fill:"#A4CDF3",fillOpacity:"0.5"}),(0,Cl.jsxs)("defs",{children:[(0,Cl.jsxs)("linearGradient",{id:`${o}-paint0_linear_12221_26907`,x1:"38.3423",y1:"21.9516",x2:"46.3388",y2:"103.855",gradientUnits:"userSpaceOnUse",children:[(0,Cl.jsx)("stop",{stopColor:"#F2F9FF",stopOpacity:"0.5"}),(0,Cl.jsx)("stop",{offset:"0.629481",stopColor:"#D1E1F0",stopOpacity:"0.5"})]}),(0,Cl.jsxs)("linearGradient",{id:`${o}-paint1_linear_12221_26907`,x1:"43.314",y1:"64.3826",x2:"226.883",y2:"215.125",gradientUnits:"userSpaceOnUse",children:[(0,Cl.jsx)("stop",{stopColor:"#CDE3FA"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#9CBBDA"})]})]})]}),(0,Cl.jsxs)("div",{className:"p-abs inset-bottom-start d-flex items-center text-sans-serif ms-4 mb-4 z-index-1",dir:"ltr",children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular px-1 py-0-5 border-radius-2 me-3",{"text-white bg-blue-60":s}),style:s?Qv:void 0,children:n}),(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular px-1 py-0-5 border-radius-2",{"text-white bg-blue-60":a}),style:a?Qv:void 0,children:i})]})]})},{ScrollToFieldsProvider:eS,useAddFieldToScroll:tS,useScrollToFieldsTrigger:nS,useFakeStripeElement:iS}=(0,Ud.J)(),sS=e=>{let{transitionEntered:t,stripeElementState:n,setStripeElementState:i}=e;const{state:s,controller:a}=Tc(Vn.AU_BECS),o=(0,kr.useId)(),r=(0,Bl.P)(),l=(0,nc.t)(),c=(0,Zl.$)(),u=(0,Vv.j)(),h=(0,Wv.l)(qv.bG.SAFARI,18),m=(0,Il.M)(),p=zv({paymentMethod:Gn.AU_BECS}),[g,y]=(0,kr.useState)(),f=(0,kr.useRef)(null),v=$d(s.shakeKey,0!==s.shakeKey),S=(0,kr.useRef)(!1),E=nS(),A=iS({scrollIntoView:e=>{var t;return null===(t=f.current)||void 0===t?void 0:t.scrollIntoView(e)},focus:()=>{var e;return null===(e=null==g?void 0:g.getElement(Bv.AU_BANK_ACCOUNT))||void 0===e?void 0:e.focus()}});return tS(A,(e=>Boolean(e.error)||e.isEmpty)),(0,kr.useEffect)((()=>{(0,d.sH)(void 0,void 0,void 0,(function*(){if(c)return;if(!f.current)throw new Error("auBankAccountContainerRef is not provided");const{stripeElements:e}=yield a.initiateAuBECS(f.current,{onAuBankAccountElementReady:()=>{i((e=>Object.assign(Object.assign({},e),{isReady:!0})))}});y(e)}))}),[a,c,i]),(0,kr.useEffect)((()=>{if(!n.isReady||!g||!t)return;const e=g.getElement(Bv.AU_BANK_ACCOUNT);if(!e){if(c)return;throw new Error("auBankAccount element is not initialized")}const s=()=>{S.current?m.document.dispatchEvent(new Event("stripeElementEvent")):S.current=!0,i((e=>Object.assign(Object.assign({},e),{isFocused:!0})))},a=()=>{i((e=>Object.assign(Object.assign({},e),{isFocused:!1})))},o=e=>{i((t=>{var n,i;return Object.assign(Object.assign({},t),{error:null!==(i=null===(n=e.error)||void 0===n?void 0:n.message)&&void 0!==i?i:null})}))};return e.on("focus",s),e.on("blur",a),e.on("change",o),r||u||h||S.current||e.focus(),()=>{e.off("focus",s),e.off("blur",a),e.off("change",o)}}),[a,t,g,c,m,i,n.isReady,r,u,h]),(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${o}`,onSubmit:e=>{e.preventDefault(),E(),a.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${o}`,title:l.translate("auBECSScreen.title"),titleQa:"au-becs-title",a11yAutoFocus:r||u||h}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-5 pb-8":!r}),children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("fixed-container",{"grow-1 d-flex flex-column":!r}),children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center",r?"text-ellipsis":"text-line-clamp-4"),children:l.translate("auBECSScreen.description")}),(0,Cl.jsx)(Jv,{className:(0,Ml.A)("mx-auto",r?"mt-7":"mt-5"),firstNumber:"000-000",secondNumber:"000123456",firstNumberHighlighted:n.isFocused,secondNumberHighlighted:n.isFocused}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-rel",r?"mt-7":"mt-5",{shake:v,"pointer-events-none":s.locked}),children:[(0,Cl.jsx)("div",{ref:f,className:"StripeElement",onClick:p}),n.error&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:n.isFocused,children:n.error}),(0,Cl.jsx)("p",{role:"alert",className:"sr-only",children:n.error})]})]}),(0,Cl.jsx)("div",{className:r?"mt-5":"grow-1 min-h-0 p-rel mt-4",children:(0,Cl.jsx)("div",{className:(0,Ml.A)({"p-abs inset-0 scroll-box":!r}),children:(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-20-regular text-gray-80 text-ellipsis",{"px-3 py-2-5":!r,"pointer-events-none":s.locked}),as:"p",token:"auBECSScreen.legalInformation",params:{link:"https://stripe.com/au/legal/becs-dd-service-agreement"}})})})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",errorTitle:s.payErrorMessage,processingState:s.processingState,dataQa:"au-becs-continue-button",trackingElement:"nextButton",onClick:p,children:s.isPaymentScreen?th(l,s.formattedAmount,s.frequency):l.translate("auBECSScreen.button")})})]})};var aS;function oS(e){const[t,n]=(0,kr.useState)(!1);return(0,kr.useLayoutEffect)((()=>{const{current:t}=e;if(!t)return;const i=()=>{const e=t.offsetWidth<t.scrollWidth||t.offsetHeight<t.scrollHeight;n(e)},s=new ResizeObserver(i);return t&&(s.observe(t),i()),()=>s.disconnect()}),[e]),t}!function(e){e.TRILLIUM="AFHQHUFB",e.ANIMAL_HUMANE_SOCIETY="APZFWQVA",e.SOS_INTERNATIONAL="ASYXEBAM",e.MUSLIMI="APRVBZRU",e.DAILY_GIVING="AYEWEYZD",e.UNFPA="ACSRWCJP",e.UNICEF_NORGE="AMUBFBCE",e.ASCRS_FOUNDATION="ACYFHBCY",e.CLINTON_FOUNDATION="ACUVFNNB",e.BLINKNOW="AEDSCDSM",e.HICT_PARENT="AJDZGJPP",e.HICT="AKVNXBFW",e.GREATER_GOOD_CHARITIES="AHTMBNKF",e.STC="VMZETRCF",e.UNICEF="APQJSHGS",e.PIH="AJDEFYWC",e.AHA_PARENT="ARMPCVPV",e.AHA="ADQRERLU",e.BEST_FRIENDS="AFZUYXBL",e.NEVERTHIRSTWATER="RWHMSQPD",e.CORG="AZCENQQL",e.AUS="AGZKYDGZ",e.NDSTREET="ALTVXKWG",e.ALZ="AJGEZYBE",e.LUST="AEDVPKAW",e.ARTHRITIS="AUSMBFYM",e.FREEDOM_BAKERIES="AFKPNPQY",e.MASJID_AL_FURGAN="ASYLMXZK",e.FCA="AFLRJKTK",e.MISSION_AVIATION_FELLOWSHIP="ABLRVZQV",e.FOOD_FOR_THE_POOR="AGPURJCY",e.MPAC="ANSRXGKF",e.RFT="ACMRCWPB",e.CHILDMIND="ZSNREIBR",e.FUNDRAISE_UP_NYC="APWCYEMD",e.SALVATION_ARMY_UK="ASNVRJLX",e.MERCY_SHIPS_AU="AWKKWSUU",e.LONELY_ORPHANS="AUKZQSFX",e.ALZHEIMER_ASSOCIATION="AJGEZYBE",e.PANCREATIC_CANCER_UK="ATBTMWDS",e.THE_BAIL_PROJECT="AYHQYPSQ",e.OBAMA_FOUNDATION="AHNVSXNQ",e.SAFE_HORIZON="AWBJEPNJ",e.FEED_THE_CHILDREN="AHQLCMJQ",e.STAGING_FORWARD_BLUE="ANGUPPGC",e.STAGING_HELPING_HAND="HRMEIGNS",e.STAGING_HELPING_HAND_UK="AWKXSTZX",e.HELPING_HAND="MCJZDSLZ",e.INTERNATIONAL_JUSTICE_MISSION_UK="AGMQWWLR",e.GUIDE_DOGS="APLFUNKH",e.ROPSI="AJZSDMZE",e.ROPSI_AU="AESYHEDW",e.ROPSI_UK="ASHPENZB",e.ROPSI_CA="AZRBXHWY",e.FAMILY_ELDERCARE="ARRCDXDL",e.ENTERTAINMENT_INDUSTRY="ASXBZCVR",e.ONE_FOR_ISRAEL="ASBGJCET",e.TREVOR="ABGHKWJN",e.PARKINSON="AWQWPUEN",e.NAVY="ALAWCVJC",e.HONEST_REPORTING="ARBELMET",e.KCET="AEJGNVQN",e.OPSMILE="ATVPVDAJ",e.WIKIMEDIA_FOUNDATION="AVLMPSRU",e.ARBOR="ALPEXDKM",e.CANADIAN_RED_CROSS="ATVNLEWE",e.CANADIAN_CANCER_SOCIETY="APZMZAGU",e.WORLDWISH="AZFMPNQE",e.LUPUS="ARVHGABZ",e.CONCERN_WORLDWIDE="AGSTXLKM",e.DURHAM_RESCUE_MISSION="ALCUDRVC",e.MUSCULAR_DYSTROPHY_ASSOCIATION="AJGERPHC",e.TRILLIUM_HEALTH_FOUNDATION="AFHQHUFB",e.CANADIAN_WILDLIFE_FEDERATION="ASBNVYMX",e.HARVEST_MANITOBA="AVALTECL",e.MUSLIM_LEGAL_FUND="AAMRKAJS",e.WISHORG="AKVYFUBL",e.FORWARD_BLUE="AETRGCDZ",e.BRIGHTFOCUS="ASPUXQFL",e.BRIGHTFOCUS_ALZ="ABLMUZMD",e.IFAW_DE="AHEESHPV",e.MATE_HOSPITAL_FOUNDATION="AMSFLMWE",e.EVERYTOWN_FOR_GUN_SAFETY="AMNBTWFT",e.OXFAM="AHPFYYUL",e.LIGONER="ARNXLWYU",e.END_CITIZEN_UNITED="AJAQPESZ",e.PROGRESSIVE_TURNOUT_PROJECT="ASYNMFUG"}(aS||(aS={}));const rS=e=>{var t,n;const i=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:(0,Ml.A)(e.className),"aria-hidden":!!e.ariaHidden||void 0,"data-testid":e.dataTestId,fill:"none",viewBox:"0 0 64 64",height:null!==(t=e.height)&&void 0!==t?t:64,width:null!==(n=e.width)&&void 0!==n?n:64,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"24.0263",width:"26",x:"14",y:"23.5",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1.5"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.753923 0 0 0 0 0.0394018 0 0 0 0 0.468114 0 0 0 0.16 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_5614_10321"})]}),(0,Cl.jsxs)("filter",{id:`b-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"15.5483",width:"14.1826",x:"14.085",y:"22.9985",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_5614_10321",stdDeviation:"2"})]}),(0,Cl.jsxs)("filter",{id:`c-${i}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"15.5483",width:"14.1826",x:"25.5386",y:"22.9985",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feGaussianBlur",{result:"effect1_foregroundBlur_5614_10321",stdDeviation:"2"})]}),(0,Cl.jsxs)("linearGradient",{id:`d-${i}`,gradientUnits:"userSpaceOnUse",x1:"39.4602",x2:"43.2501",y1:"9.34783",y2:"49.635",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#d4e8ff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#aed0f9"})]}),(0,Cl.jsxs)("linearGradient",{id:`e-${i}`,gradientUnits:"userSpaceOnUse",x1:"14.1589",x2:"26.5091",y1:"19.2105",y2:"52.5764",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ef505a"}),(0,Cl.jsx)("stop",{offset:".766418",stopColor:"#e61446"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#d60443"})]}),(0,Cl.jsxs)("linearGradient",{id:`f-${i}`,gradientUnits:"userSpaceOnUse",x1:"20.9333",x2:"28.7525",y1:"27.4211",y2:"45.932",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff1f3"}),(0,Cl.jsx)("stop",{offset:".71",stopColor:"#ffe0e7"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fed4e1"})]}),(0,Cl.jsxs)("radialGradient",{id:`g-${i}`,cx:"0",cy:"0",gradientTransform:"matrix(0 15.1591 -13.8222 0 27 28.1364)",gradientUnits:"userSpaceOnUse",r:"1",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff",stopOpacity:".7"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsxs)("linearGradient",{id:`h-${i}`,gradientUnits:"userSpaceOnUse",x1:"2.65798",x2:"2.65798",y1:"0",y2:"8.18031",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#fff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),(0,Cl.jsx)("path",{d:"m28 9c-8.8366 0-16 7.1634-16 16v8c0 8.8366 7.1634 16 16 16h18c3.4031 0 6.5581-1.0625 9.1514-2.8738 3.0372.8662 5.5406.5697 7.9294-.4701.7855-.3419.6816-1.4562-.0809-1.8466-1.5753-.8065-2.6265-1.7568-3.2995-2.5406 1.4596-2.4131 2.2996-5.2429 2.2996-8.2689v-8c0-8.8366-7.1634-16-16-16z",fill:`url(#d-${i})`}),(0,Cl.jsx)("path",{d:"m18.0005 15c-8.83654 0-15.99998 7.1634-15.99998 16v8c0 3.0319.84333 5.8669 2.30821 8.2831-.67348.7811-1.72144 1.7247-3.28728 2.5264-.76252.3904-.86638 1.5047-.080911 1.8466 2.384981 1.0381 4.884101 1.3353 7.914641.4743 2.59212 1.8088 5.74482 2.8696 9.14532 2.8696h18c8.8366 0 16-7.1634 16-16v-8c0-8.8366-7.1634-16-16-16z",fill:`url(#e-${i})`}),(0,Cl.jsxs)("g",{filter:`url(#a-${i})`,children:[(0,Cl.jsx)("path",{d:"m25.5002 47.1028c.9081.5647 2.0915.5647 2.9996 0 21.9195-13.6308 7.3499-28.6137-1.4998-19.1112-8.8497-9.5026-23.4193 5.4802-1.4998 19.1112z",fill:`url(#f-${i})`}),(0,Cl.jsx)("path",{d:"m25.5002 47.1028c.9081.5647 2.0915.5647 2.9996 0 21.9195-13.6308 7.3499-28.6137-1.4998-19.1112-8.8497-9.5026-23.4193 5.4802-1.4998 19.1112z",fill:`url(#g-${i})`,fillOpacity:".4"})]}),(0,Cl.jsx)("g",{filter:`url(#b-${i})`,children:(0,Cl.jsx)("ellipse",{cx:"2.65798",cy:"4.09016",fill:`url(#h-${i})`,rx:"2.65798",ry:"4.09016",transform:"matrix(.754153 -.656699 .575342 .817913 16.8184 29.1728)"})}),(0,Cl.jsx)("g",{filter:`url(#c-${i})`,children:(0,Cl.jsx)("ellipse",{cx:"2.65798",cy:"4.09016",fill:`url(#h-${i})`,rx:"2.65798",ry:"4.09016",transform:"matrix(-.754153 -.656699 -.575342 .817913 36.9878 29.1728)"})})]})},lS=(0,kr.memo)(rS);var cS;function uS(){return uS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uS.apply(null,arguments)}var dS,hS=function(e,t){return kr.createElement("svg",uS({fill:"none",height:28,viewBox:"0 0 28 28",width:28,xmlns:"http://www.w3.org/2000/svg",ref:t},e),cS||(cS=kr.createElement("g",{fill:"currentColor"},kr.createElement("path",{clipRule:"evenodd",d:"m15.0393 2.44995c-.6707-.24772-1.4079-.24772-2.0786 0l-8.30715 3.06797c-.39274.14504-.65355.51939-.65355.93807v7.54411c0 3.6861 1.95965 6.6874 4.28911 8.8073 1.16017 1.0557 2.38789 1.8689 3.45309 2.4137 1.1081.5668 1.9145.779 2.2578.779s1.1497-.2122 2.2578-.779c1.0652-.5448 2.2929-1.358 3.4531-2.4137 2.3294-2.1199 4.2891-5.1212 4.2891-8.8073v-7.54411c0-.41868-.2608-.79303-.6536-.93807zm-2.7715-1.876139c1.1179-.412868 2.3465-.412868 3.4644 0l8.3071 3.067969c1.1783.43514 1.9607 1.55819 1.9607 2.81421v7.54411c0 4.4389-2.3618 7.9375-4.943 10.2865-1.2952 1.1786-2.6702 2.092-3.8885 2.7151-1.1754.6012-2.3332.9984-3.1685.9984s-1.9931-.3972-3.1685-.9984c-1.21831-.6231-2.59328-1.5365-3.88847-2.7151-2.58125-2.349-4.94303-5.8476-4.94303-10.2865v-7.54411c0-1.25602.78243-2.37907 1.96066-2.81421z",fillRule:"evenodd"}),kr.createElement("path",{d:"m18.2906 11.75h-.2535v-1.1855c0-2.19278-1.7415-4.02451-3.9182-4.06361-.0595-.00107-.1783-.00107-.2378 0-2.1767.0391-3.91819 1.87083-3.91819 4.06361v1.1855h-.25354c-.39069 0-.70937.4028-.70937.9003v5.9463c0 .4969.31868.9035.7094.9035h8.5812c.3907 0 .7094-.4066.7094-.9035v-5.9463c0-.4974-.3187-.9003-.7094-.9003zm-3.4867 3.8674v1.7967c0 .2058-.1723.3799-.3784.3799h-.8509c-.2061 0-.3785-.1741-.3785-.3799v-1.7967c-.1999-.1966-.3162-.4684-.3162-.7691 0-.5698.4408-1.0594 1.0013-1.082.0594-.0024.1783-.0024.2377 0 .5605.0226 1.0013.5122 1.0013 1.082 0 .3007-.1164.5725-.3163.7691zm1.5623-3.8674h-4.7323v-1.1855c0-1.30621 1.0623-2.38623 2.3661-2.38623s2.3662 1.08002 2.3662 2.38623z"}))))},mS=(0,kr.forwardRef)(hS),pS=(0,kr.memo)(mS);function gS(){return gS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},gS.apply(null,arguments)}var yS=function(e,t){return kr.createElement("svg",gS({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),dS||(dS=kr.createElement("path",{d:"m12 5v14m-7-7h14",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},fS=(0,kr.forwardRef)(yS),vS=(0,kr.memo)(fS);const SS={minWidth:"80px"},ES=e=>{let{amount:t,donation:n,rate:i,className:s}=e;const a=(0,nc.t)(),{controller:o}=Tc(Vn.DONATE);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex items-center justify-between gap-x-4",s),children:[(0,Cl.jsx)(fc,{as:"p",className:"donor-rating-label body-40-regular text-ellipsis",dataQa:"donor-rating-upsell-tooltip-label",token:"donorRatingBanner.upsell.label",params:{amount:a.formatCurrency(t,{currency:n.currency,display:"short"}),rate:i}}),(0,Cl.jsxs)("button",{type:"button",className:"btn btn-xs btn-primary shrink-0 d-flex items-center justify-center w-auto max-w-50",style:SS,"data-qa":"donor-rating-upsell-tooltip-button",onClick:()=>o.applyDonorRatingUpsell(),children:[(0,Cl.jsx)(vS,{className:"icon-stroke icon-stroke-2 shrink-0 me-0-5 font-size-16"}),(0,Cl.jsx)("span",{className:"text-truncate",children:a.formatCurrency(t,{currency:n.currency,display:"short"})})]})]})},AS=(0,kr.memo)(ES),CS=()=>{const{state:e}=Tc(Vn.DONATE),t=Uc().get(u.DONOR_RATING_CHECKOUT_EXPERIMENT),n=li.THRESHOLD_NAME_MAP[e.donorRating.upsell.position];return{isDonorRatingExperimentTestGroup2Enabled:t.isTestGroup2,donorRatingUpsellRate:n}},{useAddFieldToScroll:bS,useScrollToFieldsTrigger:PS,ScrollToFieldsProvider:NS}=(0,Ud.J)(),DS=e=>{let{hint:t,donation:n,currency:i,disabled:s,errors:a,onSelect:o,donorRatingUpsell:r,isMaxOptionsEnabled:l}=e;const c=(0,nc.t)(),u=(0,Bl.P)(),d=(0,gc.Q)(),h=Kl(),m=(0,ql.wf)(),p=(0,kr.useMemo)((()=>t.default),[t.default]),g=(0,kr.useRef)(null),y=a.amount.min&&p,{isDonorRatingExperimentTestGroup2Enabled:f,donorRatingUpsellRate:v}=CS(),S=r.position!==Xn.NONE,E=f&&S&&!u&&!s&&p,A=()=>c.formatAmount({amount:t.amount,currency:i,currencyFormat:Yt.SHORT,numberFormat:Kt.COMPACT,forceExplicit:!0}),C=()=>c.formatAmount({amount:n.minAmount,currency:i,currencyFormat:Yt.SHORT,numberFormat:Kt.ROUNDED,forceExplicit:!0});return bS(g,(()=>y)),(0,Sd.f)({ref:g,mode:vd.Q.ALL,autoFocus:p,preventScroll:!0}),(0,Cl.jsx)(Zc.S,{content:(0,Cl.jsx)(AS,{amount:r.amount,donation:n,rate:v}),trigger:"manual",manualOpen:E,placement:d?"left":"right",maxWidth:"300px",rootContainer:m,children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("amount-hint p-rel bg-transparent-hover-gray-10 border-top border-gray-20",{"amount-hint-checked border-transparent z-index-2":p}),children:[(0,Cl.jsx)("input",{type:"radio",id:`${t.id}-hint`,className:(0,Ml.A)("amount-hint-radio p-abs inset-0",p?"z-index-2 cursor-default":"z-index-3 cursor-pointer",{"has-error":y}),value:t.id,title:`${A()}, ${t.description}`,name:"hintOptions",checked:p,disabled:s,"aria-invalid":y,"aria-describedby":`${t.id}-hint-error`,"data-qa":"suggested-amount-hint-button",onChange:()=>o(t),ref:g}),(0,Cl.jsxs)("label",{htmlFor:`${t.id}-hint`,className:(0,Ml.A)("body-40-regular d-block p-rel text-gray-100 text-noselect",h("amount-hint-label"),l&&h("amount-hint-label-sm")),"data-qa":"suggested-amount-hint-label",children:[(0,Cl.jsxs)("span",{className:(0,Ml.A)("d-flex p-rel z-index-2",l?"body-50-medium":"body-60-medium"),children:[(0,Cl.jsx)("span",{className:"text-truncate me-2",children:A()}),(0,Cl.jsx)("span",{className:"icon-slot icon-slot-18 shrink-0 ms-auto","aria-hidden":!0,children:y&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered","data-testid":"min-amount-tooltip-trigger",dataQa:"suggested-amount-hint",showTooltip:y&&!!g.current,children:(0,Cl.jsx)(fc,{as:"p",token:"donateForm.donationAmountField.error.min",params:{amount:C()}})})})]}),(0,Cl.jsx)("span",{className:"p-rel text-truncate z-index-2",children:t.description})]}),y&&(0,Cl.jsx)(fc,{as:"p",id:`${t.id}-hint-error`,className:"sr-only",token:"donateForm.donationAmountField.error.min",params:{amount:C()}})]})})},TS=(0,kr.memo)(DS),kS=e=>{let{disabled:t,onShowCustomAmount:n}=e;const i=(0,nc.t)(),s=(0,Bl.P)(),a=Kl();return(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(a("custom-amount-btn"),"btn-reset p-rel w-100 text-start text-truncate bg-white-hover-gray-10 border-top border-gray-20 border-bottom-radius-8",s?"body-60-regular":"body-40-regular",{"pointer-events-none":t}),disabled:t,onClick:()=>n(),"data-qa":"suggested-amount-custom-button",children:i.translate("donateForm.amountHint.customAmount")})},IS=(0,kr.memo)(kS),_S=e=>{let{currency:t,disabled:n,onChange:i,list:s}=e;const a=(0,nc.t)(),o=(0,kr.useId)(),r=xc();return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("label",{className:"sr-only",htmlFor:`currency-${o}`,"data-qa":"currency-selector-label",children:[a.translate("donateForm.donationCurrency")," ",t]}),(0,Cl.jsx)("select",{id:`currency-${o}`,className:"currency-select p-abs inset-0 max-w-100 text-noselect p-0 border-0 m-0 overflow-hidden cursor-pointer z-index-1",value:t,onChange:e=>{i(e.target.value)},"data-qa":"currency-selector","data-tracking-element-name":"changeCurrency",disabled:n,children:s.map(((e,t)=>(0,Cl.jsx)("optgroup",{children:e.map(((e,t)=>(0,Cl.jsxs)("option",{value:e,children:[e,"  ",r.getName(e)]},t)))},t)))})]})},OS=(0,kr.memo)(_S),xS=e=>{let{donation:t,disabled:n,autofocusMode:i,flowType:s,className:a,style:o,isCustomAmount:r,placeholder:l,guessedCurrenciesList:c,allCurrenciesList:u,showError:d,errors:h,donorRatingUpsell:m}=e;const{controller:p,state:g}=Tc(Vn.DONATE),y=(0,Zl.$)(),f=(0,gc.Q)(),v=(0,Bl.P)(),S=Vc("lg"),E=(0,nc.t)(),A=xc(),C=Rc(),b=(0,Nl.n)().getAskPageConfig().show,P=(0,ql.wf)(),N=(0,kr.useRef)(null),D=(0,kr.useRef)(null);(0,Sd.f)({ref:D,autoFocus:t.canModifyAmount,mode:i}),bS(D,(e=>e.amount.required||e.amount.min||e.amount.max));const T=(e=>{const t=(0,Nl.n)();return(0,kr.useMemo)((()=>{var n,i,s,a;return t.company.allowCentsForCharges?e>0:void 0!==(null===(i=null===(n=t.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.amount)&&!Number.isInteger(null===(a=null===(s=t.external.state)||void 0===s?void 0:s.donation)||void 0===a?void 0:a.amount)}),[t,e])})(A.getDigits(t.currency)),[k,I]=(0,kr.useState)(!1),[_,O]=(0,kr.useState)(!1),[x,w]=(0,kr.useState)(!1),[R,M]=(0,kr.useState)(!1),{isDonorRatingExperimentTestGroup2Enabled:L,donorRatingUpsellRate:F}=CS(),U=p.isAverageDonationAmountVariantTestGroup(W.TEST_1),j=g.donation.averageDonationAmount,B=U&&Boolean(j),G=(0,kr.useCallback)((()=>R?E.translate("donateForm.donationAmountField.error.required"):_?E.translate("donateForm.donationAmountField.error.min",{amount:E.formatCurrency(t.minAmount,{currency:t.currency,display:"round"})}):x?E.translate("donateForm.donationAmountField.error.max",{amount:E.formatCurrency(t.maxAmount,{currency:t.currency,display:"floatcents"})}):""),[E,x,_,R,t.currency,t.maxAmount,t.minAmount]),q=(0,kr.useCallback)((e=>{p.changeAmount(e),p.tryToCalculateDonorRating({debounce:!0})}),[p]),V=(0,kr.useCallback)((e=>{p.changeCurrency(e),p.validateAmount(),C.trackCheckoutCustomEvent({type:Ee.DONATION_CURRENCY_SELECTED,data:{currency:e}})}),[p,C]),H=(0,kr.useMemo)((()=>[c,u]),[c,u]),K=(0,kr.useMemo)((()=>(0,Cl.jsx)(OS,{currency:t.currency,disabled:n,onChange:V,list:H})),[H,V,t.currency,n]),Y=(0,kr.useCallback)((()=>{p.validateAmount(h.amount.required),O(!y&&h.amount.min),w(!y&&h.amount.max),M(!y&&h.amount.required)}),[p,y,h.amount.min,h.amount.max,h.amount.required]);(0,kr.useEffect)((()=>{N.current&&(O(!y&&h.amount.min),w(!y&&h.amount.max),M(!y&&h.amount.required),I(B))}),[h.amount.max,h.amount.min,h.amount.required,y,N,B]);let z={content:"",trigger:"manual",placement:f?"left":"right",maxWidth:"300px",rootContainer:P};if(U&&(z=Object.assign(Object.assign({},z),{content:(0,Cl.jsx)(fc,{as:"p",token:"donateForm.donationAmountField.average.hint",params:{amount:E.formatCurrency(null!=j?j:0,{currency:t.currency,display:"round"})}}),manualOpen:k&&b&&S&&!v&&!n&&!g.forceHideAverageDonationHintTooltip,dataQa:"average-donation-amount-tooltip"})),L){const e=m.position!==Xn.NONE;z=Object.assign(Object.assign({},z),{content:(0,Cl.jsx)(AS,{amount:m.amount,donation:t,rate:F}),manualOpen:e&&!v&&!n&&!!D.current})}return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("div",{ref:N,className:a,style:o,children:(0,Cl.jsx)(Zc.S,Object.assign({},z,{children:(0,Cl.jsx)("div",{children:(0,Cl.jsx)(Yp,{ref:D,className:(0,Ml.A)("group-price-control",{"group-price-control-custom-amount":r}),currency:t.currency,amount:t.amount,canModifyAmount:t.canModifyAmount,withoutFraction:!T,canSelectCurrency:t.canModifyAmount&&t.canSelectCurrency,currencyCodeNode:t.canModifyAmount&&t.canSelectCurrency&&K,currencyService:A,hasError:d,errorLabel:G(),"aria-required":!0,trackingElement:"amountInput",onAmountChange:q,onAmountInputBlur:Y,donationType:s,isCustomAmount:r,placeholder:l,disabled:n,dataQa:"amount"})})}))}),B&&(v||!S||!b)&&(0,Cl.jsx)("div",{className:"bg-blue-10 border-radius-10 px-4 py-3 mt-3",children:(0,Cl.jsx)(fc,{as:"p",className:"body-40-regular text-truncate",token:"donateForm.donationAmountField.average.hint",dataQa:"average-donation-amount-tooltip",params:{amount:E.formatCurrency(null!=j?j:0,{currency:t.currency,display:"round"})}})})]})},wS=(0,kr.memo)(xS),RS={marginLeft:"-1px",marginRight:"-1px",marginBottom:"-1px"},MS=e=>{let{donation:t,className:n,shake:i,disabled:s,showFrequencyCustomAmountInput:a,isMaxOptionsEnabled:o,errors:r,donorRatingUpsell:l,tribute:c,guessedCurrenciesList:u,allCurrenciesList:d,showError:h,flowType:m,animationEnded:p,autofocusMode:g}=e;const{controller:y}=Tc(Vn.DONATE),f=(0,nc.t)(),v=(0,kr.useCallback)((e=>{y.changeCurrentHint(e),y.tryToCalculateDonorRating()}),[y]),S=(0,kr.useMemo)((()=>t.hintOptions),[t.hintOptions]),E=(0,kr.useCallback)((()=>{y.changeAmount(null),y.tryToCalculateDonorRating()}),[y]);return(0,Cl.jsxs)("fieldset",{className:(0,Ml.A)("border border-gray-20 border-radius-base",n,{shake:i}),children:[(0,Cl.jsx)("legend",{className:"sr-only",children:f.translate("donateForm.suggestionAriaLabel")}),S&&S.map(((e,n)=>(0,Cl.jsx)(TS,{hint:e,donation:t,currency:t.currency,disabled:s,errors:r,onSelect:v,isMaxOptionsEnabled:o,donorRatingUpsell:l},n))),a?(0,Cl.jsx)(wS,{donation:t,errors:r,tribute:c,guessedCurrenciesList:u,allCurrenciesList:d,showError:h,flowType:m,isCustomAmount:!0,style:RS,disabled:s,animationEnded:p,autofocusMode:g,donorRatingUpsell:l}):(0,Cl.jsx)(IS,{disabled:s,onShowCustomAmount:E})]})},LS=(0,kr.memo)(MS),FS=e=>{let{donation:t,shake:n,animationEnded:i,autofocusMode:s,disabled:a,errors:o,tribute:r,guessedCurrenciesList:l,allCurrenciesList:c,showError:u,flowType:d,donorRatingUpsell:h}=e;var m;const{controller:p,state:g}=Tc(Vn.DONATE),y=(0,nc.t)(),f=Kl(),v=g.donation.averageDonationAmount===g.donation.amount,[S,E]=(0,kr.useState)({[g.donation.frequency]:v}),A=null!==(m=S[g.donation.frequency])&&void 0!==m&&m,C=p.isAverageDonationAmountVariantTestGroup(W.TEST_2),b=p.isAverageDonationAmountVariantTestGroup(W.TEST_3),P=()=>{E((e=>Object.assign(Object.assign({},e),{[g.donation.frequency]:!0})))};return(0,Cl.jsxs)(Cl.Fragment,{children:[t.showAmountSuggestions&&(0,Cl.jsxs)("fieldset",{className:(0,Ml.A)("amount-options d-flex flex-wrap",C||b?" gap-y-3":"gap-y-2-5",{shake:n}),children:[(0,Cl.jsx)("legend",{className:"sr-only",children:y.translate("donateForm.suggestionAriaLabel")}),t.amountOptions.map(((e,n)=>{const i=e===g.donation.averageDonationAmount,s=e===t.amount,o=i&&!s&&!A;return(0,Cl.jsxs)("div",{className:"amount-option shrink-0 p-rel","data-qa":"suggested-amount-button",children:[(0,Cl.jsx)("input",{type:"radio",id:`${e}-option`,className:(0,Ml.A)("amount-option-radio p-abs",s?"pointer-events-none":"cursor-pointer",{"z-index-2":b&&i}),title:y.formatCurrency(e,{currency:t.currency,display:"shortlabel"}),name:"amountOptions",value:e,checked:s,disabled:a,"aria-label":y.translate("donateForm.suggestionAmountAriaLabel",{amount:y.formatCurrency(e,{currency:t.currency,display:"shortlabel"})}),onChange:e=>(e=>{p.changeAmount(e),p.tryToCalculateDonorRating(),p.validateAmount(),E((e=>Object.assign(Object.assign({},e),{[g.donation.frequency]:!0})))})(Number.parseInt(e.target.value)),"data-tracking-element-name":"suggestionButton","data-qa":"suggested-amount-radio"}),(0,Cl.jsx)("label",{htmlFor:`${e}-option`,className:(0,Ml.A)("body-60-regular d-flex items-center justify-center text-gray-100 text-sans-serif text-noselect text-center bg-white px-0-5 border-radius-8",f("amount-option-label"),{"amount-option-popular-gradient":b&&o}),"aria-hidden":!0,"data-qa":"suggested-amount-label",children:(0,Cl.jsx)("span",{className:(0,Ml.A)("text-truncate",{"p-rel z-index-1":b&&i}),children:y.formatCurrency(e,{currency:t.currency,display:"shortlabel"})})}),(C||b)&&i&&(0,Cl.jsxs)("div",{className:"p-abs inset-top-centered max-w-100 mt-minus-2 overflow-hidden",children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("font-size-10 line-height-17 font-weight-700 text-uppercase border-radius-10 px-2",s?"bg-blue-60 text-white":"bg-white text-blue-60",{invisible:b&&o}),"data-qa":"suggested-amount-popular-label",children:y.translate("donateForm.donationAmountField.average.popular")}),b&&o&&(0,Cl.jsx)("div",{className:(0,Ml.A)("amount-option-popular-badge p-abs inset-top-start d-flex border-radius-10 overflow-hidden",s?"bg-blue-60 text-white":"bg-white text-blue-60"),onAnimationEnd:P,children:(0,Cl.jsx)("p",{className:"font-size-10 line-height-17 font-weight-700 text-uppercase px-2","data-qa":"suggested-amount-popular-animated-label",children:y.translate("donateForm.donationAmountField.average.popular")})})]})]},n)}))]}),(0,Cl.jsx)(wS,{donation:t,errors:o,tribute:r,guessedCurrenciesList:l,allCurrenciesList:c,showError:u,flowType:d,disabled:a,className:(0,Ml.A)({"mt-2-5":t.showAmountSuggestions&&!C&&!b,"mt-3":t.showAmountSuggestions&&(C||b),shake:n}),animationEnded:i,autofocusMode:s,donorRatingUpsell:h})]})},US=(0,kr.memo)(FS),jS=e=>{let{isActive:t,disabled:n,toggleAnnualDonation:i}=e;const s=(0,nc.t)();return(0,Cl.jsx)(Fd,{className:"body-40-regular",customLabelClasses:"line-height-20",checked:t,disabled:n,dataQa:"annual-donation-checkbox",dataTestId:"annual-donation-checkbox",trackingElement:"repeatAnnualCheckbox",onChange:i,children:(0,Cl.jsx)("span",{className:"body-40-regular text-truncate","data-qa":"annual-donation-label",children:s.translate("donateForm.annualDonation.label")})})},BS=(0,kr.memo)(jS);var GS=n(8814),qS=n(1633);const VS=e=>{let{trigger:t,children:n,className:i,contentClassName:s,hasCloseButton:a=!0,hasAnimation:o=!0,hasPortal:r=!0,rootContainer:l,disabled:c,dataQa:u,defaultOpen:d=!1,onOpenChange:h}=e;const m=(0,nc.t)(),p=(0,Bl.P)(),g=Vc("lg"),y=(0,Il.M)(),f=zl(y),v=(0,Nl.n)(),S=v.infrastructureParams.livemode,E=v.getAskPageConfig().show,[A,C]=(0,kr.useState)(null!=d&&d),b=(0,kr.useCallback)((e=>{C(e),null==h||h(e)}),[h]),P=(0,kr.useCallback)((()=>{b(!1)}),[b]),N=(0,kr.useCallback)((()=>{b(!0)}),[b]),{refs:D,context:T}=(0,GS.we)({open:A,onOpenChange:b}),k=(0,GS.It)(T,{role:"dialog"}),I=(0,GS.kp)(T),_=(0,GS.s9)(T,{enabled:!1,escapeKey:!1}),{getReferenceProps:O,getFloatingProps:x}=(0,GS.bv)([k,I,_]),{isMounted:w,styles:R}=(0,GS.DL)(T,{duration:o?{open:Number(150),close:Number(100)}:{open:0,close:0},initial:{opacity:0,translate:"0 30px 0"},open:{opacity:1,translate:"0 0 0"}}),M=(0,kr.cloneElement)(t,Object.assign({ref:D.setReference},O({onClick:e=>{var n,i;null===(i=(n=t.props).onClick)||void 0===i||i.call(n,e)}}))),L=(0,qS.uh)({onSwipedDown:()=>{c||b(!1)},touchEventOptions:{passive:!1},preventScrollOnSwipe:!0,trackMouse:!0});(0,kr.useEffect)((()=>{if(!A)return;const e=e=>{"Escape"===e.key&&(e.stopImmediatePropagation(),c||b(!1))};return f((t=>t.document.addEventListener("keyup",e,!0))),()=>{f((t=>{var n;return null===(n=t.document)||void 0===n?void 0:n.removeEventListener("keyup",e,!0)}))}}),[A,f,T,c,b]);const F=(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(GS.zR,{className:(0,Ml.A)("bottom-sheet-overlay",{"border-radius-16":!p&&g||!E&&!p,"border-bottom-radius-16":!p&&!g&&E})}),(0,Cl.jsx)(GS.s3,{context:T,children:(0,Cl.jsx)("div",Object.assign({},L,{children:(0,Cl.jsx)("div",Object.assign({ref:D.setFloating,className:(0,Ml.A)("bottom-sheet inset-bottom-start w-100",p?"p-fixed":"p-abs",i,{"pb-10":!S&&p}),"data-qa":u},x(),{children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("bg-white",p?"border-top-radius-16":"border-radius-16",s),style:R,children:["function"==typeof n?n({closeSheet:P,openSheet:N}):n,a&&(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-top-end font-size-24 text-gray-100 me-4 mt-4-5","aria-label":m.translate("common.closeDialogButtonAriaLabel"),disabled:c,"data-qa":u?`${u}-close-button`:"bottom-sheet-close-button",onClick:P,children:(0,Cl.jsx)(su.A,{className:"icon-stroke d-block","aria-hidden":!0})})]})}))}))})]});return(0,Cl.jsxs)(Cl.Fragment,{children:[M,w&&(r?(0,Cl.jsx)(GS.XF,{root:l,children:F}):F)]})},HS=500,KS={minHeight:"60px"},YS={minHeight:"180px"},zS=e=>{let{trigger:t,rootContainer:n,disabled:i,comment:s,onCommentChange:a,defaultOpen:o=!1,onOpened:r,defaultOpenDelay:l=HS}=e;const c=(0,nc.t)(),u=(0,kr.useId)(),[d,h]=(0,kr.useState)(s),m=(0,kr.useRef)(null);(0,kr.useEffect)((()=>{h(s)}),[s]),(0,kr.useEffect)((()=>{if(o&&m.current){const e=setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.call(m)}),l);return()=>{clearTimeout(e)}}}),[o,l]);const p=(0,kr.useCallback)((()=>{h("")}),[]),g=(0,kr.useCallback)((e=>{h(e.target.value)}),[]),y=(0,kr.useCallback)(((e,t)=>{e.preventDefault(),e.stopPropagation(),a(d),t()}),[a,d]),f=(0,kr.useCallback)((e=>{e&&r&&r(),e||h(s)}),[s,r]);return(0,Cl.jsx)(VS,{trigger:t,rootContainer:n,className:"max-h-95 d-flex flex-column",contentClassName:"grow-1 min-h-0 d-flex flex-column",disabled:i,defaultOpen:!1,onOpenChange:f,children:e=>{let{closeSheet:t,openSheet:n}=e;return m.current=n,(0,Cl.jsxs)("form",{className:"grow-1 d-flex flex-column min-h-0",onSubmit:e=>y(e,t),children:[(0,Cl.jsx)("div",{className:"fixed-container d-flex items-center justify-center px-10 py-1 shrink-0",style:KS,children:(0,Cl.jsx)("h3",{className:"body-60-medium text-center text-ellipsis",children:c.translate("donateForm.comment.label")})}),(0,Cl.jsx)("hr",{className:"shrink-0"}),(0,Cl.jsx)("div",{className:"px-body grow-1 min-h-0 pt-6 pb-7 overflow-y-auto custom-scrollbar",children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsxs)("div",{className:"form-group",children:[(0,Cl.jsx)("textarea",{id:`comment-${u}`,className:"form-control has-label-floating pe-9",style:YS,value:d,onChange:g,maxLength:fd.MAX_LENGTH,disabled:i,"data-qa":"comment",autoFocus:!0}),(0,Cl.jsx)("label",{htmlFor:`comment-${u}`,className:(0,Ml.A)("form-label form-label-top is-floating",{"has-value":d}),"data-qa":"comment-label",children:c.translate("donateForm.comment.bottomSheet.textarea.label")}),d&&(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-top-end font-size-18 text-gray-40 me-4 mt-4","aria-label":c.translate("common.clearButtonAriaLabel"),disabled:i,"data-qa":"comment-clear-button",onClick:p,children:(0,Cl.jsx)(su.A,{className:"icon-stroke d-block","aria-hidden":!0})})]}),(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:i,"data-qa":"save-comment",children:c.translate("donateForm.comment.bottomSheet.button")})]})})]})}})},WS=(0,kr.memo)(zS),$S=(e,t)=>{var{className:n,disabled:i,hasContent:s}=e,a=(0,d.Tt)(e,["className","disabled","hasContent"]);const o=(0,nc.t)();return(0,Cl.jsx)("button",Object.assign({ref:t,type:"button",className:(0,Ml.A)("btn-link body-40-regular",n),disabled:i,"data-qa":"comment-button"},a,{children:s?o.translate("donateForm.comment.commentSaved"):o.translate("donateForm.comment.label")}))},XS=(0,kr.forwardRef)($S),QS=e=>{let{isActive:t,endDate:n,disabled:i,className:s,toggleDailyDonation:a}=e;const o=(0,nc.t)(),r=o.formatDate(n,{type:Qr.SHORT_WITH_YEAR});return(0,Cl.jsx)(Fd,{className:(0,Ml.A)("body-40-regular",s),customLabelClasses:"line-height-20",checked:t,disabled:i,onChange:a,dataQa:"daily-donation-checkbox",dataTestId:"daily-donation-checkbox",trackingElement:"dailyDonationCheckbox",children:(0,Cl.jsx)("span",{className:"body-40-regular text-truncate","data-qa":"daily-donation-label",children:o.translate("donateForm.dailyDonation.label",{endDate:r})})})},ZS=(0,kr.memo)(QS);var JS,eE,tE;function nE(){return nE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nE.apply(null,arguments)}var iE=function(e,t){return kr.createElement("svg",nE({width:16,height:18,viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),JS||(JS=kr.createElement("path",{d:"M2 6.96774V11.4839M5.97794 2V16M10.0221 5.16129V13.2903M14 6.96774V11.4839",stroke:"#667080",strokeWidth:2.5,strokeLinecap:"round"})),eE||(eE=kr.createElement("path",{d:"M2 6.96774V11.4839M5.97794 2V16M10.0221 5.16129V13.2903M14 6.96774V11.4839",stroke:"url(#paint0_linear_3570_80161)",strokeWidth:2.5,strokeLinecap:"round"})),tE||(tE=kr.createElement("defs",null,kr.createElement("linearGradient",{id:"paint0_linear_3570_80161",x1:-.666666,y1:12.5,x2:7.09165,y2:1.35879,gradientUnits:"userSpaceOnUse"},kr.createElement("stop",{offset:.149038,stopColor:"#43E983"}),kr.createElement("stop",{offset:.403846,stopColor:"#6599FF"}),kr.createElement("stop",{offset:.495192,stopColor:"#48A6FF"}),kr.createElement("stop",{offset:1,stopColor:"#FF83C1"})))))},sE=(0,kr.forwardRef)(iE),aE=(0,kr.memo)(sE);const oE=()=>{const{controller:e}=Tc(Vn.DONATE),t=Uc().get(u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT);return(0,kr.useEffect)((()=>{t.exposure()}),[t]),(0,Cl.jsxs)("div",{children:[(0,Cl.jsxs)("button",{type:"button",className:"btn btn-default d-flex items-center justify-center","data-qa":"use-voice-flow-button","data-tracking-element-name":"useVoiceFlowButton",onClick:()=>e.useVoiceFlow(),children:[(0,Cl.jsx)(aE,{className:"me-2 shrink-0","aria-hidden":!0}),(0,Cl.jsx)("span",{children:"Talk to donate"})]}),(0,Cl.jsxs)("div",{className:"d-flex items-center mt-5",children:[(0,Cl.jsx)("div",{className:"bg-gray-20",style:{flex:1,height:"1px"}}),(0,Cl.jsx)("span",{className:"px-3 body-40-regular",children:"Or fill out the form"}),(0,Cl.jsx)("div",{className:"bg-gray-20",style:{flex:1,height:"1px"}})]})]})},rE=(0,kr.memo)(oE);var lE,cE;function uE(e){const t=new Date(e).getTime()-Date.now();return t<=0?{days:0,hours:0,minutes:0,seconds:0}:{days:dE(t,lE.DAYS),hours:dE(t,lE.HOURS),minutes:dE(t,lE.MINUTES),seconds:dE(t,lE.SECONDS)}}function dE(e,t){const n=36e5;switch(t){case lE.DAYS:return Math.floor(e/864e5);case lE.HOURS:return Math.floor(e/n);case lE.MINUTES:return Math.floor(e%n/6e4);case lE.SECONDS:return Math.floor(e%6e4/1e3);default:throw new Bs.HP(t)}}!function(e){e.DAYS="days",e.HOURS="hours",e.MINUTES="minutes",e.SECONDS="seconds"}(lE||(lE={})),function(e){e[e.DAYS=0]="DAYS",e[e.HOURS=1]="HOURS"}(cE||(cE={}));const hE=e=>{const t=(0,nc.t)(),n=function(e){const[t,n]=(0,kr.useState)(uE(e)),[i,s]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>{if(i)return;const t=setTimeout((()=>{const t=uE(e);var i;n(t),!((i=t).days||i.hours||i.minutes||i.seconds)&&s(!0)}),1e3);return()=>{clearTimeout(t)}}),[t,e,i]),{time:t,type:t[lE.DAYS]>=2?cE.DAYS:cE.HOURS}}(e.targetDate),i=function(e,t,n){if(n===cE.DAYS)return e.translate("donateMatching.countdown.endsInDays",{value:t.days});const i=String(t.hours).padStart(2,"0"),s=String(t.minutes).padStart(2,"0"),a=String(t.seconds).padStart(2,"0");return e.translate("donateMatching.countdown.endsInHours",{hours:`${i}:${s}:${a}`})}(t,n.time,n.type);return(0,Cl.jsx)("p",{className:"body-40-medium text-truncate","data-qa":"rate-matching-timer-label","data-testid":"matching-countdown",children:i})},mE=e=>{let{size:t=20,className:n,shouldAnimate:i}=e;return(0,Cl.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 32 32",fill:"none",className:(0,Ml.A)("check-icon",{"check-icon-animated":i},n),"aria-hidden":!0,children:[(0,Cl.jsxs)("g",{stroke:"#3371e6",strokeWidth:"1",strokeLinecap:"round",children:[(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-1",height:"1",rx:".5",width:"1",x:"15.1084",y:"7.5"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-2",height:"1",rx:".5",width:"1",x:"19.8105",y:"9.02783"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-3",height:"1",rx:".5",width:"1",x:"22.7168",y:"13.0278"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-4",height:"1",rx:".5",width:"1",x:"22.7168",y:"17.9722"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-5",height:"1",rx:".5",width:"1",x:"19.8105",y:"21.9722"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-6",height:"1",rx:".5",width:"1",x:"15.1084",y:"23.5"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-7",height:"1",rx:".5",width:"1",x:"10.4062",y:"21.9722"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-8",height:"1",rx:".5",width:"1",x:"7.5",y:"17.9722"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-9",height:"1",rx:".5",width:"1",x:"7.5",y:"13.0278"}),(0,Cl.jsx)("rect",{className:"check-icon-little-circle check-icon-little-circle-10",height:"1",rx:".5",width:"1",x:"10.4062",y:"9.02783"})]}),(0,Cl.jsx)("rect",{className:"check-icon-main-circle",fill:"#3371e6",height:"22",rx:"11",width:"22",x:"4.98044",y:"5"}),(0,Cl.jsx)("path",{className:"check-icon-check",d:"m10.6001 16.0974 3.7947 3.7946 6.9661-6.4357",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"14",strokeDashoffset:"0",strokeWidth:"1.5"})]})},pE=e=>{let{size:t=20,className:n,shouldAnimate:i}=e;const s=(0,kr.useId)();return(0,Cl.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 32 32",fill:"none",className:(0,Ml.A)({"lightning-icon-animated":i},n),children:[(0,Cl.jsx)("mask",{id:`mask-${s}`,height:"32",maskUnits:"userSpaceOnUse",width:"32",x:"0",y:"0",children:(0,Cl.jsx)("path",{className:"lightning-icon-mask",d:"m32 32h-32v-31.99998474h32z",fill:"#d9d9d9"})}),(0,Cl.jsx)("g",{mask:`url(#mask-${s})`,children:(0,Cl.jsx)("path",{className:"lightning-icon-figure",d:"m18.2642 4.37539c0-.46699-.5834-.67907-.8833-.3211l-10.7572 12.83991c-.41365.5442-.62047.8162-.62363 1.046-.00275.1998.07845.3898.22019.5154.16305.1444.48612.1444 1.13226.1444h5.88328c.2761 0 .5.2239.5.5v8.5246c0 .467.5834.6791.8833.3211l10.7572-12.8399c.4136-.5441.6205-.8162.6236-1.046.0028-.1997-.0784-.3898-.2202-.5153-.163-.1445-.4861-.1445-1.1322-.1445h-5.8833c-.2761 0-.5-.2238-.5-.5z",fill:"#3371e6"})}),(0,Cl.jsx)("path",{className:"lightning-icon-line lightning-icon-line-1",d:"M11.7727 23.9137C11.3455 21.8153 9.46268 21.1179 9.46268 21.1179",stroke:"#3371e6",strokeWidth:"1.6",strokeLinecap:"round",strokeDasharray:"4",strokeDashoffset:"0"}),(0,Cl.jsx)("path",{className:"lightning-icon-line lightning-icon-line-2",d:"M11.4617 27.9227C10.0618 25.4822 5.2002 24.9023 5.2002 24.9023",stroke:"#3371e6",strokeWidth:"1.6",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"0"}),(0,Cl.jsx)("path",{className:"lightning-icon-line lightning-icon-line-3",d:"M18.0491 27.7006C19.2643 25.2154 24.6426 25.3198 24.6426 25.3198",stroke:"#3371e6",strokeWidth:"1.6",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"0"})]})};var gE;!function(e){e.LIGHTNING="lightning",e.CHECK="check",e.NONE="none"}(gE||(gE={}));const yE=e=>{let{id:t,className:n,amount:i,rate:s,sponsor:a,sponsorLogo:o,currency:r,minLimit:l,maxLimit:c,maxLimitEnabled:u,matchingImpact:d,isDonationMatched:h,isDonationOverMaxLimit:m,isMatchingLimited:p,upsellAmountToAdd:g,shouldAnimateLightning:y,shouldAnimateCheck:f,iconType:v}=e;const S=(0,Zl.$)(),E=function(e){const{isDonationMatched:t,isDonationOverMaxLimit:n,matchingImpact:i,rate:s,currency:a,isMatchingLimited:o}=e,r=(0,nc.t)();if(n||t&&null!==i&&i>0){const e=r.formatCurrency(i||0,{currency:a,display:"round"});return o?r.translate("donateMatching.title.withAmountLimited",{amount:e}):r.translate("donateMatching.title.withAmount",{amount:e,rate:s})}return r.translate("donateMatching.title.withoutAmount",{rate:s})}({isDonationMatched:h,isDonationOverMaxLimit:m,matchingImpact:d||0,rate:s,currency:r,isMatchingLimited:p}),A=function(e){const t=(0,nc.t)(),{sponsor:n,minLimit:i,currency:s,rate:a,amount:o,maxLimitEnabled:r,isDonationOverMaxLimit:l,isMatchingLimited:c}=e,u=r?e.maxLimit:1/0,d=(e,n)=>t.formatAmount({amount:e,currency:n,currencyFormat:Yt.SHORT,numberFormat:Kt.FLOAT,forceExplicit:!0}),h=Number.isFinite(u)?d(u,s):"";if(!o)return n?t.translate("donateMatching.description.withSponsor",{sponsor:n,rate:a}):t.translate("donateMatching.description.withoutSponsorAndAmount",{rate:a});if(o<i){const e=d(i-o,s);return n?t.translate("donateMatching.description.withSponsorBelowMin",{amount:e,sponsor:n,rate:a}):t.translate("donateMatching.description.withoutSponsorBelowMin",{amount:e,rate:a})}return l||c&&r?n?t.translate("donateMatching.description.withSponsorAndMaxLimit",{sponsor:n,maxLimit:h}):t.translate("donateMatching.description.withMaxLimit",{maxLimit:h}):n?t.translate("donateMatching.description.withSponsor",{sponsor:n,rate:a}):t.translate("donateMatching.description.withoutSponsor",{rate:a})}({sponsor:a,minLimit:l,maxLimit:c,currency:r,rate:s,amount:i,maxLimitEnabled:u,isDonationOverMaxLimit:m,isMatchingLimited:p});return(0,Cl.jsxs)("p",{id:t,className:(0,Ml.A)("body-40-regular text-line-clamp-5",n),children:[(0,Cl.jsxs)("strong",{className:"compact-50-medium","data-qa":"impact-label","data-testid":"impact-label",children:[E,(0,Cl.jsxs)("span",{className:"text-nowrap","aria-hidden":!0,children:["",(0,Cl.jsxs)("span",{className:"icon-slot icon-slot-14 d-inline-block",children:[v===gE.LIGHTNING&&(0,Cl.jsx)(pE,{shouldAnimate:y&&!S,className:"p-abs inset-centered"}),v===gE.CHECK&&(0,Cl.jsx)(mE,{shouldAnimate:f&&!S,className:"p-abs inset-centered"})]})]})]}),(0,Cl.jsx)("br",{}),(0,Cl.jsx)("span",{"data-qa":"impact-description","data-testid":"impact-description",children:A})]})},fE=(0,kr.memo)(yE),vE=e=>{var{className:t,currency:n,upsellAmountToAdd:i,handleAddUpsellAmount:s}=e,a=(0,d.Tt)(e,["className","currency","upsellAmountToAdd","handleAddUpsellAmount"]);const o=(0,nc.t)(),r=Kl(),l=(0,kr.useMemo)((()=>o.formatAmount({amount:i,currency:n,currencyFormat:Yt.SHORT,numberFormat:Kt.COMPACT,forceExplicit:!0})),[o,n,i]);return(0,Cl.jsx)("button",Object.assign({type:"button",className:(0,Ml.A)("btn btn-primary",r("btn-xxs"),t),"data-qa":"donate-matching-upsell-button","data-testid":"upsell-button","data-tracking-element-name":"donate-matching-upsell-button",onClick:s},a,{children:o.translate("donateMatching.upsell.button",{amount:l})}))},SE=(0,kr.memo)(vE),EE={width:40,borderRadius:"50%"},AE=e=>{let{className:t,currency:n,rate:i,sponsor:s,matchingImpact:a,sponsorLogo:o,upsellAmountToAdd:r,amountAfterUpsell:l,handleAddUpsellAmount:c,donationAmount:u,minLimit:d,maxLimit:h,maxLimitEnabled:m,isDonationMatched:p,isDonationOverMaxLimit:g,endDate:y,isCountdownEnabled:f,isDaysCountdownEnabled:v,isHourCountdownEnabled:S,isMatchingLimited:E,isMaxOptionsEnabled:A}=e;const C=(0,nc.t)(),b=(0,kr.useId)(),P=(0,Bl.P)(),N=ss?null==o?void 0:o.previewUrlRetina:null==o?void 0:o.previewUrl,D=(0,kr.useRef)(null),{shouldAnimateLightning:T,shouldAnimateCheck:k,iconType:I}=(e=>{let{isDonationMatched:t,upsellAmountToAdd:n,amount:i,minLimit:s}=e;const[a,o]=(0,kr.useState)(!1),[r,l]=(0,kr.useState)(!1),[c,u]=(0,kr.useState)(gE.NONE),d=(0,kr.useRef)(!1),h=(0,kr.useRef)(null),m=(0,kr.useRef)(null),p=null!==n,g=i>=s;return(0,kr.useEffect)((()=>{t&&!d.current&&g&&(o(!0),u(gE.LIGHTNING)),d.current=!0}),[t,g]),(0,kr.useEffect)((()=>{if(null===h.current||null===m.current)return h.current=p,void(m.current=i);h.current&&!p&&i>m.current&&g&&(l(!0),u(gE.CHECK)),h.current=p,m.current=i}),[p,i,g]),(0,kr.useEffect)((()=>{g||u(gE.NONE)}),[g]),{shouldAnimateLightning:a,shouldAnimateCheck:r,iconType:c}})({isDonationMatched:p,upsellAmountToAdd:r,amount:null!=u?u:0,minLimit:null!=d?d:0}),_=!!r&&!!l,O=y&&f&&(v||S),x=_||O;return(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-rel bg-blue-10 px-4 border-bottom-radius-8",t),"data-qa":"matching-impact-block","data-testid":"matching-impact-block",children:[!!N&&(0,Cl.jsx)("img",{src:N,className:(0,Ml.A)("p-abs inset-top-end me-2",A&&!P?"mt-3":"mt-4"),width:40,height:40,style:EE,alt:s?C.translate("donateMatching.sponsorLogoAlt",{sponsorName:s}):"","data-qa":"sponsor-logo","data-testid":"matching-impact-sponsor-logo"}),(0,Cl.jsx)(bc,{size:A&&!P?12:16}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:D,timeout:150,classNames:"rtg-matching-slide-"+(_?"with-upsell":"without-upsell"),children:(0,Cl.jsxs)("div",{ref:D,children:[(0,Cl.jsxs)("div",{className:"d-flex",role:"status",children:[(0,Cl.jsx)(fE,{id:`matching-description-${b}`,className:"grow-1 me-auto",sponsor:s,sponsorLogo:o,rate:i,amount:null!=u?u:0,currency:n,minLimit:null!=d?d:0,maxLimit:h&&h>0?h:1/0,maxLimitEnabled:m,matchingImpact:a,isDonationMatched:p,isDonationOverMaxLimit:g,isMatchingLimited:E,upsellAmountToAdd:r,shouldAnimateLightning:T,shouldAnimateCheck:k,iconType:I}),!!N&&(0,Cl.jsx)("div",{className:"shrink-0 ms-1-5",style:EE,"aria-hidden":!0})]}),x&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:A&&!P?4:8}),(0,Cl.jsxs)("div",{className:"d-flex items-center gap-2-5",children:[_&&(0,Cl.jsx)(SE,{className:"shrink-0 w-auto max-w-50",currency:n,"aria-describedby":`matching-description-${b}`,upsellAmountToAdd:r,handleAddUpsellAmount:c}),O&&(0,Cl.jsx)(hE,{targetDate:y})]})]})]})},"matching-impact-"+(_?"with-upsell":"without-upsell"))}),(0,Cl.jsx)(bc,{size:A&&!P?8:12})]})},CE=(0,kr.memo)(AE),bE=e=>{let{donorRating:t}=e;const i=li.THRESHOLD_NAME_MAP[t.thresholdName];return(0,Cl.jsxs)("div",{className:"donor-rating-banner body-40-regular fixed-container d-flex items-center justify-center border-radius-10 bg-orange-10 border border-orange-30 px-2",children:[void 0!==t.iconName&&(0,Cl.jsx)("img",{className:"d-block shrink-0 me-2",src:n(7065)(`./${t.iconName}.webp`),width:20,height:20,"aria-hidden":!0,alt:t.iconName}),(0,Cl.jsx)(fc,{as:"p",className:"donor-rating-label text-truncate",dataQa:"donor-rating-label",token:"donorRatingBanner.rate",params:{rate:i}})]})},PE=(0,kr.memo)(bE),NE=e=>{const{index:t,onAnimationEnd:n}=e,i=(0,kr.useRef)(null),[s,a]=(0,kr.useState)(!1);(0,kr.useEffect)((()=>{a(!0)}),[]);const o=(0,kr.useCallback)((()=>{n(t)}),[t,n]);return(0,Cl.jsx)(Ll.A,{nodeRef:i,classNames:"rtg-flying-heart",in:s,timeout:2500,onEntered:o,children:(0,Cl.jsx)("span",{ref:i,className:"flying-heart",children:(0,Cl.jsx)(Fu,{className:"d-block",width:14,height:14})})})},DE=(0,kr.memo)(NE),TE=e=>{let{heartTrigger:t}=e;const[n,i]=(0,kr.useState)([]);(0,kr.useEffect)((()=>{null!==t&&i((e=>{const t=(e[e.length-1]||0)+1,n=[...e,t];return n.length===e.length?e:n}))}),[t]);const s=(0,kr.useCallback)((e=>{i((t=>t.filter((t=>t!==e))))}),[]);return(0,Cl.jsx)(Cl.Fragment,{children:n.map((e=>(0,Cl.jsx)(DE,{index:e,onAnimationEnd:s},e)))})},kE=(0,kr.memo)(TE),IE=e=>{const{state:t,controller:n}=Tc(Vn.DONATE),i=(0,nc.t)(),s=Kl(),[a,o]=(0,kr.useState)(null),r=(0,kr.useCallback)((e=>{n.validateAmount(),n.changeFrequency(e),e===t.rightButtonFrequency&&o((a||0)+1)}),[n,a,t.rightButtonFrequency]),l=(0,kr.useMemo)((()=>t.donation.frequency===t.rightButtonFrequency),[t.donation.frequency,t.rightButtonFrequency]),c=(0,kr.useMemo)((()=>t.donation.frequency===qn.ANNUAL),[t.donation.frequency]),u=(0,kr.useMemo)((()=>t.donation.frequency===qn.ANNUAL&&t.donation.showAnnualCheckbox),[t.donation.frequency,t.donation.showAnnualCheckbox]),d=(0,kr.useCallback)((()=>{const e=t.donation.annualCheckboxChecked?qn.ANNUAL:t.leftButtonFrequency;r(e)}),[r,t.leftButtonFrequency,t.donation.annualCheckboxChecked]);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("frequency-wrap p-rel",{"frequency-wrap-three-columns":t.donation.showAnnualTab},e.className),"aria-label":i.translate("donateForm.frequencyAriaLabel"),children:[(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(s("frequency-btn"),"btn-reset body-60-regular p-rel d-flex items-center justify-center max-w-100 bg-transparent border-radius-8 z-index-1",{"frequency-btn-selected":t.donation.frequency===t.leftButtonFrequency||u}),"aria-current":t.donation.frequency===t.leftButtonFrequency||u,disabled:e.disabled,onClick:d,"data-qa":"less-frequent-button","data-tracking-element-name":"onceRepeat",children:(0,Cl.jsx)("span",{className:"p-rel text-truncate","data-testid":"left-button-label",children:t.leftButtonLabel})}),(0,Cl.jsxs)("button",{type:"button",className:(0,Ml.A)(s("frequency-btn"),"btn-reset body-60-regular p-rel d-flex items-center justify-center max-w-100 bg-transparent border-radius-8 z-index-1",{"frequency-btn-selected":l}),"aria-current":t.donation.frequency===t.rightButtonFrequency,disabled:e.disabled,onClick:()=>r(t.rightButtonFrequency),"data-qa":"more-frequent-button","data-tracking-element-name":"monthlyPlan",children:[(0,Cl.jsxs)("span",{className:"p-rel shrink-0 text-fuchsia-80 me-1","aria-hidden":!0,children:[(0,Cl.jsx)(Fu,{className:"d-block",width:14,height:14}),(0,Cl.jsx)(kE,{heartTrigger:a})]}),(0,Cl.jsx)("span",{className:"p-rel text-truncate mx-0-5","data-testid":"right-button-label",children:t.rightButtonLabel})]}),t.donation.showAnnualTab&&(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(s("frequency-btn"),{"frequency-btn-selected":c}),"aria-current":c,disabled:e.disabled,onClick:()=>r(qn.ANNUAL),"data-qa":"annual-frequent-button","data-tracking-element-name":"repeatAnnualTab",children:(0,Cl.jsx)("span",{className:"p-rel text-truncate",children:i.translate("donateForm.annual")})}),!t.donation.showAnnualTab&&(0,Cl.jsx)("div",{className:"frequency-frame p-abs inset-0 border-radius-8"})]})},_E=(0,kr.memo)(IE);var OE,xE,wE;function RE(){return RE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},RE.apply(null,arguments)}var ME=function(e,t){return kr.createElement("svg",RE({fill:"none",height:31,viewBox:"0 0 22 31",width:22,xmlns:"http://www.w3.org/2000/svg",ref:t},e),OE||(OE=kr.createElement("g",{clipRule:"evenodd",fillRule:"evenodd"},kr.createElement("path",{d:"m.507812 24.6719c-.026481-.0459-.052961-.0918-.098827-.0653l.026481.0459s.045865-.0265.072346.0194z"}),kr.createElement("path",{d:"m.185395 24.0017c.045867-.0265.045867-.0265 0 0 .118215-.0071.118214-.0071.045866-.0265 0 0 .000001 0-.045866.0265z"}),kr.createElement("path",{d:"m.179981 24.0035.019687-.0735z"}))),xE||(xE=kr.createElement("path",{d:"m16.9661 23.931c-5.446 2.8727-8.22466 5.3799-8.22466 5.3799s-.80873-4.5387-.05829-9.6647",stroke:"#222832",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),wE||(wE=kr.createElement("path",{d:"m9.35452 27.0478c22.14548-34.0478 3.64548-27.04779997-.35409-21.0478",stroke:"#222832",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})))},LE=(0,kr.forwardRef)(ME),FE=(0,kr.memo)(LE);const UE=e=>{let{className:t,isCustomFont:n=!1}=e;const i=(0,nc.t)(),s=(0,gc.Q)();return(0,Cl.jsxs)("div",{className:(0,Ml.A)("frequency-hint-top d-flex items-center justify-center mx-minus-3",t,{"pt-1":n}),children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("text-truncate",n?"frequency-hint-top-text-custom-font":"frequency-hint-top-text-default-font"),"data-qa":"recurring-frequency-hint-label",children:i.translate("frequencyHint.label")}),(0,Cl.jsx)("span",{className:(0,Ml.A)("icon-slot icon-slot-12 shrink-0 mt-1-5",{"icon-flip-horizontal":s}),"aria-hidden":!0,children:(0,Cl.jsx)(FE,{className:"p-abs inset-top-start",width:19,height:27})})]})},jE=(0,kr.memo)(UE),BE=(e,t)=>{var{className:n,disabled:i,hasContent:s}=e,a=(0,d.Tt)(e,["className","disabled","hasContent"]);const o=(0,nc.t)();return(0,Cl.jsx)("button",Object.assign({ref:t,type:"button",className:(0,Ml.A)("btn-link body-40-regular",n),disabled:i,"data-qa":"tribute-trigger"},a,{children:s?o.translate("donateForm.tribute.dedicationSaved"):o.translate("donateForm.tribute.label.dedication")}))},GE=(0,kr.forwardRef)(BE),qE={minHeight:"60px"},VE=e=>{let{trigger:t,name:n,inHonorOfMaxLength:i,rootContainer:s,disabled:a,onChangeTributeName:o}=e;const r=(0,nc.t)(),l=(0,kr.useId)(),[c,u]=(0,kr.useState)(n);(0,kr.useEffect)((()=>{u(n)}),[n]);const d=(0,kr.useCallback)((()=>{u("")}),[]),h=(0,kr.useCallback)((e=>{u(e.target.value)}),[]),m=(0,kr.useCallback)(((e,t)=>{e.preventDefault(),e.stopPropagation(),o(c.trim()),t()}),[o,c]),p=(0,kr.useCallback)((e=>{e||u(n)}),[n]);return(0,Cl.jsx)(VS,{trigger:t,rootContainer:s,className:"max-h-95 d-flex flex-column",contentClassName:"grow-1 min-h-0 d-flex flex-column",disabled:a,onOpenChange:p,children:e=>{let{closeSheet:t}=e;return(0,Cl.jsxs)("form",{className:"grow-1 d-flex flex-column min-h-0",onSubmit:e=>m(e,t),children:[(0,Cl.jsx)("div",{className:"fixed-container d-flex items-center justify-center px-10 py-1 shrink-0",style:qE,children:(0,Cl.jsx)("h3",{className:"body-60-medium text-center text-ellipsis",children:r.translate("donateForm.tribute.bottomSheet.title")})}),(0,Cl.jsx)("hr",{className:"shrink-0"}),(0,Cl.jsx)("div",{className:"px-body grow-1 min-h-0 pt-6 pb-7 overflow-y-auto custom-scrollbar",children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)("p",{className:"text-center text-ellipsis",children:r.translate("donateForm.tribute.bottomSheet.description")}),(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)(Kd.t,{id:`tribute-${l}`,className:"pe-9",label:r.translate("donateForm.tribute.inputPlaceholder"),labelFloating:!0,value:c,maxLength:i,disabled:a,dataQa:"tribute-name",onChange:h,autoFocus:!0,children:c&&(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered-end font-size-18 text-gray-40 me-4","aria-label":r.translate("common.clearButtonAriaLabel"),disabled:a,"data-qa":"tribute-clear-button",onClick:d,children:(0,Cl.jsx)(su.A,{className:"icon-stroke d-block","aria-hidden":!0})})}),(0,Cl.jsx)(bc,{size:6}),(0,Cl.jsx)("p",{className:"body-30-regular text-gray-80 text-ellipsis",children:r.translate("donateForm.tribute.bottomSheet.hint")}),(0,Cl.jsx)(bc,{size:24}),(0,Cl.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:a,"data-qa":"save-tribute",children:r.translate("donateForm.tribute.bottomSheet.button")})]})})]})}})},HE=(0,kr.memo)(VE),KE=15*ns.MS.SECOND,YE="btn-loading",zE="has-error";class WE extends Error{constructor(){super("Checkout application is hanging"),this.name="HangingDetectorError"}}const $E=()=>{var e,t,n,i;const{state:s,controller:a}=Tc(Vn.DONATE),o=(0,kr.useId)(),c=(0,nc.t)(),d=(0,Bl.P)(),h=Vc("lg"),m=(0,kr.useRef)(null),p=(0,kr.useRef)(null),g=Uc(),y=Kl(),f=(e=>{const t=(0,Il.M)(),n=Dc(),i=(0,Bl.P)(),s=Ol(),a=(0,kr.useRef)(null),o=(0,kr.useRef)(null),c=(0,kr.useRef)(null),u=(0,kr.useCallback)((()=>{i||c.current||(c.current=!0,s.captureException(new WE,(e=>(e.setTag(r.ERROR_TYPE,l.CHECKOUT_HANGING),e.setFingerprint(["hanging-detector-error"]),e))))}),[s,i]),{set:d,clear:h}=(0,hd.D)((()=>{m(),u()})),m=(0,kr.useCallback)((()=>{var e,t;h(),null===(e=a.current)||void 0===e||e.call(a),a.current=null,null===(t=o.current)||void 0===t||t.disconnect(),o.current=null}),[h]),p=(0,kr.useCallback)((()=>{if(a.current||o.current)return;if(d([],KE),a.current=n.onScreenChanged((()=>{m()})),o.current=new MutationObserver((e=>{for(const t of e)if("attributes"===t.type&&"class"===t.attributeName&&[YE,zE].some((e=>t.target.classList.contains(e))))return void m()})),o.current.observe(t.document.body,{subtree:!0,childList:!1,attributes:!0,attributeFilter:["class"]}),n.getCurrentFlow().getCurrentScreen().name!==e)return void m();const i=!!t.document.querySelector(`.${YE}`);(t.document.querySelector(`.${zE}`)||i)&&m()}),[t,n,e,d,m]);return(0,kr.useEffect)((()=>m),[m]),p})(Vn.DONATE),v=(0,kr.useRef)(null),S=function(){const e=Dc(),t=(0,Pc.a)(),[n,i]=(0,kr.useState)((()=>e.getCurrentFlow().historyPreviousScreenName));return(0,kr.useEffect)((()=>e.onScreenChanged((()=>{t.current&&i(e.getCurrentFlow().historyPreviousScreenName)}))),[e,t]),n}();(0,Sd.f)({ref:v,autoFocus:S===wl.COMMENT,mode:vd.Q.DESKTOP,preventScroll:!0});const E=PS(),A=(0,kr.useRef)(null),C=(0,kr.useRef)(null),b=jl(),P=s.comment.isEnabled&&s.rateMatching.enabled,N=s.tribute.show&&s.rateMatching.enabled,D=Hl(),[T,k]=(0,kr.useState)(!0),I=$d(s.amountShakeKey,0!==s.amountShakeKey),_=$d(s.designationShakeKey,0!==s.designationShakeKey),O=g.get(u.NEW_FONT_FOR_HINT_TO_RECURRING_EXPERIMENT),x=!!s.donation.showAmountSuggestions&&s.donation.hintOptions,w=!x,R=s.donation.showDonationEndDate&&!!s.donation.donationEndDate,M=O.isTestGroup1&&!h||O.isTestGroup2&&!h,L=s.donation.showAnnualCheckbox&&(s.donation.frequency===qn.ONCE||s.donation.frequency===qn.ANNUAL),F=a.isDesignationReadOnly(),U=a.isDesignationEditable(),j=!s.designations.isValid&&(null===(n=null===(t=null===(e=s.errors.donationItems)||void 0===e?void 0:e[0])||void 0===t?void 0:t.designation)||void 0===n?void 0:n.required);bS(p,(e=>e.designation.required)),bS(C,(()=>j));const B=(0,kr.useCallback)((()=>{a.toggleTribute()}),[a]),G=(0,kr.useCallback)((e=>{a.changeTributeName(e)}),[a]),q=(0,kr.useCallback)((e=>{a.setTributeActive(e.length>0),a.changeTributeName(e)}),[a]),V=(0,kr.useCallback)((e=>a.changeComment(e)),[a]),H=(0,kr.useCallback)((()=>{a.addComment()}),[a]),K=(0,kr.useCallback)((e=>{a.setIsTributeInputFocused(e)}),[a]),Y=(0,kr.useCallback)((()=>a.savePrevComment()),[a]),z=(0,kr.useCallback)((()=>{k(!0)}),[]),W=(0,kr.useCallback)((()=>{k(!1)}),[]),$=(0,kr.useCallback)((e=>{a.toggleDonationEndDateActive(e)}),[a]),{handleGoalSelect:X,handleGoalListOpen:Q,handleGoalListScrollVisible:Z,handleGoalSearchInputVisible:J,handleGoalClick:ee,handleGoalGroupOpen:te,handleGoalTreeUpdate:ne,handleGoalListScroll:ie,handleGoalSearchFinished:se}=(e=>({handleGoalSelect:(0,kr.useCallback)((t=>{e.setDesignationsSelectedGoal(t)}),[e]),handleGoalListOpen:(0,kr.useCallback)(((t,n)=>e.setTrackingDesignationListOpen(t,n)),[e]),handleGoalListScrollVisible:(0,kr.useCallback)((t=>e.setTrackingDesignationListScrollVisible(t)),[e]),handleGoalSearchInputVisible:(0,kr.useCallback)((t=>e.setTrackingDesignationSearchInputVisible(t)),[e]),handleGoalClick:(0,kr.useCallback)((t=>e.setTrackingDesignationClickedGoal(t)),[e]),handleGoalGroupOpen:(0,kr.useCallback)(((t,n)=>e.setTrackingDesignationClickedGroup(t,n)),[e]),handleGoalTreeUpdate:(0,kr.useCallback)((t=>e.setTrackingDesignationItems(t)),[e]),handleGoalListScroll:(0,kr.useCallback)((()=>e.trackDesignationScrollUsed()),[e]),handleGoalSearchFinished:(0,kr.useCallback)(((t,n)=>e.trackDesignationSearchFinished(t,n)),[e])}))(a),ae=(0,kr.useCallback)((()=>{a.addRateMatchingUpsellAmount()}),[a]);(0,kr.useEffect)((()=>{O.exposure()}),[O]);const{isDonorRatingExperimentTestGroup2Enabled:oe,donorRatingUpsellRate:re}=CS(),le=(0,kr.useRef)(null),ce=s.isDonateByVoiceExperimentEnabled&&x&&!d,ue=x&&(U||F)&&(R||s.tribute.show||s.comment.isEnabled),de=w&&R&&(U||F)&&(s.tribute.show||s.comment.isEnabled);return(0,Cl.jsxs)("form",{ref:A,className:"flow-screen p-rel","aria-labelledby":`screen-header-${o}`,"data-qa":"fiat-donate-form",onSubmit:e=>{E(),e.preventDefault(),a.leave()},children:[(0,Cl.jsx)(Ll.A,{nodeRef:le,in:s.donorRating.shouldShowDonorRatingBanner,timeout:150,classNames:d?"rtg-donor-rating-mobile":"rtg-donor-rating-desktop",unmountOnExit:!0,exit:!s.donorRating.immediateExit,children:(0,Cl.jsx)("div",{ref:le,className:(0,Ml.A)(y("donor-rating-banner-wrapper"),"w-100 px-body"),role:"alert",children:(0,Cl.jsx)(PE,{donorRating:s.donorRating})})}),(0,Cl.jsx)(Ad,{id:`screen-header-${o}`,className:"border-bottom-0",titleFullWidth:!0,screenTitle:c.translate("donateForm.title"),a11yAutoFocus:d||!s.donation.canModifyAmount,children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex items-center justify-center",{"pt-3 pb-2":d,"py-3":(!s.rateMatching.enabled||s.rateMatching.enabled&&!ue)&&!d,"pt-3 pb-1":s.rateMatching.enabled&&R&&!x&&!d}),children:[(0,Cl.jsx)(pS,{className:"icon-fill shrink-0 font-size-28 text-green-80 me-2","aria-hidden":!0}),(0,Cl.jsx)("h2",{className:"title-50-semibold text-truncate",children:c.translate("donateForm.title")})]})}),(0,Cl.jsx)(td,{className:"px-body",children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[s.isDonateByVoiceExperimentEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(rE,{}),(0,Cl.jsx)(bc,{size:20})]}),M&&(0,Cl.jsx)(jE,{className:"mb-3",isCustomFont:O.isTestGroup1}),s.donation.canModifyFrequency&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(_E,{disabled:a.isLocked}),(0,Cl.jsx)(bc,{size:d?16:12,sizeMin:8})]}),(0,Cl.jsx)(Fp.A,{children:(0,Cl.jsx)(Ll.A,{nodeRef:m,timeout:150,onEntered:z,onExited:W,classNames:x?"rtg-amount-hints":"rtg-amount-suggestions",children:(0,Cl.jsxs)("div",{ref:m,className:(0,Ml.A)({"p-rel z-index-1":oe&&d||D}),children:[x&&(0,Cl.jsx)(LS,{donation:s.donation,tribute:s.tribute,errors:s.errors,guessedCurrenciesList:s.guessedCurrenciesList,allCurrenciesList:s.allCurrenciesList,showError:s.showError,flowType:s.flowType,showFrequencyCustomAmountInput:s.showFrequencyCustomAmountInput,shake:I,disabled:a.isLocked,animationEnded:T,autofocusMode:vd.Q.ALL,isMaxOptionsEnabled:s.rateMatching.enabled&&ue,donorRatingUpsell:s.donorRating.upsell}),w&&(0,Cl.jsx)(US,{donation:s.donation,tribute:s.tribute,errors:s.errors,guessedCurrenciesList:s.guessedCurrenciesList,allCurrenciesList:s.allCurrenciesList,showError:s.showError,flowType:s.flowType,shake:I,disabled:a.isLocked,animationEnded:T,autofocusMode:vd.Q.DESKTOP,donorRatingUpsell:s.donorRating.upsell})]})},x?"amount-hints":"amount-suggestions")}),s.rateMatching.enabled&&(0,Cl.jsx)(Cl.Fragment,{children:(0,Cl.jsx)(CE,{className:"mt-minus-2",donationAmount:s.donation.amount,currency:s.donation.currency,rate:s.rateMatching.rate,sponsor:s.rateMatching.sponsor,sponsorLogo:s.rateMatching.sponsorLogo,matchingImpact:s.rateMatching.matchingImpact,minLimit:s.rateMatching.minRateMatchingAmount,maxLimit:s.rateMatching.totalAmountLimitInDonationCurrency,maxLimitEnabled:s.rateMatching.totalAmountLimitEnabled,upsellAmountToAdd:s.rateMatching.upsellAmountToAdd,amountAfterUpsell:s.rateMatching.amountAfterUpsell,isDonationMatched:s.rateMatching.isDonationMatched,isDonationOverMaxLimit:s.rateMatching.isDonationOverMaxLimit,isMatchingLimited:s.rateMatching.isMatchingLimited,endDate:s.rateMatching.endDate,isCountdownEnabled:s.rateMatching.isCountdownEnabled,isDaysCountdownEnabled:s.rateMatching.isDaysCountdownEnabled,isHourCountdownEnabled:s.rateMatching.isHourCountdownEnabled,isMaxOptionsEnabled:ue||de,handleAddUpsellAmount:ae})}),oe&&d&&(0,Cl.jsxs)("div",{className:(0,Ml.A)("donor-rating-upsell-wrapper",{"is-visible":s.donorRating.upsell.position!==Xn.NONE}),role:"alert",children:[(0,Cl.jsx)(bc,{size:12}),(0,Cl.jsx)(AS,{amount:s.donorRating.upsell.amount,donation:s.donation,rate:re,className:"bg-blue-10 px-4 py-3 border-radius-10"})]}),L&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:20}),(0,Cl.jsx)(BS,{isActive:null!==(i=s.donation.annualCheckboxChecked)&&void 0!==i&&i,disabled:a.isLocked,toggleAnnualDonation:e=>a.toggleAnnualCheckbox(e)})]}),R&&s.donation.donationEndDate&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:12,sizeMin:4}),(0,Cl.jsx)(ZS,{endDate:s.donation.donationEndDate,isActive:s.donation.isDonationEndDateActive,toggleDailyDonation:$,disabled:a.isLocked})]}),U&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:s.rateMatching.enabled?12:20,sizeMin:4}),(0,Cl.jsx)(ef,{availableGoals:s.designations.availableGoals,selectedGoals:s.designations.selectedGoals,isGoalsLoading:s.designations.isOptionsLoading,isValueLoading:s.designations.isValueLoading,hasError:j,shake:_,boundingElementRef:A,setRef:C,locked:a.isLocked,onGoalSelect:X,onListScroll:ie,onSearchFinished:se,onListOpen:Q,onListScrollVisible:Z,onSearchInputVisible:J,onGoalClick:ee,onGroupOpen:te,onTreeUpdate:ne})]}),s.tribute.show&&!N&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:ce?4:16,sizeMin:4}),(0,Cl.jsx)(df,{inHonorOfMaxLength:s.tribute.inHonorOfMaxLength,isActive:s.tribute.isActive,sharingEnabled:s.tribute.sharingEnabled,labelType:s.tribute.labelType,name:s.tribute.name,disabled:a.isLocked,onToggleTribute:B,onChangeTributeName:G,onInputFocusChange:K})]}),(0,Cl.jsx)(bc,{size:16,sizeMin:4,className:"mt-auto"}),F&&(0,Cl.jsx)(tf,{className:"shrink-0",isLoading:s.designations.isValueLoading,availableGoals:s.designations.availableGoals,selectedGoals:s.designations.selectedGoals}),s.comment.isEnabled&&!P&&(0,Cl.jsxs)(Cl.Fragment,{children:[F&&(0,Cl.jsx)(bc,{size:12,sizeMin:4}),(0,Cl.jsx)(my,{setRef:v,prevContent:s.comment.prevContent,content:s.comment.content,onAddComment:H,onHighlight:Y,disabled:a.isLocked})]}),(P||N)&&(0,Cl.jsxs)(Cl.Fragment,{children:[F&&(0,Cl.jsx)(bc,{size:12,sizeMin:4}),(0,Cl.jsxs)("div",{className:"d-flex",children:[N&&(0,Cl.jsx)(HE,{trigger:(0,Cl.jsx)(GE,{disabled:a.isLocked,hasContent:!!s.tribute.name}),name:s.tribute.name,inHonorOfMaxLength:s.tribute.inHonorOfMaxLength,rootContainer:h&&!d?A:b||null,disabled:a.isLocked,onChangeTributeName:q}),P&&N&&(0,Cl.jsx)("span",{className:"body-40-regular shrink-0 mx-1","aria-hidden":!0,children:""}),P&&(0,Cl.jsx)(WS,{trigger:(0,Cl.jsx)(XS,{disabled:a.isLocked,hasContent:!!s.comment.content}),rootContainer:h&&!d?A:b||null,disabled:a.isLocked,comment:s.comment.content,onCommentChange:V,defaultOpen:s.shouldOpenCommentBottomSheet,onOpened:()=>a.setShouldOpenCommentBottomSheet(!1)})]})]}),!d&&(0,Cl.jsx)(bc,{size:s.isDonateByVoiceExperimentEnabled?12:20,sizeMin:s.isDonateByVoiceExperimentEnabled?12:16})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn btn-primary",disabled:a.isLocked,processingState:s.processingState,trackingElement:"nextButton",dataQa:"donate-button",onClick:f,children:s.donateButtonLabel})})]})};var XE;!function(e){e.CONTINUE="continue",e.UPSELL_PAY_LATER="upsell_pay_later"}(XE||(XE={}));const QE=e=>{const{controller:t}=Tc(Vn.DOUBLE),n=(0,nc.t)();return(0,Cl.jsx)("div",{className:(0,Ml.A)("d-flex justify-center",e.className),children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",disabled:e.locked,onClick:()=>t.skip(),"data-qa":"skip-to-the-next-step","data-tracking-element-name":"skipButton",children:n.translate("doubleDonationScreen.button.skip")})})},ZE=(0,kr.memo)(QE),JE=e=>{const t=(0,nc.t)(),n=(0,kr.useCallback)((()=>{e.onLeave()}),[e]),i=(0,kr.useCallback)((()=>{e.onAcceptUpsell()}),[e]);return(0,Cl.jsx)("div",{className:(0,Ml.A)(e.className),children:e.isAlreadyPaidAmountNotMatched?(0,Cl.jsx)(lh,{className:"btn-primary",processingState:e.processingState,onClick:n,dataQa:"double-continue",trackingElement:"nextButton",errorTitle:e.payErrorMessage,errorMessage:e.additionalPayErrorMessage,children:t.translate("doubleDonationScreen.button.continue")}):(0,Cl.jsxs)(Cl.Fragment,{children:[e.buttonType===XE.CONTINUE&&(0,Cl.jsx)(lh,{className:"btn-primary",processingState:e.processingState,onClick:n,dataQa:"double-continue",trackingElement:"nextButton",errorTitle:e.payErrorMessage,errorMessage:e.additionalPayErrorMessage,children:t.translate("doubleDonationScreen.button.continue")}),e.buttonType===XE.UPSELL_PAY_LATER&&(0,Cl.jsxs)("div",{className:"d-block",children:[(0,Cl.jsx)(lh,{className:"btn-primary",processingState:e.processingState,onClick:i,dataQa:"double-continue",trackingElement:"nextButton",errorTitle:e.payErrorMessage,errorMessage:e.additionalPayErrorMessage,children:e.changeAmountButtonLabel}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-5",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",disabled:e.locked,onClick:n,"data-qa":"skip-to-the-next-step","data-tracking-element-name":"skipButton",children:e.noChangeAmountButtonLabel})})]}),e.showSkipButton&&(0,Cl.jsx)(ZE,{locked:e.locked,className:"mt-5"})]})})},eA=(0,kr.memo)(JE),tA=e=>{let{isIntegrationEnabled:t,companies:n,showEmployerMatchedBlock:i,showDTDUpsell:s,employer:a,locked:o,autoFocus:r}=e;const{controller:l}=Tc(Vn.DOUBLE),c=(0,nc.t)(),u=(0,Zl.$)(),d=(0,kr.useRef)(null),h=(0,kr.useMemo)((()=>t?n.map((e=>({id:e.id.toString(),value:e.company_name}))):[]),[n,t]),m=(0,kr.useCallback)((e=>{u||t&&l.getDTDCompanies(e)}),[l,u,t]),p=(0,kr.useCallback)((e=>{l.changeEmployerName(e)}),[l]),g=(0,kr.useCallback)((()=>{var e;l.changeEmployerName(""),l.resetEmployerDTD(),null===(e=d.current)||void 0===e||e.focus()}),[l]),y=(0,kr.useCallback)((e=>l.setEmployerDTD(Number(e))),[l]);return(0,Cl.jsx)(hv,{inputRef:d,className:(0,Ml.A)("search-select-double",{"search-select-double-active":i||s}),labelFloating:!0,labelOptional:!0,label:c.translate("doubleDonationScreen.matchInput.label"),options:h,value:a.name,autoComplete:"organization",onSearch:m,onSelect:y,onChange:p,placeholder:c.translate("doubleDonationScreen.matchInput.placeholder"),onClear:g,disabled:o,hint:(0,Cl.jsx)(fc,{token:"doubleDonationScreen.tooltipLabel",params:{link:"https://doublethedonation.com/privacy-policy/"}}),hintAriaLabel:c.translate("doubleDonationScreen.helpAriaLabel"),allowClear:!0,dataQa:"company-field",trackingElement:"selectEmployer",autoFocus:r,autoFocusMode:vd.Q.DESKTOP})},nA=(0,kr.memo)(tA),iA=e=>{const t=(0,nc.t)(),n=(0,kr.useRef)(null),i=(0,Bl.P)(),s=ec(n);return(0,Cl.jsx)(Ll.A,{classNames:i?"rtg-dtd-description-mobile":"rtg-dtd-description",nodeRef:n,in:e.showDTDDescription,addEndListener:s,mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsxs)("div",{ref:n,children:[(0,Cl.jsx)(fc,{className:(0,Ml.A)("text-center",i?"text-ellipsis":"text-line-clamp-4"),as:"p",token:"doubleDonationScreen.description.desktop"}),(0,Cl.jsx)("p",{className:(0,Ml.A)("font-weight-500 text-center mt-1-5",i?"text-ellipsis":"text-line-clamp-4"),children:t.translate("doubleDonationScreen.callToAction")}),(0,Cl.jsx)(bc,{size:16})]})})},sA=(0,kr.memo)(iA);var aA,oA,rA;function lA(){return lA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},lA.apply(null,arguments)}var cA,uA=function(e,t){return kr.createElement("svg",lA({fill:"none",height:100,viewBox:"0 0 100 100",width:100,xmlns:"http://www.w3.org/2000/svg",ref:t},e),aA||(aA=kr.createElement("circle",{cx:50,cy:50,fill:"#c4c4c4",r:50})),oA||(oA=kr.createElement("circle",{cx:50,cy:50,fill:"#fff",r:49.5,stroke:"#c7cdd6"})),rA||(rA=kr.createElement("path",{clipRule:"evenodd",d:"m23 92.0905v-19.1493c0-2.1476 1.7185-3.9412 3.8729-3.9412h2.1271v-13.127c0-2.1175 1.7054-3.873 3.8279-3.873h1.1721v-10.984c0-2.2061 1.7927-4.016 4-4.016h1.2055l1.4179-6.1095.002-.0079c.4286-1.7193 1.9819-2.8826 3.7361-2.8826h4.1385v-11c0-.8284.6716-1.5 1.5-1.5s1.5.6716 1.5 1.5v11h4.2669c1.7542 0 3.3075 1.1633 3.7362 2.8826l.0041.0165 1.3019 6.1009h1.1909c2.2073 0 4 1.8099 4 4.016v10.984h2.1721c2.1225 0 3.8279 1.7555 3.8279 3.873v13.127h2.1271c2.1544 0 3.8729 1.7936 3.8729 3.9412v18.4895c-.6557.444-1.3226.8729-2 1.2861v-19.7756c0-1.0877-.8671-1.9412-1.8729-1.9412h-16.2542c-1.0058 0-1.8729.8535-1.8729 1.9412v26.7025c-.6628.0793-1.3295.1456-2 .1986v-43.9693c0-2.1175 1.7054-3.873 3.8279-3.873h6.1721v-10.984c0-1.1115-.9073-2.016-2-2.016h-24c-1.0927 0-2 .9045-2 2.016v10.984h7.1721c2.1225 0 3.8279 1.7555 3.8279 3.873v44.0385c-.6703-.0397-1.3371-.0926-2-.1584v-26.8119c0-1.0877-.8671-1.9412-1.8729-1.9412h-16.2542c-1.0058 0-1.8729.8535-1.8729 1.9412v20.3697c-.6769-.3916-1.3437-.7985-2-1.2204zm19.5677-60.7311-1.309 5.6406h17.5054l-1.2053-5.6483c-.2039-.7888-.9281-1.3517-1.7919-1.3517h-11.4054c-.8666 0-1.5927.5665-1.7938 1.3594zm.5594 37.6406h-12.1271v-13.127c0-1.0428.8397-1.873 1.8279-1.873h10.3442c.9882 0 1.8279.8302 1.8279 1.873v13.6198c-.5536-.3134-1.1914-.4928-1.8729-.4928zm26.8729 0v-13.127c0-1.0428-.8397-1.873-1.8279-1.873h-10.3442c-.9882 0-1.8279.8302-1.8279 1.873v13.6198c.5536-.3134 1.1914-.4928 1.8729-.4928zm-26-36v2h2v-2zm5 0v2h2v-2zm5 2v-2h2v2zm-20 26v-3h2v3zm0 5v-3h2v3zm6-5v-3h2v3zm0 2v3h2v-3zm19-5v3h2v-3zm0 5v3h2v-3zm6-5v3h2v-3zm0 8v-3h2v3zm-34 10v14.5268h-2v-14.5268zm5 19.3691v-19.3691h-2v19.3691zm31 0v-19.3691h-2v19.3691zm5-4.8423v-14.5268h-2v14.5268zm-32-47.5268v6.0193h2v-6.0193zm6 6.0193v-6.0193h2v6.0193zm6-6.0193v6.0193h2v-6.0193zm6 6.0193v-6.0193h2v6.0193z",fill:"#619fff",fillRule:"evenodd"})))},dA=(0,kr.forwardRef)(uA),hA=(0,kr.memo)(dA);function mA(){return mA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mA.apply(null,arguments)}var pA,gA,yA=function(e,t){return kr.createElement("svg",mA({fill:"none",height:26,viewBox:"0 0 26 26",width:26,xmlns:"http://www.w3.org/2000/svg",ref:t},e),cA||(cA=kr.createElement("g",{stroke:"#428dff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4},kr.createElement("path",{d:"m13 2v22"}),kr.createElement("path",{d:"m2 13h22"}))))},fA=(0,kr.forwardRef)(yA),vA=(0,kr.memo)(fA);function SA(){return SA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},SA.apply(null,arguments)}var EA=function(e,t){return kr.createElement("svg",SA({fill:"none",height:100,viewBox:"0 0 100 100",width:100,xmlns:"http://www.w3.org/2000/svg",ref:t},e),pA||(pA=kr.createElement("circle",{cx:50,cy:50,fill:"#fff",r:49.5,stroke:"#c7cdd6"})),gA||(gA=kr.createElement("g",{fill:"#619fff"},kr.createElement("path",{d:"m57.2608 62.7612c-2.0159 1.5341-4.5318 2.4449-7.2605 2.4449s-5.2446-.9108-7.2604-2.4449c-.4176-.3178-.8138-.6623-1.1859-1.0311-.146-.1447-.2884-.2931-.4268-.4451-.7192-.7894.3304-1.6178 1.2605-1.1484.0241.0122.0481.0252.072.0391.4596.2678.9347.5119 1.4236.7305 1.8681.8354 3.9383 1.2999 6.117 1.2999s4.2489-.4645 6.117-1.2999c.489-.2186.9641-.4627 1.4236-.7305.0239-.0139.048-.0269.0721-.0391.93-.4694 1.9796.359 1.2605 1.1484-.1385.152-.2808.3004-.4269.4451-.3721.3688-.7682.7133-1.1858 1.0311z"}),kr.createElement("path",{d:"m39 50c0-1.6569 1.1123-3 2.4845-3h.031c1.3722 0 2.4845 1.3431 2.4845 3s-1.1123 3-2.4845 3h-.031c-1.3722 0-2.4845-1.3431-2.4845-3z"}),kr.createElement("path",{d:"m58.4845 47c-1.3722 0-2.4845 1.3431-2.4845 3s1.1123 3 2.4845 3h.031c1.3722 0 2.4845-1.3431 2.4845-3s-1.1123-3-2.4845-3z"}),kr.createElement("path",{clipRule:"evenodd",d:"m50 75c13.8071 0 25-11.1929 25-25s-11.1929-25-25-25-25 11.1929-25 25 11.1929 25 25 25zm23-25c0 12.7026-10.2974 23-23 23-12.7025 0-23-10.2974-23-23 0-12.7025 10.2975-23 23-23 12.7026 0 23 10.2975 23 23z",fillRule:"evenodd"}))))},AA=(0,kr.forwardRef)(EA),CA=(0,kr.memo)(AA);const bA=()=>{const{state:e}=Tc(Vn.DOUBLE);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("double-img shrink-0 mx-auto",{enabled:!e.showDTDDescription}),"aria-hidden":!0,children:[(0,Cl.jsx)("div",{className:"double-img-user",children:(0,Cl.jsx)(CA,{className:"d-block",width:80,height:80})}),(0,Cl.jsx)("div",{className:"double-img-plus",children:(0,Cl.jsx)(vA,{className:"d-block",width:21,height:21})}),(0,Cl.jsx)("div",{className:"double-img-company",children:(0,Cl.jsx)(hA,{className:"d-block",width:80,height:80})})]})},PA=(0,kr.memo)(bA),NA={characterData:!0,childList:!0,subtree:!0},DA=e=>{let{currency:t,showDTDUpsell:n,isAlreadyPaidAmountNotMatched:i,showEmployerMatchedBlock:s,employer:a,minimumMatchedAmount:o,upsellTotal:r,DTDUpsellDoubledAmount:l,DTDDoubledAmount:c,isFeeCovered:u}=e;const d=(0,nc.t)(),h=(0,Bl.P)(),[m,p]=(0,kr.useState)(!1),g=(0,kr.useCallback)((e=>{const t=e.parentElement,n=e.firstChild;t&&n&&t.offsetHeight<=n.offsetHeight+44&&p(!0)}),[]),y=e=>d.formatAmount({currency:t,currencyFormat:Yt.SHORT,numberFormat:Kt.FLOAT,forceExplicit:!0,amount:e}),{mutableElementRef:f}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NA;const n=(0,kr.useRef)(null);return(0,kr.useEffect)((()=>{if(!(null==n?void 0:n.current)||!e)return;const i=new MutationObserver((()=>{e(n.current)}));return i.observe(n.current,t),()=>i.disconnect()}),[e,t,n]),{mutableElementRef:n}}(g),v=Zu(n||s||i);return(0,Cl.jsx)("div",{ref:f,className:(0,Ml.A)("p-rel",{"grow-1":!h&&m}),children:(n||s||i)&&(0,Cl.jsxs)("div",{ref:v,className:(0,Ml.A)("px-3 py-2-5 border border-gray-20 border-top-0 border-bottom-radius-8 focus-not-visible",{"p-abs inset-top-start inset-top-end":!h&&!m,"p-abs inset-0 scroll-box border-top-radius-0":!h&&m}),"data-qa":i?"dtd-is-already-paid-amount-not-matched-message":s?"dtd-employer-matched-message":"dtd-upsell-message","data-testid":(()=>{if(!i)return s?"dtd-employer-matched-message":"dtd-upsell-message"})(),children:[n&&!i&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("p",{className:"body-60-medium text-ellipsis",children:d.translate("doubleDonationScreen.nameMatch",{name:a.name,amount:y(o)})}),(0,Cl.jsx)("p",{className:"body-40-regular text-ellipsis mt-1",children:d.translate("doubleDonationScreen.message",{withCosts:u?d.translate("doubleDonationScreen.withCosts"):"",amount:y(r),doubleAmount:y(l)})})]}),s&&!i&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("p",{className:"body-60-medium text-ellipsis",children:d.translate("doubleDonationScreen.matchedCompanyBlock.name",{name:a.name})}),(0,Cl.jsx)("p",{className:"body-40-regular text-ellipsis mt-1",children:d.translate("doubleDonationScreen.matchedCompanyBlock.message",{doubleAmount:y(c)})})]}),i&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("p",{className:"body-60-medium text-ellipsis",children:d.translate("doubleDonationScreen.smallDonationAmountExperiment.name",{name:a.name})}),(0,Cl.jsx)("p",{className:"body-40-regular text-ellipsis mt-1",children:d.translate("doubleDonationScreen.smallDonationAmountExperiment.message")})]})]})})},TA=e=>{const{state:t,controller:n}=Tc(Vn.DOUBLE),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,Bl.P)(),o=(0,kr.useCallback)((()=>n.leave()),[n]),r=(0,kr.useCallback)((()=>n.acceptUpsell()),[n]);return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${s}`,"data-qa":"active-screen-dtd",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,title:i.translate("doubleDonationScreen.title"),a11yAutoFocus:a}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body d-flex flex-column",{"pt-6 pb-4":!a,"z-index-4":t.showDTDDescription,"overflow-hidden":!t.showDTDDescription}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[(0,Cl.jsx)(PA,{}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("grow-1 d-flex flex-column",a?"mt-6":"mt-4"),children:[(0,Cl.jsx)(sA,{showDTDDescription:t.showDTDDescription}),(0,Cl.jsx)(nA,{isIntegrationEnabled:t.isIntegrationEnabled,companies:t.companies,showEmployerMatchedBlock:t.showEmployerMatchedBlock,showDTDUpsell:t.showDTDUpsell,employer:t.employer,locked:t.locked,autoFocus:!0}),(0,Cl.jsx)(DA,{showDTDUpsell:t.showDTDUpsell,employer:t.employer,minimumMatchedAmount:t.minimumMatchedAmount,currency:t.currency,isFeeCovered:t.isFeeCovered,upsellTotal:t.upsellTotal,DTDUpsellDoubledAmount:t.DTDUpsellDoubledAmount,DTDDoubledAmount:t.DTDDoubledAmount,showEmployerMatchedBlock:t.showEmployerMatchedBlock,isAlreadyPaidAmountNotMatched:t.isAlreadyPaidAmountNotMatched})]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(eA,{buttonType:t.buttonType,processingState:t.processingState,formattedTotal:t.formattedTotal,frequency:t.frequency,locked:t.locked,formattedUpsellTotal:t.formattedUpsellTotal,declineButtonLabel:t.declineButtonLabel,changeAmountButtonLabel:t.changeAmountButtonLabel,noChangeAmountButtonLabel:t.noChangeAmountButtonLabel,showSkipButton:t.showSkipButton,isAlreadyPaidAmountNotMatched:t.isAlreadyPaidAmountNotMatched,onLeave:o,onAcceptUpsell:r,additionalPayErrorMessage:t.additionalPayErrorMessage,payErrorMessage:t.payErrorMessage})})]})},kA=(0,kr.memo)(TA),IA=()=>{const{stripeElementState:e,setStripeElementState:t}=Xv(),{stripeElementState:n,setStripeElementState:i}=Xv(),{stripeElementState:s,setStripeElementState:a}=Xv(),o=(0,kr.useCallback)(((e,n)=>{switch(e){case Bv.CARD_NUMBER:t(n);break;case Bv.CARD_EXPIRY:i(n);break;case Bv.CARD_CVC:a(n)}}),[t,a,i]);return{stripeElementsCardState:{[Bv.CARD_NUMBER]:e,[Bv.CARD_EXPIRY]:n,[Bv.CARD_CVC]:s},setStripeElementsCardState:o}},_A=()=>{const e=(0,nc.t)(),t=Kl();return(0,Cl.jsxs)("div",{className:(0,Ml.A)(t("payment-loader"),"p-abs inset-0 d-flex flex-column items-center justify-center p-8 bg-white"),children:[(0,Cl.jsx)(oh,{size:"lg"}),(0,Cl.jsx)("p",{className:"mt-6 body-60-regular text-center text-ellipsis max-w-100",children:e.translate("paymentLoader.text")})]})},OA=e=>{let{disabled:t,onClick:n}=e;const i=(0,nc.t)();return(0,Cl.jsxs)("button",{type:"button",className:"btn btn-black d-flex items-center justify-center",disabled:t,"aria-label":i.translate("paymentOptions.donateWithAriaLabel",{paymentMethod:i.translate("paymentOptions.applePay.label")}),onClick:n,"data-tracking-element-name":"paymentMethod-applePay","data-qa":"fast-track-apple-pay-button","data-testid":"fast-track-apple-pay-button",children:[(0,Cl.jsx)("span",{className:"text-truncate me-1-5","aria-hidden":!0,children:i.translate("paymentOptions.donateWith")}),(0,Cl.jsx)(ph,{width:50,height:26,className:"shrink-0","aria-hidden":!0})]})},xA=(0,kr.memo)(OA),wA=e=>{const{onClick:t,disabled:n}=e,{state:i}=Tc(Vn.FAST_TRACK_PAYMENT_OPTIONS),s=(0,nc.t)(),[a,o]=(0,kr.useState)(!1),r=(0,hd.D)((e=>o(e))),l=(0,kr.useCallback)((()=>i.livemode?t():(r.set([!0]),void r.set([!1],3e3))),[t,i.livemode,r]);return(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn p-rel d-flex items-center justify-center",a?"btn-testmode":"btn-black"),disabled:n,"aria-label":s.translate("paymentOptions.donateWithAriaLabel",{paymentMethod:s.translate("paymentOptions.googlePay.label")}),onClick:l,"data-tracking-element-name":"paymentMethod-googlePay","data-qa":"fast-track-google-pay-button","data-testid":"fast-track-google-pay-button",children:a?(0,Cl.jsx)("span",{role:"alert",children:s.translate("paymentOptions.googlePay.notAvailableInTestMode.oneLine")}):(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("span",{className:"text-truncate me-1-5","aria-hidden":!0,children:s.translate("paymentOptions.donateWith")}),(0,Cl.jsx)(Nh,{width:53,height:26,className:"shrink-0","aria-hidden":!0})]})})},RA=(0,kr.memo)(wA);var MA;!function(e){e.SILVER="silver",e.WHITE="white",e.GOLD="gold"}(MA||(MA={}));const{useAddFieldToScroll:LA,useScrollToFieldsTrigger:FA,ScrollToFieldsProvider:UA}=(0,Ud.J)(),jA="paymentMethod-paypal",BA=e=>{let{disabled:t}=e;const{state:n,controller:i}=Tc(Vn.FAST_TRACK_PAYMENT_OPTIONS),s=(0,nc.t)(),a=(0,kr.useRef)(null),[o,r]=(0,kr.useState)(!1),l=(0,hd.D)((e=>r(e))),c=Rc(),u=FA();(0,kr.useEffect)((()=>{if(a.current&&n.livemode)return i.initiatePaypal({element:a.current,buttonColor:MA.GOLD,onClick:()=>{a.current&&(u(),c.trackClick(jA,a.current))}}),()=>i.closePaypalButton()}),[i,n.livemode,c,u]);const d=(0,kr.useCallback)((()=>{n.livemode||(l.set([!0]),l.set([!1],3e3))}),[n.livemode,l]);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("btn p-rel px-1 d-flex items-center justify-center",{"btn-paypal-gold":!o,"btn-testmode":o,disabled:t}),role:n.livemode?void 0:"button",tabIndex:n.livemode?void 0:0,"aria-labelledby":"paypal-button",onClick:d,onKeyPress:d,"data-qa":"fast-track-paypal-button","data-testid":"fast-track-paypal-button",children:[(0,Cl.jsx)("div",{ref:a,id:"paypal-button",className:"p-abs inset-centered min-w-100 line-height-0","data-tracking-element-name":jA}),o?(0,Cl.jsx)("p",{className:"text-truncate",role:"alert",children:s.translate("paymentOptions.paypal.notAvailableInTestMode.oneLine")}):(0,Cl.jsx)(wh,{width:69,height:22,className:"shrink-0","aria-hidden":!0})]})},GA=(0,kr.memo)(BA),qA={[ch.APPLE_PAY]:xA,[ch.GOOGLE_PAY]:RA,[ch.PAYPAL]:GA},VA=e=>{let{option:t,show:n,locked:i,onClick:s}=e;const a=qA[t],o=(0,kr.useRef)(null),{saveTriggerElement:r}=kl(),l=(0,kr.useCallback)((()=>{if(o.current){const e=o.current.firstElementChild;e&&r(e)}s(t)}),[s,t,r]);return(0,Cl.jsx)("div",{ref:o,className:(0,Ml.A)({"d-none":!n}),children:(0,Cl.jsx)(a,{disabled:i,onClick:l})},t)},HA=e=>{let{availableOptions:t,buttonOptions:n,errorTitle:i,errorMessage:s,locked:a,onChoosePaymentOption:o,onErrorClick:r}=e;const l=(0,kr.useRef)(null),c=Boolean(i||s),u=(0,kr.useCallback)((e=>{e.preventDefault(),r()}),[r]);return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Ll.A,{nodeRef:l,in:c,timeout:0,classNames:"rtg-fade",mountOnEnter:!0,unmountOnExit:!0,children:(0,Cl.jsx)(yu,{setRef:l,type:"danger",className:"mb-3",children:(0,Cl.jsx)(ou,{errorTitle:i,errorMessage:s,dataQa:"fast-track-payment-option",dataTrackingElementName:"fast-track-payment-options-screen-back-button",onMessageClick:u})})}),(0,Cl.jsx)("div",{className:"d-flex flex-column gap-y-2",children:t.map((e=>{const{visible:t}=n[e];return(0,Cl.jsx)(VA,{option:e,show:t,locked:a,onClick:o},e)}))})]})},KA=(0,kr.memo)(HA),YA=["top","bottom"],zA=e=>{let{anonymousChecked:t,locked:n,className:i,dataTestId:s,onToggle:a}=e;const o=(0,nc.t)(),r=(0,gc.Q)(),l=(0,ql.wf)();return(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:t,disabled:n,onChange:a,dataQa:"anonymously-checkbox",trackingElement:"anonymousCheckbox",dataTestId:s,children:(0,Cl.jsx)("span",{className:"text-truncate",children:o.translate("privacyScreen.donateAnonymously.label")})}),(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!n&&o.translate("privacyScreen.donateAnonymously.tooltipLabel"),trigger:"click",placement:r?"left-start":"right-start",fallbackPlacements:YA,rootContainer:l,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:n,"aria-label":o.translate("privacyScreen.donateAnonymously.helpAriaLabel"),"data-qa":"anonymous-checkbox-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":r}),"aria-hidden":!0})})})})]})},WA=(0,kr.memo)(zA),$A=["top","bottom"],XA=e=>{let{generalConsent:t,locked:n,className:i,dataTestId:s,onToggle:a,onShowConsent:o}=e;const r=(0,nc.t)(),l=(0,gc.Q)(),c=(0,ql.wf)(),u=(0,Nl.n)(),{checkboxText:d}=u.campaign.config.consentText.general,{additionalInfoText:h}=u.campaign.config.consentText.general;return(0,kr.useEffect)((()=>{o()}),[o]),(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:t.isAccepted,disabled:n,onChange:a,dataQa:"general-consent-checkbox",trackingElement:"generalConsentCheckbox",dataTestId:s,children:(0,Cl.jsx)("span",{className:"text-truncate",dir:"auto",children:d?(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:d},"data-qa":"general-consent-text"}):r.translate("privacyScreen.generalConsent.label")})}),h&&(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!n&&(0,Cl.jsx)("p",{dangerouslySetInnerHTML:{__html:h},dir:"auto"}),trigger:"click",placement:l?"left-start":"right-start",fallbackPlacements:$A,maxWidth:"260px",maxHeight:"220px",rootContainer:c,"data-qa":"general-consent-checkbox-text-popover",children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:n,"aria-label":r.translate("privacyScreen.generalConsent.helpAriaLabel"),"data-qa":"general-consent-checkbox-help-button","data-testid":"general-consent-checkbox-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":l}),"aria-hidden":!0})})})})]})},QA=(0,kr.memo)(XA),ZA=["top","bottom"],JA=e=>{let{validation:t,onBehalfOf:n,className:i,locked:s,dataTestIdCheckbox:a,dataTestIdInput:o,onToggleOnBehalfOf:r,onChangeCompanyName:l}=e;var c;const u=(0,nc.t)(),d=(0,gc.Q)(),h=(0,kr.useId)(),m=(0,ql.wf)(),p=!t.onBehalfOf.isValid,g=t.onBehalfOf.fields.onBehalfOf.errors.required,y=t.onBehalfOf.fields.onBehalfOf.errors.minLength,[f,v]=(0,kr.useState)(!1),[S,E]=(0,kr.useState)(!1),A=(0,kr.useRef)(null);return LA(A,(e=>!e.onBehalfOf.isValid)),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex",i),children:[(0,Cl.jsx)(Fd,{checked:n.isActive,disabled:s,dataQa:"behalf-company-button",trackingElement:"showBehalfOfInput",dataTestId:a,onChange:()=>{r(),v(!0)},children:(0,Cl.jsx)("span",{className:"text-truncate",children:u.translate("privacyScreen.donateAsOrganization.label")})}),(0,Cl.jsx)("div",{className:"shrink-0 icon-slot icon-slot-18 ms-2",children:(0,Cl.jsx)(Zc.S,{content:!s&&u.translate("privacyScreen.donateAsOrganization.input.tooltipLabel"),trigger:"click",placement:d?"left-start":"right-start",fallbackPlacements:ZA,maxWidth:"220px",rootContainer:m,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon p-abs inset-centered text-gray-60 font-size-18",disabled:s,"aria-label":u.translate("privacyScreen.donateAsOrganization.input.helpAriaLabel"),"data-qa":"donate-as-organization-help-button",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":d}),"aria-hidden":!0})})})})]}),n.isActive&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8,sizeMin:4}),(0,Cl.jsx)(Kd.t,{id:`on-behalf-${h}`,setRef:A,label:u.translate("privacyScreen.donateAsOrganization.input.label"),labelFloating:!0,autoFocus:n.isActive&&f,autoFocusMode:vd.Q.ALL,className:(0,Ml.A)({"pe-10":p}),formLabelClass:(0,Ml.A)({"pe-6":p}),formGroupClass:"shrink-0",placeholder:u.translate("privacyScreen.donateAsOrganization.input.placeholder"),value:null!==(c=n.companyName)&&void 0!==c?c:"",maxLength:Xh.ON_BEHALF_OF_MAX_LENGTH,autoComplete:"organization",disabled:s,error:p,"aria-required":!0,"aria-describedby":`on-behalf-${h}-error`,dataQa:"behalf-company-field",dataTestId:o,onChange:e=>l(e.target.value),onFocus:()=>E(!0),onBlur:()=>E(!1),children:p&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:S,children:(0,Cl.jsxs)("p",{id:`on-behalf-${h}-error`,children:[g&&u.translate("privacyScreen.donateAsOrganization.input.error.required"),!g&&y&&u.translate("privacyScreen.donateAsOrganization.input.error.minLength")]})})})]})]})},eC=(0,kr.memo)(JA),tC=e=>{var t;const n=(0,Bl.P)(),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,kr.useRef)(null);return LA(a,(e=>!e.isAccepted.isValid)),(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Fd,{setRef:a,className:e.className,checked:null!==(t=e.termsAndConditions.isAccepted)&&void 0!==t&&t,error:!e.validation.isAccepted.isValid,disabled:e.locked,"aria-required":!0,"aria-describedby":`terms-checkbox-${s}-error`,onChange:e.onToggle,dataQa:"accept-terms-checkbox",trackingElement:"termsChecked",dataTestId:e.dataTestId,children:(0,Cl.jsx)("span",{className:(0,Ml.A)({"text-line-clamp-2":!n}),dir:"auto","data-qa":"accept-terms-text",children:e.termsAndConditions.text?(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:e.termsAndConditions.text},"data-qa":"accept-terms-link"}):(0,Cl.jsx)(fc,{token:"privacyScreen.terms.label"})})}),e.validation.isAccepted.fields.isAccepted.errors.required&&(0,Cl.jsx)("p",{id:`terms-checkbox-${s}-error`,className:"sr-only",children:i.translate("privacyScreen.terms.error.required")})]})},nC=(0,kr.memo)(tC),iC=e=>{let{currency:t,prefixCurrencySymbol:n,postfixCurrencySymbol:i,total:s,isRecurring:a,recurringLabel:o}=e;const r=(0,nc.t)(),l=(0,kr.useMemo)((()=>(0,Up.p)(t,r.locale)),[r.locale,t]);return(0,Cl.jsxs)("div",{className:"d-flex",children:[(0,Cl.jsx)("p",{className:"body-40-regular text-truncate me-4",children:r.translate("paymentMethodScreen.transactionCosts.total")}),(0,Cl.jsxs)("p",{className:"body-40-medium shrink-0 max-w-70 text-truncate ms-auto","data-qa":"donation-amount-label",children:[n&&(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif","aria-hidden":"true",children:n}),(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif",children:r.formatCurrency(s,{currency:t,display:"trimzeroes",withoutPrefix:!0,withoutSuffix:!0})}),i&&(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif","aria-hidden":"true",children:i}),(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif ms-0-5",children:l}),a&&(0,Cl.jsx)("span",{className:"d-inline-block",children:o})]})]})};var sC;!function(e){e.DEFAULT_YES="defaultYes",e.DEFAULT_NO="defaultNo",e.ONLY_YES="onlyYes",e.ONLY_NO="onlyNo",e.SMART_COVERING="smartCovering"}(sC||(sC={}));const aC=(e,t)=>{(0,kr.useEffect)((()=>{const n=null==e?void 0:e.current;if(n)return n.addEventListener("blur",t),()=>{n.removeEventListener("blur",t)}}),[e,t])},oC=["top","top-end","bottom","bottom-end"],rC=e=>{let{includeFees:t,isFeeCovered:n,currency:i,processingFee:s,showIncludeFee:a,locked:o,transitionEntered:r,isPaymentLoader:l,dataQa:c,dataTestId:u,toggleCheckbox:d}=e;const h=(0,nc.t)(),m=(0,gc.Q)(),p=(0,Bl.P)(),g=t!==sC.ONLY_NO,y=t===sC.ONLY_YES,f=(0,kr.useRef)(null),v=(0,kr.useRef)(null),S=(0,kr.useRef)(null),E=(0,ql.wf)(),A=[m?"right":"left","top"],C=ec(S),[b,P]=(0,kr.useState)(!1),{showHelpTooltip:N,helpTooltipRef:D,handleHelpTooltipKeyDown:T,handleHelpTooltipChecked:k}=function(e){const t=(0,kr.useRef)(null),[n,i]=(0,kr.useState)(!1),s=()=>{i((e=>!e))},a=()=>{i(!1)};return bu(t,a),aC(e,a),{helpTooltipRef:t,showHelpTooltip:n,handleHelpTooltipChecked:e=>{e.stopPropagation(),s()},handleHelpTooltipKeyDown:e=>{e.code!==Fl.J.ENTER&&e.code!==Fl.J.SPACE||(e.stopPropagation(),e.preventDefault(),s())}}}(v);(0,kr.useEffect)((()=>{P(!!f.current&&!n&&!N)}),[n,N]);const I=(0,Cl.jsxs)(Cl.Fragment,{children:[y&&h.translate("paymentMethodScreen.transactionCosts.tooltip.required"),a&&(0,Cl.jsx)(fc,{className:"fee-tooltip",token:"paymentMethodScreen.transactionCosts.tooltip.message",params:{processingFee:h.formatCurrency(s,{currency:i,display:"floatcents"})}})]});return(0,Cl.jsx)(Cl.Fragment,{children:g&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Zc.S,{content:h.translate("paymentMethodScreen.transactionCosts.tooltip.question"),trigger:"manual",manualOpen:r&&!l&&!o&&!p&&b,placement:m?"left":"right",fallbackPlacements:A,maxWidth:"220px",rootContainer:E,"data-qa":"cover-fee-tooltip",children:(0,Cl.jsxs)("div",{className:"d-flex items-center px-4 mx-minus-4","data-qa":c,"data-testid":u,children:[y&&(0,Cl.jsx)("p",{className:"body-40-regular text-truncate","data-qa":"fee-amount-text",children:h.translate("paymentMethodScreen.transactionCosts.included",{amount:h.formatCurrency(s,{currency:i,display:"floatcents"})})}),a&&(0,Cl.jsx)(Fd,{innerRef:f,className:"body-40-regular",customLabelClasses:"line-height-20",checked:n,disabled:o,onChange:d,dataQa:"cover-fee-checkbox",trackingElement:"coverFee",children:(0,Cl.jsx)("span",{className:"body-40-regular text-truncate",children:h.translate("paymentMethodScreen.transactionCosts.label")})}),(0,Cl.jsx)(Zc.S,{ref:D,content:I,trigger:"manual",manualOpen:r&&!o&&N,placement:m?"left":"right",fallbackPlacements:oC,maxWidth:"220px",rootContainer:E,"data-qa":"why-cover-fee-tooltip",children:(0,Cl.jsx)("button",{ref:v,type:"button",className:"btn-icon shrink-0 font-size-18 text-gray-60 ms-2","aria-label":h.translate("paymentMethodScreen.transactionCosts.helpAriaLabel"),disabled:o,onClick:k,onKeyDown:T,"data-qa":"transaction-cost-tip","data-testid":"transaction-cost-tip",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":m}),"aria-hidden":!0})})})]})}),(0,Cl.jsx)(Ll.A,{nodeRef:S,in:p&&a&&!n,mountOnEnter:!0,unmountOnExit:!0,addEndListener:C,classNames:"rtg-fee-accordion-mobile",children:(0,Cl.jsx)("p",{ref:S,className:"body-40-regular text-ellipsis mt-2",role:"alert","data-qa":"cover-fee-tooltip",children:h.translate("paymentMethodScreen.transactionCosts.tooltip.question")})}),(0,Cl.jsx)("hr",{className:"border-gray-15 mt-3 mb-2-5","aria-hidden":!0})]})})};function lC(){const e=Mc(),[t,n]=(0,kr.useState)(!1);return(0,kr.useEffect)((()=>e.onStateUpdate((()=>{n(e.checkoutUIState.showPaymentLoader)}))),[e]),t}const cC=e=>{let{transitionEntered:t}=e;const{state:n,controller:i}=Tc(Vn.FAST_TRACK_PAYMENT_OPTIONS),s=(0,nc.t)(),a=(0,kr.useId)(),o=(0,Bl.P)(),r=lC(),l=n.availableOptions,{returnFocusToTrigger:c}=kl(),u=(0,kr.useCallback)((()=>{i.toggleFeeCovered()}),[i]),d=FA(),h=(0,kr.useCallback)((e=>{i.choosePaymentOption(e,{onModalHide:()=>{c()}}),d()}),[i,d,c]),m=(0,kr.useCallback)((e=>i.changeCompanyName(e)),[i]),p=(0,kr.useCallback)((()=>i.toggleOnBehalfOf()),[i]),g=(0,kr.useCallback)((()=>i.toggleAnonymousChecked()),[i]),y=(0,kr.useCallback)((e=>i.toggleGeneralConsentChecked(e)),[i]),f=(0,kr.useCallback)((()=>i.toggleTermsAndConditionsAccepted()),[i]),v=(0,kr.useCallback)((()=>i.setGeneralConsentShown()),[i]),S=(0,kr.useCallback)((()=>{i.resetError(),i.goToPrivacyScreen()}),[i]);return(0,Cl.jsxs)("section",{className:"p-rel flow-screen","aria-labelledby":`screen-header-${a}`,"data-qa":"fast-track-payment-option-screen",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${a}`,title:s.translate("fastTrackPaymentOptionsScreen.title"),a11yAutoFocus:!0,onBackButtonClick:()=>i.resetError()}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-8":!o}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsxs)("div",{className:"bg-gray-10 border-radius-16 px-4 py-5",children:[(0,Cl.jsx)(rC,{showIncludeFee:n.showIncludeFee,isFeeCovered:n.isFeeCovered,locked:n.locked,processingFee:n.processingFee,currency:n.currency,toggleCheckbox:u,includeFees:n.includeFees,transitionEntered:t,isPaymentLoader:r,dataQa:"transaction-costs-lpo",dataTestId:"transaction-costs-lpo"}),(0,Cl.jsx)(iC,{prefixCurrencySymbol:n.prefixCurrencySymbol,postfixCurrencySymbol:n.postfixCurrencySymbol,currency:n.currency,total:n.total,isRecurring:n.isRecurring,recurringLabel:n.recurringLabel})]}),(0,Cl.jsx)(bc,{size:o?16:20}),n.onBehalfOf.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8}),(0,Cl.jsx)(eC,{onBehalfOf:n.onBehalfOf,locked:n.locked,validation:n.validation,dataTestIdCheckbox:"privacy-on-behalf-on-checkbox",dataTestIdInput:"privacy-on-behalf-on-input",onToggleOnBehalfOf:p,onChangeCompanyName:m})]}),n.showAnonymous&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8}),(0,Cl.jsx)(WA,{anonymousChecked:n.anonymousChecked,locked:n.locked,dataTestId:"privacy-anonymous-checkbox",onToggle:g})]}),n.generalConsent.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8}),(0,Cl.jsx)(QA,{generalConsent:n.generalConsent,locked:n.locked,dataTestId:"general-consent-checkbox",onToggle:y,onShowConsent:v})]}),n.termsAndConditions.isEnabled&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(bc,{size:8}),(0,Cl.jsx)(nC,{termsAndConditions:n.termsAndConditions,locked:n.locked,validation:n.validation,dataTestId:"privacy-terms-checkbox",onToggle:f})]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(KA,{availableOptions:l,buttonOptions:n.buttonOptions,errorTitle:n.paymentError.title,errorMessage:n.paymentError.message,locked:n.locked,onChoosePaymentOption:h,onErrorClick:S})}),r&&(0,Cl.jsx)(_A,{})]})};var uC;function dC(){return dC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dC.apply(null,arguments)}var hC=function(e,t){return kr.createElement("svg",dC({fill:"none",height:36,viewBox:"0 0 102 36",width:102,xmlns:"http://www.w3.org/2000/svg",ref:t},e),uC||(uC=kr.createElement("path",{d:"m51.768 17.256c2.83-4.4504 1.4109-5.1346 1.2663-5.0523-2.7532 1.5572-4.8499 6.2447-4.6739 7.806.243 2.1494 1.9046-.3916 3.4076-2.7537zm10.7215-4.0841c-.5126.9186-.8436 1.928-.9748 2.9726-.0724.522-.1568 2.7897-.1381 3.0979.0289.5006.0924.9985.1902 1.4902.0673.2455.4869 1.128-.8596 1.3145-.7923.1094-.7768-1.881-.7923-2.2068-.0304-.6942.0842-3.1333.1576-3.4953.0774-.3703-.077.0221-.2228.2645-.3357.564-.7264 1.3271-1.1943 2.0785-.6145.988-1.9851 3.3414-3.8543 3.2013-.6993-.0531-1.4106-.1435-1.8169-2.0999-.1558-.7499-.0954-1.7357-.0794-2.3275-.0195-.1219-.0029-.2617-.1045-.2047-.662 1.5506-2.8121 6.1205-5.2416 5.0932-1.1252-.4744-1.6796-1.9326-.4375-4.7802 1.2101-2.7754 4.2625-6.2172 5.4784-6.4483 1.0837-.2066 1.1964.3414 1.1964.3414.0988-.2022.7744-.1785.9222.1116.1974.388.3292.4552.1974 1.4787-.0746.5903-.6208 4.2824-.5265 5.551.0434.5945.145 2.0594.7469 2.1299 1.0514.1264 2.3256-2.1189 2.4703-2.3535.2832-.4587 2.5518-4.2769 2.8311-4.8344.3005-.6011.4905-1.04.6844-1.4226s.7783-.4251 1.2878-.0762c.5094.3489.2543.8285.0799 1.1244zm-48.0051 1.8703c-1.3339.1442-3.7659 3.3812-4.267 4.5307-.51231 1.1738-.69726 2.3054-.0893 2.7775 1.2581.9807 2.5596-.6817 2.9421-1.0681.2367-.2379 1.8919-2.0504 2.3081-3.8913.2752-1.2155.4026-2.4881-.8939-2.3488zm.6951 14.367c-.092.1652-.1866.3288-.2838.491-.9827 1.6379-2.2719 3.0993-3.8704 4.1527-2.1651 1.4262-4.1985 1.9741-6.47046 1.9467-1.32108-.0153-2.59509-.23-3.681415-.9237-.89044-.5686-1.017386-1.4576-.747703-2.0445.374914-.8176 1.545208-.738 2.043118-.2688 1.24319 1.1703 1.98527 1.6241 3.58363 1.5464 1.31769-.0756 2.60043-.4542 3.74914-1.1067 6.61179-3.8762 6.55139-10.8443 6.81979-15.043.0284-.2553-.1098-.0696-.1565.0694-.3191.8933-.7141 1.7575-1.1806 2.5828-.6777 1.2294-1.6366 2.2796-2.7977 3.0641-.8373.5552-2.1971.8239-3.15466.1973-.34712-.2287-2.37703-1.4216-.65659-4.9754 1.08192-2.2361 3.35855-3.7871 3.87215-4.116 1.2558-.8052 2.1532-1.1881 3.0942-1.1155.4792.035.5483.2244.9046.2149.2028-.239.3147-.4146.6484-.5072.4479-.0718.9798.3049 1.1844 1.0188.2045.7139-.3282 1.8607-.4627 2.4122.0011-.0003.4742 7.1534-2.4369 12.4045zm7.5328-16.1178c-.8104.0153-.7441.6025-.914 1.1162-.1644.5122-1.561 5.1182-1.7384 5.944-.1773.8258-.2989 1.5674-.0425 2.7007.2609 1.1585 1.5837.8199 1.724.6166.6462-.9086.0738-1.1763.053-1.8109-.0166-.6632.1643-1.359.3008-2.257.0486-.3201.146-1.7758.1939-1.9734.0539-.2134.5102-1.8343 1.1675-2.8201.2814-.4226.5291-1.5382-.7443-1.5161zm2.2057-5.38681c-.1108-.22866-.7137-.94895-1.5005-.38979-1.1705.83202.1791 1.98174.3958 2.5458.2167.564 1.3867 1.0366 1.2159-.07625-.0249-.16006.2108-1.41755-.1112-2.07976zm12.9236 5.42541c-.381.0852-1.1413.2392-1.6197.3201-.7243.122-1.1189.5793-1.0916 1.0415.0273.4656.186.6849.8323.5617.5843-.1109 1.083-.6097 1.5944-.6119 0 0-1.056 4.4695-1.1251 5.0684-.069.599-.3814 2.2376.2602 3.1673 1.4273 2.0695 4.2821-.3026 4.5489-.561.196-.191 1.9995-1.7787 2.6109-3.052.3097-.6462-.2176-.7889-.5746-.9208-.357-.1318-1.1112.0961-1.2166.5686-.2296 1.0266-2.7272 3.7958-3.9633 3.2406-1.4568-.6555 1.1712-7.9999 1.1712-7.9999.3134-.1412 1.9007-.5519 3.4034-.9398 1.7337-.4459 7.0324-1.4963 5.8365-3.0855-.5853-.77741-2.098.4065-2.6106.6543-1.8366.8842-6.3321 2.1822-6.3321 2.1822s.5837-2.6403.7726-3.1604c.217-.59528 1.0174-.98477 1.1339-2.04454.1374-1.23265-1.3416-1.79394-2.0476-.44437-.146.27699-.3472 1.04148-.367 1.06054-.1896.18293-1.8222.83736-3.4274 1.60566-.5059.24211-3.3795 1.29101-3.3848 1.28421.0039-.022.8725-2.78682 1.879-5.09342.6696-1.53371 1.613-3.66866 3.2844-4.10205 1.5653-.40504.8273 1.23173 1.5316 1.65719.8933.53934 1.4413-.14085 1.5781-.79132.1073-.50946.0789-3.18283-2.6284-2.9156001-2.5762.2550351-4.629 4.2029701-7.1673 11.5801001-.0273.0295-2.0434 1.3369-3.7148 1.6729-.8265.1658-1.1922.2376-1.3015.5335-.0902.2374-.1095.496-.0556.7442.0539.2483.1788.4753.3593.6534.4763.5707 4.198-1.9023 4.194-1.8852-.0759.1007-3.1294 11.7808-3.1539 11.9171-.1759.9727-1.1604 3.5375-1.1071 4.7017.0295.599.2633 1.8456 1.1223 1.79 1.7988.1185 1.4519-2.4185 1.331-2.8837-.2519-.9624 1.0403-7.3241 2.2-12.0124.2364-.9563.7222-2.5254.8067-2.8986.0487-.2687.1595-.5223.3235-.7403.1641-.218.3768-.3943.621-.5147 0 0 6.4662-3.05997 6.5263-3.04229.0005.00671-1.0325 3.69459-1.0325 3.69459zm44.3013 5.8385c1.252 1.1886 2.4972.4351 3.1381-.0832 1.9657-1.5869 6.0185-8.8192 6.0185-8.8192.0231.242-1.6887 8.5367.5998 9.4564 1.4675.5884 4.8829-2.337 5.274-2.6078 2.2551-1.5627.8733-2.1342.4383-2.1342-1.1629-.0037-.9535.8416-1.2716 1.2212-.5246.6271-2.6332 2.8049-3.6656 2.2267-.556-.3128-.4188-2.1555-.3634-2.5802.3249-4.3903.4117-5.183.6665-6.19282.1427-.56129.8239-.5465 1.241-.62333 5.6306-1.04438 6.6405-.62318 7.3425-.96679.557-.27515.657-1.45962-.133-1.71435-.362-.11418-.82.16219-1.6491.47256-.8247.30595-4.9793 1.22823-5.5903 1.31923-.5628.08171-.6833.00214-.82-.17485-.1345-.17515.1245-2.23525.9316-3.9429.3512-.73904.3605-1.87-.7863-1.9575-.4716-.034-.8722.10076-1.0514.50427-.1784.40093-.522 4.05953-.6023 4.30313-.0813.24055-.5163.42836-.6124.84589-.0962.41754-.0292.67807-.3091.77197-.2829.0965-1.0576.17119-1.3763.24817-.3354.08202-.5344.72609-.5467 1.0985-.0123.37242.5862.15107.8748.10884.3295-.04817 1.1352-.45229.5619.24058-.2173.2648-4.1258 6.3984-5.6521 7.6614-1.7563 1.4514-1.6307-1.4025-1.5869-1.8886.2655-2.9104 1.5337-4.8629 1.7159-5.3263.1792-.4657.2547-1.84563-1.2425-1.54075-.1745.04422-.3349.13231-.4661.25598s-.2288.27885-.2838.45089c-.0025.00999-.0039.0202-.0044.03049-.1505 1.36019-2.7506 7.47449-.7896 9.33709zm2.2821-14.24048c.4614.90306 1.2496.58369 1.3838.35061.1347-.23125.2422-.27927.6244-.43385.7017-.28141-.5099-1.54576-1.6624-1.18904-.0741.03234-.1379.08452-.1844.15082s-.074.14418-.0794.2251c.0313.26464-.239.59437-.082.89681zm-14.1346 7.09688s.7563-.6542 1.0766-.6373c.1486.0073-.1106.4206.4091.6759.276.1372-.3019 1.9828-1.4444 3.7543-2.6238 4.0675-3.8678 3.8839-3.9757 2.6486-.2219-2.5774 3.1735-5.9166 3.9344-6.4415zm1.332 3.3348s-.0097.8764.0583 1.6257c.0607.6726.2897 2.0799.5257 2.5351.3657.7012 1.141.7012 1.7381.3576.7815-.4508.4119-1.2939.1143-1.5745-.2598-.2472-.8912-.5641-1.0824-1.6228-.1125-.6267-.0205-3.4508.1645-4.4388.1915-.9067.4776-1.7907.8535-2.63723.3113-.61662 2.1866-4.14733 2.2141-5.33256.0114-.51723-.5193-.94605-1.3865-.85642-.8672.08964-1.083.78676-1.0845 1.24378-.0021.45442-.9204 3.65448-.9679 3.80006-.0759.2186-.2264 1.52884-.6744 1.53173-.9977-.01753-1.9712.30954-2.7574.92654-.4321.3287-1.8994 1.4746-2.7465 2.6702-.3843.5411-2.1316 2.7961-1.9341 5.4879.18 2.4476 1.8859 2.0145 2.3753 1.936 2.2262-.359 3.7915-4.035 4.0182-4.4858.401-.8001.2654-.5849.5715-1.1665zm-8.7702-8.94233c-.1631.20122-.1224.8398.2328 1.16999.2674.24894.3048.29482.3134.49604.0152.37105.2512.39163.6146.38644.4444-.0064.8078-.31601.8527-.94605.045-.63004-.563-1.16892-1.0524-1.29027-.4894-.12134-.7495-.07942-.9611.18385z",fill:"#000"})))},mC=(0,kr.forwardRef)(hC),pC=(0,kr.memo)(mC);const gC=()=>{const{state:e}=Tc(Vn.GIFT_AID),t=(0,Bl.P)(),n=(0,kr.useRef)(null),i=oS(n);return(0,Cl.jsx)("div",{className:"p-rel grow-1","data-qa":"legal-text",children:(0,Cl.jsx)("div",{ref:n,className:(0,Ml.A)({"border-top border-gray-20":!i||t,"p-abs inset-0":!t,"scroll-box":i,"pointer-events-none":e.locked}),children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular text-gray-80 text-ellipsis",i?"px-3 py-2-5":"pt-4-5"),dangerouslySetInnerHTML:{__html:e.legalText}})})})},yC=(0,kr.memo)(gC),fC={boxShadow:"inset 0 0 0 1px #c7cdd6"},vC={boxShadow:"inset 0 -1px 0 0 #c7cdd6"},SC=e=>{let{className:t,email:n,name:i}=e;const s=(0,nc.t)();return(0,Cl.jsxs)("div",{className:t,children:[(0,Cl.jsx)("p",{className:"text-center text-truncate",children:s.translate("idealConfirmationScreen.description")}),(0,Cl.jsxs)("div",{className:"bg-white border-radius-8 mt-5",style:fC,children:[(0,Cl.jsxs)("div",{className:"px-3 py-2",style:vC,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("idealConfirmationScreen.email")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate",children:n})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("idealConfirmationScreen.name")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate",children:i})]})]})]})},EC=(0,kr.memo)(SC);var AC;function CC(){return CC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},CC.apply(null,arguments)}var bC,PC,NC,DC,TC,kC,IC=function(e,t){return kr.createElement("svg",CC({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),AC||(AC=kr.createElement("path",{d:"m5 9.00002v7.99998m4.5-7.99998v7.99998m5-7.99998v7.99998m4.5-7.99998v7.99998m-16 1.6v.8c0 .5601 0 .8401.10899 1.054.09588.1882.24886.3412.43702.437.21391.109.49394.109 1.05399.109h14.8c.5601 0 .8401 0 1.054-.109.1882-.0958.3411-.2488.437-.437.109-.2139.109-.4939.109-1.054v-.8c0-.56 0-.8401-.109-1.054-.0959-.1881-.2488-.3411-.437-.437-.2139-.109-.4939-.109-1.054-.109h-14.8c-.56005 0-.84008 0-1.05399.109-.18816.0959-.34114.2489-.43702.437-.10899.2139-.10899.494-.10899 1.054zm8.6529-15.52285-7.39999 1.64445c-.44706.09934-.67059.14902-.83745.26922-.14717.10603-.26273.2501-.33431.41677-.08115.18895-.08115.41794-.08115.8759v1.11653c0 .56005 0 .84008.10899 1.05399.09588.18816.24886.34114.43702.43702.21391.10899.49394.10899 1.05399.10899h14.8c.5601 0 .8401 0 1.054-.10899.1882-.09588.3411-.24886.437-.43702.109-.21391.109-.49394.109-1.05399v-1.11653c0-.45796 0-.68694-.0812-.8759-.0715-.16667-.1871-.31074-.3343-.41677-.1668-.1202-.3903-.16988-.8374-.26922l-7.4-1.64445c-.1295-.02878-.1943-.04317-.2597-.04891-.0582-.0051-.1166-.0051-.1748 0-.0654.00574-.1302.02013-.2597.04891z",stroke:"currentColor",strokeLinecap:"round"})))},_C=(0,kr.forwardRef)(IC),OC=(0,kr.memo)(_C);function xC(){return xC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xC.apply(null,arguments)}var wC=function(e,t){return kr.createElement("svg",xC({fill:"none",height:28,viewBox:"0 0 28 28",width:28,xmlns:"http://www.w3.org/2000/svg",ref:t},e),bC||(bC=kr.createElement("path",{d:"m0 2.99597v21.02063c0 1.0062.82326 1.8294 1.82947 1.8294h12.55933c9.4949 0 13.6112-5.3146 13.6112-12.3672 0-7.01599-4.1163-12.3123-13.6112-12.3123h-12.55933c-1.00621 0-1.82947.82326-1.82947 1.82947z",fill:"#fff"})),PC||(PC=kr.createElement("path",{d:"m8.40625 6.32564v15.53216h6.75985c6.1379 0 8.7998-3.4668 8.7998-8.3698 0-4.69257-2.6619-8.33321-8.7998-8.33321h-5.58899c-.64946 0-1.17086.53054-1.17086 1.17085z",fill:"#c06"})),NC||(NC=kr.createElement("path",{d:"m14.3891 24.1721h-10.92187c-.96962 0-1.75629-.7867-1.75629-1.7563v-17.8099c0-.96962.78667-1.75629 1.75629-1.75629h10.92187c10.364 0 11.9099 6.66841 11.9099 10.63839 0 6.8879-4.2352 10.6841-11.9099 10.6841zm-10.92187-20.73706c-.64946 0-1.17086.5214-1.17086 1.17086v17.8099c0 .6494.5214 1.1708 1.17086 1.1708h10.92187c7.2996 0 11.3244-3.5857 11.3244-10.0986 0-8.74489-7.0983-10.05296-11.3244-10.05296z",fill:"#000"})),DC||(DC=kr.createElement("g",{fill:"#fff"},kr.createElement("path",{d:"m10.7856 11.3934c.2378 0 .4574.0366.6678.1098s.3842.1921.5397.3384c.1463.1555.2652.3476.3567.5672.0823.2287.1281.4939.1281.8049 0 .2745-.0366.5214-.1006.7501-.0732.2287-.1738.43-.3111.5946-.1372.1647-.311.2927-.5214.3933-.2103.0915-.4573.1464-.7409.1464h-1.60078v-3.7138h1.58248zm-.0549 3.0278c.1189 0 .2287-.0183.3476-.0549.1098-.0366.2104-.1006.2927-.1921.0824-.0915.1555-.2012.2104-.3476.0549-.1463.0824-.311.0824-.5214 0-.1829-.0183-.3567-.0549-.5031-.0366-.1463-.1006-.2836-.183-.3842-.0823-.1006-.1921-.1921-.3293-.247-.1372-.0548-.3018-.0823-.5031-.0823h-.5854v2.3417h.7226z"}),kr.createElement("path",{d:"m15.7795 11.3934v.6861h-1.9576v.7958h1.8021v.6312h-1.8021v.9055h2.0033v.6861h-2.8174v-3.7138h2.7717z"}),kr.createElement("path",{d:"m18.5784 11.3936 1.3904 3.7138h-.8507l-.2836-.8233h-1.3904l-.2927.8233h-.8233l1.3996-3.7138zm.0457 2.2776-.4665-1.3629h-.0092l-.4848 1.3629z"}),kr.createElement("path",{d:"m21.2965 11.3936v3.0277h1.8112v.6861h-2.6253v-3.7138z"}))),TC||(TC=kr.createElement("path",{d:"m5.35118 14.9607c.94471 0 1.71055-.7659 1.71055-1.7106s-.76584-1.7105-1.71055-1.7105-1.71056.7658-1.71056 1.7105.76585 1.7106 1.71056 1.7106z",fill:"#000"})),kC||(kC=kr.createElement("path",{d:"m6.64143 21.8579c-1.43613 0-2.5887-1.1617-2.5887-2.5887v-2.0215c0-.7135.57629-1.299 1.29893-1.299.71349 0 1.29892.5763 1.29892 1.299v4.6102z",fill:"#000"})))},RC=(0,kr.forwardRef)(wC),MC=(0,kr.memo)(RC);const LC=e=>{let{className:t}=e;const n=(0,nc.t)();return(0,Cl.jsxs)("div",{className:t,children:[(0,Cl.jsxs)("div",{className:"d-flex items-center justify-center","aria-hidden":!0,children:[(0,Cl.jsx)("div",{className:"ideal-img-logo",children:(0,Cl.jsx)(MC,{className:"icon d-block"})}),(0,Cl.jsx)("div",{className:"ideal-img-bank",children:(0,Cl.jsx)(OC,{className:"icon-stroke d-block"})})]}),(0,Cl.jsx)("p",{className:"text-center mt-8",children:n.translate("idealConfirmationScreen.returnInfoLabel")})]})},FC=(0,kr.memo)(LC),UC=e=>{let{className:t,locked:n}=e;const i=(0,Bl.P)();return(0,Cl.jsx)("div",{className:(0,Ml.A)("p-rel",t),children:(0,Cl.jsx)("div",{className:(0,Ml.A)({"p-abs inset-0 scroll-box":!i}),children:(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-20-regular text-gray-80 text-ellipsis",{"px-3 py-2-5":!i,"pointer-events-none":n}),as:"p",token:"idealConfirmationScreen.legalInformation"})})})},jC=(0,kr.memo)(UC);var BC;!function(e){e.VISA="visa",e.MASTERCARD="mastercard",e.AMEX="amex",e.DISCOVER="discover",e.DINERS="diners",e.JCB="jcb",e.UNIONPAY="unionpay",e.UNKNOWN="unknown",e.UNKNOWN_ERROR="unknown-error"}(BC||(BC={}));const GC={visa:BC.VISA,mastercard:BC.MASTERCARD,amex:BC.AMEX,discover:BC.DISCOVER,diners:BC.DINERS,jcb:BC.JCB,unionpay:BC.UNIONPAY,unknown:BC.UNKNOWN};var qC;function VC(){return VC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},VC.apply(null,arguments)}var HC=function(e,t){return kr.createElement("svg",VC({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",strokeWidth:1.4,ref:t},e),qC||(qC=kr.createElement("path",{d:"m16 16v2.8c0 1.1201 0 1.6802-.218 2.108-.1917.3763-.4977.6823-.874.874-.4278.218-.9879.218-2.108.218h-7.6c-1.1201 0-1.68016 0-2.10798-.218-.37633-.1917-.68229-.4977-.87403-.874-.21799-.4278-.21799-.9879-.21799-2.108v-7.6c0-1.1201 0-1.68016.21799-2.10798.19174-.37633.4977-.68229.87403-.87403.42782-.21799.98788-.21799 2.10798-.21799h2.8m3.2 8h7.6c1.1201 0 1.6802 0 2.108-.218.3763-.1917.6823-.4977.874-.874.218-.4278.218-.9879.218-2.108v-7.6c0-1.1201 0-1.68016-.218-2.10798-.1917-.37633-.4977-.68229-.874-.87403-.4278-.21799-.9879-.21799-2.108-.21799h-7.6c-1.1201 0-1.68016 0-2.10798.21799-.37633.19174-.68229.4977-.87403.87403-.21799.42782-.21799.98787-.21799 2.10798v7.6c0 1.1201 0 1.6802.21799 2.108.19174.3763.4977.6823.87403.874.42782.218.98788.218 2.10798.218z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})))},KC=(0,kr.forwardRef)(HC),YC=(0,kr.memo)(KC);const zC=e=>{let{isBottomPlacement:t,locked:n}=e;const i=(0,nc.t)(),s=(0,Bl.P)(),a=(0,kr.useRef)(null),o=(0,Il.M)();return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("div",{className:"test-mode-tooltip-stripes p-abs inset-0 border-radius-8 z-index-1 overflow-hidden"}),(0,Cl.jsx)("p",{className:"text-gray-80 mt-1",children:i.translate("creditCard.testModeTooltip.instructions")}),(0,Cl.jsxs)("div",{className:"d-flex items-center mt-1",children:[(0,Cl.jsxs)("p",{ref:a,className:"body-40-medium text-sans-serif text-select-all","data-qa":"testmode-tooltip-card-number",children:["4242",(0,Cl.jsx)("span",{className:"text-transparent",children:"."}),"4242",(0,Cl.jsx)("span",{className:"text-transparent",children:"."}),"4242",(0,Cl.jsx)("span",{className:"text-transparent",children:"."}),"4242"]}),!s&&(0,Cl.jsx)("button",{type:"button",className:"btn-icon text-gray-40 ms-1-5",disabled:n,"aria-label":i.translate("creditCard.testModeTooltip.copyAriaLabel"),"data-qa":"testmode-tooltip-copy-button",onClick:()=>{var e;if(!a.current)throw new Error("Number ref is not defined");null===(e=o.getSelection())||void 0===e||e.selectAllChildren(a.current);try{o.document.execCommand("copy"),setTimeout((()=>{var e;null===(e=o.getSelection())||void 0===e||e.removeAllRanges()}),2e3)}catch(e){}},children:(0,Cl.jsx)(YC,{className:"icon-stroke icon-stroke-2 d-block","aria-hidden":!0})})]}),(0,Cl.jsxs)("div",{className:"d-flex flex-wrap items-center gap-x-4 gap-y-1 mt-0-5",children:[(0,Cl.jsxs)("p",{children:[(0,Cl.jsx)("span",{className:"text-gray-80 me-1",children:i.translate("creditCard.testModeTooltip.expireDate")}),(0,Cl.jsxs)("b",{className:"body-40-medium text-sans-serif text-select-all","data-qa":"testmode-tooltip-expire",children:["04/",((new Date).getFullYear()+2).toString().slice(-2)]})]}),(0,Cl.jsxs)("p",{children:[(0,Cl.jsx)("span",{className:"text-gray-80 me-1",children:i.translate("creditCard.testModeTooltip.cvc")}),(0,Cl.jsx)("b",{className:"body-40-medium text-sans-serif text-select-all","data-qa":"testmode-tooltip-cvc",children:"000"})]})]})]})},WC=(0,kr.memo)(zC),{ScrollToFieldsProvider:$C,useAddFieldToScroll:XC,useScrollToFieldsTrigger:QC,useFakeStripeElement:ZC}=(0,Ud.J)(),JC=["top","bottom"],eb=e=>{const{isReady:t,locked:i,stripeElementsCardState:s,setStripeElementsCardState:a}=e,{state:o,controller:r}=Tc(Vn.PAYMENT_OPTIONS),l=(0,nc.t)(),c=(0,gc.Q)(),h=(0,kr.useId)(),m=(0,Vv.j)(),p=(0,Zl.$)(),g=(0,Wv.l)(qv.bG.SAFARI,18),y=zv({paymentMethod:Gn.CARD}),[f,v]=(0,kr.useState)(),S=$d(o.shakeKey,0!==o.shakeKey),E=(0,kr.useRef)(null),A=(0,kr.useRef)(null),C=(0,kr.useRef)(null),b=(0,ql.wf)(),P=[c?"right":"left","top-end"],{isStripeLinkCheckoutExperimentTestGroupEnabled:N}={isStripeLinkCheckoutExperimentTestGroupEnabled:Uc().get(u.STRIPE_LINK_CHECKOUT_EXPERIMENT).isTestGroup},[D,T]=(0,kr.useState)(!1),[k,I]=(0,kr.useState)(BC.UNKNOWN),_=(0,kr.useRef)(!1),O=(0,Il.M)(),x=ZC({scrollIntoView:e=>{var t;return null===(t=E.current)||void 0===t?void 0:t.scrollIntoView(e)},focus:()=>{var e;return null===(e=null==f?void 0:f.getElement(Bv.CARD_NUMBER))||void 0===e?void 0:e.focus()}}),w=ZC({scrollIntoView:e=>{var t;return null===(t=A.current)||void 0===t?void 0:t.scrollIntoView(e)},focus:()=>{var e;return null===(e=null==f?void 0:f.getElement(Bv.CARD_EXPIRY))||void 0===e?void 0:e.focus()}}),R=ZC({scrollIntoView:e=>{var t;return null===(t=C.current)||void 0===t?void 0:t.scrollIntoView(e)},focus:()=>{var e;return null===(e=null==f?void 0:f.getElement(Bv.CARD_CVC))||void 0===e?void 0:e.focus()}});return XC(x,(e=>Boolean(e.cardNumber.error)||e.cardNumber.isEmpty)),XC(w,(e=>Boolean(e.cardExpiry.error)||e.cardExpiry.isEmpty)),XC(R,(e=>Boolean(e.cardCvc.error)||e.cardCvc.isEmpty)),(0,kr.useEffect)((()=>{(0,d.sH)(void 0,void 0,void 0,(function*(){if(p)return;if(!E.current||!A.current||!C.current)throw new Error("Card containers are not provided");const{stripeElements:e}=yield r.initiateCreditCard({source:Gv.PAYMENT_OPTIONS,onCardElementReady:e=>{a(e,(e=>Object.assign(Object.assign({},e),{isReady:!0})))},cardCvcContainer:C.current,cardExpiryContainer:A.current,cardNumberContainer:E.current,cardNumberOptions:{placeholder:"1234 1234 1234 1234",showIcon:!1},cardCvcOptions:{placeholder:"123"},stripeElementStyleOverride:Object.assign(Object.assign({},il),{base:Object.assign(Object.assign({},il.base),{"::placeholder":{color:"transparent"}}),invalid:Object.assign(Object.assign({},il.invalid),{color:"#222832",":focus":{color:"#222832"},"::placeholder":{color:"transparent"}})})});v(e)}))}),[r,p,a]),(0,kr.useEffect)((()=>{const e=null==f?void 0:f.getElement(Bv.CARD_NUMBER),t=null==f?void 0:f.getElement(Bv.CARD_EXPIRY),n=null==f?void 0:f.getElement(Bv.CARD_CVC);e&&t&&n&&(e.update({disabled:i}),t.update({disabled:i}),n.update({disabled:i}))}),[i,f]),(0,kr.useEffect)((()=>{if(!s.cardNumber.isReady||!f||!t)return;const e=f.getElement(Bv.CARD_NUMBER),n=f.getElement(Bv.CARD_EXPIRY),i=f.getElement(Bv.CARD_CVC);if(!e||!n||!i){if(p)return;throw new Error("Card elements are not initialized")}const o={[Bv.CARD_NUMBER]:!1,[Bv.CARD_EXPIRY]:!1,[Bv.CARD_CVC]:!1},l={[Bv.CARD_NUMBER]:e,[Bv.CARD_EXPIRY]:n,[Bv.CARD_CVC]:i};function c(e){if(r.changeCardFilledFields(e.elementType,e.complete),e.elementType===Bv.CARD_NUMBER&&(e.error?I(BC.UNKNOWN_ERROR):I(GC[e.brand]||BC.UNKNOWN)),a(e.elementType,(t=>{var n;return Object.assign(Object.assign({},t),{isEmpty:e.empty,error:(null===(n=e.error)||void 0===n?void 0:n.message)||null})})),!e.complete)return void(o[e.elementType]=!1);o[e.elementType]=!0;const[t]=Object.entries(o).find((e=>{let[,t]=e;return!t}))||[];t&&(g||l[t].focus())}const u=e=>{T(!0),_.current?O.document.dispatchEvent(new Event("stripeElementEvent")):_.current=!0,a(e.elementType,(e=>Object.assign(Object.assign({},e),{isFocused:!0})))},d=e=>{a(e.elementType,(e=>Object.assign(Object.assign({},e),{isFocused:!1})))};return e.on("focus",u),n.on("focus",u),i.on("focus",u),m||g||_.current||e.focus(),e.on("change",c),n.on("change",c),i.on("change",c),e.on("blur",d),n.on("blur",d),i.on("blur",d),()=>{e.off("change",c),n.off("change",c),i.off("change",c),e.off("focus",u),n.off("focus",u),i.off("focus",u),e.off("blur",d),n.off("blur",d),i.off("blur",d)}}),[r,O.document,p,a,f,s.cardNumber.isReady,t,m,g]),(0,Cl.jsx)(Zc.S,{content:(0,Cl.jsx)(WC,{locked:o.locked}),trigger:"manual",manualOpen:t&&!i&&!o.locked&&o.showTestModeTooltipInfo,placement:c?"left":"right",fallbackPlacements:P,maxWidth:"220px",rootContainer:b,children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("group-stacked-vertical group-shadow",{shake:S}),"data-qa":"payment-information-block",role:"group",children:[(0,Cl.jsxs)(Hh.s,{htmlFor:`card-number-${h}`,label:l.translate("creditCard.numberInput.label"),labelFloating:!0,formGroupClass:(0,Ml.A)("group-stacked-item",{"pointer-events-none":o.locked||i,"has-stripe-link":N}),formLabelClass:(0,Ml.A)({"has-value":!s[Bv.CARD_NUMBER].isEmpty,"has-error":null!==s[Bv.CARD_NUMBER].error}),dataQa:"card-number-label",children:[(0,Cl.jsx)("div",{ref:E,id:`card-number-${h}`,className:"StripeElement has-label-floating",onClick:y}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("p-abs inset-centered-end d-flex items-center z-index-5",{"me-2-5":!N,"me-4":N&&s[Bv.CARD_NUMBER].error,"d-none":N&&!s[Bv.CARD_NUMBER].error}),children:[s[Bv.CARD_NUMBER].error&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&(0,Cl.jsx)(fu.U,{className:(0,Ml.A)("shrink-0",{"me-2":!N}),showTooltip:s.cardNumber.isFocused,tooltipDataQa:"card-number",children:s[Bv.CARD_NUMBER].error}),(0,Cl.jsx)("p",{role:"alert",className:"sr-only",children:s[Bv.CARD_NUMBER].error})]}),(0,Cl.jsx)("img",{className:(0,Ml.A)("shrink-0 pointer-events-none",{"d-none":N}),src:n(534)(`./card-${k}.png`),width:30,height:20,alt:k,"aria-hidden":!0})]})]}),(0,Cl.jsxs)("div",{className:"group-stacked-item group-stacked-horizontal",children:[(0,Cl.jsxs)(Hh.s,{htmlFor:`expiration-${h}`,label:l.translate("creditCard.expirationDate.label"),labelFloating:!0,formGroupClass:(0,Ml.A)("group-stacked-item",{"pointer-events-none":o.locked||i}),formLabelClass:(0,Ml.A)({"has-value":!s[Bv.CARD_EXPIRY].isEmpty,"has-error pe-6":null!==s[Bv.CARD_EXPIRY].error}),dataQa:"expiration-label",children:[(0,Cl.jsx)("div",{ref:A,id:`expiration-${h}`,className:"StripeElement has-label-floating",onClick:y}),s[Bv.CARD_EXPIRY].error&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:s.cardExpiry.isFocused,tooltipDataQa:"card-expiry",children:s[Bv.CARD_EXPIRY].error}),(0,Cl.jsx)("p",{role:"alert",className:"sr-only",children:s[Bv.CARD_EXPIRY].error})]})]}),(0,Cl.jsxs)(Hh.s,{htmlFor:`cvc-${h}`,label:l.translate("creditCard.cvcCode.label"),labelFloating:!0,formGroupClass:(0,Ml.A)("group-stacked-item",{"pointer-events-none":o.locked||i}),formLabelClass:(0,Ml.A)({"has-value":!s[Bv.CARD_CVC].isEmpty,"has-error pe-12":null!==s[Bv.CARD_CVC].error}),dataQa:"cvc-label",children:[(0,Cl.jsx)("div",{ref:C,id:`cvc-${h}`,className:"StripeElement has-label-floating",onClick:y}),(0,Cl.jsxs)("div",{className:"p-abs inset-centered-end d-flex items-center z-index-5 me-4","data-qa":"cvc-wrapper",children:[s[Bv.CARD_CVC].error&&(0,Cl.jsxs)(Cl.Fragment,{children:[t&&(0,Cl.jsx)(fu.U,{className:"shrink-0 me-2",showTooltip:s.cardCvc.isFocused,tooltipDataQa:"card-cvc",children:s[Bv.CARD_CVC].error}),(0,Cl.jsx)("p",{role:"alert",className:"sr-only",children:s[Bv.CARD_CVC].error})]}),(0,Cl.jsx)(Zc.S,{content:!o.locked&&!i&&t&&!D&&l.translate("creditCard.cvcCode.tooltipLabel"),trigger:"click",placement:c?"left-start":"right-start",fallbackPlacements:JC,rootContainer:b,children:(0,Cl.jsx)("button",{type:"button",className:"btn-icon font-size-18 text-gray-60",disabled:o.locked||i,"aria-label":l.translate("creditCard.cvcCode.helpAriaLabel"),"data-qa":"cvc-help-button",onClick:()=>T(!1),children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":c}),"aria-hidden":!0})})})]})]})]})]})})},tb=(0,kr.memo)(eb);function nb(e){switch(e){case ch.CARD:case ch.APPLE_PAY:case ch.GOOGLE_PAY:case ch.SEPA:case ch.PAYPAL:case ch.AU_BECS:case ch.UK_BACS:case ch.VENMO:case ch.ACSS:case ch.IDEAL:return e;case ch.US_BANK_ACCOUNT:case ch.US_BANK_ACCOUNT_INSTANT:case ch.US_BANK_ACCOUNT_VERIFICATION:return ch.US_BANK_ACCOUNT;default:throw new Bs.HP(e)}}var ib,sb,ab,ob,rb;function lb(){return lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},lb.apply(null,arguments)}var cb,ub,db,hb,mb,pb=function(e,t){return kr.createElement("svg",lb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",strokeWidth:1.4,xmlns:"http://www.w3.org/2000/svg",ref:t},e),ib||(ib=kr.createElement("path",{d:"M12 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),sb||(sb=kr.createElement("path",{d:"M7 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),ab||(ab=kr.createElement("path",{d:"M17 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),ob||(ob=kr.createElement("path",{d:"M12 2L4 7.5H20L12 2Z",stroke:"#2F2F39",strokeLinejoin:"round"})),rb||(rb=kr.createElement("path",{d:"M4 21H20",stroke:"#2F2F39",strokeLinecap:"round"})))},gb=(0,kr.forwardRef)(pb),yb=(0,kr.memo)(gb);function fb(){return fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fb.apply(null,arguments)}var vb,Sb,Eb=function(e,t){return kr.createElement("svg",fb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",strokeWidth:1.4,xmlns:"http://www.w3.org/2000/svg",ref:t},e),cb||(cb=kr.createElement("path",{d:"M12 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),ub||(ub=kr.createElement("path",{d:"M7 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),db||(db=kr.createElement("path",{d:"M17 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),hb||(hb=kr.createElement("path",{d:"M12 2L4 7.5H20L12 2Z",stroke:"#2F2F39",strokeLinejoin:"round"})),mb||(mb=kr.createElement("path",{d:"M4 21H20",stroke:"#2F2F39",strokeLinecap:"round"})))},Ab=(0,kr.forwardRef)(Eb),Cb=(0,kr.memo)(Ab);function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bb.apply(null,arguments)}var Pb,Nb,Db,Tb,kb,Ib=function(e,t){return kr.createElement("svg",bb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),vb||(vb=kr.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.1001 18.16C19.6901 17.26 19.9101 16.8 20.3601 15.79C17.0401 14.53 16.5101 9.8 19.7901 7.99C18.7901 6.73 17.3801 6 16.0501 6C15.0901 6 14.4301 6.25 13.8401 6.48C13.3401 6.67 12.8901 6.84 12.3301 6.84C11.7301 6.84 11.2001 6.65 10.6401 6.45C10.0301 6.23 9.39007 6 8.59007 6C7.10007 6 5.51007 6.91 4.50007 8.47C3.08007 10.67 3.33007 14.79 5.62007 18.31C6.44007 19.57 7.54007 20.98 8.97007 21C9.57007 21.01 9.96007 20.83 10.3901 20.64C10.8801 20.42 11.4101 20.18 12.3401 20.18C13.2701 20.17 13.7901 20.42 14.2801 20.64C14.7001 20.83 15.0801 21.01 15.6701 21C17.1201 20.98 18.2801 19.42 19.1001 18.16Z",fill:"black"})),Sb||(Sb=kr.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.8399 1C15.9999 2.1 15.5499 3.19 14.9599 3.95C14.3299 4.77 13.2299 5.41 12.1699 5.37C11.9799 4.31 12.4699 3.22 13.0699 2.49C13.7399 1.69 14.8699 1.07 15.8399 1Z",fill:"black"})))},_b=(0,kr.forwardRef)(Ib),Ob=(0,kr.memo)(_b);function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xb.apply(null,arguments)}var wb,Rb,Mb,Lb,Fb=function(e,t){return kr.createElement("svg",xb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",strokeWidth:1.4,xmlns:"http://www.w3.org/2000/svg",ref:t},e),Pb||(Pb=kr.createElement("path",{d:"M12 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),Nb||(Nb=kr.createElement("path",{d:"M7 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),Db||(Db=kr.createElement("path",{d:"M17 11.5V17.5",stroke:"#2F2F39",strokeLinecap:"round"})),Tb||(Tb=kr.createElement("path",{d:"M12 2L4 7.5H20L12 2Z",stroke:"#2F2F39",strokeLinejoin:"round"})),kb||(kb=kr.createElement("path",{d:"M4 21H20",stroke:"#2F2F39",strokeLinecap:"round"})))},Ub=(0,kr.forwardRef)(Fb),jb=(0,kr.memo)(Ub);function Bb(){return Bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Bb.apply(null,arguments)}var Gb,qb,Vb,Hb,Kb,Yb,zb,Wb,$b,Xb=function(e,t){return kr.createElement("svg",Bb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),wb||(wb=kr.createElement("path",{d:"M21 12.2069C21 11.6015 20.9464 11.0268 20.8544 10.4674H12.1953V13.9234H17.1532C16.931 15.0575 16.2797 16.0154 15.3141 16.6667V18.9656H18.272C20.0038 17.364 21 15.0039 21 12.2069Z",fill:"#4285F4"})),Rb||(Rb=kr.createElement("path",{d:"M12.1958 21.1954C14.6786 21.1954 16.7552 20.3678 18.2725 18.9655L15.3146 16.6666C14.487 17.2184 13.4372 17.5555 12.1958 17.5555C9.79728 17.5555 7.7666 15.9387 7.03862 13.7547H3.98877V16.1226C5.49837 19.1264 8.60186 21.1954 12.1958 21.1954Z",fill:"#34A853"})),Mb||(Mb=kr.createElement("path",{d:"M7.03837 13.7547C6.84679 13.203 6.74717 12.6129 6.74717 11.9999C6.74717 11.3869 6.85446 10.7968 7.03837 10.2451V7.87726H3.98852C3.36016 9.11865 3 10.5133 3 11.9999C3 13.4865 3.36016 14.8812 3.98852 16.1226L7.03837 13.7547Z",fill:"#FBBC05"})),Lb||(Lb=kr.createElement("path",{d:"M12.1958 6.44432C13.5521 6.44432 14.7629 6.91176 15.7207 7.82365L18.3414 5.20293C16.7552 3.71632 14.6786 2.80443 12.1958 2.80443C8.60186 2.80443 5.49837 4.87342 3.98877 7.87729L7.03862 10.2451C7.7666 8.0612 9.79728 6.44432 12.1958 6.44432Z",fill:"#EA4335"})))},Qb=(0,kr.forwardRef)(Xb),Zb=(0,kr.memo)(Qb);function Jb(){return Jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Jb.apply(null,arguments)}var eP,tP,nP,iP,sP=function(e,t){return kr.createElement("svg",Jb({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),Gb||(Gb=kr.createElement("path",{d:"M0 2.98816V21.0058C0 21.8683 0.705652 22.5739 1.56811 22.5739H12.3332C20.4717 22.5739 24 18.0185 24 11.9735C24 5.95974 20.4717 1.42004 12.3332 1.42004H1.56811C0.705652 1.42004 0 2.1257 0 2.98816Z",fill:"white"})),qb||(qb=kr.createElement("path",{d:"M7.20551 5.84209V19.1554H12.9997C18.2607 19.1554 20.5423 16.1838 20.5423 11.9813C20.5423 7.95905 18.2607 4.8385 12.9997 4.8385H8.2091C7.65242 4.8385 7.20551 5.29325 7.20551 5.84209Z",fill:"#CC0066"})),Vb||(Vb=kr.createElement("path",{d:"M12.3332 21.1391H2.97158C2.14048 21.1391 1.46619 20.4648 1.46619 19.6337V4.36806C1.46619 3.53696 2.14048 2.86267 2.97158 2.86267H12.3332C21.2166 2.86267 22.5416 8.57845 22.5416 11.9813C22.5416 17.8852 18.9115 21.1391 12.3332 21.1391ZM2.97158 3.36447C2.4149 3.36447 1.96798 3.81138 1.96798 4.36806V19.6337C1.96798 20.1903 2.4149 20.6373 2.97158 20.6373H12.3332C18.59 20.6373 22.0399 17.5637 22.0399 11.9813C22.0399 4.48567 15.9556 3.36447 12.3332 3.36447H2.97158V3.36447Z",fill:"black"})),Hb||(Hb=kr.createElement("path",{d:"M9.24405 10.1858C9.44791 10.1858 9.63608 10.2172 9.81642 10.2799C9.99675 10.3426 10.1457 10.4446 10.279 10.57C10.4045 10.7033 10.5064 10.8679 10.5848 11.0561C10.6554 11.2521 10.6946 11.4795 10.6946 11.7461C10.6946 11.9813 10.6632 12.193 10.6083 12.389C10.5456 12.585 10.4593 12.7575 10.3417 12.8987C10.2241 13.0398 10.0752 13.1496 9.89482 13.2358C9.71449 13.3142 9.50279 13.3613 9.25973 13.3613H7.88763V10.178H9.24405V10.1858ZM9.19701 12.781C9.29894 12.781 9.39302 12.7654 9.49495 12.734C9.58904 12.7026 9.67529 12.6478 9.74585 12.5694C9.81642 12.4909 9.87914 12.3969 9.92618 12.2714C9.97323 12.146 9.99675 12.0048 9.99675 11.8245C9.99675 11.6677 9.98107 11.5187 9.94971 11.3933C9.91834 11.2678 9.86346 11.1502 9.79289 11.064C9.72233 10.9777 9.62824 10.8993 9.51063 10.8523C9.39303 10.8052 9.25189 10.7817 9.0794 10.7817H8.57761V12.7889H9.19701V12.781Z",fill:"white"})),Kb||(Kb=kr.createElement("path",{d:"M13.525 10.1858V10.7739H11.8471V11.456H13.3917V11.997H11.8471V12.7732H13.5642V13.3613H11.1493V10.178H13.525V10.1858Z",fill:"white"})),Yb||(Yb=kr.createElement("path",{d:"M15.9242 10.1858L17.116 13.3691H16.3868L16.1437 12.6634H14.952L14.7011 13.3691H13.9954L15.195 10.1858H15.9242V10.1858ZM15.9634 12.1381L15.5635 10.9698H15.5557L15.1401 12.1381H15.9634Z",fill:"white"})),zb||(zb=kr.createElement("path",{d:"M18.2529 10.1858V12.781H19.8053V13.3691H17.5551V10.1858H18.2529V10.1858Z",fill:"white"})),Wb||(Wb=kr.createElement("path",{d:"M4.58673 13.2437C5.39648 13.2437 6.05292 12.5872 6.05292 11.7775C6.05292 10.9677 5.39648 10.3113 4.58673 10.3113C3.77698 10.3113 3.12054 10.9677 3.12054 11.7775C3.12054 12.5872 3.77698 13.2437 4.58673 13.2437Z",fill:"black"})),$b||($b=kr.createElement("path",{d:"M5.69227 19.1555C4.4613 19.1555 3.47339 18.1597 3.47339 16.9366V15.2038C3.47339 14.5923 3.96734 14.0905 4.58675 14.0905C5.19832 14.0905 5.70011 14.5844 5.70011 15.2038V19.1555H5.69227Z",fill:"black"})))},aP=(0,kr.forwardRef)(sP),oP=(0,kr.memo)(aP);function rP(){return rP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},rP.apply(null,arguments)}var lP,cP=function(e,t){return kr.createElement("svg",rP({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),eP||(eP=kr.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.69207 19.9323C5.03411 19.9366 6.38045 19.9323 7.72248 19.928C7.82563 19.7521 7.84772 19.5591 7.86975 19.3671C7.87904 19.2859 7.88833 19.2048 7.90375 19.1253C8.01949 18.4432 8.12442 17.7589 8.2293 17.0755C8.27301 16.7905 8.31671 16.5056 8.36115 16.2212C8.48628 15.4229 8.61147 14.6245 8.7323 13.8262C8.75816 13.6622 8.80565 13.5069 8.85743 13.3516C8.85638 13.3478 8.85538 13.344 8.85439 13.3403C9.08728 12.9799 9.41037 12.8254 9.8493 12.8254C10.0894 12.8254 10.3296 12.8278 10.5697 12.8303C11.4297 12.8392 12.2893 12.8479 13.1461 12.7434C14.1214 12.6226 15.0621 12.3723 15.9338 11.9062C17.2758 11.1856 18.1906 10.0852 18.7646 8.69141C19.0365 8.02682 19.2522 7.34072 19.3428 6.6244C19.3479 6.61684 19.3515 6.60782 19.3553 6.59811C19.358 6.59129 19.3608 6.5841 19.3644 6.57692L19.3903 6.44748C19.3864 6.43578 19.379 6.42408 19.3712 6.40278C19.372 6.4032 19.3728 6.40357 19.3737 6.40399C19.4902 5.79989 19.529 5.19574 19.4211 4.5916C19.1881 3.29703 18.4761 2.34336 17.3067 1.75647C16.1803 1.18256 14.9505 1.02722 13.7121 1.01428C12.0904 0.995773 10.4666 0.999293 8.84374 1.00282C8.19504 1.00422 7.54651 1.00564 6.89829 1.00564C6.37184 1.00564 5.96623 1.35517 5.88852 1.86868C5.84823 2.13056 5.80841 2.39245 5.76864 2.65433C5.68905 3.1778 5.60946 3.70132 5.52604 4.22479C5.45285 4.67984 5.37918 5.13483 5.30547 5.58987C5.15762 6.50278 5.00982 7.41569 4.86581 8.32861C4.79251 8.79214 4.72353 9.25568 4.65455 9.71922C4.58545 10.1834 4.51634 10.6477 4.44291 11.1119C4.33948 11.7679 4.23153 12.4228 4.12368 13.077C4.02008 13.7054 3.91659 14.3333 3.81722 14.9611C3.7021 15.6916 3.5904 16.4231 3.47861 17.1553C3.37249 17.8505 3.26627 18.5462 3.15697 19.2419C3.09658 19.613 3.32958 19.9323 3.69207 19.9323Z",fill:"#012D8A"})),tP||(tP=kr.createElement("path",{d:"M7.72489 19.9284C7.87159 19.6824 7.85433 19.3934 7.8975 19.1258C8.06146 18.1592 8.20386 17.1926 8.35491 16.2216C8.48004 15.4233 8.60517 14.625 8.726 13.8267C8.75192 13.6627 8.79935 13.5073 8.85113 13.352C9.08419 12.9895 9.4078 12.8298 9.84799 12.8342C10.9484 12.8342 12.0487 12.8903 13.1448 12.7522C14.1244 12.6314 15.0608 12.3811 15.9325 11.915C17.2745 11.1944 18.1893 10.094 18.7633 8.70017C19.0351 8.03563 19.2509 7.34947 19.3415 6.63315C19.3501 6.61589 19.3544 6.59863 19.3631 6.58567C19.3717 6.54254 19.3804 6.49937 19.389 6.45624C20.416 6.99995 20.9641 7.87162 21.1107 9.01087C21.2316 9.94729 21.0892 10.8578 20.8562 11.764C20.6706 12.4847 20.3858 13.1621 19.9802 13.7835C19.3199 14.8019 18.4008 15.5096 17.2573 15.9153C16.6617 16.1267 16.049 16.2475 15.4233 16.3209C14.9011 16.3813 14.379 16.3813 13.8568 16.3856C13.3304 16.3856 12.9938 16.6747 12.9204 17.1926C12.7608 18.2843 12.6011 19.3761 12.4112 20.4678C12.3465 20.839 12.2947 21.2144 12.23 21.5811C12.148 22.0299 11.8287 22.2975 11.3756 22.2975C10.2752 22.2975 9.17479 22.2975 8.07442 22.2975C7.65585 22.2975 7.45301 22.0559 7.52206 21.6502C7.60406 21.1497 7.68601 20.6534 7.76802 20.1528C7.78098 20.0709 7.80254 19.9888 7.72489 19.9284Z",fill:"#019AE0"})),nP||(nP=kr.createElement("path",{d:"M19.3899 6.44723C19.3812 6.49036 19.3726 6.53354 19.364 6.57666C19.3554 6.59393 19.3511 6.61119 19.3424 6.62415C19.2518 7.34047 19.036 8.02657 18.7642 8.69116C18.1902 10.085 17.2754 11.1853 15.9334 11.906C15.0617 12.372 14.121 12.6223 13.1457 12.7432C12.0497 12.8769 10.9492 12.8251 9.84886 12.8251C9.40872 12.8251 9.08505 12.9805 8.85205 13.343C8.78301 13.1013 8.87792 12.864 8.9211 12.6353C9.05053 11.9448 9.14549 11.2458 9.24906 10.551C9.33102 10.003 9.42598 9.45496 9.51229 8.9069C9.62446 8.19488 9.73668 7.48716 9.85316 6.7752C9.88338 6.59393 9.90064 6.40405 9.96538 6.23144C10.1078 5.86465 10.4271 5.7136 10.7853 5.7136C12.4725 5.70069 14.1641 5.69633 15.8514 5.7136C16.5202 5.72225 17.1891 5.75678 17.8493 5.88621C18.3758 5.98978 18.8893 6.14949 19.3683 6.39545C19.3769 6.42131 19.3856 6.43427 19.3899 6.44723Z",fill:"#001F6B"})),iP||(iP=kr.createElement("path",{d:"M19.3457 6.62828C19.3543 6.61102 19.3587 6.59376 19.3673 6.58085C19.3587 6.59376 19.3543 6.61102 19.3457 6.62828Z",fill:"#012D8A"})))},uP=(0,kr.forwardRef)(cP),dP=(0,kr.memo)(uP);function hP(){return hP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hP.apply(null,arguments)}var mP,pP,gP=function(e,t){return kr.createElement("svg",hP({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),lP||(lP=kr.createElement("g",{clipRule:"evenodd",fillRule:"evenodd"},kr.createElement("path",{d:"m1 5c0-2.20914 1.79086-4 4-4h14c2.2091 0 4 1.79086 4 4v14c0 2.2091-1.7909 4-4 4h-14c-2.20914 0-4-1.7909-4-4z",fill:"#10298d"}),kr.createElement("path",{d:"m19.3801 13.5428h-1.767l-.2378.8626h-1.3665l1.4739-4.98914h1.9951l1.4944 4.98914h-1.3389zm-.2623-.9719-.6189-2.1622-.6017 2.1622zm-6.7181 1.8345v-4.98914h2.4618c.3381 0 .5965.02828.7732.08356.405.12984.6762.39337.8163.79248.0714.2089.1074.5245.1074.9449 0 .5065-.0386.8703-.1176 1.092-.1588.4371-.484.6891-.9751.7553-.0579.0096-.3034.018-.7366.0257l-.2192.0071h-.7893v1.2881zm1.3215-2.4457h.8241c.2616-.0097.4197-.0302.4782-.0617.0771-.0438.1298-.1312.1555-.2623.0167-.0874.0257-.2166.0257-.3882 0-.2115-.0167-.3683-.0508-.4705-.0469-.1427-.1606-.2301-.3406-.2616-.0855-.0068-.1714-.0091-.2571-.0071h-.835zm-6.72902-.9513h-1.22896c0-.2057-.02442-.3433-.0707-.4127-.07327-.1041-.27639-.1555-.60548-.1555-.32138 0-.53413.0295-.63826.0893-.10348.0598-.15555.1903-.15555.3908 0 .1819.04628.3015.1382.3587.08054.0442.17039.0689.26224.072l.24811.0167c.3323.0212.66397.0463.99628.0765.42036.0424.72374.1562.91336.3406.14847.1427.23782.3311.2661.5624.01607.1389.02378.2957.02378.4693 0 .4023-.03664.6961-.11248.8831-.13691.342-.44543.5579-.92365.6486-.20054.0385-.50649.0572-.91914.0572-.68904 0-1.16918-.0412-1.43979-.126-.3323-.1016-.55148-.3098-.65818-.6229-.05914-.1729-.08806-.4627-.08806-.8696h1.23024v.1041c0 .2166.06171.3561.18447.4178.08356.0431.1864.0649.3066.0681h.4525c.23075 0 .3773-.0122.44158-.0359.05086-.0179.09716-.0467.13561-.0845.03844-.0378.06807-.0835.08678-.1341.02037-.0784.02989-.1593.02829-.2404 0-.2192-.07906-.3535-.23654-.4011-.05913-.0192-.33423-.0456-.82273-.079-.27398-.0161-.54718-.0435-.81888-.0823-.40237-.0765-.67104-.234-.80473-.4731-.11827-.2024-.17676-.5097-.17676-.9204 0-.313.03214-.5637.09513-.752.06427-.189.16583-.33233.30852-.43003.20633-.15041.47243-.23847.79509-.26482.2976-.02571.59584-.03728.89408-.03599.51614 0 .8838.02956 1.10362.08998.53542.14591.80217.55466.80217 1.22706-.00112.0826-.00498.1651-.01157.2474z",fill:"#fff"}),kr.createElement("path",{d:"m10.5749 10.118c.5457 0 1.0317.2558 1.3518.6556l.2854-.6209c-.4625-.44495-1.0796-.69312-1.7214-.69225-1.04123 0-1.93209.63955-2.29782 1.54395h-.55599l-.32781.7141h.71411c-.01157.1478-.01093.2956.00385.4435h-.35994l-.32781.7141h.8703c.19127.4462.50947.8264.91504 1.0932s.88067.4086 1.36607.4076c.5162 0 .9963-.1568 1.3929-.4255v-.8761c-.1617.1891-.3624.3409-.5883.4451-.2258.1041-.4716.1582-.7204.1585-.2905-.0011-.57605-.0752-.83053-.2153-.25447-.1402-.46969-.3419-.62592-.5869h1.82025l.3285-.7147h-2.41742c-.02116-.1469-.02461-.2958-.01029-.4435h2.63081l.3278-.7135h-2.73171c.15053-.2681.36947-.4914.63449-.6472s.56662-.2386.87402-.2398z",fill:"#ffcc02"}))))},yP=(0,kr.forwardRef)(gP),fP=(0,kr.memo)(yP);function vP(){return vP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},vP.apply(null,arguments)}var SP,EP=function(e,t){return kr.createElement("svg",vP({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),mP||(mP=kr.createElement("path",{d:"M18.6667 2H5.33333C3.49238 2 2 3.49238 2 5.33333V18.6667C2 20.5076 3.49238 22 5.33333 22H18.6667C20.5076 22 22 20.5076 22 18.6667V5.33333C22 3.49238 20.5076 2 18.6667 2Z",fill:"#008CFF"})),pP||(pP=kr.createElement("path",{d:"M16.4377 7C16.8258 7.6 17 8.21869 17 9C17 11.4918 14.7315 14.7278 12.8903 17H8.6859L7 7.5459L10.6827 7.21803L11.5783 13.9449C12.4105 12.6721 13.4397 10.6721 13.4397 9.30951C13.4397 8.56295 13.3033 8.05541 13.09 7.63737L16.4377 7Z",fill:"white"})))},AP=(0,kr.forwardRef)(EP),CP=(0,kr.memo)(AP);function bP(){return bP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bP.apply(null,arguments)}var PP,NP=function(e,t){return kr.createElement("svg",bP({fill:"none",height:20,viewBox:"0 0 20 20",width:20,xmlns:"http://www.w3.org/2000/svg",ref:t},e),SP||(SP=kr.createElement("g",{stroke:"currentColor",strokeWidth:1.4},kr.createElement("rect",{height:10.9,rx:2.15,width:16.3,x:1.85,y:4.55313}),kr.createElement("path",{d:"m1.89999 8.25156h16.30001"}),kr.createElement("path",{d:"m4.60001 12.7031h5.39999",strokeLinecap:"round"}))))},DP=(0,kr.forwardRef)(NP),TP=(0,kr.memo)(DP);function kP(){return kP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kP.apply(null,arguments)}var IP=function(e,t){return kr.createElement("svg",kP({fill:"none",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",ref:t},e),PP||(PP=kr.createElement("g",{fill:"currentColor"},kr.createElement("path",{clipRule:"evenodd",d:"m12.5525 9.7447c-2.99092-.21639-9.77273 1.1855-9.77273 4.2535 0 2.0004 3.59111 4.9249 9.43923 5.0017.2308 0 6.8741-.2566 6.7717-7.3873-.0861-5.98915-5.0046-6.71876-6.438-6.90138l.0001-.70661c5.7145.36271 10.6447 3.82157 10.6447 7.99259 0 4.412-5.0276 8.0028-11.2092 8.0028s-11.183612-3.5911-11.183612-8.0028c0-4.41161 5.001722-8.00272 11.183612-8.00272.1894 0 .3776.00337.5645.01013z",fillRule:"evenodd"}),kr.createElement("path",{d:"m6.83008 14.3939c0 3.9259 5.72712 4.9593 5.72712 4.9593v-4.9385-4.93856c-1.4874.40641-5.7268 1.78666-5.72712 4.91776z"}))))},_P=(0,kr.forwardRef)(IP),OP=(0,kr.memo)(_P);function xP(e,t){return t?e.translate("paymentOptions.creditCard.labelCreditDebit"):e.translate("paymentOptions.creditCard.label")}var wP=e=>{let{setRef:t,option:n,isActive:i,disabled:s,onChoosePaymentOption:a}=e;const o=(0,nc.t)(),r=(0,Nl.n)(),l=((e,t,n)=>{switch(e){case ch.CARD:return{icon:(0,Cl.jsx)(TP,{className:"icon-stroke-2 text-black",width:20,height:20}),label:xP(t,n)};case ch.APPLE_PAY:return{icon:(0,Cl.jsx)(Ob,{width:20,height:20}),label:t.translate("paymentOptions.applePay.label")};case ch.GOOGLE_PAY:return{icon:(0,Cl.jsx)(Zb,{width:20,height:20}),label:t.translate("paymentOptions.googlePay.label")};case ch.PAYPAL:return{icon:(0,Cl.jsx)(dP,{width:20,height:20}),label:t.translate("paymentOptions.paypal.label")};case ch.VENMO:return{icon:(0,Cl.jsx)(CP,{width:20,height:20}),label:t.translate("paymentOptions.venmo.label")};case ch.ACSS:return{icon:(0,Cl.jsx)(Cb,{width:20,height:20}),label:t.translate("paymentOptions.bankTransfer.label")};case ch.IDEAL:return{icon:(0,Cl.jsx)(oP,{width:20,height:20}),label:t.translate("paymentOptions.ideal.label")};case ch.UK_BACS:return{icon:(0,Cl.jsx)(OP,{width:20,height:20}),label:t.translate("paymentOptions.ukBacs.label")};case ch.AU_BECS:return{icon:(0,Cl.jsx)(jb,{width:20,height:20}),label:t.translate("paymentOptions.auBECS.label")};case ch.SEPA:return{icon:(0,Cl.jsx)(fP,{width:20,height:20}),label:t.translate("paymentOptions.sepa.label")};case ch.US_BANK_ACCOUNT_VERIFICATION:case ch.US_BANK_ACCOUNT_INSTANT:case ch.US_BANK_ACCOUNT:return{icon:(0,Cl.jsx)(yb,{width:20,height:20}),label:t.translate("paymentOptions.bankTransfer.label")};default:throw new Bs.HP(e)}})(n,o,r.featureConfig.creditDebitCardLabel),c=nb(n);return(0,Cl.jsxs)("button",{ref:t,type:"button",className:(0,Ml.A)("payment-option-list-item btn-reset p-rel d-flex items-center w-100 bg-transparent-hover-gray-10 border-top border-gray-15 px-3-5",{"payment-option-list-item-active border-transparent z-index-2":i,"pointer-events-none":i||s}),"aria-current":i,"data-tracking-element-name":`payment-option-${n}`,"data-qa":`payment-option-list-${c}`,disabled:s,"data-testid":`payment-option-list-${n}`,onClick:()=>{a(n)},children:[(0,Cl.jsx)("span",{className:"payment-option-list-item-icon p-rel shrink-0 d-flex justify-center me-2 z-index-1","aria-hidden":!0,children:l.icon}),(0,Cl.jsx)("span",{className:(0,Ml.A)("p-rel text-truncate z-index-1",i?"body-60-medium":"body-60-regular"),children:l.label})]})};const RP=(e,t)=>{let{className:n,disabled:i,onClick:s}=e;const a=(0,nc.t)();return(0,Cl.jsx)("button",{ref:t,type:"button",className:(0,Ml.A)("btn-link body-40-regular text-nowrap text-ellipsis max-w-100",n),disabled:i,onClick:s,"data-tracking-element-name":"show-more-options","data-qa":"payment-option-more-button",children:a.translate("paymentMethodScreen.moreOptions")})};var MP=(0,kr.forwardRef)(RP);const LP=e=>{let{className:t,displayedOptions:n,selectedOption:i,showAllPaymentOptions:s,shouldShowMoreButton:a,locked:o,onChoosePaymentOption:r,onShowMoreClick:l,onClickOutside:c}=e;const u=(0,Bl.P)(),d=(0,kr.useRef)(null),h=Zu(s);bu(d,c);const m=e=>{r(e),!u&&s&&l()};return(0,Cl.jsxs)("div",{className:t,children:[(0,Cl.jsxs)("div",{className:"p-rel",children:[!u&&(0,Cl.jsx)("div",{className:"invisible border",children:n.map((e=>(0,Cl.jsx)("div",{className:"payment-option-list-item"},e)))}),(0,Cl.jsx)("div",{className:(0,Ml.A)("bg-white border-radius-8 border border-gray-20",{"p-abs inset-top-start w-100":!u,"payment-option-list":s&&!u}),children:n.map(((e,t)=>(0,Cl.jsx)(wP,{disabled:o,setRef:s&&3===t?h:null,option:e,isActive:i===e,onChoosePaymentOption:m},e)))})]}),(0,Cl.jsx)(MP,{ref:d,className:(0,Ml.A)("self-start mt-2",{"d-none":!a,invisible:s&&!u}),disabled:o,onClick:()=>{l()}})]})},FP=e=>{let{processingState:t,disabled:n,onClick:i}=e;const s=(0,nc.t)(),a=zv({paymentMethod:Gn.ACSS}),o=(0,kr.useCallback)((()=>{a(),i()}),[a,i]);return(0,Cl.jsx)(lh,{processingState:t,className:"btn-primary",disabled:n,dataQa:"acss-button",trackingElement:"paymentMethod-acss",onClick:o,children:s.translate("paymentOptions.continue")})},UP=(0,kr.memo)(FP),jP=e=>{const t=(0,nc.t)();return(0,Cl.jsxs)("button",{type:"button",className:"btn btn-black d-flex justify-center items-center",dir:"ltr","aria-label":t.translate("paymentOptions.continueWithAriaLabel",{paymentMethod:t.translate("paymentOptions.applePay.label")}),onClick:e.onClick,disabled:e.disabled,"data-tracking-element-name":"paymentMethod-applePay","data-qa":"apple-pay-button",children:[(0,Cl.jsx)("span",{className:"text-truncate me-1-5",children:t.translate("paymentOptions.continueWith")}),(0,Cl.jsx)(ph,{className:"shrink-0",width:50,height:26,"aria-hidden":!0})]})},BP=(0,kr.memo)(jP),GP=e=>{const t=(0,nc.t)();return(0,Cl.jsx)(lh,{processingState:e.processingState,className:"btn-primary",onClick:e.onClick,disabled:e.disabled,dataQa:"au-becs-button",trackingElement:"paymentMethod-auBECS",children:t.translate("paymentOptions.continue")})},qP=(0,kr.memo)(GP),VP=e=>{let{processingState:t,disabled:n,onClick:i}=e;const s=(0,nc.t)(),a=zv({paymentMethod:Gn.CARD}),o=QC(),r=(0,kr.useCallback)((()=>{a(),o(),i()}),[i,o,a]);return(0,Cl.jsx)(lh,{className:"btn-primary",processingState:t,disabled:n,dataQa:"cc-button",trackingElement:"paymentMethod-creditCard",onClick:r,children:s.translate("paymentOptions.donate")})},HP=(0,kr.memo)(VP),KP=e=>{const{state:t}=Tc(Vn.PAYMENT_OPTIONS),{onClick:n,disabled:i}=e,s=(0,nc.t)(),[a,o]=(0,kr.useState)(!1),r=(0,hd.D)((e=>o(e))),l=(0,kr.useCallback)((()=>t.livemode?i?void 0:n():(r.set([!0]),void r.set([!1],3e3))),[i,n,t.livemode,r]);return(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn p-rel d-flex justify-center items-center",a?"btn-testmode":"btn-black"),disabled:i,"aria-label":s.translate("paymentOptions.continueWithAriaLabel",{paymentMethod:s.translate("paymentOptions.googlePay.label")}),onClick:l,"data-tracking-element-name":"paymentMethod-googlePay","data-qa":"google-pay-button",children:a?(0,Cl.jsx)("span",{role:"alert",children:s.translate("paymentOptions.googlePay.notAvailableInTestMode.oneLine")}):(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("span",{className:"text-truncate me-1-5",children:s.translate("paymentOptions.continueWith")}),(0,Cl.jsx)(Nh,{className:"shrink-0",width:62,height:31,"aria-hidden":!0})]})})},YP=(0,kr.memo)(KP),zP=e=>{let{processingState:t,disabled:n,onClick:i}=e;const s=(0,nc.t)(),a=zv({paymentMethod:Gn.IDEAL}),o=(0,kr.useCallback)((()=>{a(),i()}),[a,i]);return(0,Cl.jsx)(lh,{processingState:t,className:"btn-primary",onClick:o,disabled:n,dataQa:"ideal-button",trackingElement:"paymentMethod-ideal",children:s.translate("paymentOptions.continue")})},WP=(0,kr.memo)(zP),$P="paymentMethod-paypal",XP=e=>{let{disabled:t}=e;const{state:n,controller:i}=Tc(Vn.PAYMENT_OPTIONS),s=(0,nc.t)(),a=(o={paymentMethod:Gn.PAYPAL},Yv({paymentSdkProperty:"paypal",paymentSdkError:new Hv,paymentSdkSentryErrorType:l.PAYPAL_SDK_INITIALIZATION,paymentSdkSentryErrorFingerprint:"paypal-sdk-is-not-ready",paymentMethod:o.paymentMethod}));var o;const r=(0,kr.useRef)(null),[c,u]=(0,kr.useState)(!1),d=(0,hd.D)((e=>u(e))),h=Rc();(0,kr.useEffect)((()=>{if(r.current&&n.livemode)return i.initiatePaypal({element:r.current,buttonColor:MA.GOLD,onClick:()=>{r.current&&h.trackClick($P,r.current)}}),()=>i.closePaypalButton()}),[i,n.livemode,h]);const m=(0,kr.useCallback)((()=>{a(),n.livemode||(d.set([!0]),d.set([!1],3e3))}),[a,n.livemode,d]);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("btn p-rel px-1 d-flex items-center justify-center",{"btn-paypal-gold":!c,"btn-testmode":c,disabled:t}),role:n.livemode?void 0:"button",tabIndex:n.livemode?void 0:0,"aria-labelledby":"paypal-button",onClick:m,onKeyPress:m,"data-qa":"paypal-button",children:[(0,Cl.jsx)("div",{ref:r,id:"paypal-button",className:"p-abs inset-centered min-w-100 line-height-0","data-tracking-element-name":$P}),c?(0,Cl.jsx)("p",{className:"text-truncate",role:"alert",children:s.translate("paymentOptions.paypal.notAvailableInTestMode.oneLine")}):(0,Cl.jsx)(wh,{width:69,height:22,"aria-hidden":!0})]})},QP=(0,kr.memo)(XP),ZP=e=>{const t=(0,nc.t)();return(0,Cl.jsx)(lh,{processingState:e.processingState,className:"btn-primary",onClick:e.onClick,disabled:e.disabled,dataQa:"sepa-button",dataTestId:"sepa-button",trackingElement:"paymentMethod-sepa",children:t.translate("paymentOptions.continue")})},JP=(0,kr.memo)(ZP),eN=e=>{const t=(0,nc.t)();return(0,Cl.jsx)(lh,{processingState:e.processingState,className:"btn-primary",onClick:e.onClick,disabled:e.disabled,dataQa:"uk-bacs-button",trackingElement:"paymentMethod-ukBacs",children:t.translate("paymentOptions.continue")})},tN=(0,kr.memo)(eN),nN=e=>{let{processingState:t,disabled:n,onClick:i}=e;const s=(0,nc.t)(),a=zv({paymentMethod:Gn.US_BANK_ACCOUNT}),o=(0,kr.useCallback)((()=>{a(),i()}),[a,i]);return(0,Cl.jsx)(lh,{processingState:t,className:"btn-primary",disabled:n,dataQa:"us-bank-account-button",trackingElement:"paymentMethod-usBankAccount",onClick:o,children:s.translate("paymentOptions.continue")})},iN=(0,kr.memo)(nN);var sN;function aN(){return aN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},aN.apply(null,arguments)}var oN=function(e,t){return kr.createElement("svg",aN({fill:"none",height:16,viewBox:"0 0 69 16",width:69,xmlns:"http://www.w3.org/2000/svg",ref:t},e),sN||(sN=kr.createElement("g",{fill:"#fff"},kr.createElement("path",{d:"m13.2779 1.96094c.4249.70637.6165 1.43393.6165 2.35299 0 2.93132-2.4861 6.73937-4.50383 9.41327h-4.60865l-1.84833-11.12446 4.03538-.38563.97724 7.91579c.91309-1.49731 2.03989-3.8503 2.03989-5.45453 0-.87811-.14946-1.47621-.38302-1.96868z"}),kr.createElement("path",{d:"m18.5093 6.8563c.7426 0 2.6121-.34193 2.6121-1.41142 0-.51356-.3607-.76973-.7859-.76973-.7438 0-1.7198.89776-1.8262 2.18115zm-.085 2.11812c0 1.30588.7214 1.81828 1.6778 1.81828 1.0415 0 2.0387-.2562 3.3348-.91921l-.4882 3.33671c-.9132.4491-2.3364.7488-3.7178.7488-3.5041 0-4.7582-2.139-4.7582-4.81307 0-3.46585 2.04-7.14593 6.2457-7.14593 2.3156 0 3.6104 1.30579 3.6104 3.12403.0002 2.93122-3.7375 3.8292-5.9045 3.85039z"}),kr.createElement("path",{d:"m35.9733 4.56799c0 .42779-.0645 1.04829-.1287 1.4538l-1.2109 7.70191h-3.9293l1.1045-7.06022c.021-.1915.0854-.57702.0854-.79092 0-.51355-.3188-.64169-.702-.64169-.5091 0-1.0193.23509-1.3591.40672l-1.2528 8.08621h-3.9515l1.8052-11.53109h3.42l.0433.92037c.8069-.53474 1.8693-1.11308 3.3767-1.11308 1.9972-.00022 2.6992 1.027 2.6992 2.56799z"}),kr.createElement("path",{d:"m47.64 3.26231c1.1253-.81211 2.188-1.26231 3.6532-1.26231 2.0176 0 2.7194 1.02722 2.7194 2.5682 0 .4278-.0642 1.0483-.1284 1.45381l-1.2095 7.70189h-3.9304l1.1256-7.20942c.0207-.19271.0642-.4278.0642-.57691 0-.57823-.3188-.70648-.702-.70648-.488 0-.9759.2139-1.3381.40671l-1.2526 8.0862h-3.9294l1.1256-7.20941c.0207-.19271.0629-.4278.0629-.57691 0-.57823-.3189-.70648-.7008-.70648-.5101 0-1.0192.23509-1.359.40671l-1.2538 8.08619h-3.9502l1.805-11.53107h3.3783l.1061.96266c.7859-.57691 1.8475-1.15525 3.2705-1.15525 1.2322-.00044 2.039.53442 2.4434 1.26187z"}),kr.createElement("path",{d:"m61.8319 6.62143c0-.94135-.2339-1.58316-.9343-1.58316-1.5507 0-1.8692 2.75949-1.8692 4.17113 0 1.0709.2977 1.7337.9979 1.7337 1.4657 0 1.8056-2.91014 1.8056-4.32167zm-6.7967 2.41755c0-3.63637 1.9112-7.03898 6.3087-7.03898 3.3135 0 4.5248 1.96867 4.5248 4.68599 0 3.59421-1.8907 7.31631-6.3942 7.31631-3.3349 0-4.4393-2.2037-4.4393-4.96332z"}))))},rN=(0,kr.forwardRef)(oN),lN=(0,kr.memo)(rN);const cN="paymentMethod-venmo",uN=e=>{let{disabled:t,onClick:n}=e;const{state:i,controller:s}=Tc(Vn.PAYMENT_OPTIONS),a=(0,nc.t)(),o=(0,kr.useRef)(null),[r,l]=(0,kr.useState)(!1),c=(0,hd.D)((e=>l(e))),u=Rc();(0,kr.useEffect)((()=>{if(o.current)return s.initiateVenmo({element:o.current,onClick:()=>{o.current&&u.trackClick(cN,o.current)}}),()=>s.closeVenmoButton()}),[s,u]);const d=(0,kr.useCallback)((()=>{if(!i.livemode)return c.set([!0]),void c.set([!1],3e3);t||n()}),[t,n,c,i.livemode]);return(0,Cl.jsxs)("div",{className:(0,Ml.A)("btn p-rel px-1 d-flex items-center justify-center",r?"btn-testmode":"btn-venmo",{disabled:t}),role:i.livemode?void 0:"button",tabIndex:i.livemode?void 0:0,"aria-labelledby":"venmo-button",onClick:d,onKeyPress:d,children:[(0,Cl.jsx)("div",{ref:o,id:"venmo-button",className:"p-abs inset-centered min-w-100 line-height-0","data-tracking-element-name":cN}),r?(0,Cl.jsx)("p",{className:"text-truncate",role:"alert",children:a.translate("paymentOptions.venmo.notAvailableInTestMode.oneLine")}):(0,Cl.jsx)(lN,{width:76,height:24,"aria-hidden":!0})]})},dN=(0,kr.memo)(uN),hN={[ch.CARD]:HP,[ch.APPLE_PAY]:BP,[ch.GOOGLE_PAY]:YP,[ch.PAYPAL]:QP,[ch.VENMO]:dN,[ch.UK_BACS]:tN,[ch.AU_BECS]:qP,[ch.ACSS]:UP,[ch.SEPA]:JP,[ch.IDEAL]:WP,[ch.US_BANK_ACCOUNT]:iN,[ch.US_BANK_ACCOUNT_INSTANT]:iN,[ch.US_BANK_ACCOUNT_VERIFICATION]:iN},mN=e=>{let{transitionEntered:t,option:n,show:i,disabled:s,processingState:a,errorMessage:o,errorTitle:r,onClick:l}=e;const c=(0,ql.wf)(),{saveTriggerElement:u}=kl(),d=(0,kr.useRef)(null),h=nb(n),m=(0,kr.useCallback)((()=>{var e;const t=null===(e=d.current)||void 0===e?void 0:e.firstElementChild;t&&u(t),l(n)}),[l,n,u]),p=hN[n];return(0,Cl.jsx)(Zc.S,{content:(0,Cl.jsx)(ou,{errorTitle:r,errorMessage:o,dataQa:h,dataTestId:h}),trigger:"manual",manualOpen:t&&i&&Boolean(o),placement:"top",maxWidth:"300px",rootContainer:c,children:(0,Cl.jsx)("div",{className:(0,Ml.A)({"d-none":!i}),children:(0,Cl.jsx)("div",{ref:d,children:(0,Cl.jsx)(p,{onClick:m,disabled:s,processingState:a})})},n)})},pN=e=>{let{transitionEntered:t,availableOptions:n,buttonOptions:i,preSelectedPaymentOption:s,locked:a,onChoosePaymentOption:o,getProcessingState:r}=e;return(0,Cl.jsx)(Cl.Fragment,{children:n.map((e=>{const{errorTitle:n,error:l,visible:c}=i[e],u=s===e;return(0,Cl.jsx)(mN,{option:e,errorTitle:n,errorMessage:l,show:c&&u,onClick:o,processingState:r(e),disabled:a,transitionEntered:t},e)}))})},gN=(0,kr.memo)(pN),yN=e=>{let{currency:t,prefixCurrencySymbol:n,postfixCurrencySymbol:i,total:s,isRecurring:a,recurringLabel:o}=e;const r=(0,nc.t)(),l=(0,kr.useMemo)((()=>(0,Up.p)(t,r.locale)),[r.locale,t]);return(0,Cl.jsxs)("div",{className:"d-flex",children:[(0,Cl.jsx)("p",{className:"body-40-regular text-truncate me-4",children:r.translate("paymentMethodScreen.transactionCosts.total")}),(0,Cl.jsxs)("p",{className:"body-40-medium shrink-0 max-w-70 text-truncate ms-auto","data-qa":"donation-amount-label",children:[n&&(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif","aria-hidden":"true",children:n}),(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif",children:r.formatCurrency(s,{currency:t,display:"trimzeroes",withoutPrefix:!0,withoutSuffix:!0})}),i&&(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif","aria-hidden":"true",children:i}),(0,Cl.jsx)("span",{className:"d-inline-block text-sans-serif ms-0-5",children:l}),a&&(0,Cl.jsx)("span",{className:"d-inline-block",children:o})]})]})};var fN;!function(e){e.PARTIAL="partial",e.FULL="full",e.NONE="none"}(fN||(fN={}));const vN=e=>{let{setRef:t,labels:n,coverageLevel:i,partialFee:s,fullFee:a,selectFeeCoverageLevel:o}=e;const r=(0,kr.useId)(),[l,c]=(0,kr.useState)(0),u=i===fN.PARTIAL||i===fN.FULL;return(0,kr.useEffect)((()=>{if(i!==fN.NONE){const e=i===fN.PARTIAL?s:a;c(e)}}),[i,s,a]),(0,Cl.jsxs)("div",{className:"p-rel",ref:t,children:[(0,Cl.jsxs)("select",{id:`fee-coverage-select-${r}`,className:"fee-select p-abs inset-0 max-w-100 text-noselect p-0 border-0 m-0 overflow-hidden cursor-pointer z-index-1",value:i,"data-qa":"fee-coverage-selector","data-testid":"fee-coverage-selector",onChange:e=>{const t=e.target.value;o(t)},children:[(0,Cl.jsxs)("option",{value:fN.FULL,children:[a,"% - ",n.fullCoverage]}),(0,Cl.jsxs)("option",{value:fN.PARTIAL,children:[s,"% - ",n.partialCoverage]}),(0,Cl.jsx)("option",{value:fN.NONE,children:n.noCoverage})]}),(0,Cl.jsxs)("label",{htmlFor:`fee-coverage-select-${r}`,className:"fee-select-label d-flex items-start gap-2","data-qa":"fee-coverage-label","data-testid":"fee-coverage-label",children:[(0,Cl.jsx)("span",{className:"icon-slot icon-slot-18 shrink-0","aria-hidden":!0,children:(0,Cl.jsx)("span",{className:(0,Ml.A)("fee-select-check p-abs inset-centered text-white border-radius-4",{"has-coverage":u}),"data-qa":"fee-coverage-checkbox",children:(0,Cl.jsx)(Ld,{className:"p-abs inset-centered"})})}),(0,Cl.jsx)("span",{dangerouslySetInnerHTML:{__html:n.formatLabel(`${(()=>{switch(i){case fN.PARTIAL:return s;case fN.FULL:return a;case fN.NONE:default:return l||a}})()}%`)}})]})]})},SN=(0,kr.memo)(vN),EN=["top","top-end","bottom","bottom-end"],AN=e=>{let{includeFees:t,isFeeCovered:n,currency:i,processingFee:s,showIncludeFee:a,locked:o,paymentOption:r,transitionEntered:l,isPaymentLoader:c,dataQa:u,dataTestId:d,toggleCheckbox:h}=e;const{controller:m,state:p}=Tc(Vn.PAYMENT_OPTIONS),g=(0,nc.t)(),y=(0,gc.Q)(),f=(0,Bl.P)(),v=Vc("lg"),S=t!==sC.ONLY_NO,E=t===sC.ONLY_YES,A=(0,kr.useRef)(null),C=(0,kr.useRef)(null),b=(0,kr.useRef)(null),P=(0,kr.useRef)(null),N=(0,ql.wf)(),D=m.isFeeCoverageSelectionExperimentEnabled(),T=D&&a,k=!D&&a,I=[y?"right":"left","top"],_=ec(P),[O,x]=(0,kr.useState)(!1),{showHelpTooltip:w,helpTooltipRef:R,handleHelpTooltipKeyDown:M,handleHelpTooltipChecked:L}=function(e){const t=(0,kr.useRef)(null),[n,i]=(0,kr.useState)(!1),s=()=>{i((e=>!e))},a=()=>{i(!1)};return bu(t,a),aC(e,a),{helpTooltipRef:t,showHelpTooltip:n,handleHelpTooltipChecked:e=>{e.stopPropagation(),s()},handleHelpTooltipKeyDown:e=>{e.code!==Fl.J.ENTER&&e.code!==Fl.J.SPACE||(e.stopPropagation(),e.preventDefault(),s())}}}(b);(0,kr.useEffect)((()=>{const e=r===ch.CARD&&!v;x(!(!A.current&&!C.current||n||w||e))}),[n,w,r,v]);const F=(0,Cl.jsxs)(Cl.Fragment,{children:[E&&g.translate("paymentMethodScreen.transactionCosts.tooltip.required"),a&&(0,Cl.jsx)(fc,{className:"fee-tooltip",token:"paymentMethodScreen.transactionCosts.tooltip.message",params:{processingFee:g.formatCurrency(s,{currency:i,display:"floatcents"})}})]}),U={formatLabel:e=>g.translate("paymentMethodScreen.transactionCosts.selectPercentage.label",{percentage:e}),noCoverage:g.translate("paymentMethodScreen.transactionCosts.selectPercentage.noCoverage"),partialCoverage:g.translate("paymentMethodScreen.transactionCosts.selectPercentage.partialCoverage"),fullCoverage:g.translate("paymentMethodScreen.transactionCosts.selectPercentage.fullCoverage")};return(0,Cl.jsx)(Cl.Fragment,{children:S&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(Zc.S,{content:g.translate("paymentMethodScreen.transactionCosts.tooltip.question"),trigger:"manual",manualOpen:l&&!c&&!o&&!f&&O,placement:y?"left":"right",fallbackPlacements:I,maxWidth:"220px",rootContainer:N,"data-qa":"cover-fee-tooltip",children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("d-flex items-center",{"px-8 mx-minus-8":!f}),"data-qa":u,"data-testid":d,children:[E&&(0,Cl.jsx)("p",{className:"body-40-regular text-truncate","data-qa":"fee-amount-text",children:g.translate("paymentMethodScreen.transactionCosts.included",{amount:g.formatCurrency(s,{currency:i,display:"floatcents"})})}),k&&(0,Cl.jsx)(Fd,{innerRef:A,className:"body-40-regular",customLabelClasses:"line-height-20",checked:n,disabled:o,onChange:h,dataQa:"cover-fee-checkbox",trackingElement:"coverFee",children:(0,Cl.jsx)("span",{className:"body-40-regular text-truncate",children:g.translate("paymentMethodScreen.transactionCosts.label")})}),T&&(0,Cl.jsx)(SN,{setRef:C,labels:U,coverageLevel:p.coverageLevel,partialFee:p.partialFee,fullFee:p.fullFee,selectFeeCoverageLevel:e=>m.selectFeeCoverageLevel(e)}),(0,Cl.jsx)(Zc.S,{ref:R,content:F,trigger:"manual",manualOpen:l&&!o&&w,placement:y?"left":"right",fallbackPlacements:EN,maxWidth:"220px",rootContainer:N,"data-qa":"why-cover-fee-tooltip",children:(0,Cl.jsx)("button",{ref:b,type:"button",className:"btn-icon shrink-0 font-size-18 text-gray-60 ms-2","aria-label":g.translate("paymentMethodScreen.transactionCosts.helpAriaLabel"),disabled:o,onClick:L,onKeyDown:M,"data-qa":"transaction-cost-tip","data-testid":"transaction-cost-tip",children:(0,Cl.jsx)(Bh.A,{className:(0,Ml.A)("icon-stroke d-block",{"icon-flip-horizontal":y}),"aria-hidden":!0})})})]})}),(0,Cl.jsx)(Ll.A,{nodeRef:P,in:f&&a&&!n,mountOnEnter:!0,unmountOnExit:!0,addEndListener:_,classNames:"rtg-fee-accordion-mobile",children:(0,Cl.jsx)("p",{ref:P,className:"body-40-regular text-ellipsis mt-2",role:"alert","data-qa":"cover-fee-tooltip",children:g.translate("paymentMethodScreen.transactionCosts.tooltip.question")})}),(0,Cl.jsx)("hr",{className:"border-gray-15 mt-3 mb-2-5","aria-hidden":!0})]})})},CN=()=>{const e=(0,nc.t)(),t=window.document.location.href.replace("http://","https://");return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(ed,{className:"d-block mx-auto",ariaHidden:!0}),(0,Cl.jsx)("p",{className:"text-center text-ellipsis mt-6",children:e.translate("paymentMethodScreen.creditCardIsUnavailableInfo.part-1")}),(0,Cl.jsx)(fc,{className:"text-center text-ellipsis mt-2-5",as:"p",token:"paymentMethodScreen.creditCardIsUnavailableInfo.part-2",params:{link:t}})]})},bN=(0,kr.memo)(CN),PN=e=>{let{transitionEntered:t,stripeElementsCardState:n,setStripeElementsCardState:i}=e;const{state:s,controller:a}=Tc(Vn.PAYMENT_OPTIONS),o=(0,kr.useId)(),r=(0,Bl.P)(),l=(0,nc.t)(),c=lC(),{returnFocusToTrigger:u}=kl(),d=a.getFrequency(),h=a.getCurrency();(0,kr.useEffect)((()=>{a.syncPaymentButtons()}),[a,d,h]);const m=(0,kr.useCallback)((()=>{a.toggleFeeCovered()}),[a]),p=(0,kr.useCallback)((e=>a.choosePaymentOption(e,{onModalHide:()=>{u()}})),[a,u]),g=(0,kr.useCallback)((e=>{a.selectPaymentOption(e)}),[a]),y=(0,kr.useCallback)((()=>{a.toggleShowAllPaymentOptions()}),[a]),f=(0,kr.useCallback)((()=>{s.showAllPaymentOptions&&!r&&a.setShowAllPaymentOptions(!1)}),[a,s.showAllPaymentOptions,r]),v=(0,kr.useCallback)((e=>{switch(e){case ch.ACSS:return s.processingACSSState;case ch.US_BANK_ACCOUNT:case ch.US_BANK_ACCOUNT_INSTANT:case ch.US_BANK_ACCOUNT_VERIFICATION:return s.processingUSBankAccountState;case ch.CARD:return s.processingCardState;case ch.IDEAL:return s.processingIdealState;default:return Xl.IDLE}}),[s.processingACSSState,s.processingCardState,s.processingIdealState,s.processingUSBankAccountState]);return(0,Cl.jsxs)("section",{className:"p-rel flow-screen","aria-labelledby":`screen-header-${o}`,"data-qa":"active-screen-payment-method",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${o}`,title:s.preSelectedPaymentOption&&s.isMultiplePaymentOptions?l.translate("paymentMethodScreen.title.multipleOptions"):l.translate("paymentMethodScreen.title.onlyCard"),isBackFlowDisabled:s.isBackFlowDisabled,forceShowBackButton:s.isBackFlowDisabled,a11yAutoFocus:r}),s.stripeElementsAvailable?(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-8 pb-5":!r}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[!!s.preSelectedPaymentOption&&s.isMultiplePaymentOptions&&(0,Cl.jsx)(LP,{className:"shrink-0",displayedOptions:s.displayedPaymentOptions,locked:s.locked,selectedOption:s.preSelectedPaymentOption,shouldShowMoreButton:s.shouldShowMoreButton,showAllPaymentOptions:s.showAllPaymentOptions,onChoosePaymentOption:g,onShowMoreClick:y,onClickOutside:f}),s.preSelectedPaymentOption===ch.CARD&&s.isMultiplePaymentOptions&&(0,Cl.jsx)(bc,{size:32,sizeMin:16}),(0,Cl.jsx)("div",{className:(0,Ml.A)(s.preSelectedPaymentOption===ch.CARD?"shrink-0":"d-none",{"opacity-20":s.showAllPaymentOptions&&!r}),children:(0,Cl.jsx)(tb,{isReady:!!t&&s.preSelectedPaymentOption===ch.CARD,locked:s.showAllPaymentOptions&&!r,stripeElementsCardState:n,setStripeElementsCardState:i})}),(0,Cl.jsx)(bc,{size:32,sizeMin:16,className:"mt-auto"}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("shrink-0",{"opacity-20":s.showAllPaymentOptions&&!r}),children:[(0,Cl.jsx)(AN,{paymentOption:s.preSelectedPaymentOption,showIncludeFee:s.showIncludeFee,isFeeCovered:s.isFeeCovered,locked:s.locked||s.showAllPaymentOptions&&!r,processingFee:s.processingFee,currency:s.currency,toggleCheckbox:m,includeFees:s.includeFees,transitionEntered:t,isPaymentLoader:c,dataQa:"transaction-costs-lpo"}),(0,Cl.jsx)(yN,{prefixCurrencySymbol:s.prefixCurrencySymbol,postfixCurrencySymbol:s.postfixCurrencySymbol,currency:s.currency,total:s.total,isRecurring:s.isRecurring,recurringLabel:s.recurringLabel})]})]})}),(0,Cl.jsx)(gd,{className:(0,Ml.A)({"opacity-20":s.showAllPaymentOptions&&!r}),isBackFlowDisabled:s.isBackFlowDisabled,children:s.isStripeAccountConnected?(0,Cl.jsx)(gN,{preSelectedPaymentOption:s.preSelectedPaymentOption,availableOptions:s.availableOptions,buttonOptions:s.buttonOptions,locked:s.locked||s.showAllPaymentOptions&&!r,onChoosePaymentOption:p,getProcessingState:v,transitionEntered:t}):(0,Cl.jsx)("p",{className:"font-weight-600 text-center text-red-80 text-ellipsis",dangerouslySetInnerHTML:{__html:l.safeTranslate("paymentMethodScreen.stripe.connectionInfo")},"data-qa":"stripe-danger-text"})})]}):(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body justify-center",{"pt-4 pb-6":r}),children:(0,Cl.jsx)("div",{className:"fixed-container",children:(0,Cl.jsx)(bN,{})})}),(0,Cl.jsx)(gd,{className:(0,Ml.A)({"pt-10 pb-5":!r})})]}),c&&(0,Cl.jsx)(_A,{})]})},{ScrollToFieldsProvider:NN,useAddFieldToScroll:DN,useScrollToFieldsTrigger:TN,useFakeStripeElement:kN}=(0,Ud.J)(),IN=e=>{let{transitionEntered:t,stripeElementState:n,setStripeElementState:i}=e;const{state:s,controller:a}=Tc(Vn.SEPA),o=(0,nc.t)(),r=(0,kr.useId)(),l=(0,Bl.P)(),c=(0,Zl.$)(),u=(0,Vv.j)(),h=(0,Wv.l)(qv.bG.SAFARI,18),m=zv({paymentMethod:Gn.SEPA}),p=(0,kr.useRef)(null),[g,y]=(0,kr.useState)(),f=$d(s.shakeKey,0!==s.shakeKey),v={maxHeight:l?void 0:"150px"},S=(0,kr.useRef)(!1),E=(0,Il.M)(),A=TN();(0,kr.useEffect)((()=>{(0,d.sH)(void 0,void 0,void 0,(function*(){if(c)return;if(!p.current)throw new Error("ibanContainerRef is not provided");const e={onIbanElementReady:()=>{i((e=>Object.assign(Object.assign({},e),{isReady:!0})))}},{stripeElements:t}=yield a.initiateSepa(p.current,Object.assign(Object.assign({},e),{stripeElementStyleOverride:Object.assign(Object.assign({},il),{base:Object.assign(Object.assign({},il.base),{"::placeholder":{color:"transparent"}}),invalid:Object.assign(Object.assign({},il.invalid),{color:"#222832",":focus":{color:"#222832"},"::placeholder":{color:"transparent"}})}),showIcon:!1}));y(t)}))}),[a,c,i]),(0,kr.useEffect)((()=>{if(!n.isReady||!g||!t)return;const e=g.getElement(Bv.IBAN);if(!e)throw new Error("iban element is not initialized");const s=()=>{S.current?E.document.dispatchEvent(new Event("stripeElementEvent")):S.current=!0,i((e=>Object.assign(Object.assign({},e),{isFocused:!0})))},o=()=>{i((e=>Object.assign(Object.assign({},e),{isFocused:!1})))},r=e=>{a.recalculatePaymentScreen(),i((t=>{var n,i;return Object.assign(Object.assign({},t),{isEmpty:e.empty,error:null!==(i=null===(n=e.error)||void 0===n?void 0:n.message)&&void 0!==i?i:null})}))};return e.on("focus",s),e.on("blur",o),e.on("change",r),l||u||h||S.current||e.focus(),()=>{e.off("focus",s),e.off("blur",o),e.off("change",r)}}),[a,E.document,i,n.isReady,g,t,l,u,h]);const C=kN({focus:()=>{var e;return null===(e=null==g?void 0:g.getElement(Bv.IBAN))||void 0===e?void 0:e.focus()},scrollIntoView:e=>{var t;return null===(t=p.current)||void 0===t?void 0:t.scrollIntoView(e)}});return DN(C,(e=>Boolean(e.error)||e.isEmpty)),(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${r}`,onSubmit:e=>{e.preventDefault(),A(),a.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${r}`,title:o.translate("sepaScreen.title"),titleQa:"sepa-title",a11yAutoFocus:l||u||h}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-5":!l}),children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("fixed-container",{"grow-1 d-flex flex-column":!l}),children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center",l?"text-ellipsis":"text-line-clamp-4"),children:o.translate("sepaScreen.description")}),(0,Cl.jsxs)(Hh.s,{htmlFor:`iban-number-${r}`,label:o.translate("sepaScreen.ibanNumberLabel"),labelFloating:!0,formGroupClass:(0,Ml.A)("mt-5",{"pointer-events-none":s.locked,shake:f}),formLabelClass:(0,Ml.A)({"has-value":!n.isEmpty,"has-error pe-6":null!==n.error}),dataQa:"iban-number-label",children:[(0,Cl.jsx)("div",{ref:p,id:`iban-number-${r}`,className:"StripeElement has-label-floating",onClick:m}),n.error&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:n.isFocused,children:n.error}),(0,Cl.jsx)("p",{role:"alert",className:"sr-only",children:n.error})]})]}),(0,Cl.jsx)("div",{className:l?"mt-5":"grow-1 min-h-0 p-rel mt-4",style:v,children:(0,Cl.jsx)("div",{className:(0,Ml.A)({"p-abs inset-0 scroll-box":!l}),children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular text-gray-80 text-ellipsis",{"px-3 py-2-5":!l,"pointer-events-none":s.locked}),children:o.translate("sepaScreen.legalInformation")})})})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",errorTitle:s.payErrorMessage,processingState:s.processingState,dataQa:"sepa-continue-button",trackingElement:"nextButton",onClick:m,children:s.isPaymentScreen?th(o,s.formattedAmount,s.frequency):o.translate("sepaScreen.button")})})]})};function _N(e,t=" "){return e.filter((e=>"string"==typeof e||"number"==typeof e)).map((e=>"string"==typeof e?e.trim():e)).filter((e=>""!==e)).join(t)}var ON;function xN(){return xN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xN.apply(null,arguments)}var wN=function(e,t){return kr.createElement("svg",xN({fill:"none",height:28,viewBox:"0 0 87 28",width:87,xmlns:"http://www.w3.org/2000/svg",ref:t},e),ON||(ON=kr.createElement("path",{clipRule:"evenodd",d:"m40.6994 5.87862h4.4869s4.4427-.08959 4.3979 3.94846c-.0443 3.00672-4.3073 3.45522-4.3073 3.45522h-4.577v-7.40368zm13.4235 14.49468c.126.5873.5508 1.2346 1.9681 1.3011 1.8843.0443 2.9614-.6739 2.9614-.6739v1.3911s-2.064.4943-3.0515.4943c-1.0318 0-4.0833-.225-4.0833-3.0516 0-2.288 2.513-3.0062 3.9484-3.0062 2.513.0896 3.7245.9874 3.6797 3.5448 0 .0369-4.1346.0093-5.4228.0004zm.0059-1.1228h3.4429s0-1.3011-1.6604-1.3011c-1.2489 0-1.6575.6735-1.7825 1.3011zm10.8913-1.4049c.4982-.5405 1.3346-.9732 2.7375-.9732 2.7823 0 3.2312 2.3333 3.1864 2.9614-.0448.6282-.2692 3.0063-3.4995 3.0063-1.2203 0-1.9671-.4165-2.4239-.9333v.7536h-2.1989v-8.0771h2.1989v3.2623zm1.8854 3.7382c1.3011-.0453 1.8844-1.1661 1.8844-1.7047 0-.5385-.3146-1.6604-1.975-1.6604-1.2882 0-1.6806.9732-1.7948 1.4487v.5853c.1133.4849.5076 1.3311 1.8854 1.3311zm18.9812-.224.0443 1.2568s-1.0318.224-1.7047.224-2.4239-.4037-2.4239-2.1094v-2.6026h-1.8391v-1.1662h1.8391v-1.3911h2.2442v1.3911h1.8401v1.1662h-1.8401v2.2443s0 1.1218.8979 1.1218c.8969 0 .9422-.1349.9422-.1349zm-6.8208-14.26972h2.6026v6.23702h2.1979v-6.23702h2.6479v-1.30154h-7.4484zm-.8979.31407.2693-1.30155s-1.1219-.49325-3.0959-.49325c-1.9297 0-5.0255 1.07708-5.0255 3.99375 0 2.8719 3.2755 3.8589 5.2948 3.8589s2.6922-.3141 2.6922-.3141l-.224-1.4359s-.8979.2692-2.4239.2692c-1.4807-.0448-3.0053-1.2114-3.0053-2.51249.0443-1.16667 1.3902-2.46822 3.1412-2.46822 1.3453 0 2.3771.40366 2.3771.40366zm-19.8338-1.57032s3.6797-.17919 3.6797 1.97447c0 1.84009-2.1084 1.97447-2.1084 1.97447s.5828.08959.8526.49323c.224.3589 1.7047 3.0516 1.7047 3.0516h-2.2442s-.3589-.449-.5385-.7626c-.1344-.314-.5386-.9874-.5386-.9874s-.3136-1.1219-1.3911-1.1219c-.0271 0-.4652-.0167-.8078-.0295v2.9014h-2.1537v-7.49377zm-1.3911 3.36561h1.1671s1.6151-.09009 1.7047-1.07708c.0453-.94219-1.5698-1.07707-1.5698-1.07707h-1.302zm9.0192 1.16666h3.5901v-1.39113h-3.5901v-1.70521h3.9047v-1.43593h-6.1021v7.49377h6.1473v-1.3464h-3.9494v-1.6151zm8.75 5.7433h2.199v-1.5261h-2.199zm0 6.5515h2.199v-5.6985h-2.199zm-23.9609-9.3333h2.1536v-7.49377h-2.1536zm-10.052 1.8848h4.4869s4.4427-.0905 4.3979 3.9485c-.0443 3.0063-4.3073 3.4557-4.3073 3.4557h-4.577v-7.4042zm2.1989 6.0131h1.4359s2.9615-.1797 2.9615-2.4683c0-2.2885-3.1411-2.513-3.1411-2.513h-1.2563zm0-9.3339h1.4359s2.9615-.2244 2.9615-2.46818c0-2.33333-3.1411-2.51252-3.1411-2.51252h-1.2563zm-22.3468-1.5521v15.0141s-8.7057-1.5708-8.7057-7.5386c.0005-4.7597 6.4447-6.8577 8.7057-7.4755zm0-.2801c-5.2323-.37853-17.0963 2.0739-17.0963 7.4411 0 3.4995 6.28226 8.6156 16.513 8.75.4036 0 12.0255-.449 11.8463-12.9234-.1506-10.47738-7.9924-12.31254-10.5-12.632021v-.6384659c9.9969.6345289 17.8593 6.6465569 17.8593 13.9433869 0 7.7182-8.7952 14-19.6093 14-10.81402 0-19.5645-6.2823-19.5645-14 0-7.71772 8.74999-14 19.5645-14 .3313 0 .6606.0059087.9875.017723v10.041677z",fill:"currentColor",fillRule:"evenodd"})))},RN=(0,kr.forwardRef)(wN),MN=(0,kr.memo)(RN);const LN={boxShadow:"inset 0 0 0 1px #c7cdd6"},FN={boxShadow:"inset 0 -1px 0 0 #c7cdd6"};function UN(e){/[0-9]/.test(e.key)||!e.key||1!==e.key.length||e.ctrlKey||e.metaKey||e.preventDefault()}const{useAddFieldToScroll:jN,useScrollToFieldsTrigger:BN,ScrollToFieldsProvider:GN}=(0,Ud.J)(),qN=e=>{var t,n,i;const{state:s,controller:a}=Tc(Vn.UK_BACS),o=(0,Bl.P)(),r=(0,nc.t)(),l=(0,kr.useId)(),c=zv({paymentMethod:Gn.UK_BACS}),[u,d]=(0,kr.useState)(!1),[h,m]=(0,kr.useState)(!1),[p,g]=(0,kr.useState)(!1),y=BN(),f=(0,kr.useRef)(null),v=(0,kr.useRef)(null),S=(0,kr.useRef)(null),E=(0,kr.useRef)(null),A=s.errors.sortCode,C=s.errors.accountNumber,b=s.errors.accountHolderName,P=$d(s.shakeKey,0!==s.shakeKey),N=(0,Qu.k)();jN(f,(e=>Boolean(e.sortCode))),jN(v,(e=>Boolean(e.accountNumber))),jN(S,(e=>Boolean(e.accountHolderName))),jN(E,(e=>Boolean(e.termsChecked))),(0,kr.useEffect)((()=>{if(s.sortCode||s.accountNumber||s.accountHolderName)return;if(s.livemode||!N)return;if(!f.current||!v.current||!S.current)throw new Error("Input fields refs are not defined");const e=a.fillDemoData({sortCode:f,accountNumber:v,accountHolderName:S});return()=>{e()}}),[N,a,s.livemode]);const D=(0,kr.useCallback)((e=>{const t=e.target.value;a.changeSortCode(t),v.current&&6===t.length&&v.current.focus()}),[a]),T=(0,kr.useCallback)((e=>{const t=e.target.value;a.changeAccountNumber(t),S.current&&17===t.length&&S.current.focus()}),[a]);return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${l}`,"data-qa":"uk-bacs-title",onSubmit:e=>{y(),e.preventDefault(),a.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${l}`,screenTitle:r.translate("ukBacsScreen.title"),a11yAutoFocus:o,children:(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-30-medium",{"py-2":o}),"aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"icon-slot d-block",children:(0,Cl.jsx)(MN,{className:"p-abs inset-centered text-black",width:87,height:28})})})}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body d-flex flex-column",{"pt-8":!o,shake:P}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[(0,Cl.jsxs)("div",{className:"group-stacked-vertical",children:[(0,Cl.jsx)(Kd.t,{id:`sort-code-${l}`,className:(0,Ml.A)("text-sans-serif",{"pe-10":A}),formLabelClass:(0,Ml.A)({"pe-6":A}),formGroupClass:"group-stacked-item",label:r.translate("ukBacsScreen.sortCode.label"),labelFloating:!0,setRef:f,autoFocus:!0,autoFocusMode:vd.Q.DESKTOP,name:"sortCode",inputMode:"numeric",error:A,placeholder:r.translate("ukBacsScreen.sortCode.label"),value:null!==(t=s.sortCode)&&void 0!==t?t:"",disabled:s.locked,"aria-required":!0,"aria-describedby":`sort-code-${l}-error`,onKeyPress:UN,dataQa:"sort-code",onChange:D,onFocus:()=>d(!0),onBlur:()=>d(!1),children:A&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:u,children:(0,Cl.jsx)("p",{id:`sort-code-${l}-error`,children:r.translate("ukBacsScreen.sortCode.error")})})}),(0,Cl.jsx)(Kd.t,{id:`account-number-${l}`,className:(0,Ml.A)("text-sans-serif",{"pe-10":C}),formLabelClass:(0,Ml.A)({"pe-6":C}),formGroupClass:"group-stacked-item",setRef:v,label:r.translate("ukBacsScreen.accountNumber.label"),labelFloating:!0,name:"ukBacsAccountNumber",inputMode:"numeric",error:C,placeholder:r.translate("ukBacsScreen.accountNumber.label"),value:null!==(n=s.accountNumber)&&void 0!==n?n:"",disabled:s.locked,"aria-required":!0,"aria-describedby":`account-number-${l}-error`,onKeyPress:UN,dataQa:"account-number",onChange:T,onFocus:()=>m(!0),onBlur:()=>m(!1),children:C&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:h,children:(0,Cl.jsx)("p",{id:`account-number-${l}-error`,children:r.translate("ukBacsScreen.accountNumber.error")})})})]}),(0,Cl.jsx)(bc,{size:16}),(0,Cl.jsx)(Kd.t,{id:`account-holder-name-${l}`,className:(0,Ml.A)("text-sans-serif",{"pe-10":b}),formLabelClass:(0,Ml.A)({"pe-6":b}),formGroupClass:"p-rel",label:r.translate("ukBacsScreen.accountHolderName.label"),labelFloating:!0,setRef:S,name:"ukBacsAccountHolderName",error:b,placeholder:r.translate("ukBacsScreen.accountHolderName.label"),minLength:1,value:null!==(i=s.accountHolderName)&&void 0!==i?i:"",disabled:s.locked,"aria-required":!0,"aria-describedby":`account-holder-name-${l}-error`,dataQa:"account-holder-name",onChange:e=>a.changeAccountHolderName(e.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1),children:b&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:p,children:(0,Cl.jsx)("p",{id:`account-holder-name-${l}-error`,children:r.translate("ukBacsScreen.accountHolderName.error")})})}),(0,Cl.jsx)(bc,{size:16}),(0,Cl.jsx)(Fd,{setRef:E,customLabelClasses:"line-height-18 text-gray-80",checked:s.termsChecked,error:s.errors.termsChecked,disabled:s.locked,"aria-required":!0,"aria-describedby":`terms-checkbox-${l}-error`,onChange:()=>a.toggleTermsChecked(),dataQa:"uk-bacs-legal-checkbox",children:(0,Cl.jsx)("span",{className:(0,Ml.A)("body-20-regular",{"text-line-clamp-8":!o}),"data-qa":"uk-bacs-legal-text-label",children:r.translate("ukBacsScreen.legalInformation.label",{companyName:s.companyName})})}),s.errors.termsChecked&&(0,Cl.jsx)("p",{id:`terms-checkbox-${l}-error`,className:"sr-only",children:r.translate("ukBacsScreen.legalInformation.error")}),!o&&(0,Cl.jsx)(bc,{size:20})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:s.processingState,errorTitle:s.payErrorMessage||r.safeTranslate("common.errorOccurredText"),dataQa:"uk-bacs-continue-button",trackingElement:"nextButton",onClick:c,children:r.translate("ukBacsScreen.button")})})]})},VN=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:e.className,"aria-hidden":e.ariaHidden&&!0,fill:"none",height:"96",viewBox:"0 0 96 96",width:"96",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("linearGradient",{id:`a-${t}`,gradientUnits:"userSpaceOnUse",x1:"34",x2:"34",y1:"12",y2:"88",children:[(0,Cl.jsx)("stop",{offset:".360343",stopColor:"#e6f0ff"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#c9deff"})]}),(0,Cl.jsxs)("linearGradient",{id:`b-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#8dbaf8"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#bfdaff",stopOpacity:"0"})]}),(0,Cl.jsx)("linearGradient",{id:`c-${t}`,gradientUnits:"userSpaceOnUse",x1:"25",x2:"34",xlinkHref:`#b-${t}`,y1:"24",y2:"24"}),(0,Cl.jsxs)("linearGradient",{id:`d-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#739ad5"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#c1dafc"})]}),(0,Cl.jsx)("linearGradient",{id:`e-${t}`,gradientUnits:"userSpaceOnUse",x1:"24.5",x2:"24.5",xlinkHref:`#d-${t}`,y1:"24",y2:"4"}),(0,Cl.jsxs)("linearGradient",{id:`f-${t}`,children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#e8f4ff"}),(0,Cl.jsx)("stop",{offset:".756988",stopColor:"#4880d3",stopOpacity:".24"})]}),(0,Cl.jsx)("linearGradient",{id:`g-${t}`,gradientUnits:"userSpaceOnUse",x1:"25",x2:"25",xlinkHref:`#f-${t}`,y1:"4",y2:"24"}),(0,Cl.jsx)("linearGradient",{id:`h-${t}`,gradientUnits:"userSpaceOnUse",x1:"67",x2:"76",xlinkHref:`#b-${t}`,y1:"24",y2:"24"}),(0,Cl.jsx)("linearGradient",{id:`i-${t}`,gradientUnits:"userSpaceOnUse",x1:"66.5",x2:"66.5",xlinkHref:`#d-${t}`,y1:"24",y2:"4"}),(0,Cl.jsx)("linearGradient",{id:`j-${t}`,gradientUnits:"userSpaceOnUse",x1:"67",x2:"67",xlinkHref:`#f-${t}`,y1:"4",y2:"24"}),(0,Cl.jsx)("rect",{fill:"#a9cbff",height:"76",rx:"10",width:"92",x:"3",y:"16"}),(0,Cl.jsx)("rect",{fill:`url(#a-${t})`,height:"76",rx:"8",width:"90",x:"1",y:"12"}),(0,Cl.jsx)("path",{d:"m4.25439 86.4409c1.32765.9798 2.96908 1.559 4.74579 1.559h74.00002c4.4183 0 8-3.5817 8-8v-60c0-1.7767-.5792-3.4181-1.5591-4.7457.3599.843.5591 1.7711.5591 2.7457v62c0 3.866-3.134 7-7 7h-76.00002c-.97461 0-1.9027-.1991-2.74579-.559z",fill:"#dfecff"}),(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m26.7465 16.6999c.7142-1.0714 1.2535-2.7243 1.2535-4.6999h6c0 2.9949-.8039 5.8421-2.2612 8.0281-1.4434 2.165-3.7668 3.9719-6.7388 3.9719v-6c.3417 0 1.0183-.2078 1.7465-1.3001z",fill:`url(#c-${t})`,fillRule:"evenodd"}),(0,Cl.jsx)("path",{d:"m25 4c-2.2091 0-4 1.79086-4 4v4h10v-4c0-2.20914-1.7909-4-4-4z",fill:"#739ad5"}),(0,Cl.jsx)("path",{d:"m25 4c-2.2091 0-4 1.79086-4 4v12c0 2.2091 1.7909 4 4 4s4-1.7909 4-4v-12c0-.55229.4477-1 1-1s1 .44771 1 1c0-2.20914-1.7909-4-4-4z",fill:`url(#e-${t})`}),(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m25 5c-1.6569 0-3 1.34315-3 3v12c0 1.6569 1.3431 3 3 3s3-1.3431 3-3v-12c0-.87072.5564-1.61147 1.3331-1.8861-.55-.67948-1.3908-1.1139-2.3331-1.1139zm5.5007 1.06318c-.6822-1.23036-1.9942-2.06318-3.5007-2.06318h-2c-2.2091 0-4 1.79086-4 4v12c0 2.2091 1.7909 4 4 4s4-1.7909 4-4v-12c0-.49577.3608-.90727.8341-.9863.054-.00901.1094-.0137.1659-.0137.5523 0 1 .44771 1 1 0-.70264-.1812-1.36297-.4993-1.93682z",fill:`url(#g-${t})`,fillRule:"evenodd"}),(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m68.7465 16.6999c.7142-1.0714 1.2535-2.7243 1.2535-4.6999h6c0 2.9949-.8039 5.8421-2.2612 8.0281-1.4434 2.165-3.7668 3.9719-6.7388 3.9719v-6c.3417 0 1.0183-.2078 1.7465-1.3001z",fill:`url(#h-${t})`,fillRule:"evenodd"}),(0,Cl.jsx)("path",{d:"m67 4c-2.2091 0-4 1.79086-4 4v4h10v-4c0-2.20914-1.7909-4-4-4z",fill:"#739ad5"}),(0,Cl.jsx)("path",{d:"m67 4c-2.2091 0-4 1.79086-4 4v12c0 2.2091 1.7909 4 4 4s4-1.7909 4-4v-12c0-.55229.4477-1 1-1s1 .44771 1 1c0-2.20914-1.7909-4-4-4z",fill:`url(#i-${t})`}),(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m67 5c-1.6569 0-3 1.34315-3 3v12c0 1.6569 1.3431 3 3 3s3-1.3431 3-3v-12c0-.87072.5564-1.61147 1.3331-1.8861-.55-.67948-1.3908-1.1139-2.3331-1.1139zm5.5007 1.06318c-.6822-1.23036-1.9942-2.06318-3.5007-2.06318h-2c-2.2091 0-4 1.79086-4 4v12c0 2.2091 1.7909 4 4 4s4-1.7909 4-4v-12c0-.49577.3608-.90727.8341-.9863.054-.00901.1094-.0137.1659-.0137.5523 0 1 .44771 1 1 0-.70264-.1812-1.36297-.4993-1.93682z",fill:`url(#j-${t})`,fillRule:"evenodd"}),(0,Cl.jsxs)("g",{fill:"#b5cbee",children:[(0,Cl.jsx)("path",{d:"m14 51c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m32 51c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m50 51c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m68 51c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m14 69c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m32 69c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m50 69c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m68 69c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m14 33c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m32 33c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m50 33c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"}),(0,Cl.jsx)("path",{d:"m68 33c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z"})]}),(0,Cl.jsx)("path",{d:"m13 50c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m31 50c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m49 50c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m67 50c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m13 68c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m31 68c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m49 68c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m67 68c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m13 32c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m31 32c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m49 32c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{d:"m67 32c0-1.1046.8954-2 2-2h8c1.1046 0 2 .8954 2 2v8c0 1.1046-.8954 2-2 2h-8c-1.1046 0-2-.8954-2-2z",fill:"#f7faff"}),(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m60.9768 43.2791c3.0364.9078 5.2846 3.9193 4.9987 8.0868-.2477 3.6099-2.1691 7.1112-4.3664 9.9483-2.2111 2.855-4.8174 5.1863-6.6657 6.4679-.5554.3851-1.3173.2462-1.7017-.3103-.3845-.5565-.2458-1.3198.3096-1.705 1.6427-1.139 4.0669-3.2973 6.1252-5.9551 2.0723-2.6756 3.6593-5.7102 3.8586-8.6139.215-3.1337-1.4195-5.0206-3.2578-5.5701-1.83-.5472-4.1921.1325-5.6767 2.9002l-.6216 1.1588-1.1097-.7034c-1.879-1.1909-3.5844-1.2975-4.8373-.8748-1.2631.4261-2.1695 1.4163-2.4702 2.6611-.5706 2.3615 1.0339 6.6752 9.5698 9.5163.6411.2134.9881.907.7751 1.5493-.2129.6423-.9052.99-1.5463.7766-8.919-2.9687-12.2139-8.1234-11.1761-12.4189.5034-2.0837 2.0281-3.7192 4.067-4.4071 1.7439-.5884 3.7908-.4654 5.8467.5253 2.0401-2.8813 5.1448-3.8493 7.8788-3.032z",fill:"#fa4e77",fillRule:"evenodd"})]})},HN=(0,kr.memo)(VN);function KN(){const e=(0,kr.useRef)(!1),t=Uc().get(u.QUARTERLY_UPSELL_MODAL_EXPERIMENT),n=(0,kr.useCallback)((n=>{e.current||(t.tryExposure({targetFrequency:n}),e.current=!0)}),[t]);return{isQuarterlyUpsellExperimentActive:t.isTestGroup(),tryToExposeQuarterlyUpsell:n}}var YN;!function(e){e.HIGH="high",e.LOW="low"}(YN||(YN={}));const zN=e=>{let{disabled:t,trackingElement:n,onClick:i}=e;const{state:s}=Tc(Vn.UPSELL);return(0,Cl.jsxs)(lh,{className:"btn-danger d-flex items-center justify-center",processingState:s.processingState.highMonthly,disabled:t,trackingElement:null!=n?n:"",dataTestId:"upsell-high",dataQa:"upsell-high",onClick:()=>i(YN.HIGH),children:[(0,Cl.jsx)(Fu,{className:"icon-fill shrink-0 font-size-18 me-2","aria-hidden":!0}),(0,Cl.jsx)("span",{className:"text-truncate",children:s.highButtonText})]})},WN=(0,kr.memo)(zN),$N=e=>{let{className:t,disabled:n,trackingElement:i,onClick:s}=e;const{state:a}=Tc(Vn.UPSELL);return(0,Cl.jsx)(lh,{className:(0,Ml.A)("btn-primary",t),processingState:a.processingState.lowMonthly,disabled:n,trackingElement:null!=i?i:"",dataTestId:"upsell-low",dataQa:"upsell-low-monthly",onClick:()=>s(YN.LOW),children:a.lowButtonText})},XN=(0,kr.memo)($N),QN=e=>{const{amount:t,currency:n,trackingElement:i,disabled:s,onClick:a,targetFrequency:o}=e,r=(0,nc.t)();let l="";const{isQuarterlyUpsellExperimentActive:c}=KN(),u=r.formatAmount({amount:t,currency:n,numberFormat:Kt.FLOAT,currencyFormat:Yt.SHORT,forceExplicit:!0});return l=c&&o===qn.QUARTERLY?r.translate("upsellScreen.button.keepMonthly",{amount:u}):r.translate("upsellScreen.button.keepOneTimeLink",{amount:u}),(0,Cl.jsx)("button",{type:"button",className:"btn-link text-truncate",disabled:s,"data-tracking-element-name":i,"data-qa":"upsell-one-time","data-testid":"keep-one-time-link",onClick:a,children:l})},ZN=(0,kr.memo)(QN),JN=()=>{const{state:e}=Tc(Vn.UPSELL),t=(0,Bl.P)();return(0,Cl.jsx)("p",{className:(0,Ml.A)("text-center",t?"text-ellipsis":"text-line-clamp-6"),dangerouslySetInnerHTML:{__html:e.questionShortText},"data-testid":"upsell-screen-question-text"})},eD=(0,kr.memo)(JN),tD=()=>{const{state:e,controller:t}=Tc(Vn.UPSELL),n=(0,kr.useId)(),i=(0,Bl.P)(),{tryToExposeQuarterlyUpsell:s}=KN(),{tryToExpose:a}=function(){const e=(0,kr.useRef)(!1),t=Uc().get(u.UPSELL_AMOUNTS_DATASET_MODAL_EXPERIMENT);return{tryToExpose:(0,kr.useCallback)((n=>{e.current||n!==qn.ANNUAL&&(t.tryToExpose(n),e.current=!0)}),[t])}}(),o=(0,kr.useCallback)((e=>{t.confirm(e)}),[t]);return(0,kr.useEffect)((()=>{t.setShowed()}),[t]),(0,kr.useEffect)((()=>{s(e.targetFrequency)}),[e.targetFrequency,s]),(0,kr.useEffect)((()=>{a(e.targetFrequency)}),[e.targetFrequency,a]),(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${n}`,"data-qa":"active-screen-upsell",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${n}`,title:e.screenTitle,titleTestId:"upsell-screen-title",a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"py-6":e.isAnnualTribute&&!i,"py-8":!e.isAnnualTribute&&!i}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[e.isAnnualTribute&&(0,Cl.jsx)(HN,{className:"d-block mx-auto mt-2 mb-6",ariaHidden:!0}),(0,Cl.jsx)(eD,{})]})}),(0,Cl.jsxs)(gd,{children:[e.highAmount&&(0,Cl.jsx)(WN,{amount:e.highAmount,trackingElement:"oldUpsellHighMonthly",disabled:t.isLocked,onClick:o}),e.lowAmount&&(0,Cl.jsx)(XN,{className:"mt-2",amount:e.lowAmount,trackingElement:"oldUpsellLowMonthly",disabled:t.isLocked,onClick:o}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-4",children:(0,Cl.jsx)(ZN,{amount:e.upsell.fromAmount,currency:e.currency,trackingElement:"oldUpsellKeep",disabled:t.isLocked,onClick:()=>o(null),targetFrequency:e.targetFrequency})})]})]})},nD=(0,kr.memo)(tD),iD={boxShadow:"inset 0 0 0 1px #c7cdd6"},sD={boxShadow:"inset 0 -1px 0 0 #c7cdd6"},aD={letterSpacing:"-0.2em"},oD=e=>{const t=(0,kr.useId)();return(0,Cl.jsxs)("svg",{className:(0,Ml.A)(e.className),"aria-hidden":!!e.ariaHidden||void 0,fill:"none",height:e.height||128,viewBox:"0 0 158 128",width:e.width||158,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,Cl.jsxs)("filter",{id:`a-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"33",width:"11",x:"98.4998",y:"59",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`b-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"33",width:"11",x:"73.4998",y:"59",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`c-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"6",width:"91",x:"33.4998",y:"103",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`d-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"6",width:"79",x:"39.4998",y:"97",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`e-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"30",width:"90",x:"34.4998",y:"19",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`f-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"96.4998",y:"92",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`g-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"96.4998",y:"54",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`h-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"71.4998",y:"92",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`i-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"71.4998",y:"54",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`j-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"33",width:"11",x:"48.4998",y:"59",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`k-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"46.4998",y:"92",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`l-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"15",x:"46.4998",y:"54",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`m-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"5",width:"82",x:"38.4998",y:"49",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",mode:"normal",result:"shape"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dy:"-1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",k2:"-1",k3:"1",operator:"arithmetic"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.725694 0 0 0 0 0.753183 0 0 0 0 0.791667 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"shape",mode:"normal",result:"effect1_innerShadow_16856_24583"})]}),(0,Cl.jsxs)("filter",{id:`n-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"66.4238",width:"51.5996",x:"9.14014",y:"24.7031",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:".5",dy:".5"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.06125 0 0 0 0 0.525 0 0 0 0 0.132596 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_16856_24583"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_16856_24583",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("filter",{id:`o-${t}`,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",height:"34.9189",width:"28.3767",x:"20.7512",y:"39.0498",children:[(0,Cl.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,Cl.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Cl.jsx)("feOffset",{dx:".5",dy:".5"}),(0,Cl.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,Cl.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Cl.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.160784 0 0 0 0 0.619608 0 0 0 0 0.231373 0 0 0 1 0"}),(0,Cl.jsx)("feBlend",{in2:"BackgroundImageFix",mode:"normal",result:"effect1_dropShadow_16856_24583"}),(0,Cl.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_16856_24583",mode:"normal",result:"shape"})]}),(0,Cl.jsxs)("linearGradient",{id:`p-${t}`,gradientUnits:"userSpaceOnUse",x1:"7.07017",x2:"54.682",y1:"32.2054",y2:"71.3086",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#beffd2"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#beffd2",stopOpacity:".15"})]}),(0,Cl.jsxs)("linearGradient",{id:`q-${t}`,gradientUnits:"userSpaceOnUse",x1:"18.1884",x2:"39.841",y1:"54.9202",y2:"81.3544",children:[(0,Cl.jsx)("stop",{offset:"0",stopColor:"#ebfff1"}),(0,Cl.jsx)("stop",{offset:"1",stopColor:"#ebfff1",stopOpacity:"0"})]}),(0,Cl.jsx)("g",{filter:`url(#a-${t})`,children:(0,Cl.jsx)("path",{d:"m98.4998 59h11v33h-11z",fill:"#dde0eb"})}),(0,Cl.jsx)("g",{filter:`url(#b-${t})`,children:(0,Cl.jsx)("path",{d:"m73.4998 59h11v33h-11z",fill:"#dde0eb"})}),(0,Cl.jsx)("g",{filter:`url(#c-${t})`,children:(0,Cl.jsx)("path",{d:"m33.4998 103h91v6h-91z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#d-${t})`,children:(0,Cl.jsx)("path",{d:"m39.4998 97h79v6h-79z",fill:"#dde0eb"})}),(0,Cl.jsx)("g",{filter:`url(#e-${t})`,children:(0,Cl.jsx)("path",{d:"m34.4998 43.2308 45-24.2308 45.0002 24.2308v5.7692h-90.0002z",fill:"#c9cfd7"})}),(0,Cl.jsx)("path",{d:"m48.4998 43 31-16 31.0002 16z",fill:"#dde0eb"}),(0,Cl.jsx)("g",{filter:`url(#f-${t})`,children:(0,Cl.jsx)("path",{d:"m96.4998 94c0-1.1046.8954-2 2-2h11.0002c1.104 0 2 .8954 2 2v3h-15.0002z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#g-${t})`,children:(0,Cl.jsx)("path",{d:"m96.4998 57c0 1.1046.8954 2 2 2h11.0002c1.104 0 2-.8954 2-2v-3h-15.0002z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#h-${t})`,children:(0,Cl.jsx)("path",{d:"m71.4998 94c0-1.1046.8954-2 2-2h11c1.1045 0 2 .8954 2 2v3h-15z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#i-${t})`,children:(0,Cl.jsx)("path",{d:"m71.4998 57c0 1.1046.8954 2 2 2h11c1.1045 0 2-.8954 2-2v-3h-15z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#j-${t})`,children:(0,Cl.jsx)("path",{d:"m48.4998 59h11v33h-11z",fill:"#dde0eb"})}),(0,Cl.jsx)("g",{filter:`url(#k-${t})`,children:(0,Cl.jsx)("path",{d:"m46.4998 94c0-1.1046.8954-2 2-2h11c1.1045 0 2 .8954 2 2v3h-15z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#l-${t})`,children:(0,Cl.jsx)("path",{d:"m46.4998 57c0 1.1046.8954 2 2 2h11c1.1045 0 2-.8954 2-2v-3h-15z",fill:"#c9cfd7"})}),(0,Cl.jsx)("g",{filter:`url(#m-${t})`,children:(0,Cl.jsx)("path",{d:"m38.4998 49h82.0002l-2.216 5h-77.568z",fill:"#dde0eb"})}),(0,Cl.jsx)("path",{d:"m35.8866 19.5614c-.9308-.3612-1.963-.3612-2.8938 0l-28.21625 10.9479c-.7695.2985-1.27655 1.0392-1.27655 1.8645v25.0408c0 24.0092 24.3098 38.4147 30.9397 38.4147 6.63 0 30.9398-14.4055 30.9398-38.4147v-25.0408c0-.8253-.5071-1.566-1.2766-1.8645z",fill:"#3ac24f"}),(0,Cl.jsxs)("g",{filter:`url(#n-${t})`,children:[(0,Cl.jsx)("path",{clipRule:"evenodd",d:"m10.6401 35.6313v21.5716c0 9.4566 4.6827 17.33 10.5723 23.0788 2.9207 2.851 6.0022 5.0351 8.632 6.4779 1.3139.7208 2.4515 1.2217 3.3408 1.5298.7584.2627 1.1579.3229 1.2493.3367l.0054.0008.0054-.0008c.0915-.0138.4909-.074 1.2493-.3367.8893-.3081 2.0269-.809 3.3408-1.5298 2.6298-1.4428 5.7113-3.6269 8.6321-6.4779 5.8896-5.7488 10.5722-13.6222 10.5722-23.0788v-21.5716l-23.7998-9.4282z",fill:"#3bcb53",fillRule:"evenodd"}),(0,Cl.jsx)("path",{d:"m34.4399 87.9681c-.155-.0285-.4945-.1033-1.0419-.2929-.8485-.294-1.9525-.7786-3.2409-1.4855-2.5788-1.4148-5.6126-3.5638-8.4907-6.3731-5.8068-5.668-10.3763-13.3839-10.3763-22.6137v-21.13l23.1498-9.1706 23.1498 9.1706v21.13c0 9.2298-4.5694 16.9457-10.3762 22.6137-2.8781 2.8093-5.9119 4.9583-8.4907 6.3731-1.2884.7069-2.3924 1.1915-3.2409 1.4855-.5475.1896-.887.2644-1.042.2929z",stroke:`url(#p-${t})`,strokeWidth:"1.3"})]}),(0,Cl.jsxs)("g",{filter:`url(#o-${t})`,children:[(0,Cl.jsx)("path",{d:"m44.8987 53.0362h-.618v-2.8197c0-5.2152-4.2452-9.5718-9.5513-9.6648-.1449-.0025-.4346-.0025-.5796 0-5.3061.093-9.5513 4.4496-9.5513 9.6648v2.8197h-.6181c-.9523 0-1.7292.9581-1.7292 2.1413v14.1425c0 1.1819.7769 2.1489 1.7293 2.1489h20.9182c.9524 0 1.7293-.967 1.7293-2.1489v-14.1425c0-1.1832-.7769-2.1413-1.7293-2.1413zm-8.4993 9.1982v4.2733c0 .4893-.4203.9034-.9226.9034h-2.0743c-.5024 0-.9226-.4141-.9226-.9034v-4.2733c-.4872-.4675-.7708-1.114-.7708-1.8292 0-1.3552 1.0745-2.5197 2.4408-2.5735.1448-.0057.4348-.0057.5796 0 1.3663.0538 2.4408 1.2183 2.4408 2.5735-.0001.7152-.2837 1.3617-.7709 1.8292zm3.8082-9.1982h-5.4782-.5796-5.4781v-2.8197c0-3.1066 2.5897-5.6753 5.7679-5.6753s5.768 2.5687 5.768 5.6753z",fill:"#beffd2"}),(0,Cl.jsx)("path",{d:"m43.7807 53.0362v.5h.5.618c.5823 0 1.2293.6298 1.2293 1.6413v14.1425c0 1.0129-.6492 1.6489-1.2293 1.6489h-20.9182c-.5801 0-1.2293-.636-1.2293-1.6489v-14.1425c0-1.0116.647-1.6413 1.2292-1.6413h.6181.5v-.5-2.8197c0-4.9418 4.026-9.0766 9.0601-9.1649.1391-.0024.4229-.0024.5621 0 5.034.0883 9.06 4.2231 9.06 9.1649zm-6.1104 7.3691v-.0001c0-1.6134-1.2764-3.0083-2.9211-3.0731-.1579-.0063-.4611-.0063-.619 0-1.6447.0648-2.9211 1.4597-2.9211 3.0731 0 .7736.28 1.4858.7708 2.0312v4.0713c0 .7744.6531 1.4034 1.4226 1.4034h2.0743c.7695 0 1.4226-.629 1.4226-1.4034v-4.0713c.4907-.5454.7708-1.2576.7709-2.0311zm-9.4986-7.3691v.5h.5 5.4781.5796 5.4782.5v-.5-2.8197c0-3.3892-2.8202-6.1753-6.268-6.1753-3.4479 0-6.2679 2.7861-6.2679 6.1753z",stroke:`url(#q-${t})`})]})]})},rD=(0,kr.memo)(oD);var lD;!function(e){e.INDIVIDUAL="individual",e.COMPANY="company"}(lD||(lD={}));const{useAddFieldToScroll:cD,useScrollToFieldsTrigger:uD,ScrollToFieldsProvider:dD}=(0,Ud.J)(),hD=e=>{var t,n,i;const{state:s,controller:a}=Tc(Vn.US_BANK_ACCOUNT),o=(0,Bl.P)(),r=(0,nc.t)(),l=(0,kr.useId)(),c=s.errors.routingNumber,u=s.errors.accountNumber,d=s.errors.accountHolderName,h=uD(),m=$d(s.shakeKey,0!==s.shakeKey),p=(0,Qu.k)(),g=(0,kr.useRef)(null),y=(0,kr.useRef)(null),f=(0,kr.useRef)(null),[v,S]=(0,kr.useState)(!1),[E,A]=(0,kr.useState)(!1),[C,b]=(0,kr.useState)(!1);cD(g,(e=>Boolean(e.routingNumber))),cD(y,(e=>Boolean(e.accountNumber))),cD(f,(e=>Boolean(e.accountHolderName))),(0,kr.useEffect)((()=>{if(s.routingNumber||s.accountNumber||s.accountHolderName)return;if(s.livemode||!p)return;if(!g.current||!y.current||!f.current)throw new Error("Input fields refs are not defined");const e=a.fillDemoData({routingNumber:g.current,accountNumber:y.current,accountHolderName:f.current});return()=>{e()}}),[p,a,s.livemode]);const P=(0,kr.useCallback)((e=>{const t=e.target.value;a.changeRoutingNumber(t),y.current&&9===t.length&&y.current.focus()}),[a]),N=(0,kr.useCallback)((e=>{const t=e.target.value;a.changeAccountNumber(t),f.current&&17===t.length&&f.current.focus()}),[a]);return(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${l}`,"data-qa":"active-screen-routing-account",onSubmit:e=>{h(),e.preventDefault(),a.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${l}`,title:r.translate("usBankAccountScreen.title"),a11yAutoFocus:o}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body d-flex flex-column",{"pt-5 pb-7":!o}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[(0,Cl.jsx)("p",{className:(0,Ml.A)("shrink-0 text-center",o?"text-ellipsis":"text-line-clamp-3"),children:r.translate("usBankAccountScreen.description.desktop")}),(0,Cl.jsx)(bc,{size:o?28:20,sizeMin:6}),(0,Cl.jsx)(Jv,{className:"shrink-0 mx-auto",firstNumber:"119562715",secondNumber:"891562828814208",firstNumberHighlighted:v,secondNumberHighlighted:E}),(0,Cl.jsx)(bc,{size:o?28:20,sizeMin:6}),(0,Cl.jsxs)("div",{className:(0,Ml.A)("group-stacked-vertical shrink-0",{shake:m}),children:[(0,Cl.jsx)(Kd.t,{id:`routing-number-${l}`,className:(0,Ml.A)("text-sans-serif",{"pe-10":c}),formLabelClass:(0,Ml.A)({"pe-6":c}),formGroupClass:"group-stacked-item",label:r.translate("usBankAccountScreen.routingNumber.label"),labelFloating:!0,autoFocus:!0,autoFocusMode:vd.Q.DESKTOP,setRef:g,error:c,placeholder:r.translate("usBankAccountScreen.routingNumber.label"),value:null!==(t=s.routingNumber)&&void 0!==t?t:"",maxLength:9,disabled:s.locked,"aria-required":!0,"aria-describedby":`routing-number-${l}-error`,onChange:P,onKeyPress:UN,onFocus:()=>S(!0),onBlur:()=>S(!1),dataQa:"routing-number",inputMode:"numeric",children:c&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:v,children:(0,Cl.jsx)("p",{id:`routing-number-${l}-error`,children:r.translate("usBankAccountScreen.routingNumber.error")})})}),(0,Cl.jsx)(Kd.t,{id:`account-number-${l}`,className:(0,Ml.A)("text-sans-serif",{"pe-10":u}),formLabelClass:(0,Ml.A)({"pe-6":u}),formGroupClass:"group-stacked-item",label:r.translate("usBankAccountScreen.accountNumber.label"),labelFloating:!0,setRef:y,error:u,placeholder:r.translate("usBankAccountScreen.accountNumber.label"),value:null!==(n=s.accountNumber)&&void 0!==n?n:"",maxLength:17,minLength:4,disabled:s.locked,"aria-required":!0,"aria-describedby":`account-number-${l}-error`,onKeyPress:UN,onChange:N,onFocus:()=>A(!0),onBlur:()=>A(!1),dataQa:"ach-account-number",inputMode:"numeric",children:u&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:E,children:(0,Cl.jsx)("p",{id:`account-number-${l}-error`,children:r.translate("usBankAccountScreen.accountNumber.error")})})})]}),(0,Cl.jsx)(bc,{size:16,sizeMin:6}),(0,Cl.jsx)(Kd.t,{id:`account-holder-name-${l}`,className:(0,Ml.A)({"pe-10":d}),formLabelClass:(0,Ml.A)({"pe-6":d}),formGroupClass:(0,Ml.A)("shrink-0",{shake:m}),label:r.translate("usBankAccountScreen.accountHolderName.label"),labelFloating:!0,setRef:f,error:d,placeholder:r.translate("usBankAccountScreen.accountHolderName.label"),minLength:1,value:null!==(i=s.accountHolderName)&&void 0!==i?i:"",disabled:s.locked,"aria-describedby":`account-holder-name-${l}-error`,onChange:e=>a.changeAccountHolderName(e.target.value),onFocus:()=>b(!0),onBlur:()=>b(!1),dataQa:"us-bank-account-holder-name",children:d&&(0,Cl.jsx)(fu.U,{className:"p-abs inset-centered-end z-index-5 me-4",showTooltip:C,children:(0,Cl.jsx)("p",{id:`account-holder-name-${l}-error`,children:r.translate("usBankAccountScreen.accountHolderName.error")})})}),(0,Cl.jsx)(bc,{size:20,sizeMin:6}),(0,Cl.jsxs)("div",{role:"radiogroup",className:"d-flex justify-center shrink-0","aria-label":r.translate("usBankAccountScreen.accountType.label"),children:[(0,Cl.jsx)(Um,{radioName:"accountType",className:"max-w-50 me-3",checked:s.accountType===lD.INDIVIDUAL,radioValue:s.accountType,disabled:s.locked,onChange:()=>a.changeAccountType(lD.INDIVIDUAL),dataQa:"personal-bank-account",trackingElement:"personalBankAccount",children:(0,Cl.jsx)("span",{className:"text-truncate",children:r.translate("usBankAccountScreen.accountType.personal")})}),(0,Cl.jsx)(Um,{radioName:"accountType",className:"max-w-50 ms-3",checked:s.accountType===lD.COMPANY,radioValue:s.accountType,disabled:s.locked,onChange:()=>a.changeAccountType(lD.COMPANY),dataQa:"business-bank-account",trackingElement:"businessBankAccount",children:(0,Cl.jsx)("span",{className:"text-truncate",children:r.translate("usBankAccountScreen.accountType.business")})})]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{type:"submit",className:"btn-primary",processingState:s.processingState,errorTitle:s.errorMessage||r.safeTranslate("common.errorOccurredText"),dataQa:"ach-continue",trackingElement:"nextButton",children:r.translate("usBankAccountScreen.button")})})]})},mD={filter:"drop-shadow(rgba(109, 141, 177, 0.5) 0 1px 5px)"},pD={letterSpacing:"-0.2em"},gD={background:"#E3EDF6",height:"12px"},yD=Object.assign(Object.assign({},gD),{width:"146px"}),fD=Object.assign(Object.assign({},gD),{width:"46px"}),vD=e=>{const t=(0,nc.t)(),n=(0,gc.Q)(),i=(0,Bl.P)();return(0,Cl.jsxs)("div",{className:"fixed-container",children:[e.showAmountExample&&(0,Cl.jsx)(fc,{as:"p",className:(0,Ml.A)("text-center",i?"text-ellipsis":"text-line-clamp-7"),token:"usBankAccountGuideScreen.description.amounts",params:{amount:t.formatCurrency(100,{currency:"USD"})}}),e.showDescriptorCodeExample&&(0,Cl.jsx)(fc,{as:"p",className:(0,Ml.A)("text-center",i?"text-ellipsis":"text-line-clamp-7"),token:"usBankAccountGuideScreen.description.descriptorCode"}),(0,Cl.jsx)("div",{className:"mt-5",style:mD,children:(0,Cl.jsxs)("div",{className:"us-bank-account-receipt w-100 px-6 pt-4 bg-gray-05 border-top-radius-4 mx-auto",children:[(0,Cl.jsx)("p",{className:"text-center text-truncate",children:t.translate("usBankAccountGuideScreen.bankStatement")}),(0,Cl.jsx)("hr",{className:"mt-4","aria-hidden":!0}),e.showAmountExample&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("p",{className:(0,Ml.A)("body-40-regular d-flex gap-x-1 py-3",{"text-start":n}),dir:"ltr",children:[(0,Cl.jsxs)("span",{className:(0,Ml.A)("text-gray-60 grow-1",i?"text-ellipsis":"text-line-clamp-2"),children:[e.statementDescriptor,":"]}),(0,Cl.jsx)("span",{className:"shrink-0 text-sans-serif",dangerouslySetInnerHTML:{__html:e.amountExample}})]}),(0,Cl.jsx)("hr",{"aria-hidden":!0}),(0,Cl.jsxs)("p",{className:(0,Ml.A)("body-40-regular d-flex gap-x-1 py-3 ",{"text-start":n}),dir:"ltr",children:[(0,Cl.jsxs)("span",{className:(0,Ml.A)("text-gray-60 grow-1",i?"text-ellipsis":"text-line-clamp-2"),children:[e.statementDescriptor,":"]}),(0,Cl.jsx)("span",{className:"shrink-0 text-sans-serif",dangerouslySetInnerHTML:{__html:e.amountExample}})]}),(0,Cl.jsx)("hr",{className:"mb-3","aria-hidden":!0})]}),e.showDescriptorCodeExample&&(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsxs)("p",{className:(0,Ml.A)("body-40-regular d-flex gap-x-1 py-3",{"text-start":n}),dir:"ltr",children:[(0,Cl.jsxs)("span",{className:"d-flex flex-wrap grow-1",children:[(0,Cl.jsxs)("span",{className:(0,Ml.A)("text-gray-60 me-1",i?"text-ellipsis":"text-line-clamp-2"),children:[e.statementDescriptor,":"]}),(0,Cl.jsxs)("span",{className:"d-flex body-40-medium shrink-0 text-nowrap",children:[e.descriptorCodeExample.prefix,(0,Cl.jsx)("span",{className:"d-inline-block font-size-18",style:pD,"aria-hidden":!0,children:""})]})]}),(0,Cl.jsx)("span",{className:"text-gray-60 shrink-0 text-sans-serif",dangerouslySetInnerHTML:{__html:e.descriptorCodeExample.amount}})]}),(0,Cl.jsx)("hr",{"aria-hidden":!0}),(0,Cl.jsxs)("div",{className:"d-flex justify-between mt-4 mb-3",dir:"ltr",children:[(0,Cl.jsx)("div",{className:"border-radius-8",style:yD}),(0,Cl.jsx)("div",{className:"border-radius-8",style:fD})]})]})]})})]})},SD=(0,kr.memo)(vD),ED={[Vn.DONATE]:()=>{const{state:e}=Tc(Vn.DONATE);return(0,Cl.jsx)(NS,{state:e.errors,children:(0,Cl.jsx)($E,{})})},[Vn.UPSELL]:nD,[Vn.PAYMENT_OPTIONS]:e=>{const{stripeElementsCardState:t,setStripeElementsCardState:n}=IA();return(0,Cl.jsx)($C,{state:t,children:(0,Cl.jsx)(PN,Object.assign({},e,{stripeElementsCardState:t,setStripeElementsCardState:n}))})},[Vn.US_BANK_ACCOUNT]:e=>{const{state:t}=Tc(Vn.US_BANK_ACCOUNT);return(0,Cl.jsx)(dD,{state:t.errors,children:(0,Cl.jsx)(hD,Object.assign({},e))})},[Vn.US_BANK_ACCOUNT_DONATE_OPTIONS]:e=>{const{state:t,controller:n}=Tc(Vn.US_BANK_ACCOUNT_DONATE_OPTIONS),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,Bl.P)(),{saveTriggerElement:o,returnFocusToTrigger:r}=kl(),l=(0,kr.useCallback)((e=>{e.currentTarget&&o(e.currentTarget),n.authorizeToBank({onModalHide:()=>{r()}})}),[n,o,r]);return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${s}`,"data-qa":"active-screen-link-to-bank",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,title:i.translate("usBankAccountDonateOptionsScreen.title"),a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body items-center",a?"pb-3":"justify-center py-4"),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsx)(rD,{className:"d-block mx-auto",ariaHidden:!0}),(0,Cl.jsx)("p",{className:"text-center mt-4",children:i.translate("usBankAccountDonateOptionsScreen.description")})]})}),(0,Cl.jsxs)(gd,{children:[(0,Cl.jsx)(lh,{className:"btn-primary",processingState:t.processingState,errorTitle:t.loginToBankError,disabled:t.locked,dataQa:"authorize-bank-button",trackingElement:"authorizeBankButton",onClick:l,children:i.translate("usBankAccountDonateOptionsScreen.button.authorize")}),(0,Cl.jsx)("button",{type:"button",className:"btn btn-default mt-3",disabled:t.locked,"data-qa":"routing-account-button","data-tracking-element-name":"routingAccountButton",onClick:()=>n.fillDetailsManually(),children:i.translate("usBankAccountDonateOptionsScreen.button.routing")})]})]})},[Vn.US_BANK_ACCOUNT_CONFIRMATION]:()=>{const{state:e,controller:t}=Tc(Vn.US_BANK_ACCOUNT_CONFIRMATION),n=(0,kr.useId)(),i=(0,Bl.P)(),s=(0,nc.t)();return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${n}`,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${n}`,title:s.translate("usBankAccountConfirmationScreen.title"),titleQa:"us-bank-account-confirmation-title",a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body d-flex flex-column",{"py-5":!i}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 d-flex flex-column min-h-0",children:[(0,Cl.jsxs)("div",{className:"shrink-0 bg-white border-radius-8",style:iD,children:[(0,Cl.jsxs)("div",{className:"px-3 py-2",style:sD,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("usBankAccountConfirmationScreen.agreementDate")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate","data-qa":"agreement-date-label",children:e.usBankAccount.agreementDate})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",style:sD,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("usBankAccountConfirmationScreen.accountHolderName")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate","data-qa":"account-holder-name-label",children:e.usBankAccount.accountHolderName})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",style:sD,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("usBankAccountConfirmationScreen.financialInstitution")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate","data-qa":"financial-institution-label",children:e.usBankAccount.financialInstitution})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",style:sD,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("usBankAccountConfirmationScreen.routingNumber")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate","data-qa":"routing-number-label",children:e.usBankAccount.routingNumber})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:s.translate("usBankAccountConfirmationScreen.accountNumber")}),(0,Cl.jsxs)("p",{className:"body-60-regular d-flex items-start text-truncate",children:[(0,Cl.jsx)("span",{className:"font-size-18 shrink-0 me-1 font-weight-400",style:aD,"aria-hidden":!0,children:""}),(0,Cl.jsx)("span",{className:"shrink-0","data-qa":"account-number-last4-label",children:e.usBankAccount.accountNumberLast4})]})]})]}),(0,Cl.jsx)("div",{className:i?"mt-5":"grow-1 min-h-0 p-rel mt-4",children:(0,Cl.jsx)("div",{className:(0,Ml.A)({"p-abs inset-0 scroll-box":!i}),children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular text-gray-80 text-ellipsis",{"px-3 py-2-5":!i,"pointer-events-none":e.locked}),children:e.isRecurring?s.translate("usBankAccountConfirmationScreen.mandateRecurring",{companyName:e.companyName}):s.translate("usBankAccountConfirmationScreen.mandate",{companyName:e.companyName,payButtonTitle:s.translate("usBankAccountConfirmationScreen.button")})})})})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{className:"btn-primary",processingState:e.processingState,errorTitle:e.payErrorMessage,onClick:()=>{t.leave()},dataQa:"us-bank-account-pay-button",trackingElement:"nextButton",children:s.translate("usBankAccountConfirmationScreen.button")})})]})},[Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE]:e=>{const{state:t,controller:n}=Tc(Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,Bl.P)();return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${s}`,"data-qa":"active-screen-us-bank-account-guide",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,title:i.translate("usBankAccountGuideScreen.title"),a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-6":!a}),children:(0,Cl.jsx)(SD,{statementDescriptor:t.statementDescriptor,amountExample:n.amountExample,descriptorCodeExample:n.descriptorCodeExample,showAmountExample:"amounts"===t.verificationType,showDescriptorCodeExample:"descriptor_code"===t.verificationType})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>{n.leave()},"data-qa":"us-bank-account-micro-dep-continue-button",children:i.translate("usBankAccountGuideScreen.button")})})]})},[Vn.UK_BACS]:e=>{const{state:t}=Tc(Vn.UK_BACS);return(0,Cl.jsx)(GN,{state:t.errors,children:(0,Cl.jsx)(qN,Object.assign({},e))})},[Vn.UK_BACS_CONFIRMATION]:e=>{const{state:t,controller:n}=Tc(Vn.UK_BACS_CONFIRMATION),i=(0,kr.useId)(),s=(0,Bl.P)(),a=(0,nc.t)(),o=_N(t.ukBacs.sortCode.match(/(\d{2})/g)||[],"-");return(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${i}`,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${i}`,title:a.translate("ukBacsConfirmationScreen.title"),titleQa:"uk-bacs-confirmation-title",a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-8 pb-3":!s}),children:(0,Cl.jsxs)("div",{className:"fixed-container",children:[(0,Cl.jsxs)("div",{className:"bg-white border-radius-8",style:LN,children:[(0,Cl.jsxs)("div",{className:"px-3 py-2",style:FN,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:a.translate("ukBacsConfirmationScreen.email")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate",children:t.email})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",style:FN,children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:a.translate("ukBacsConfirmationScreen.name")}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate",children:t.ukBacs.accountHolderName})]}),(0,Cl.jsxs)("div",{className:"px-3 py-2",children:[(0,Cl.jsx)("p",{className:"compact-20-semibold text-truncate text-gray-60",children:a.translate("ukBacsConfirmationScreen.accountDetails")}),(0,Cl.jsxs)("div",{className:"d-flex text-sans-serif",children:[(0,Cl.jsx)("p",{className:"body-60-regular text-truncate me-3",children:o}),(0,Cl.jsx)("p",{className:"body-60-regular text-truncate",children:t.ukBacs.accountNumber})]})]})]}),(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-20-regular mt-4",s?"text-ellipsis":"text-line-clamp-7"),as:"p",token:"ukBacsConfirmationScreen.legalInformation",params:{statementDescriptor:t.company.stripe.ukBacsDisplayName,email:t.email}}),(0,Cl.jsx)("hr",{className:"my-3","aria-hidden":!0}),(0,Cl.jsxs)("div",{className:"d-flex items-center",children:[(0,Cl.jsx)(fc,{className:(0,Ml.A)("body-20-regular",s?"text-ellipsis":"text-line-clamp-2 p-1 m-minus-1",{"pointer-events-none":t.locked}),as:"p",token:"ukBacsConfirmationScreen.guarantee",params:{link:"https://stripe.com/bacs_debit/direct-debit-guarantee"}}),(0,Cl.jsx)(MN,{className:"text-gray-60 shrink-0 ms-3",width:67,height:22,"aria-hidden":!0})]})]})}),(0,Cl.jsx)(gd,{children:(0,Cl.jsx)(lh,{className:"btn-primary",processingState:t.processingState,errorTitle:t.payErrorMessage,onClick:()=>{n.leave()},dataQa:"uk-bacs-pay-button",trackingElement:"nextButton",children:th(a,t.formattedAmount,t.frequency)})})]})},[Vn.AU_BECS]:e=>{const{stripeElementState:t,setStripeElementState:n}=Xv();return(0,Cl.jsx)(eS,{state:t,children:(0,Cl.jsx)(sS,Object.assign({stripeElementState:t,setStripeElementState:n},e))})},[Vn.DOUBLE]:kA,[Vn.GIFT_AID]:e=>{const{state:t,controller:n}=Tc(Vn.GIFT_AID),i=(0,nc.t)(),s=(0,kr.useId)(),a=(0,Bl.P)(),o=(0,kr.useCallback)((e=>{n.changeGiftAid(e),n.leave()}),[n]),r=(0,kr.useCallback)((()=>{o(!1)}),[o]);return(0,kr.useEffect)((()=>{n.setShown()}),[n]),(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${s}`,"data-qa":"active-screen-gift-aid",children:[(0,Cl.jsx)(Ad,{id:`screen-header-${s}`,screenTitle:i.translate("giftAidScreen.title"),a11yAutoFocus:!0,children:(0,Cl.jsx)("h2",{className:(0,Ml.A)("title-30-medium",{"py-2":a}),"aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"icon-slot d-block",children:(0,Cl.jsx)(pC,{className:"p-abs inset-centered"})})})}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",a?"pb-2":"pt-6 pb-4"),children:(0,Cl.jsxs)("div",{className:(0,Ml.A)("fixed-container",{"grow-1 d-flex flex-column":!a}),children:[(0,Cl.jsxs)("p",{className:(0,Ml.A)("text-center",a?"text-ellipsis":"text-line-clamp-6"),children:[i.translate("giftAidScreen.governmentText")," ",i.translate("giftAidScreen.ratioInfo")]}),(0,Cl.jsx)(fc,{as:"p",className:(0,Ml.A)("body-60-medium text-center mt-4-5",a?"text-ellipsis":"text-line-clamp-3"),token:"giftAidScreen.actionQuestion"}),t.legalText&&(0,Cl.jsx)("div",{className:"grow-1 mt-4-5 d-flex flex-column",children:(0,Cl.jsx)(yC,{})})]})}),(0,Cl.jsxs)(gd,{children:[(0,Cl.jsx)("button",{type:"button",className:"btn btn-primary",disabled:t.locked,onClick:()=>o(!0),"data-qa":"gift-aid-continue","data-tracking-element-name":"claimButton",children:i.translate("giftAidScreen.button.claim")}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-5",children:(0,Cl.jsx)(lh,{buttonType:"link",onClick:r,processingState:t.processingState,errorTitle:t.payErrorMessage||i.safeTranslate("common.errorOccurredText"),dataQa:"no-gift-aid-and-pay",trackingElement:"dontClaimButton",children:i.translate("giftAidScreen.button.refuse")})})]})]})},[Vn.SEPA]:e=>{const{stripeElementState:t,setStripeElementState:n}=Xv();return(0,Cl.jsx)(NN,{state:t,children:(0,Cl.jsx)(IN,Object.assign({stripeElementState:t,setStripeElementState:n},e))})},[Vn.IDEAL_CONFIRMATION]:e=>{const{state:t,controller:n}=Tc(Vn.IDEAL_CONFIRMATION),i=(0,Bl.P)(),s=(0,nc.t)(),a=(0,kr.useId)(),o=(0,kr.useCallback)((()=>{n.leave()}),[n]),r=(0,kr.useCallback)((()=>{n.returnToBankWindow()}),[n]),l=(0,kr.useCallback)((()=>{n.back()}),[n]);return(0,kr.useEffect)((()=>{t.shouldPaymentRestore&&n.leave()}),[n,t.shouldPaymentRestore]),(0,Cl.jsxs)("section",{className:"flow-screen","aria-labelledby":`screen-header-${a}`,children:[(0,Cl.jsx)(Ad,{id:`screen-header-${a}`,backButtonClickHandler:l,forceShowBackButton:t.forceShowBackButton,title:s.translate("idealConfirmationScreen.title"),titleQa:"ideal-confirmation-title",a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-5 pb-6":!i}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[t.showReturnBankInfo?(0,Cl.jsx)(FC,{className:(0,Ml.A)("shrink-0",i?"mt-3":"my-auto")}):(0,Cl.jsx)(EC,{email:t.email,name:t.name,className:"shrink-0"}),!t.showReturnBankInfo&&t.isSubscription&&(0,Cl.jsx)(jC,{className:(0,Ml.A)("grow-1",i?"mt-5":"mt-4"),locked:t.locked})]})}),(0,Cl.jsx)(gd,{backButtonClickHandler:l,forceShowBackButton:t.forceShowBackButton,children:t.showReturnBankInfo?(0,Cl.jsx)(lh,{className:"btn-primary",processingState:Xl.IDLE,trackingElement:"nextButton",dataQa:"ideal-continue-button",onClick:r,children:s.translate("idealConfirmationScreen.button")}):(0,Cl.jsxs)(Cl.Fragment,{children:[n.showNextStepOverview&&(0,Cl.jsx)("p",{className:"body-20-regular text-center text-ellipsis mb-4",children:s.translate("idealConfirmationScreen.nextStep")}),(0,Cl.jsx)(lh,{className:"btn-primary",processingState:t.processingState,errorTitle:t.errorMessage||s.safeTranslate("common.errorOccurredText"),onClick:o,dataQa:"ideal-pay-button",trackingElement:"nextButton",children:th(s,t.formattedAmount,t.frequency)})]})})]})},[Vn.COMMUNICATION_CONSENT]:()=>{const{controller:e,state:t}=Tc(Vn.COMMUNICATION_CONSENT),n=(0,kr.useId)(),i=(0,nc.t)(),s=(0,Bl.P)(),a=function(){const{campaign:e}=(0,Nl.n)();return e.config.consentText.customized.description}(),o=(0,Nl.n)().company.key===aS.ONE_FOR_ISRAEL,r=function(e,t){const n=!!Lc().tribute.dataPoint.tributeeName;return!(t&&n&&e.length>=5)}(t.channels,o),l=(0,kr.useRef)(null),c=oS(l),u=(0,kr.useCallback)((t=>n=>{e.changeChannel(t,n)}),[e]);return(0,kr.useEffect)((()=>{e.setCustomizedConsentShown()}),[e]),(0,Cl.jsxs)("form",{className:"flow-screen","aria-labelledby":`screen-header-${n}`,"data-qa":"communication-consent-screen",onSubmit:t=>{t.preventDefault(),e.leave()},children:[(0,Cl.jsx)(Ad,{id:`screen-header-${n}`,title:i.translate("communicationConsentScreen.title"),a11yAutoFocus:!0}),(0,Cl.jsx)(td,{className:(0,Ml.A)("px-body",{"pt-6 pb-4":!s}),children:(0,Cl.jsxs)("div",{className:"fixed-container grow-1 min-h-0 d-flex flex-column",children:[r&&(0,Cl.jsx)(lS,{className:"shrink-0 mx-auto mb-5",dataTestId:"communication-consent-icon",ariaHidden:!0}),(0,Cl.jsx)("p",{className:(0,Ml.A)("shrink-0 text-center",s?"text-ellipsis":"text-line-clamp-2"),children:i.translate(o?"communicationConsentScreen.descriptionIsOneForIsrael":"communicationConsentScreen.description")}),(0,Cl.jsx)("div",{className:"mt-5",children:t.channels.map(((e,t)=>(0,Cl.jsx)(Fd,{className:(0,Ml.A)({"mt-2":0!==t}),dataQa:`communication-consent-${e.type}`,dataTestId:`communication-consent-${e.type}`,checked:e.isAccepted,onChange:u(e.type),children:(0,Cl.jsx)("span",{className:"body-60-regular",children:i.translate(`communicationConsentScreen.channels.${e.type}`)})},e.type)))}),!!a&&(0,Cl.jsx)("div",{className:"p-rel grow-1 shrink-0 mt-5",children:(0,Cl.jsx)("div",{ref:l,className:(0,Ml.A)({"p-abs inset-0 d-flex flex-column":!s,"scroll-box":c,"pointer-events-none":t.locked}),children:(0,Cl.jsx)("p",{className:(0,Ml.A)("body-20-regular shrink-0 text-gray-80 text-ellipsis mt-auto",{"px-3 py-2-5":c}),"data-qa":"communication-consent-description",dangerouslySetInnerHTML:{__html:a}})})})]})}),(0,Cl.jsxs)(gd,{children:[(0,Cl.jsx)("button",{type:"submit",className:"btn btn-primary","data-qa":"communication-consent-continue","data-testid":"communication-consent-continue","data-tracking-element-name":"nextButton",children:i.translate("communicationConsentScreen.button.continue")}),(0,Cl.jsx)("div",{className:"d-flex justify-center mt-5",children:(0,Cl.jsx)("button",{type:"button",className:"btn-link body-60-regular text-truncate","data-qa":"communication-consent-skip","data-testid":"communication-consent-skip","data-tracking-element-name":"skipButton",onClick:()=>{e.resetChannels(),e.leave()},children:i.translate("communicationConsentScreen.button.skip")})})]})]})},[Vn.FAST_TRACK_PAYMENT_OPTIONS]:e=>{const{stripeElementsCardState:t,setStripeElementsCardState:n}=IA(),{state:i}=Tc(Vn.FAST_TRACK_PAYMENT_OPTIONS);return(0,Cl.jsx)(UA,{state:i.validation,children:(0,Cl.jsx)(cC,Object.assign({},e,{stripeElementsCardState:t,setStripeElementsCardState:n}))})},[Vn.DONATE_BY_VOICE]:()=>{const{state:e}=Tc(Vn.DONATE_BY_VOICE),t=(0,kr.useRef)(null),n=(0,kr.useCallback)((()=>{t.current&&(t.current.pause(),t.current.srcObject=null)}),[]),i=(0,kr.useCallback)((e=>{t.current&&(t.current.srcObject=e,t.current.play().catch((()=>{})),e.getTracks().forEach((e=>{e.addEventListener("ended",n,{once:!0})})))}),[n]);(0,kr.useEffect)((()=>{if(t.current)return t.current.srcObject=new MediaStream,t.current.play().catch((()=>{})),n}),[n]);const s=e.step===If.PERMISSIONS?(0,Cl.jsx)(rv,{}):(0,Cl.jsx)(av,{onMediaStream:i});return(0,Cl.jsxs)(Cl.Fragment,{children:[(0,Cl.jsx)("audio",{ref:t}),s]})},[wl.MANDATORY_QUESTIONS]:eh,[wl.QUESTIONS]:zm,[wl.PRIVACY]:fm,[wl.THANK_YOU]:oy,[wl.COMMENT]:bd,[wl.MAILING_ADDRESS]:e=>{const{state:t}=Tc(wl.MAILING_ADDRESS);return(0,Cl.jsx)(Sv,{state:t.validation,children:(0,Cl.jsx)(Av,Object.assign({},e))})},[wl.REMIND_ME]:()=>{const{state:e}=Tc(wl.REMIND_ME);return(0,Cl.jsx)(Fv,{state:{validation:{email:e.email,termsAndConditions:e.termsAndConditions},serverErrors:e.serverErrors},children:(0,Cl.jsx)(jv,{})})},[wl.BLOCKED]:yd},AD=Object.assign(Object.assign({},kf),ED),CD=e=>{let{isDarkModeScreen:t,onScreenEntered:n}=e;const i=(0,Bl.P)(),s=(0,Zl.$)(),a=Dc(),o=(0,Vl.C)(),r=Rc(),[l,c]=(0,kr.useState)("next"),[u,d]=(0,kr.useState)(a.getCurrentFlow().getCurrentScreen().name),[h,m]=(0,kr.useState)(!0),[p,g]=(0,kr.useState)([...a.checkoutService.checkoutUIState.alwaysRenderedScreens]),[y,f]=(0,kr.useState)(),[v,S]=(0,kr.useState)(),[E,A]=(0,kr.useState)(),C=(0,Nl.n)(),b=(0,kr.useMemo)((()=>C.getAskPageConfig(ss)),[C]),P=Vc("lg"),N=(0,kr.useMemo)((()=>!P&&b.show?Iu.TOP:b.show?Iu.LEFT:null),[P,b.show]),{isTestGroup:D,showProgressBar:T}=jc(),k=Vu(),I=i||s||D,_=(0,kr.useRef)(!1),O=(0,kr.useCallback)(((e,t,n)=>{o&&!s&&r.trackCheckoutScreenView({transitionStartedAt:e,transitionFinishedAt:t,renderedAt:n,askPagePosition:N,progress:T?k:void 0})}),[o,s,r,N,T,k]);(0,kr.useEffect)((()=>{o&&!_.current&&(_.current=!0,O())}),[O,o]),(0,kr.useEffect)((()=>a.onScreenChanged((e=>{const t=a.getCurrentFlow().getCurrentScreen().name;u!==t&&(f(e.createdAt),S(e.transitionStartedAt),A(e.transitionFinishedAt),m(!1),c((null==e?void 0:e.direction)===ku.BACKWARD?"previous":"next"),d(t),g((e=>{const t=a.checkoutService.checkoutUIState.alwaysRenderedScreens;return e.length!==t.length||t.some((t=>!e.includes(t)))?[...t]:e})))}))),[u,a]);const x=(0,kr.useCallback)((()=>{if(!y)return;const e=new Date;m(!0),O(v,E,e)}),[O,y,v,E]);return(0,kr.useEffect)((()=>{null==n||n(h)}),[n,h]),(0,Cl.jsx)(Yu,{className:(0,Ml.A)({"dark-mode":t}),children:(0,Cl.jsxs)(_u.C.Provider,{value:h,children:[Object.entries(AD).map((e=>{let[t,n]=e;return!p.includes(t)&&(0,Cl.jsx)(Wu,{show:t===u,Screen:n,screenDirection:l,alwaysMount:!1,animationDisabled:I,onScreenEntered:x},t)})),p.map((e=>(0,Cl.jsx)(Wu,{show:e===u,Screen:AD[e],screenDirection:l,alwaysMount:!0,animationDisabled:I,onScreenEntered:x},e)))]})})},bD=(0,kr.memo)(CD),PD=e=>{let{enabledCrypto:t,enabledMoney:n,disabled:i}=e;const s=(0,nc.t)(),a=(0,Zl.$)(),o=Dc(),r=Kl(),l=(0,kr.useCallback)((()=>{a||o.startCryptoFlow()}),[o,a]),c="start-crypto-flow",u="start-fiat-flow";return(0,Cl.jsxs)(Cl.Fragment,{children:[t&&(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn-link max-w-100 text-truncate",r("flow-button")),disabled:i,onClick:l,"data-qa":c,"data-tracking-element-name":c,children:s.translate("changeFlowButtons.crypto")}),n&&(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)("btn-link max-w-100 text-truncate",r("flow-button")),disabled:i,onClick:()=>{a||o.startFiatFlow()},"data-qa":u,"data-tracking-element-name":u,children:s.translate("changeFlowButtons.fiat")})]})},ND=(0,kr.memo)(PD),DD=e=>{const t=(0,Bl.P)(),n=Kl(),i=(0,nc.t)();return(0,Cl.jsx)("button",{type:"button",className:(0,Ml.A)(n("modal-close"),e.className),"aria-label":i.translate("common.closeDialogButtonAriaLabel"),onClick:e.onClick,"data-qa":"global-close","data-tracking-element-name":"closeButton",children:(0,Cl.jsx)("span",{className:(0,Ml.A)("icon-slot d-block",t?"icon-slot-28":"icon-slot-32"),"aria-hidden":!0,children:(0,Cl.jsx)("span",{className:"p-abs inset-centered",children:(0,Cl.jsx)(su.A,{className:"icon-stroke icon-stroke-2 d-block"})})})})};var TD=(0,kr.memo)(DD);const kD={enter:400,exit:200},ID=()=>{!function(){const e=(0,nc.t)(),t=Dc(),n=Bc(),i=(0,Zl.$)(),[s,a]=(0,kr.useState)((()=>t.getCurrentFlow().getCurrentScreen().name));(0,kr.useEffect)((()=>t.onScreenChanged((()=>{a(t.getCurrentFlow().getCurrentScreen().name)}))),[t,s]);const o=(0,kr.useCallback)((t=>{const i=e.translate("closeTabDialog.text");if(!n.isUnrestrictedExitScreen(s))return(t||window.event).returnValue=i,i}),[n,e,s]);(0,kr.useEffect)((()=>{if(i)return;window.addEventListener("beforeunload",o);const e=()=>window.removeEventListener("beforeunload",o);return t.checkoutService.setRemoveCloseGuard(e),e}),[t.checkoutService,o,i])}();const e=function(){const e=(0,Nl.n)(),t=Bc();return!e.infrastructureParams.isMobile||t.showCloseButton}(),t=function(){const e=Dc(),t=(0,Nl.n)(),n=t.infrastructureParams.isMobile,i=t.infrastructureParams.showcase,[s,a]=(0,kr.useState)((()=>!i)),o=(e,t,n)=>{const i=e.getCurrentFlow().getCurrentScreen().name,s=!e.checkoutService.checkoutUIState.isMobileScreenWithoutFaqLinks(i),o=e.checkoutService.checkoutUIState.showFAQLinks;a(t?o&&s:o)};return(0,kr.useEffect)((()=>{if(i)return;const t=e.onScreenChanged((()=>{o(e,n)}));return o(e,n),t}),[e,n,i]),s}(),n="AFJCHFEK"===(0,Nl.n)().campaign.company,i=(0,Il.M)(),s=(0,Bl.P)(),a=Vc("lg"),o=(0,Zl.$)(),r=Kl(),l=zl(i),{show:c,entered:u,handleOpenTransitionEntered:h,handleCloseClick:m,handleCloseTransitionExited:p}=function(){var e=this;const t=(0,Bl.P)(),[n,i]=(0,kr.useState)({shouldReopen:!1,tributeSelected:!1}),[s,a]=(0,kr.useState)(!1),o=_r(),[r,l]=(0,kr.useState)(!1),c=Dc(),u=Bc(),h=Rc(),m=(0,kr.useCallback)((function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(0,d.sH)(e,[...i],void 0,(function(){let{isManualCall:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){c.shouldNotifyAbandoned(e)&&(c.checkoutService.updateSession({canUseAmountDefaults:!0}),c.checkoutService.abandonSession());const n=c.getCurrentFlow().getCurrentScreen().name;c.canClose({isMobile:t,isMobileExitScreen:u.isMobileExitScreen(n),isUnrestrictedExitScreen:u.isUnrestrictedExitScreen(n),isFinalAvailableScreen:u.isFinalAvailableScreen(n)})&&(yield c.checkoutService.saveCheckoutClosePublicParams(),a(!1))}()}))}),[c,u,t]);(0,kr.useEffect)((()=>{const e=()=>a(!0),t=e=>(0,d.sH)(this,void 0,void 0,(function*(){var{isManualCall:t}=e,n=(0,d.Tt)(e,["isManualCall"]);i(n),yield m({isManualCall:t})}));return o.on(Tr.SHOULD_SHOW,e),o.on(Tr.SHOULD_HIDE,t),()=>{o.removeListener(Tr.SHOULD_SHOW,e),o.removeListener(Tr.SHOULD_HIDE,t)}}),[m,o]);const p=(0,kr.useCallback)((()=>{h.trackCheckoutClose(),o.emit(Tr.WAS_HIDDEN,n)}),[o,n,h]);return{show:s,entered:r,handleOpenTransitionEntered:(0,kr.useCallback)((()=>{l(!0),h.trackCheckoutView()}),[h]),handleCloseTransitionExited:p,handleCloseClick:m}}(),g=(0,kr.useRef)(null),y=(0,kr.useRef)(null),f=(0,kr.useRef)(null),v=(0,kr.useRef)(null),S=(0,kr.useRef)(null),E=(0,kr.useRef)(null),{handleBlur:A,handleFocus:C}=function(e){const{rootElRef:t,disabled:n,trapStartRef:i,trapStopRef:s}=e,[a,o]=(0,kr.useState)(),r=(0,kr.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!i.current)return;if(!s.current)return;if(!t.current)return;const n=t.current.querySelectorAll(Yl);let a=[].slice.call(n);a=a.filter((e=>e!==i.current&&e!==s.current)),e&&(a=a.reverse()),a.length&&a[0].focus()}),[t,i,s]),l=(0,kr.useCallback)((e=>{n||i.current&&s.current&&(e.target===i.current&&r(a!==s.current),e.target===s.current&&r(a===i.current))}),[r,a,n,i,s]),c=(0,kr.useCallback)((e=>{n||o(e.target)}),[n]);return{trapStartRef:i,trapStopRef:s,handleFocus:l,handleBlur:c}}({rootElRef:g,trapStartRef:S,trapStopRef:E}),b=(0,Nl.n)(),P=Dc(),N=Bc(),D=kc()===wl.REMIND_ME,T=b.getAskPageConfig(),k=T.show||!!b.fundraisingPage,[I,_]=(0,kr.useState)(k),O=b.infrastructureParams.livemode,x=T.showLinks,w=s&&I&&x,[R,M]=(0,kr.useState)(!0),{shouldShowFlowsSection:L,enabledMoney:F,enabledCrypto:U}=(e=>{const t=(0,Nl.n)(),n=Mc(),{showcase:i}=t,s=i?i.isFirstScreen:e,{crypto:a,money:o}=t.enabledFlows;if(!(0,kr.useMemo)((()=>[a,o].filter(Boolean).length>1&&s),[a,s,o]))return{shouldShowFlowsSection:!1,enabledMoney:!1,enabledCrypto:!1};const r=n.type;return{shouldShowFlowsSection:!0,enabledMoney:!!o&&r!==$n.MONEY,enabledCrypto:!!a&&r!==$n.CRYPTO}})(R),j=t&&!n||L||w||o,B=Hl();(0,kr.useEffect)((()=>{const e=e=>{e.code===Fl.J.ESC&&m()};return l((t=>t.document.addEventListener("keyup",e))),()=>l((t=>{var n;return null===(n=t.document)||void 0===n?void 0:n.removeEventListener("keyup",e)}))}),[m,l]),(0,kr.useEffect)((()=>P.onScreenChanged((()=>{const e=P.getCurrentFlow(),t=e.getCurrentScreen().name,n=!N.isMobileScreenWithoutAskPage(t);_(s?n&&k:k),M(e.isCurrentScreenFirst()),l((e=>e.document.body.classList.remove("overflow-hidden")))}))),[N,P,s,k,l]);const[G,q]=(0,kr.useState)(!1),V=(0,kr.useCallback)((e=>{q(e)}),[]),H=(0,kr.useCallback)((()=>{if(!o)return;const e=new Event(Rl.CLICK_SHOWCASE);l((t=>t.parent.dispatchEvent(e)))}),[o,l]);return(0,Cl.jsx)(Cl.Fragment,{children:(0,Cl.jsx)(Vl.m.Provider,{value:u,children:(0,Cl.jsx)(Gl.Provider,{value:u&&G,children:(0,Cl.jsx)(Ll.A,{in:c,timeout:kD,classNames:s||o?{}:"rtg-modal",nodeRef:g,onEntered:h,onExited:p,unmountOnExit:!0,children:(0,Cl.jsx)("div",{className:(0,Ml.A)(r("modal"),{"has-campaign":I,showcase:o}),ref:g,onFocus:C,onBlur:A,onClickCapture:H,children:(0,Cl.jsxs)(ql.Tn.Provider,{value:g,children:[(0,Cl.jsx)("span",{ref:S,tabIndex:0,"aria-hidden":!0}),e&&(0,Cl.jsx)(TD,{onClick:m,className:(0,Ml.A)({"pointer-events-none":o})}),(0,Cl.jsx)(Ul.Provider,{value:{checkoutWrapperRef:s?f:y},children:(0,Cl.jsxs)("div",{ref:f,className:(0,Ml.A)(r("widget"),{"pb-10":!O&&!o&&s,"pb-14":!O&&!o&&!s,"pointer-events-none":o,"p-rel":s&&B}),children:[(0,Cl.jsxs)("div",{ref:y,className:(0,Ml.A)(r("widget-main"),{"p-rel overflow-hidden":!a&&B}),children:[I&&(0,Cl.jsx)("div",{className:r("widget-campaign"),"data-testid":"campaign",children:(0,Cl.jsx)(Kc,{})}),(0,Cl.jsx)("div",{className:(0,Ml.A)(r("widget-form")),ref:v,children:(0,Cl.jsx)(ql.Qq.Provider,{value:v,children:(0,Cl.jsx)(bD,{isDarkModeScreen:D,onScreenEntered:V})})})]}),j&&(0,Cl.jsx)("div",{className:r("widget-footer"),"data-qa":"widget-footer-block",children:(0,Cl.jsxs)("div",{className:(0,Ml.A)({"fixed-container":s}),children:[(!n||L)&&(0,Cl.jsxs)("div",{className:r("widget-footer-panel"),children:[!n&&(0,Cl.jsx)(Tu,{showAskPage:I}),L&&(0,Cl.jsxs)(Cl.Fragment,{children:[I&&!s&&a&&(0,Cl.jsx)("div",{className:"body-20-regular text-white opacity-80 shrink-0 mx-3","aria-hidden":!0,children:""}),(0,Cl.jsx)(ND,{enabledCrypto:U,enabledMoney:F})]})]}),w&&(0,Cl.jsx)(hc,{links:T.links,className:(0,Ml.A)("shrink-0",{"mt-3":!n||L})})]})})]})}),(0,Cl.jsx)("span",{ref:E,tabIndex:0,"aria-hidden":!0})]})})})})})})};var _D=n(5514);const OD=e=>{var t;const{onMounted:n}=e;return(0,kr.useEffect)((()=>{n()}),[n]),(0,Cl.jsx)(kr.StrictMode,{children:(0,Cl.jsx)(_l.Provider,{value:e.sentry,children:(0,Cl.jsx)(xl,{fallback:(0,Cl.jsx)("div",{children:"fallback content"}),children:(0,Cl.jsx)(Il.U.Provider,{value:e.iframeWindow,children:(0,Cl.jsx)(Nc.Provider,{value:e.flowManager,children:(0,Cl.jsx)(Nl.G.Provider,{value:e.checkoutConfiguration,children:(0,Cl.jsx)(Ir.Provider,{value:e.viewEventEmitter,children:(0,Cl.jsx)(_D.R.Provider,{value:e.intl,children:(0,Cl.jsx)(wc.Provider,{value:e.tracker,children:(0,Cl.jsx)(Fc.Provider,{value:e.experiments,children:(0,Cl.jsx)(Oc.Provider,{value:e.currencyService,children:(0,Cl.jsx)(Am.Provider,{value:null!==(t=null==e?void 0:e.showcaseContext)&&void 0!==t?t:null,children:(0,Cl.jsx)(Tl,{children:(0,Cl.jsx)(ID,{})})})})})})})})})})})})})})};class xD{constructor(e,t,n,i,s,a){this.container=e,this.iframe=t,this.eventEmitter=n,this.sentry=i,this.debug=s,this.checkoutCore=a,this.renderKey=nr()}get iframeNode(){return this.iframe.iframeNode}open(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n;if(null===(n=null===(t=null==e?void 0:e.abortController)||void 0===t?void 0:t.signal)||void 0===n?void 0:n.aborted)throw new Pl;this.targetWindow&&(yield this.render(),this.iframe.showDocument(),this.iframe.open(),this.show())}))}close(){this.iframe.close(),this.unmount(),this.iframe.destroy(),this.eventEmitter.removeAllListeners()}onHide(e){return this.eventEmitter.on(Tr.WAS_HIDDEN,e),this}get targetWindow(){return this.iframe.iframeWindow}render(e){return(0,d.sH)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{const n=()=>(this.logCheckoutOpeningTime(),t());this.root.render((0,Cl.jsx)(OD,{onMounted:n,viewEventEmitter:this.eventEmitter,flowManager:this.checkoutCore.flowManager,intl:this.checkoutCore.intl,sentry:this.sentry,tracker:this.checkoutCore.trackerCheckout,experiments:this.checkoutCore.experiments,iframeWindow:this.targetWindow,currencyService:this.checkoutCore.currencyService,checkoutConfiguration:this.checkoutCore.checkoutConfiguration,showcaseContext:e},this.renderKey))}catch(e){n(e)}}))}))}show(){this.eventEmitter.emit(Tr.SHOULD_SHOW)}regenerateKey(){return this.renderKey=nr(),this.renderKey}get root(){return this._root||(this._root=(0,bl.H)(this.container)),this._root}unmount(){this.root.unmount(),this.debug.log("Checkout UI (React) is unmounted")}logCheckoutOpeningTime(){const e=Date.now()-this.checkoutCore.trackerCheckout.checkoutOpenTimestamp;this.debug.log("checkout opening time:onMounted",`${e} ms`)}}var wD=n(5029);function RD(e,t){void 0!==t&&function(n){var i;function s(){i||(i=!0,n())}["interactive","complete"].indexOf(t.readyState)>=0?n():(i=!1,t.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))}((function(){var n=!0,i=!1,s=null,a={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function o(e){return!!(e&&e!==t&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function r(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function l(e){n=!1}function c(){t.addEventListener("mousemove",u),t.addEventListener("mousedown",u),t.addEventListener("mouseup",u),t.addEventListener("pointermove",u),t.addEventListener("pointerdown",u),t.addEventListener("pointerup",u),t.addEventListener("touchmove",u),t.addEventListener("touchstart",u),t.addEventListener("touchend",u)}function u(e){var i,s;"html"!==(null===(s=null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.nodeName)||void 0===s?void 0:s.toLowerCase())&&(n=!1,t.removeEventListener("mousemove",u),t.removeEventListener("mousedown",u),t.removeEventListener("mouseup",u),t.removeEventListener("pointermove",u),t.removeEventListener("pointerdown",u),t.removeEventListener("pointerup",u),t.removeEventListener("touchmove",u),t.removeEventListener("touchstart",u),t.removeEventListener("touchend",u))}t.addEventListener("keydown",(function(e){o(t.activeElement)&&r(t.activeElement),n=!0}),!0),t.addEventListener("mousedown",l,!0),t.addEventListener("pointerdown",l,!0),t.addEventListener("touchstart",l,!0),t.addEventListener("focus",(function(e){var t,i,s;o(e.target)&&(n||(i=(t=e.target).type,"INPUT"==(s=t.tagName)&&a[i]&&!t.readOnly||"TEXTAREA"==s&&!t.readOnly||t.isContentEditable))&&r(e.target)}),!0),t.addEventListener("blur",(function(t){var n;o(t.target)&&(t.target.classList.contains("focus-visible")||t.target.hasAttribute("data-focus-visible-added"))&&(i=!0,e.clearTimeout(s),s=e.setTimeout((function(){i=!1,e.clearTimeout(s)}),100),(n=t.target).hasAttribute("data-focus-visible-added")&&(n.classList.remove("focus-visible"),n.removeAttribute("data-focus-visible-added")))}),!0),t.addEventListener("visibilitychange",(function(e){"hidden"==t.visibilityState&&(i&&(n=!0),c())}),!0),c(),t.body.classList.add("js-focus-visible")}))}class MD{constructor(e,t){this.onLoadHandlers=[],this.ready=!1,this.templateRewriteStatus="idle",this.localeCode=e.locale,this.node=e.node,this.overrideTemplate=e.overrideTemplate,this.fonts=e.fonts||"",this.styles=e.styles||"",this.id=e.id||"",this.title=e.title,this.initialize=e.initialize,this.scripts=e.scripts||[],this.metaTags=e.metaTags||[],this.isMobile=e.isMobile||!1,this.env=e.env,this.disableRtl=e.disableRtl||!1,this.canRetryTemplateRewrite=e.canRetryTemplateRewrite||!1,this.iframe=document.createElement("iframe"),this.addEventListeners(),e.initialStyles&&this.setStyles(e.initialStyles),this.setIframeAttributes(),this.sentry=t}resize(e){if(e.height){const t=MD.getSizeInCssUnit(e.height),n=e.minHeight?MD.getSizeInCssUnit(e.minHeight):t,i=e.maxHeight?MD.getSizeInCssUnit(e.maxHeight):t;this.iframe.setAttribute("height",t),this.iframe.style.setProperty("height",t,"important"),this.iframe.style.setProperty("min-height",n,"important"),this.iframe.style.setProperty("max-height",i,"important")}if(e.width){const t=MD.getSizeInCssUnit(e.width),n=e.minWidth?MD.getSizeInCssUnit(e.minWidth):t,i=e.maxWidth?MD.getSizeInCssUnit(e.maxWidth):t;this.iframe.setAttribute("width",t),this.iframe.style.setProperty("width",t,"important"),this.iframe.style.setProperty("min-width",n,"important"),this.iframe.style.setProperty("max-width",i,"important")}}showDocument(){MD.isContentDocumentAvailable(this.iframe.contentDocument)&&this.iframe.contentDocument.body.setAttribute("style","")}setStyles(e){e.forEach((([e,t])=>{this.iframe.style.setProperty(e,String(t),"important")}))}addClass(e){e.forEach((e=>{this.iframe.className+=` ${e}`}))}removeStyles(e){MD.isContentDocumentAvailable(this.iframe.contentDocument)&&e.forEach((e=>{this.iframe.style.removeProperty(e)}))}appendElement(e){MD.isContentWindowAvailable(this.iframe.contentWindow)&&MD.isContentDocumentAvailable(this.iframe.contentDocument)&&(RD(this.iframe.contentWindow,this.iframe.contentDocument),this.iframe.contentDocument.body.appendChild(e))}addOnLoadHandler(e){if(this.ready)return e();this.onLoadHandlers.push(e)}addDocumentEventListener(e,t){MD.isContentDocumentAvailable(this.iframe.contentDocument)&&this.iframe.contentDocument.addEventListener(e,t)}removeDocumentEventListener(e,t){MD.isContentDocumentAvailable(this.iframe.contentDocument)&&this.iframe.contentDocument.removeEventListener(e,t)}findElement(e){return MD.isContentDocumentAvailable(this.iframe.contentDocument)?this.iframe.contentDocument.querySelector(e):null}matchMedia(e){return MD.isContentWindowAvailable(this.iframe.contentWindow)?this.iframe.contentWindow.matchMedia(e):null}get iframeNode(){return this.iframe}setGlobalData(e){if(MD.isContentWindowAvailable(this.iframe.contentWindow)){for(const[t,n]of Object.entries(e))this.iframe.contentWindow[t]=n;return!0}return!1}get iframeWindow(){return this.iframe.contentWindow}get iframeDocument(){return this.iframe.contentDocument}setIframeAttributes(){this.iframe.setAttribute("title",this.title),this.iframe.setAttribute("src","about:blank"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("marginwidth","0"),this.iframe.setAttribute("width","1"),this.iframe.setAttribute("height","1"),this.id&&this.iframe.setAttribute("id",this.id)}addEventListeners(){this.iframe.addEventListener("load",(()=>{var e,t,n,i,s,a,o,r,l,c;MD.isContentWindowAvailable(this.iframe.contentWindow)||null===(e=this.sentry)||void 0===e||e.captureException(new Error("Iframe contentWindow is not available"),{extra:{iframeId:null===(t=this.iframe)||void 0===t?void 0:t.id,iframeSrc:null===(n=this.iframe)||void 0===n?void 0:n.src,iframeTitle:null===(i=this.iframe)||void 0===i?void 0:i.title,iframeWidth:null===(s=this.iframe)||void 0===s?void 0:s.width,iframeHeight:null===(a=this.iframe)||void 0===a?void 0:a.height,documentReady:document.readyState,isMobile:this.isMobile,documentInnerHTML:null===(c=null===(l=null===(r=null===(o=this.iframe)||void 0===o?void 0:o.contentDocument)||void 0===r?void 0:r.children)||void 0===l?void 0:l[0])||void 0===c?void 0:c.innerHTML}}),this.initialize&&this.iframe.contentWindow&&this.iframe.contentDocument&&this.initialize(this.iframe.contentWindow,this.iframe.contentDocument),this.ready=!0,this.onLoadHandlers.forEach((e=>e()))}))}getIframeTemplate(){const e=e=>Object.keys(e).map((t=>`${t}="${e[t]}"`)).join(" "),t=this.scripts.map((t=>`<script ${e(t)}><\/script>`)).join(""),n=this.metaTags.map((t=>`<meta ${e(t)}>`)).join("");return this.overrideTemplate?this.overrideTemplate({title:this.title,styles:this.styles,fonts:this.fonts,scripts:t,metaTags:n,isMobile:this.isMobile}):`\n      <!DOCTYPE html>\n      <html style="overflow: hidden;" lang="${this.localeCode}" dir="${(0,Gt.N_)(this.localeCode,this.disableRtl)}">\n          <head>\n              <meta charset="utf-8">\n              <meta http-equiv="X-UA-Compatible" content="IE=edge">\n              ${n}\n              <title>${this.title}</title>\n              <style>${this.styles}</style>\n              <style>${this.fonts}</style>\n              ${t}\n          </head>\n          <body style="opacity: 0;"></body>\n      </html>\n    `}static isContentDocumentAvailable(e){return!!e||(console.warn("ContentDocument is not available"),!1)}static isContentWindowAvailable(e){return!!e||(console.warn("ContentWindow is not available"),!1)}static getSizeInCssUnit(e){const t=String(e);return/^\d+$/.test(t)?`${t}px`:t}}function LD(e,t){if(e.body)return t();setTimeout(LD.bind(null,e,t),10)}function FD(e){return new Promise((t=>{setTimeout(t,e)}))}async function UD(e,t){return!!e.fonts&&new Promise((n=>e.fonts.load(t).then((()=>{n(!0)})).catch((()=>{n(!1)}))))}const jD=[/FBAV|FBAN|FBSV|FBID|FBBV\/([0-9.]+)/,/Instagram\s([0-9.]+)/,/Snapchat\/([0-9.]+)/,/MicroMessenger\/([0-9.]+)/,/Twitter for iPhone[/]?([\d.]+)?/,/TikTok[/ ](\d+\.(?:[.\d]+))?/,/bytedance/i,/musical_ly/i,/LinkedInApp/i,/gsa/i,/;\s*wv\)/];var BD=n(9279);function GD(e=2147483647){return`display: block !important;margin: 0 !important;padding: 0 !important;border: 0 !important; width: 100% !important; height: 100% !important; position: fixed !important; opacity: 1 !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; transform: translateZ(100px) !important;z-index: ${e} !important;`}class qD extends MD{constructor(e,t,n){super(e,n),this.htmlElementStyleManager=t,this.sentry=n,this.templateReadyHandlers=[],this.render()}render(){let e=document.documentElement;this.env!==BD.h.PRODUCTION&&this.env!==BD.h.STAGING&&(e=document.body),this.isMobile?(this.containerDiv=document.createElement("div"),this.overlay=document.createElement("div"),this.overlay.setAttribute("id","fun-mobile-overlay-container"),this.containerDiv.setAttribute("id","fun-iframe-container"),this.containerDiv.appendChild(this.iframe),e.appendChild(this.overlay),e.appendChild(this.containerDiv)):this.node?(this.htmlElementStyleManager.setStyle("border: 0 !important; height: 100% !important; width: 100% !important; margin: 0 auto !important; padding: 0 !important; border-radius: 0 !important; display: block !important;",this.iframe),this.node.appendChild(this.iframe)):e.appendChild(this.iframe),this.setParentViewPort(),this.tryRewriteIframeTemplate()}onShow(){this.htmlElementStyleManager.setStyle(GD(),this.iframe)}open(){this.htmlElementStyleManager.saveDocumentOriginalStyles(),this.node||(this.isMobile&&this.containerDiv&&this.overlay&&(this.htmlElementStyleManager.setStyle("display: block !important;margin: 0 !important;padding: 0 !important;float: none !important;visibility: visible !important;opacity: 1 !important;position: absolute !important;width: 100% !important;height: 100% !important;top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: #f5f5f5 !important;z-index: 2147483647 !important;transform: translateZ(100px) !important;",this.containerDiv),this.htmlElementStyleManager.setStyle("position: fixed !important;top: 0 !important;left: 0 !important;right: 0 !important;bottom: 0 !important;margin: 0 !important;padding: 0 !important;background: #f5f5f5 !important;z-index: 2147483646 !important;transform: translateZ(99px) !important;",this.overlay)),this.htmlElementStyleManager.setStyle(this.isMobile?"display: block !important;border: none !important;margin: 0 !important;padding: 0 !important;width: 100% !important;height: 100% !important;":GD(2147483646),this.iframe),this.resize({width:"100%",height:"100%"}),this.node||(this.htmlElementStyleManager.appendStyle(this.isMobile?"all: initial !important;position: static !important;margin: 0 !important;padding: 0 !important;min-height: 0 !important;min-width: 0 !important;width: auto !important;height: 100% !important;overscroll-behavior-y: none !important;":"overflow: hidden !important; overscroll-behavior-y: none !important;",document.documentElement),LD(document,(()=>{this.htmlElementStyleManager.appendStyle(this.isMobile?"all: initial !important;overflow: auto !important;position: static !important;display: block !important;min-height: 0 !important;min-width: 0 !important;height: 100% !important;width: auto !important;margin: 0 !important;padding: 0 !important;overscroll-behavior-y: none !important;":"padding-right: 0 !important; overscroll-behavior-y: none !important;",document.body)}))),this.setGlobalStyles())}close(){this.htmlElementStyleManager.setStyle("border: 0 !important; width: 1px !important; height: 1px !important; position: fixed !important; opacity: 0 !important;",this.iframe),this.removeGlobalStyles(),this.htmlElementStyleManager.restoreOriginalStyles(document.documentElement),this.htmlElementStyleManager.restoreOriginalStyles(document.body),this.restoreParentViewPort()}destroy(){this.iframe.remove(),this.containerDiv&&(this.containerDiv.remove(),this.containerDiv=void 0),this.overlay&&(this.overlay.remove(),this.overlay=void 0)}setParentViewPort(){if(this.node)return;this.viewport=qD.getViewport("width=device-width, initial-scale=1, shrink-to-fit=no");const e=this.viewport,t=document.querySelector("meta[name=viewport]");t?(this.parentViewport=t,this.parentViewport.remove()):this.parentViewport=qD.getViewport(""),document.head.appendChild(e)}restoreParentViewPort(){this.node||(this.viewport&&(this.viewport.remove(),this.viewport=void 0),this.parentViewport&&(document.head.appendChild(this.parentViewport),this.parentViewport=void 0))}setGlobalStyles(){if(this.isMobile){this.headStyle=document.createElement("style");const e=this.headStyle;e.appendChild(document.createTextNode("body > *:not(#fun-iframe-container){ position: fixed !important; width: 100% !important; display: block !important }")),document.head.appendChild(e)}}removeGlobalStyles(){this.headStyle&&this.headStyle.remove()}setIframeAttributes(){var e;super.setIframeAttributes(),this.iframe.setAttribute("allowpaymentrequest","true"),this.iframe.setAttribute("allow","payment web-share"),(rl(window)||function(e){var t,n,i;return"string"==typeof(null===(t=e.navigator)||void 0===t?void 0:t.userAgent)&&!!(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.userAgent)||void 0===i?void 0:i.match("FxiOS"))}(window)||function(e){var t,n,i;return"string"==typeof(null===(t=e.navigator)||void 0===t?void 0:t.userAgent)&&!!(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.userAgent)||void 0===i?void 0:i.match("EdgiOS"))}(window)||(e=window.navigator.userAgent,jD.some((t=>t.exec(e))))||function(e){var t;const n=null===(t=e.navigator)||void 0===t?void 0:t.userAgent;return"string"==typeof n&&/(?:iPhone|iPad).*AppleWebKit\/[\w.]+/i.test(n)&&!/(?:CriOS|FxiOS|EdgiOS)\//i.test(n)}(window))&&this.iframe.setAttribute("src",location.origin)}static getViewport(e){const t=document.createElement("meta");return t.setAttribute("name","viewport"),t.setAttribute("content",e),t}configure(e){this.localeCode=e.locale;const t=e.localizedTitle;if(!MD.isContentWindowAvailable(this.iframe.contentWindow))return;if(t&&(this.title=t,this.iframe.setAttribute("title",t)),this.iframe.contentWindow.document.documentElement.setAttribute("lang",this.localeCode),this.iframe.contentWindow.document.documentElement.setAttribute("dir",(0,Gt.N_)(this.localeCode)),void 0===e.styles)return;if(e.showcase){const e=this.iframe.contentWindow.document.getElementById("main-showcase-style");null==e||e.remove()}const n=this.iframe.contentWindow.document.createElement("style");e.showcase&&n.setAttribute("id","main-showcase-style"),this.styles=e.styles||"",n.appendChild(this.iframe.contentWindow.document.createTextNode(this.styles)),this.iframe.contentWindow.document.head.appendChild(n)}async waitUntilFontsLoaded(e=1e3){if(!this.iframe.contentWindow)return!1;const t=UD(this.iframe.contentWindow.document,'1em "IBM Plex Sans"'),n=UD(this.iframe.contentWindow.document,'1em "Verveine"'),i=Promise.all([t,n]),s=FD(e);return Promise.race([i,s]).then((e=>!!Array.isArray(e)&&!e.includes(!1)))}setOnTemplateReadyHandler(e){"rewritten"!==this.templateRewriteStatus?this.templateReadyHandlers.push(e):e()}tryRewriteIframeTemplate(e=100){if(!MD.isContentWindowAvailable(this.iframe.contentWindow))return this.canRetryTemplateRewrite&&e?void setTimeout((()=>this.tryRewriteIframeTemplate(e-1)),100):void 0;"idle"===this.templateRewriteStatus&&(this.templateRewriteStatus="rewriting",this.iframe.contentWindow.document.open("text/html","replace"),this.iframe.contentWindow.document.write(this.getIframeTemplate()),RD(this.iframe.contentWindow,this.iframe.contentWindow.document),this.iframe.contentWindow.document.close(),this.templateRewriteStatus="rewritten",this.templateReadyHandlers.forEach((e=>e())))}}const VD=`\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 300;\n  font-display: swap;\n  src: url(${n(8552)}) format('woff2');\n  }\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: url(${n(1755)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: italic;\n  font-weight: 400;\n  font-display: swap;\n  src: url(${n(6569)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 500;\n  font-display: swap;\n  src: url(${n(9706)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 600;\n  font-display: swap;\n  src: url(${n(3717)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: italic;\n  font-weight: 600;\n  font-display: swap;\n  src: url(${n(4823)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans';\n  font-style: normal;\n  font-weight: 700;\n  font-display: swap;\n  src: url(${n(8676)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans Arabic';\n  font-style: normal;\n  font-weight: 300;\n  font-display: swap;\n  src: url(${n(6843)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans Arabic';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: url(${n(4312)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans Arabic';\n  font-style: normal;\n  font-weight: 500;\n  font-display: swap;\n  src: url(${n(7977)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans Arabic';\n  font-style: normal;\n  font-weight: 600;\n  font-display: swap;\n  src: url(${n(5870)}) format('woff2');\n}\n@font-face {\n  font-family: 'IBM Plex Sans Arabic';\n  font-style: normal;\n  font-weight: 700;\n  font-display: swap;\n  src: url(${n(9807)}) format('woff2');\n}\n@font-face {\n  font-family: 'Sacramento';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: url(${n(3179)}) format('woff2');\n}\n@font-face {\n  font-family: 'Verveine';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: url(${n(9562)}) format('woff2');\n}\n`,HD=(e,t)=>(0,Ml.A)({"is-mobile-safari-16":null==e?void 0:e.isMobileSafari16,"desktop-view":!(null==t?void 0:t.isMobile)});function KD(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return new Promise((n=>{const i=new qD({node:e.node,fonts:VD,isMobile:e.isMobile,title:"",id:"__checkout2",env:e.env,locale:e.localeCode,overrideTemplate(t){return`\n          <!DOCTYPE html>\n          <html class="${HD(e,t)}" lang="${e.localeCode}">\n            <head>\n                <meta charset="utf-8">\n                <meta http-equiv="X-UA-Compatible" content="IE=edge">\n                ${null==t?void 0:t.metaTags}\n                <title>${null==t?void 0:t.title}</title>\n                <style>${null==t?void 0:t.styles}</style>\n                <style>${null==t?void 0:t.fonts}</style>\n                ${null==t?void 0:t.scripts}\n            </head>\n\n            <body style="opacity: 0;">\n              <div id="root" class="donation-form" role="dialog" aria-modal="true"></div>\n            </body>\n          </html>\n      `},canRetryTemplateRewrite:!0},e.htmlElementStyleManager,t);i.setOnTemplateReadyHandler((()=>{n(i)}))}))}))}function YD(e){return(0,d.sH)(this,void 0,void 0,(function*(){return(0,Gt.iJ)(e)===wD.p.RTL?(yield n.e(645).then(n.t.bind(n,1190,23))).default:(yield n.e(706).then(n.t.bind(n,2835,23))).default}))}class zD{constructor(){this.emitter=new De.A}on(e,t){return this.emitter.on(e,t),()=>this.emitter.off(e,t)}once(e,t){return this.emitter.once(e,t),this}emit(e,...t){return this.emitter.emit(e,...t),this}removeAllListeners(){return this.emitter.eventNames().forEach((e=>{this.emitter.removeListener(e)})),this}}class WD{constructor(){this.stack=[],this.historyPreviousScreen=null}setInitial(e){this.stack=[...e],this.historyPreviousScreen=e[e.length-2]||null}getCurrent(){return this.stack[this.stack.length-1]||null}getPrevious(){return this.stack[this.stack.length-2]||null}getHistoryPrevious(){return this.historyPreviousScreen}getHistoricalScreens(){return[...this.stack]}goTo(e){const t=this.getCurrent(),n=this.stack.indexOf(e);return-1===n?(this.historyPreviousScreen=t,this.stack.push(e),this):(this.historyPreviousScreen=t,this.stack.splice(n+1),this)}has(e){return-1!==this.stack.indexOf(e)}}class $D extends zD{constructor(e,t,n){super(),this.transitionsCompiler=e,this.settings=t,this.state=n,this.isRestoredFromScreenHistory=!1,this.history=new WD,this.locked=!1,this.done=!1,this._canGoBack=!0,this.screens=e.compile(t.screens,this)}get previousScreenName(){return this.history.getPrevious()}get historyPreviousScreenName(){return this.history.getHistoryPrevious()}get isLocked(){return this.locked}get isExiting(){return this.currentScreen.final||!1}tryExit(){if(this.isExiting)return!1;const e=this.getFinalScreen();if(!e)return!1;const t=this.getScreenByName(e);return!!this.canEnterToScreen(t)&&(this.goTo(t.name),!0)}async start(){var e;try{const t=new Date,n=this.getScreenByName(this.settings.initial()),i=null!==(e=this.firstScreen)&&void 0!==e?e:n;this.firstScreen=this.getFirstScreen(i),n===i||this.isRestoredFromScreenHistory||this.history.goTo(n.name),this.history.goTo(this.firstScreen.name),await this.currentScreen.instance.beforeEnter(),this.emitScreenChanged({transitionStartedAt:t}),this.checkFlowCompleted()}catch(e){throw this.emit(Wa.ERROR,e),e}}async next(e){try{const t=new Date;if(!(null==e?void 0:e.omitBeforeLeave)&&!await this.currentScreen.instance.beforeLeave({direction:null==e?void 0:e.direction}))return;let n=this.getNextScreen(this.currentScreen),i=null==e?void 0:e.direction;if((null==e?void 0:e.getMandatoryAllowance)&&e.getMandatoryAllowance()){const e=this.getFirstMandatoryScreen();e&&(n=e,i=ku.BACKWARD)}await this.goTo(n.name,{direction:i||ku.FORWARD,transitionStartedAt:t})}catch(e){throw this.emit(Wa.ERROR,e),e}}async prev(){try{if(this.settings.initial()===this.currentScreen.name)return;const e=new Date,t=this.history.getHistoricalScreens(),n=t.findIndex((e=>{var t;return null===(t=this.screens.get(e))||void 0===t?void 0:t.final}));let i;if(i=-1!==n?t[n-1]:this.history.getPrevious(),!i)throw new Error(`Cannot go to the previous screen. Current screen: ${this.currentScreen.name}`);await this.goTo(i,{direction:ku.BACKWARD,transitionStartedAt:e})}catch(e){throw this.emit(Wa.ERROR,e),e}}getHistoricalScreens(){return this.history.getHistoricalScreens()}predictNextScreen(){return this.getNextScreen(this.currentScreen).name}async goTo(e,t){try{this.throwErrorIfCannotChangeScreen(e,null==t?void 0:t.direction),this.currentScreen.instance.dispose(),this.history.goTo(e),this.currentScreen.instance=this.transitionsCompiler.createScreenInstance(e,this),await this.currentScreen.instance.beforeEnter(),this.emitScreenChanged({direction:null==t?void 0:t.direction,transitionStartedAt:null==t?void 0:t.transitionStartedAt}),this.checkFlowCompleted()}catch(e){throw this.emit(Wa.ERROR,e),e}}lock(){return this.locked=!0,this.emit(Wa.LOCKED),this}unlock(){return this.locked=!1,this.emit(Wa.UNLOCKED),this}setFirstScreen(e){this.firstScreen=this.getScreenByName(e)}getCurrentScreen(){return this.currentScreen.instance}getScreen(e){const t=this.screens.get(e);if(!t)throw new Error(`FormFlow Screen with name ${e} not found.`);return t.instance}checkHasScreen(e){return this.screens.has(e)}isCurrentScreenFirst(){var e;return this.currentScreen.name===(null===(e=this.firstScreen)||void 0===e?void 0:e.name)}isCurrentScreenLast(){return void 0===this.currentScreen.next}dispose(){this.removeAllListeners()}setInitialHistory(e){e.length>0&&(this.history.setInitial(e),this.isRestoredFromScreenHistory=!0)}setCanGoBack(e){this._canGoBack=e}get canGoBack(){return!(!this._canGoBack||this.locked||this.done||!this.history.getPrevious())}get currentScreen(){const e=this.history.getCurrent();if(!e)throw new Error("Cannot identify current screen");const t=this.screens.get(e);if(!t)throw new Error("Cannot get current screen");return t}throwErrorIfCannotChangeScreen(e,t){if(this.locked)throw new Error(`Cannot change screen while flow is locked. Current screen: ${e}. Direction: ${t}. Viewed screens: ${this.history.getHistoricalScreens().join(", ")}`);if(this.done)throw new Error("Cannot change screen because flow is completed")}checkFlowCompleted(){this.isCurrentScreenLast()&&!this.isExiting&&(this.done=!0,this.emit(Wa.DONE))}emitScreenChanged(e){this.emit(Wa.SCREEN_CHANGED,{screen:this.currentScreen.name,instance:this.currentScreen.instance,direction:null==e?void 0:e.direction,transitionStartedAt:(null==e?void 0:e.transitionStartedAt)||new Date,transitionFinishedAt:new Date,createdAt:new Date,screenHistory:this.history.getHistoricalScreens()})}getScreenByName(e){const t=this.screens.get(e);if(!t)throw new Error(`Cant get "${e}" screen`);return t}canEnterToScreen(e){return!e.guard||!e.guard(this.state)}getFirstScreen(e){var t;if(!this.canEnterToScreen(e)){const n=null===(t=e.next)||void 0===t?void 0:t.call(e,this.state,this.history);if(!n)throw new Error('Unable to determine first screen, reached a screen without "next" function');const i=this.getScreenByName(n);return this.getFirstScreen(i)}return e}getNextScreen(e){var t;const n=null===(t=e.next)||void 0===t?void 0:t.call(e,this.state,this.history);if(!n)throw new Error("Cant go to the next screen");const i=this.getScreenByName(n);return this.canEnterToScreen(i)?i:this.getNextScreen(i)}getFirstMandatoryScreen(){return this.history.getHistoricalScreens().map((e=>this.getScreenByName(e))).find((e=>{var t;return null===(t=null==e?void 0:e.mandatory)||void 0===t?void 0:t.call(e,this.state)}))||null}getFinalScreen(){const e=[...this.screens.entries()].find((e=>e[1].final));return e?e[0]:null}}class XD{constructor(e){this.screenFactory=e}createScreenInstance(e,t){return this.screenFactory.create(e,t)}compile(e,t){const n=new Map;return Object.keys(e).forEach((i=>{const s=e[i];n.set(i,{name:i,next:s.next,guard:s.guard,mandatory:s.mandatory,final:s.final,instance:this.screenFactory.create(i,t)})})),n}}function QD(e,t,n){const i=new XD(e);return new $D(i,t,n)}function ZD(e){e=e||16;let t="";for(let n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return t}function JD(e,t){return(0,d.sH)(this,arguments,void 0,(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function*(){try{return yield e()}catch(i){if(n>=t.retries)throw i;return yield new Promise((e=>setTimeout(e,t.delay))),JD(e,t,++n)}}()}))}class eT{constructor(e,t,n,i){this.checkoutConfiguration=e,this.apiHost=t,this.sentry=n,this.externalGoalsFetchPromise=i}getGoals(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.showcase)return wn.success([]);try{const e=yield this.request(),t=this.processGoalHierarchy(e);return wn.success(t)}catch(e){const t=new Error("DesignationsAPI: Goals fetching failed"),n=e instanceof xn.GI?e.statusCode:void 0;return t.stack=e instanceof Error?e.stack:void 0,0!==n&&this.sentry.captureException(t,{extra:{description:e},fingerprint:["designations-api-failed-to-fetch-goals"]}),wn.fail(t)}}))}request(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.externalGoalsFetchPromise){const e=yield this.externalGoalsFetchPromise;return this.validateResponse({data:e,valid:!0}),e}return JD((()=>(0,d.sH)(this,void 0,void 0,(function*(){const e=yield(0,xn.Em)({url:`${this.apiHost}/checkout/getGoals`,method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},params:{locale:this.checkoutConfiguration.environmentConfig.locale,widgetKey:this.checkoutConfiguration.campaign.key}});return this.validateResponse(e),e.data}))),{retries:3,delay:500})}))}validateResponse(e){if(!e.valid)throw new Error("Invalid response");if(!Array.isArray(e.data)){if("string"==typeof e.data)throw new Error(`Server returned non-JSON response. Content: ${e.data}`);throw new Error("Server returned unexpected data type: "+typeof e.data)}}processGoalHierarchy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=[];for(const s of e){const e=ZD();if("children"in s){const t=this.processGoalHierarchy(s.children,s.key,e);if(0===t.length)continue;i.push(...t)}const a=this.mapWidgetGoal(s,e,t,n);i.push(a)}return i}mapWidgetGoal(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;var s,a;return{id:e.key,key:t,name:e.name,code:null!==(s="code"in e?e.code:null)&&void 0!==s?s:null,parentId:n,parentKey:i,repeat:e.repeat,default:null!==(a=e.default)&&void 0!==a?a:null,frequency:null,isGroup:"children"in e}}}function tT(e){return e===qn.ONCE?js.ONE_TIME:js.RECURRING}class nT{constructor(e,t,n){this.designationsApi=e,this.checkoutState=t,this.checkoutConfiguration=n,this.fetchGoalsPromise=null}tryFetchGoals(){return(0,d.sH)(this,void 0,void 0,(function*(){return null!==this.fetchGoalsPromise?this.fetchGoalsPromise:(this.fetchGoalsPromise=this.fetchAndSetGoals(),yield this.fetchGoalsPromise)}))}get designations(){return this.checkoutState.designations}fetchAndSetGoals(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.designationsApi.getGoals();wn.isSuccess(e)&&(this.designations.setAllGoals(e.successResult),this.tryToApplyExternalParams())}))}tryToApplyExternalParams(){var e,t,n,i;const s=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.donationItems;if(s)return void this.tryToSetExternalGoalFromDonationItems(s);const a=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.designation)||void 0===i?void 0:i.id;a&&this.tryToSetExternalGoal(a)}tryToSetExternalGoalFromDonationItems(e){const t=e[0];if(!t)return;const n=t.goalKey;if(!n)return;const i=this.designations.dataPoint.allGoalsById.get(n);if(!i)return;const s=tT(this.checkoutState.donation.dataPoint.frequency);this.isGoalAvailable(i,s)&&this.designations.setSelectedGoals([i],s)}tryToSetExternalGoal(e){const t=this.designations.dataPoint.allGoalsById.get(e);if(!t)return;const n=tT(this.checkoutState.donation.dataPoint.frequency);this.isGoalAvailable(t,n)&&this.designations.setSelectedGoals([t],n)}isGoalAvailable(e,t){return e.repeat===js.ALL||e.repeat===t}}const iT=(e,t,n,i,s)=>{const a=new eT(e,n,i,s);return new nT(a,t,e)};class sT{constructor(e,t){this.checkoutConfiguration=e,this.checkoutState=t}tryApply(){var e;(null===(e=this.checkoutConfiguration.external.flow)||void 0===e?void 0:e.type)===$n.CRYPTO&&(this.tryApplyCurrency(),this.tryApplyAmount())}tryApplyCurrency(){var e,t;(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.currency)&&this.checkoutState.donation.setCurrency(this.checkoutConfiguration.external.state.donation.currency)}tryApplyAmount(){var e,t;void 0!==(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.amount)&&this.checkoutState.donation.setAmount(this.checkoutConfiguration.external.state.donation.amount)}}class aT{constructor(e){this.options=e}tryApply(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;(yield null===(e=this.options.restoreParamsApplier)||void 0===e?void 0:e.tryApply())||(this.options.entryParamsApplier.tryApply(),yield null===(t=this.options.adaptiveParamsApplier)||void 0===t?void 0:t.tryApply())}))}}class oT{static getByLocale(e,t){const n=(0,Gt.Qk)(t);let i=e.fields.find((({lang:e})=>e===n));if(!i){const t=(0,Gt.Qk)(e.defaultLocale);i=e.fields.find((({lang:e})=>e===t))}return i}static getByLanguage(e,t){let n=e.fields.find((({lang:e})=>e===t));if(!n){const t=(0,Gt.Qk)(e.defaultLocale);n=e.fields.find((({lang:e})=>e===t))}return n}static findByLocale(e,t){const n=(0,Gt.Qk)(t);return e.fields.find((({lang:e})=>e===n))||null}}class rT{constructor(e,t,n,i){this.checkoutConfiguration=e,this.checkoutState=t,this.entryExternalParamsApplier=n,this.intl=i}tryApply(){this.entryExternalParamsApplier.tryApply(),this.tryApplyDesignationParams(),this.tryApplyDesignationsParams(),this.tryApplyTributeParams(),this.tryApplyCommentParams(),this.tryApplySupporterParams()}tryApplyDesignationParams(){var e,t;(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.id)&&this.checkoutState.designation.setGoal(this.checkoutConfiguration.external.state.designation.id)}tryApplyDesignationsParams(){var e;const t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.designation,n=function(e,t,n){var i,s,a;const o=null!==(i=null==e?void 0:e.id)&&void 0!==i?i:null==e?void 0:e.key,r=ZD(),l=null==e?void 0:e.code,c=null==e?void 0:e.repeat,u=null!==(s=null==e?void 0:e.default)&&void 0!==s?s:null,d=null!==(a=null==e?void 0:e.frequency)&&void 0!==a?a:null;let h=null==e?void 0:e.name;if(!h&&t&&n){const e=oT.getByLanguage(t,n);h=null==e?void 0:e.name}if(o&&l&&c&&h)return{id:o,key:r,name:h,code:l,repeat:c,frequency:d,default:u,parentId:null,parentKey:null,isGroup:!1}}(t,null==t?void 0:t.localization,this.intl.language);n&&(this.checkoutState.designations.setAllGoals([n]),this.checkoutState.designations.setSelectedGoals([n],n.repeat))}tryApplyTributeParams(){var e,t,n,i,s,a;(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.tribute)||void 0===t?void 0:t.type)===Ma.NONE&&this.checkoutState.tribute.setActive(!1),(null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.tribute)||void 0===i?void 0:i.inHonorOf)&&(this.checkoutState.tribute.setTributeeName(this.checkoutConfiguration.external.state.tribute.inHonorOf),this.checkoutState.tribute.setActive(!0)),(null===(a=null===(s=this.checkoutConfiguration.external.state)||void 0===s?void 0:s.tribute)||void 0===a?void 0:a.isSelected)&&(this.checkoutState.tribute.setOriented(!0),this.checkoutState.tribute.setActive(!0))}tryApplyCommentParams(){var e;(null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.comment)&&this.checkoutState.comment.saveComment(this.checkoutConfiguration.external.state.comment)}tryApplySupporterParams(){var e,t,n,i,s,a;(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.supporter)||void 0===t?void 0:t.firstName)&&this.checkoutState.privacy.setDonorFirstName(this.checkoutConfiguration.external.state.supporter.firstName),(null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.supporter)||void 0===i?void 0:i.lastName)&&this.checkoutState.privacy.setDonorLastName(this.checkoutConfiguration.external.state.supporter.lastName),(null===(a=null===(s=this.checkoutConfiguration.external.state)||void 0===s?void 0:s.supporter)||void 0===a?void 0:a.email)&&this.checkoutState.privacy.setDonorEmail(this.checkoutConfiguration.external.state.supporter.email)}}class lT{constructor(){this.updateListeners=new Set}synchronize(){this.checkoutStateSynchronizer.synchronize()}onStateUpdate(e){return this.updateListeners.add(e),()=>this.updateListeners.delete(e)}syncUpdate(){this.updateListeners.forEach((e=>e()))}}class cT extends lT{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f){super(),this.donation=e,this.designation=t,this.designations=n,this.tribute=i,this.preDonationUpsell=s,this.postDonationUpsell=a,this.privacy=o,this.paymentOptions=r,this.giftAid=l,this.communicationConsent=c,this.mailingAddress=u,this.comment=d,this.doubleTheDonation=h,this.questions=m,this.remindMeLater=p,this.process=g,this.benefits=y,this.checkoutStateSynchronizer=f}}const uT=e=>{let{designationsDataPoint:t,processDataPoint:n,donationParams:i,currencyService:s}=e;var a,o,r,l,c,u,d,h,m,p,g,y,f,v;const S=null===(a=n.completedData)||void 0===a?void 0:a.donationIds,E=i.availableDonationItemsDto,A=i.processingFees,C=t.selectedGoals.filter(((e,n)=>{var i;return null===(i=t.selectedGoalsAvailability[n])||void 0===i?void 0:i.isAvailable}));if(S&&C&&E&&A&&S.length>0){const e=[];for(let t=0;t<S.length;++t){const a=S[t],l=E[t],c=C[t],u=A[l.id],d=null===(r=null===(o=n.completedData)||void 0===o?void 0:o.recurringIds)||void 0===r?void 0:r[t],h=d?{id:d}:null;e.push({id:a,amount:s.toFloat(l.amount,i.currency),frequency:l.frequency,feesCovered:s.toFloat(u,i.currency),designation:{id:null==c?void 0:c.id,name:null==c?void 0:c.name,code:null==c?void 0:c.code},recurring:h})}return e}const b=null===(c=null===(l=n.completedData)||void 0===l?void 0:l.recurringIds)||void 0===c?void 0:c[0],P=b?{id:b}:null;return[{id:null!==(h=null===(d=null===(u=n.completedData)||void 0===u?void 0:u.donationIds)||void 0===d?void 0:d[0])&&void 0!==h?h:"",amount:s.toFloat(i.total,i.currency),frequency:i.frequency,feesCovered:s.toFloat(i.publicFee,i.currency),designation:{id:null!==(p=null===(m=C[0])||void 0===m?void 0:m.id)&&void 0!==p?p:"",name:null!==(y=null===(g=C[0])||void 0===g?void 0:g.name)&&void 0!==y?y:"",code:null!==(v=null===(f=C[0])||void 0===f?void 0:f.code)&&void 0!==v?v:""},recurring:P}]},dT=(e,t,n)=>{let i=null;if(!n)return null;e.goalKey&&(i={id:e.goalKey,name:e.goalName,code:e.goalCode});const s=t.selectedGoals.filter(((e,n)=>{var i;return null===(i=t.selectedGoalsAvailability[n])||void 0===i?void 0:i.isAvailable}));return s[0]&&(i={id:s[0].id,name:s[0].name,code:s[0].code}),i},hT=(e,t)=>{var n,i,s,a;let o=null;if(!t)return null;const r=null!==(s=null===(i=null===(n=e.completedData)||void 0===n?void 0:n.recurringIds)||void 0===i?void 0:i[0])&&void 0!==s?s:null===(a=e.completedData)||void 0===a?void 0:a.recurringId;return r&&(o={id:r}),o},mT=(e,t)=>{var n,i;const s=[],a=t.selectedGoals.filter(((e,n)=>{var i;return null===(i=t.selectedGoalsAvailability[n])||void 0===i?void 0:i.isAvailable}));return(null===(n=e.availableDonationItemsDto)||void 0===n?void 0:n.length)?(e.availableDonationItemsDto.forEach(((e,t)=>{var n;s.push({amount:null===e.amount?void 0:e.amount,frequency:e.frequency,goalKey:null===(n=a[t])||void 0===n?void 0:n.id})})),s):[{amount:e.amount,frequency:e.frequency,goalKey:null===(i=a[0])||void 0===i?void 0:i.id}]};class pT{static get emptyAmountOptions(){return{once:[],every4weeks:[],monthly:[],daily:[],weekly:[],biweekly:[],bimonthly:[],quarterly:[],semiannual:[],annual:[]}}static get emptyDefaultAmounts(){return{once:0,monthly:0,daily:0,weekly:0,biweekly:0,bimonthly:0,quarterly:0,semiannual:0,annual:0}}constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v){var S;this._checkoutConfiguration=e,this.checkoutState=t,this._checkoutUIState=n,this.sessionService=i,this._sessionAPI=s,this.tracker=a,this.currencyService=o,this.intl=r,this.iframeWindow=l,this.sentry=c,this.paymentScreen=u,this.eventEmitter=d,this.checkoutAPIBridge=h,this.debug=m,this.experiments=p,this.paymentAPI=g,this.logger=y,this._redirectApi=f,this.params=v,this.shouldFindMandatoryScreen=!1,this._closeSessionPromise=null,(null===(S=this.checkoutConfiguration.fundraisingPage)||void 0===S?void 0:S.key)&&(this.checkoutUIState.askPageActiveTab=Ql.FUNDRAISER)}get redirectApi(){return this._redirectApi}get sessionAPI(){return this._sessionAPI}get checkoutUIState(){return this._checkoutUIState}get checkoutConfiguration(){return this._checkoutConfiguration}get campaignConfig(){return this.checkoutConfiguration.campaign.config}get defaultAmountOptions(){return this.checkoutConfiguration.defaultAmountOptions}get company(){return this.checkoutConfiguration.company}get livemode(){return this.checkoutConfiguration.infrastructureParams.livemode}get isPaid(){return this.processDataPoint.isCompleted}get isPaymentStarted(){return!1}get canCloseSession(){return!this.sessionService.closed&&this.isPaid}reloadCheckout(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.tracker.trackCheckoutClose(),yield Ri(20),e){const t=new URL(window.location.href);Object.entries(e).forEach((e=>{let[n,i]=e;t.searchParams.set(n,i)})),window.location.replace(t)}else window.location.reload()}))}initialize(){return(0,d.sH)(this,void 0,void 0,(function*(){this.sessionService.updateSession(),this.checkoutUIState.preloadComponents()}))}dispose(){return(0,d.sH)(this,void 0,void 0,(function*(){}))}tryToCloneOnceFrequencyToAnnual(){}isMultipleRecurringPlanTestGroup1(){return!1}isMultipleRecurringPlanTestGroup2(){return!1}exposeMultipleRecurringPlanCheckoutExperiment(){}exposeMultipleRecurringPlanCampaignPagesExperiment(){}updateSession(e){return this.sessionService.updateSession(e)}abandonSession(){return this.sessionService.abandonSession()}tryCloseSession(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this._closeSessionPromise)return this._closeSessionPromise;if(this.canCloseSession){this._closeSessionPromise=this.closeSession();try{yield this._closeSessionPromise}finally{this._closeSessionPromise=null}}}))}onStateUpdate(e){return this.checkoutState.onStateUpdate(e)}syncUpdateCheckoutState(){this.checkoutState.syncUpdate()}setRemoveCloseGuard(e){this._removeCloseGuard=e}disarmCloseGuard(){this._removeCloseGuard&&this._removeCloseGuard()}updateSessionWidgetDefaults(){this.sessionService.updateSessionWidgetDefaults()}setScreenHistoryToSession(e){this.sessionService.setScreenHistory(e)}sendFeedback(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{const t=yield this.sessionAPI.feedback(e);return wn.isSuccess(t)?(this.trackFeedbackEvent(t.successResult.status,e.message.length),!0):(0!==t.failureResult.status&&this.trackFeedbackEvent(t.failureResult.status,e.message.length),!1)}catch(t){return t instanceof xn.GI&&0!==t.statusCode&&this.trackFeedbackEvent(t.statusCode,e.message.length),!1}}))}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}handlePaymentRedirect(e){return(0,d.sH)(this,void 0,void 0,(function*(){e===this.params.screenSet.thankYou&&this.canRedirect&&(this.debug.log("simulating additional pay delay before redirect"),yield Ri(pT.ADDITIONAL_PAY_DELAY),this.debug.log("it my log in checkout service"),this.debug.log("redirecting"),yield this.tryCloseSession(),yield this.redirectApi.tryRedirect(this))}))}getCommonPublicCheckoutDonationParams(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.donorNameDataPoint,n=this.donorEmailDataPoint,i=this.tributeDataPoint,s=this.onBehalfOfDataPoint,a=this.processDataPoint,o=this.donateAnonymousDataPoint,r=this.communicationConsentDataPoint,l=this.checkoutConfiguration.campaign.config,c=i.getDTO(),u=t.getDTO(),d=n.getDTO(),h=this.getDonationParams();return(e=>{let{params:t,tributeDataPointDTO:n,donorNameDataPointDTO:i,donorEmailDataPointDTO:s,anonymousDataPoint:a,onBehalfOfDataPoint:o,designationDataPoint:r,designationsDataPoint:l,commentDataPoint:c,communicationConsentDataPoint:u,processDataPoint:d,donationParams:h,campaign:m,currencyService:p,isPaid:g}=e;var y,f,v;const S=n.isActive&&!!n.inHonorOf;let E=null;var A;return d.completedData&&g&&(E={id:null!==(f=null===(y=d.completedData.donationIds)||void 0===y?void 0:y[0])&&void 0!==f?f:d.completedData.donationId,paymentMethod:(A=t.clientPaymentMethod,{[Fa.CARD]:"CreditCard",[Fa.APPLE_PAY]:"ApplePay",[Fa.GOOGLE_PAY]:"GooglePay",[Fa.PAYPAL]:"PayPal",[Fa.VENMO]:"Venmo",[Fa.US_BANK_ACCOUNT]:"ACH",[Fa.AU_BECS]:"BECS",[Fa.UK_BACS]:"Bacs",[Fa.ACSS]:"PAD",[Fa.SEPA]:"SEPA",[Fa.IDEAL]:"iDEAL",[Fa.CRYPTO]:"Crypto"}[A]||""),amount:p.toFloat(h.total,h.currency),feesCovered:p.toFloat(h.publicFee,h.currency),currency:h.currency,recurring:h.frequency!==qn.ONCE,frequency:h.frequency,donationItems:uT({designationsDataPoint:l,processDataPoint:d,donationParams:h,currencyService:p})}),{supporter:{id:(null===(v=d.completedData)||void 0===v?void 0:v.customerId)||null,email:s.email,firstName:i.firstName,lastName:i.lastName,anonymous:m.showAnonymous&&a.isAnonymousChecked,mailingListSubscribed:u.isAnyConsentAccepted,employer:t.employerName||null,onBehalfOf:o.isOnBehalfOf?o.companyName:null},comment:c.comment||null,donation:E,designation:dT(r,l,g),tribute:n.isActive?S:null,recurring:hT(d,g)}})({params:e,tributeDataPointDTO:c,donorEmailDataPointDTO:d,donorNameDataPointDTO:u,campaign:l,anonymousDataPoint:o,isPaid:this.isPaid,onBehalfOfDataPoint:s,processDataPoint:a,donationParams:h,currencyService:this.currencyService,designationDataPoint:this.designationDataPoint,designationsDataPoint:this.designationsDataPoint,commentDataPoint:this.commentDataPoint,communicationConsentDataPoint:r})}))}getCommonPublicCheckoutIntentParams(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.tributeDataPoint,n=this.donorNameDataPoint,i=this.donorEmailDataPoint,s=this.remindMeLaterDataPoint,a=t.getDTO(),o=n.getDTO(),r=i.getDTO(),l=this.getDonationParams();return(e=>{let{flowType:t,tributeDataPointDTO:n,donorNameDataPointDTO:i,donorEmailDataPointDTO:s,designationDataPoint:a,designationsDataPoint:o,commentDataPoint:r,remindMeLaterDataPoint:l,benefit:c,donationParams:u,isPaid:d,isDesignationModifiable:h}=e;var m,p;const g=n.isActive&&!!n.inHonorOf;if(d)return null;const y=o.selectedGoals.filter(((e,t)=>o.selectedGoalsAvailability[t].isAvailable));return{flowType:t,checkoutSettings:{modifyAmount:u.canModifyAmount,designation:null===(m=y[0])||void 0===m?void 0:m.id,modifyDesignation:h},comment:r.comment,donation:{amount:u.amount,currency:u.currency,recurring:u.frequency!==qn.ONCE,frequency:u.frequency,selectedHintId:u.selectedHintId,donationItems:mT(u,o)},supporter:{email:s.email,firstName:i.firstName,lastName:i.lastName},tribute:g?{type:n.type,labelType:n.labelType,inHonorOf:n.inHonorOf}:null,isSavedEmailOnExit:l.used,feeCovered:u.feeCovered,benefit:c?{id:c.key,optionValueId:null===(p=c.chosenOptionVariant)||void 0===p?void 0:p.publicId}:void 0}})({flowType:this.type,designationDataPoint:this.designationDataPoint,designationsDataPoint:this.designationsDataPoint,commentDataPoint:this.commentDataPoint,remindMeLaterDataPoint:s,tributeDataPointDTO:a,donorNameDataPointDTO:o,donorEmailDataPointDTO:r,benefit:e,donationParams:l,isDesignationModifiable:this.checkoutConfiguration.canModifyDesignation,isPaid:this.isPaid})}))}capturePayErrorToSentry(e){e&&(e instanceof xn.GI&&0===e.statusCode||this.sentry.captureException(e))}emitDonationComplete(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.getPublicCheckoutDonationParams();this.checkoutAPIBridge.emitDonationComplete(e),this.logger.donationComplete({key:this.checkoutConfiguration.campaign.key,name:this.checkoutConfiguration.campaign.name},Object.assign(Object.assign({},e),this.checkoutAPIBridge.getOpenParams()))}))}handleDonationCompleted(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=[this.emitDonationComplete(),this.tracker.trackCheckoutCharge({donationId:e.donationId,donationIds:e.donationIds,clientPaymentMethod:e.clientPaymentMethod,duration:e.duration}),this.tracker.trackCheckoutDonationComplete({donationIds:e.donationIds,paymentIntentId:e.paymentIntentId,clientPaymentMethod:e.clientPaymentMethod,duration:e.duration})];yield Promise.all(t)}))}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get canRedirect(){const e=this.checkoutState instanceof cT?this.checkoutState.postDonationUpsell.dataPoint:null;return e?this.redirectApi.canRedirect()&&!e.isEnabled:this.redirectApi.canRedirect()}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get donateAnonymousDataPoint(){return this.checkoutState.privacy.donateAnonymousDataPoint}get onBehalfOfDataPoint(){return this.checkoutState.privacy.onBehalfOfDataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get remindMeLaterDataPoint(){return this.checkoutState.remindMeLater.dataPoint}get communicationConsentDataPoint(){return this.checkoutState.communicationConsent.dataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}closeSession(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.sessionService.updateSession(),yield this.sessionService.closeSession()}))}trackFeedbackEvent(e,t){this.tracker.trackCheckoutCustomEvent({type:Ee.FEEDBACK_FORM_SENT,data:{httpCode:e,messageLength:t}})}}pT.ADDITIONAL_PAY_DELAY=1*ns.MS.SECOND;class gT extends pT{constructor(){super(...arguments),this._isPaymentCompleted=!1,this.donationStatusInterval=null}get isPaymentCompleted(){return this._isPaymentCompleted}get type(){return this.checkoutState.process.dataPoint.flowType}getPaymentScreen(e,t){return this.paymentScreen.get(e,t)}dispose(){const e=Object.create(null,{dispose:{get:()=>super.dispose}});return(0,d.sH)(this,void 0,void 0,(function*(){return this.clearDonationStatusInterval(),e.dispose.call(this)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.infrastructureParams.showcase)return wn.fail({});try{return yield this.sessionService.updateSession(),yield this.paymentAPI.hold({clientPaymentMethod:Gn.CRYPTO}),wn.success(void 0)}catch(e){return wn.fail({shouldLeave:!1})}}))}pay(e){return(0,d.sH)(this,arguments,void 0,(function(e){var t=this;let{screen:n,predictedNextScreen:i}=e;return function*(){var e,s,a;if(t.checkoutConfiguration.infrastructureParams.showcase)return wn.fail({});t.checkoutState.process.setInProgress();const o=Date.now(),r=yield t.sessionService.updateSession();if(wn.isFailure(r))return t.payErrorMessage=t.intl.translate("common.errorOccurredText"),wn.fail({});let l;try{l=yield t.paymentAPI.pay()}catch(e){return t.capturePayErrorToSentry(e),wn.fail({})}return wn.isFailure(l)?wn.fail({}):l.successResult.data.cryptoData?(t.checkoutState.cryptoWallet.setAddress(l.successResult.data.cryptoData.address),t.checkoutState.process.setCompleted({donationId:l.successResult.data.donationId,customerId:l.successResult.data.customerId,tributeId:l.successResult.data.tributeId,tributeDonorPortalLink:l.successResult.data.tributeDonorPortalLink,donationIds:(null===(e=l.successResult.data.donationItems)||void 0===e?void 0:e.map((e=>e.donationId)))||[],recurringIds:(null===(s=l.successResult.data.donationItems)||void 0===s?void 0:s.map((e=>e.recurringId)))||[]}),t.watchForPaymentStatus({donationId:l.successResult.data.donationId,donationIds:(null===(a=l.successResult.data.donationItems)||void 0===a?void 0:a.map((e=>e.donationId)))||[],paymentIntentId:l.successResult.data.paymentIntentId,startPayTimestamp:o,screen:n}),yield t.handlePaymentRedirect(i),wn.success(void 0)):wn.fail({})}()}))}saveCheckoutClosePublicParams(){return(0,d.sH)(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.getPublicCheckoutDonationParams(),this.getCommonPublicCheckoutIntentParams()]);this.checkoutAPIBridge.setDonationParams(e),this.checkoutAPIBridge.setIntentParams(t)}))}getDonationParams(){const e=this.donationDataPoint,t=e.getDTO();return{amount:t.amount,total:t.total,currency:t.currency,frequency:t.frequency,canModifyAmount:e.isAmountEditable,publicFee:0}}getPublicCheckoutDonationParams(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.getCommonPublicCheckoutDonationParams({clientPaymentMethod:Gn.CRYPTO,employerName:null})}))}get donationDataPoint(){return this.checkoutState.donation.dataPoint}watchForPaymentStatus(e){this.donationStatusInterval=setInterval((()=>(0,d.sH)(this,void 0,void 0,(function*(){(yield this.paymentAPI.status())&&(this.clearDonationStatusInterval(),this.handleDonationCompleted({donationId:e.donationId,donationIds:e.donationIds,paymentIntentId:e.paymentIntentId,clientPaymentMethod:Gn.CRYPTO,screen:e.screen,duration:e.startPayTimestamp-Date.now()}),this._isPaymentCompleted=!0)}))),5e3)}clearDonationStatusInterval(){this.donationStatusInterval&&clearInterval(this.donationStatusInterval)}}class yT{}class fT extends yT{constructor(e,t,n,i){super(),this.designationStateService=e,this.designationsStateService=t,this.mailingAddressStateService=n,this.remindMeLaterStateService=i}synchronize(){this.syncDesignation(),this.syncDesignations(),this.syncMailingAddress(),this.syncRemindMeLater()}onDonationChange(){this.syncDesignation(),this.syncDesignations(),this.syncMailingAddress()}onPrivacyChange(){this.syncRemindMeLater()}syncDesignation(){this.designationStateService.synchronize()}syncDesignations(){this.designationsStateService.synchronize()}syncMailingAddress(){this.mailingAddressStateService.synchronize()}syncRemindMeLater(){this.remindMeLaterStateService.synchronize()}}class vT{constructor(e){this.dataPointRegistry=e}}class ST extends vT{constructor(e){super(e),this.dataPointRegistry=e}synchronize(){const e=tT(this.dataPointRegistry.getDataPoint(Xu.DONATION).frequency);this.designationDataPoint.hasSelectedGoalWithRepeat(e)||this.designationDataPoint.setComputedGoalKeyByGoalRepeat(e)}get designationDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATION)}}class ET{constructor(e,t){this.dataPointRegistry=e,this.checkoutConfiguration=t}getAvailableGoals(){const e=this.goalRepeat,t=this.designationsDataPoint.allGoals,n=this._previousGoalRepeat===e&&this._previousAllGoals===t;if(this._cachedAvailableGoals&&n)return this._cachedAvailableGoals;this._previousGoalRepeat=e,this._previousAllGoals=t;const i=[];for(const n of t.values())this.isGoalAvailable(n,e)&&i.push(n);return this._cachedAvailableGoals=i,i}getSingleSelectedGoal(){const e=this.designationsDataPoint.savedGoals[this.goalRepeat];if(e)return e;const t=this.findCrossRepeatGoal();if(t)return t;return this.designationsDataPoint.defaultGoals[this.goalRepeat]||null}getSelectedGoalsAvailability(){return 0===this.designationsDataPoint.selectedGoals.length?[{isAvailable:!0}]:this.designationsDataPoint.selectedGoals.map((e=>({isAvailable:this.isGoalAvailable(e,this.goalRepeat)})))}isDesignationReadOnly(){var e,t,n;const i=this.checkoutConfiguration,s=null===(n=null===(t=null===(e=i.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.isEditable)||void 0===n||n;if(this.isMultipleDonations)return!1;if(!this.hasSelectedDesignations())return!1;if(this.isDesignationNotShown())return!1;if(i.campaign.config.displayGoal===la.ASSIGN&&i.campaign.config.showDesignation)return!0;if(!s)return!0;const a=i.campaign.config.goalsCount;return this.donationDataPoint.frequency!==qn.ONCE?a.repeat<=1:a.once<=1}isDesignationEditable(){const e=this.checkoutConfiguration;return!(e.campaign.config.displayGoal===la.WITHOUT||e.campaign.config.displayGoal===la.ASSIGN||!this.isMultipleDonations&&this.hasSelectedDesignations()&&(this.isDesignationReadOnly()||this.isDesignationNotShown()||e.campaign.config.displayGoal!==la.SELECT))}get goalRepeat(){return tT(this.donationDataPoint.frequency)}get designationsDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS)}get isMultipleDonations(){return this.isMultipleDonationsEnabled&&this.donationDataPoint.isMultipleDonations}get isMultipleDonationsEnabled(){var e,t,n;return this.checkoutConfiguration.multipleDesignations.enabled&&(null===(n=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.isEditable)||void 0===n||n)}isGoalAvailable(e,t){return e.repeat===js.ALL||e.repeat===t}findCrossRepeatGoal(){const e=this.goalRepeat===js.ONE_TIME?js.RECURRING:js.ONE_TIME,t=this.designationsDataPoint.savedGoals[e];return t&&t.repeat===js.ALL?t:null}hasSelectedDesignations(){return this.designationsDataPoint.selectedGoals.length>0}isDesignationNotShown(){if(!this.hasSelectedDesignations())return!1;const e=this.checkoutConfiguration;return e.campaign.config.displayGoal===la.ASSIGN&&!e.campaign.config.showDesignation}}class AT extends ET{get donationDataPoint(){return this.dataPointRegistry.getDataPoint(Xu.DONATION)}}class CT extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.designationsParamsService=t}synchronize(){const e=this.designationsParamsService.getAvailableGoals();this.designationsDataPoint.computed.setAvailableGoals(e);const t=this.designationsParamsService.getSingleSelectedGoal();this.designationsDataPoint.computed.setSingleSelectedGoal(t);const n=this.designationsParamsService.getSelectedGoalsAvailability();this.designationsDataPoint.computed.setSelectedGoalsAvailability(n);const i=this.designationsParamsService.isDesignationReadOnly();this.designationsDataPoint.computed.setDesignationReadOnly(i);const s=this.designationsParamsService.isDesignationEditable();this.designationsDataPoint.computed.setDesignationEditable(s)}get designationsDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS)}}class bT extends CT{constructor(e,t){super(e,t),this.dataPointRegistry=e}}class PT{constructor(e,t,n,i,s){this.checkoutConfiguration=e,this.currencyService=t,this.mailingAddressModule=n,this.paymentMethodAvailabilityManagerRepository=i,this.dataPointRegistry=s}isEnabled(){return this.mailingAddressModuleCheckoutScreenLogic.isEnabled(this.totalInCustomCurrency,this.mailingAddressModuleCheckoutScreenParams)}isRequired(){return this.mailingAddressModuleCheckoutScreenLogic.isRequired(this.totalInCustomCurrency,this.mailingAddressModuleCheckoutScreenParams)}get mailingAddressModuleCheckoutScreenLogic(){return this.mailingAddressModule.getCheckoutScreenLogic()}get campaignConfig(){return this.checkoutConfiguration.campaign.config}get totalInCustomCurrency(){const e=this.dataPointRegistry.getDataPoint(Xu.DONATION),t=this.mailingAddressModule.getCurrencyLogic({widget:this.campaignConfig});return this.currencyService.convert(e.total,e.currency,t.currency)}get mailingAddressModuleCheckoutScreenParams(){return{mailingRequired:this.campaignConfig.mailingRequired,mailingRequiredFromAmount:this.campaignConfig.mailingRequiredFromAmount,showMailing:this.campaignConfig.showMailing,showMailingFromAmount:this.campaignConfig.showMailingFromAmount,paymentMethodAvailabilityManagerRepository:this.paymentMethodAvailabilityManagerRepository,paymentMethod:null,paymentMethodCountry:null,isGiftAidAccepted:!1}}}class NT extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.mailingAddressAvailabilityService=t}synchronize(){this.mailingAddressDataPoint.computed.setAvailability({isEnabled:this.mailingAddressAvailabilityService.isEnabled(),isRequired:this.mailingAddressAvailabilityService.isRequired()})}get mailingAddressDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.MAILING_ADDRESS)}}class DT{constructor(e,t){this.checkoutConfiguration=e,this.dataPointRegistry=t}isAvailable(){return!(!this.checkoutConfiguration.isAbandonedDonationsEnabled||this.isDonorEmailValid&&this.isTermsAndConditionsValid)}get isDonorEmailValid(){return this.dataPointRegistry.getDataPoint(Wl.DONOR_EMAIL).getValidationResult().isValid}get isTermsAndConditionsValid(){return this.dataPointRegistry.getDataPoint(Wl.TERMS_AND_CONDITIONS).getValidationResult().isValid}}class TT extends DT{}class kT extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.remindMeLaterAvailabilityService=t}synchronize(){const e=this.remindMeLaterAvailabilityService.isAvailable();this.remindMeLaterDataPoint.computed.setAvailability(e)}get remindMeLaterDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.REMIND_ME_LATER)}}class IT extends kT{}class _T extends lT{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h){super(),this.donation=e,this.cryptoWallet=t,this.designation=n,this.designations=i,this.mailingAddress=s,this.comment=a,this.privacy=o,this.communicationConsent=r,this.questions=l,this.tribute=c,this.remindMeLater=u,this.process=d,this.checkoutStateSynchronizer=h}}class OT{constructor(e,t){this.dataPointRegistry=e,this.checkoutStateSynchronizer=t}perform(e){e(),this.triggerSynchronization()}}class xT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.COMMENT)}setIsRequired(e){this.perform((()=>{this.dataPoint.setIsRequired(e)}))}setIsActive(e){this.perform((()=>{this.dataPoint.setIsActive(e)}))}saveComment(e){this.perform((()=>{this.dataPoint.setComment(e)}))}savePrevComment(){this.perform((()=>{this.dataPoint.setPrevComment()}))}}class wT extends xT{triggerSynchronization(){}}class RT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.COMMUNICATION_CONSENT)}setCustomizedChannelState(e,t){this.perform((()=>{this.dataPoint.setCustomizedConsentAccepted(e,t)}))}setGeneralConsentState(e){this.perform((()=>{this.dataPoint.setGeneralConsentAccepted(e)}))}resetCustomizedConsent(){this.perform((()=>{this.dataPoint.setAllConsentsRejected()}))}setGeneralConsentShown(){this.perform((()=>{this.dataPoint.setGeneralConsentShown()}))}setCustomizedConsentShown(){this.perform((()=>{this.dataPoint.setCustomizedConsentShown()}))}}class MT extends RT{triggerSynchronization(){}}class LT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Xu.CRYPTO_WALLET)}setAddress(e){this.perform((()=>{this.dataPoint.setAddress(e)}))}triggerSynchronization(){}}class FT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATION)}setGoal(e){this.perform((()=>{this.dataPoint.setGoalKey(e,tT(this.donationDataPoint.frequency))}))}}class UT extends FT{get donationDataPoint(){return this.dataPointRegistry.getDataPoint(Xu.DONATION)}triggerSynchronization(){}}class jT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS)}addSelectedGoal(e){this.perform((()=>{this.dataPoint.addSelectedGoal(e)}))}removeSelectedGoal(e){this.perform((()=>{this.dataPoint.removeSelectedGoal(e)}))}setAllGoals(e){this.dataPoint.setAllGoals(e)}setSelectedGoals(e,t){this.perform((()=>{this.dataPoint.setSelectedGoals(e,t)}))}}class BT extends jT{triggerSynchronization(){}}class GT extends OT{}class qT extends GT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Xu.DONATION)}setAmountByDefault(e){this.perform((()=>{this.dataPoint.setAmountByDefault(e)}))}setAmount(e){this.perform((()=>{this.dataPoint.setAmount(e)}))}setCurrency(e){this.perform((()=>{this.dataPoint.setCurrency(e)}))}triggerSynchronization(){this.checkoutStateSynchronizer.onDonationChange()}}class VT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.MAILING_ADDRESS)}setLine1(e){this.perform((()=>{this.dataPoint.setLine1(e)}))}setLine2(e){this.perform((()=>{this.dataPoint.setLine2(e)}))}setCity(e){this.perform((()=>{this.dataPoint.setCity(e)}))}setRegion(e){this.perform((()=>{this.dataPoint.setRegion(e)}))}setPostal(e){this.perform((()=>{this.dataPoint.setPostal(e)}))}setSublocality(e){this.perform((()=>{this.dataPoint.setSublocality(e)}))}setAdministrativeArea(e){this.perform((()=>{this.dataPoint.setAdministrativeArea(e)}))}setCountryCode(e){this.perform((()=>{this.dataPoint.setCountryCode(e)}))}setCountryCodeIfEmptyAddress(e){this.perform((()=>{this.dataPoint.setCountryCodeIfEmptyAddress(e)}))}setCityIfEmpty(e){this.perform((()=>{this.dataPoint.setCityIfEmpty(e)}))}setLine1IfEmpty(e){this.perform((()=>{this.dataPoint.setLine1IfEmpty(e)}))}setLine2IfEmpty(e){this.perform((()=>{this.dataPoint.setLine2IfEmpty(e)}))}setRegionIfEmpty(e){this.perform((()=>{this.dataPoint.setRegionIfEmpty(e)}))}setPostalIfEmpty(e){this.perform((()=>{this.dataPoint.setPostalIfEmpty(e)}))}setSublocalityIfEmpty(e){this.perform((()=>{this.dataPoint.setSublocalityIfEmpty(e)}))}setAdministrativeAreaIfEmpty(e){this.perform((()=>{this.dataPoint.setAdministrativeAreaIfEmpty(e)}))}setSkipped(e){this.perform((()=>{this.dataPoint.setSkipped(e)}))}}class HT extends VT{triggerSynchronization(){}}class KT extends OT{get donorNameDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DONOR_NAME)}get customerTitleDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.CUSTOMER_TITLE)}get donorEmailDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DONOR_EMAIL)}get phoneNumberDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.PHONE_NUMBER)}get onBehalfOfDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.ON_BEHALF_OF)}get donateAnonymousDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DONATE_ANONYMOUS)}get termsAndConditionsDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.TERMS_AND_CONDITIONS)}setDonorFirstName(e){this.perform((()=>{this.donorNameDataPoint.setFirstName(e)}))}setDonorFirstNameIfEmpty(e){this.perform((()=>{this.donorNameDataPoint.setFirstNameIfEmpty(e)}))}setDonorLastName(e){this.perform((()=>{this.donorNameDataPoint.setLastName(e)}))}setDonorLastNameIfEmpty(e){this.perform((()=>{this.donorNameDataPoint.setLastNameIfEmpty(e)}))}setDonorFullName(e){this.perform((()=>{this.donorNameDataPoint.setFullName(e)}))}setDonorFullNameIfEmpty(e){this.perform((()=>{this.donorNameDataPoint.setFullNameIfEmpty(e)}))}setDonorTitle(e){this.perform((()=>{this.customerTitleDataPoint.setTitle(e)}))}setDonorEmail(e){this.perform((()=>{this.donorEmailDataPoint.setEmail(e)}))}setDonorEmailIfEmpty(e){this.perform((()=>{this.donorEmailDataPoint.setEmailIfEmpty(e)}))}setOnBehalfOfActive(e){this.perform((()=>{this.onBehalfOfDataPoint.setIsActive(e)}))}setOnBehalfOfCompanyName(e){this.perform((()=>{this.onBehalfOfDataPoint.setCompanyName(e)}))}setPhoneNumber(e){this.perform((()=>{this.phoneNumberDataPoint.setPhone(e)}))}setPhoneNumberIfEmpty(e){this.perform((()=>{this.phoneNumberDataPoint.setPhoneIfEmpty(e)}))}setPhoneCountryCode(e){this.perform((()=>{this.phoneNumberDataPoint.setCountryCode(e)}))}setPhoneCountryCodeIfEmptyPhone(e){this.perform((()=>{this.phoneNumberDataPoint.setCountryCodeIfEmptyPhone(e)}))}setPhoneCleanNumber(e){this.perform((()=>{this.phoneNumberDataPoint.setCleanPhone(e)}))}setDonateAnonymousChecked(e){this.perform((()=>{this.donateAnonymousDataPoint.setAnonymousChecked(e)}))}setTermsAndConditionsAccepted(e){this.perform((()=>{this.termsAndConditionsDataPoint.setAccepted(e)}))}}class YT extends KT{triggerSynchronization(){}}class zT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.PROCESS)}setInProgress(){this.perform((()=>{this.dataPoint.setInProgress()}))}setCompleted(e){this.perform((()=>{this.dataPoint.setCompleted(e)}))}setError(e){this.perform((()=>{this.dataPoint.setError(e)}))}setVoiceFlow(e){this.perform((()=>{this.dataPoint.setVoiceFlow(e)}))}}class WT extends zT{triggerSynchronization(){}}class $T extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.QUESTIONS)}setAnswer(e,t){this.perform((()=>{this.dataPoint.setAnswer(e,t)}))}}class XT extends $T{triggerSynchronization(){}}class QT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.REMIND_ME_LATER)}setState(e){this.perform((()=>{this.dataPoint.setState(e)}))}}class ZT extends QT{triggerSynchronization(){}}class JT extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(Wl.TRIBUTE)}setActive(e){this.perform((()=>{this.dataPoint.setActive(e)}))}setOriented(e){this.perform((()=>{this.dataPoint.setOriented(e)}))}setTributeeName(e){this.perform((()=>{this.dataPoint.setTributeeName(e)}))}}class ek extends JT{triggerSynchronization(){}}var tk,nk=n(2036);!function(e){e.DONATION="FiatDonation",e.GIFT_AID="GiftAid",e.PAYMENT_OPTIONS="PaymentOptions",e.PRE_DONATION_UPSELL="PreDonationUpsell",e.UK_BACS="UKBacs",e.US_BANK_ACCOUNT="USBankAccount",e.POST_DONATION_UPSELL="PostDonationUpsell",e.DTD="DTD",e.BENEFITS="Benefits"}(tk||(tk={}));class ik{constructor(e){this.sessionAPI=e}validate(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.sessionAPI.post("mailingAddress",Object.assign({},e),{rejectsOnInvalid:!0});return wn.isSuccess(t)?t.successResult:{valid:!1,validated:!0}}))}}class sk{constructor(e){this.checkoutConfiguration=e}getDTO(){return{}}getValidationResult(){return{isValid:!0}}}class ak extends sk{}const ok=1e7;class rk extends ak{constructor(e,t,n){super(e),this.checkoutConfiguration=e,this.currencyService=t,this.suggestionsService=n,this._currency="BTC",this._defaultCurrency="BTC",this._amount=0,this._defaultAmountInFiat=0,this._isAmountEditable=!0,this._isCurrencyEditable=!0,this.currencyList.includes(this.currency)||(this._currency=this.currencyList[0],this._defaultCurrency=this.currencyList[0]),this.setAmountByDefault(this.defaultCurrency)}get currency(){return this._currency}get defaultCurrency(){return this._defaultCurrency}get amount(){return this._amount}get defaultAmountInFiat(){return this._defaultAmountInFiat}get isAmountEditable(){return this._isAmountEditable}get isCurrencyEditable(){return this._isCurrencyEditable}get frequency(){return qn.ONCE}get minAmount(){return 100}get maxAmount(){return 1e8}get defaultAmount(){return 5e5}get total(){return this.amount||0}get amountInUSD(){return this.amount?this.currencyService.convert(this.amount,this.currency,"USD"):null}get totalInUSD(){return this.currencyService.convert(this.total,this.currency,"USD")}get defaultFiatCurrency(){return this.checkoutConfiguration.campaign.config.defaultCurrency}get amountInDefaultFiat(){return this.currencyService.convert(this.amount||0,this.currency,this.defaultFiatCurrency)}get totalInDefaultCurrency(){return this.total}get currencyNetworkData(){return this.currencyService.getCryptoCurrency(this.currency)}get currencyList(){const e=this.checkoutConfiguration.company.cryptoProvider;return e?this.currencyService.getCurrencyCodesBySource(e):["BTC"]}get isMultipleDonations(){return!1}get availableDonationItemsDto(){return[]}get processingFees(){return{}}getDefaultAmountsInCurrency(){return this.total}getValidationResult(){const e=null!==this.amount,t=!e||this.validateMinAmount(),n=!e||this.validateMaxAmount(),i={isValid:e&&t&&n,errors:{min:!t,max:!n,required:!e}};return{isValid:i.isValid,fields:{amount:i}}}getDTO(){return{amount:this.amount||0,total:this.amount||0,currency:this.currency,frequency:this.frequency}}setAmountByDefault(e){this._amount=this.getDefaultAmountInCurrency(e),this._defaultAmountInFiat=this.amountInDefaultFiat}getDefaultAmountInCurrency(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currency;const t=this.currencyService.convert(this.defaultAmount,"USD",e),n=this.currencyService.toFloat(t,e),i=this.getAmountByDefaultMultiplier(n);return this.beautify(t*i,e)/i}getDefaultTotalInCurrency(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currency;return this.getDefaultAmountInCurrency(e)}setAmount(e){this._amount=e}setCurrency(e){this._currency=e}validateMinAmount(){return!!this.amountInUSD&&this.amountInUSD>=this.minAmount}validateMaxAmount(){return!this.amountInUSD||this.amountInUSD<=this.maxAmount}getAmountByDefaultMultiplier(e){let t=1;return e<10?t=this.getBaseMultiplier(e):e>ok&&(t=this.getBaseMultiplier(e/ok,0)),t}getBaseMultiplier(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=-Math.floor(Math.log10(e));return Math.pow(10,n+t)}beautify(e,t){return this.suggestionsService.beautify(e,t)}}class lk{constructor(e){var t;this.amount=e.amount,this.amountHint=e.amountHint,this.isEndDateActiveValue=null===(t=e.isEndDateActive)||void 0===t||t}getAmount(){return this.amount}getAmountHint(){return this.amountHint}isEndDateActive(){return this.isEndDateActiveValue}getDto(){return{amount:this.amount,amountHint:this.amountHint,isEndDateActive:this.isEndDateActiveValue}}setAmount(e){this.amount=e}setAmountHint(e){this.amountHint=e}setEndDateActive(e){this.isEndDateActiveValue=e}}class ck{constructor(e){this.donationItemFrequenciesMap=new Map,this.id=ZD(),Object.entries(e.frequencies).forEach((e=>{let[t,n]=e;this.donationItemFrequenciesMap.set(t,new lk(n))})),this.frequency=e.defaultFrequency}getId(){return this.id}getFrequency(){return this.frequency}getAmount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.frequency;return this.getDonationItemFrequency(e).getAmount()}getAmountHint(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.frequency;return this.getDonationItemFrequency(e).getAmountHint()}isEndDateActive(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.frequency;return this.getDonationItemFrequency(e).isEndDateActive()}getDto(){const e={};return this.donationItemFrequenciesMap.forEach(((t,n)=>{e[n]=t.getDto()})),{id:this.getId(),amount:this.getAmount(),amountHint:this.getAmountHint(),isEndDateActive:this.isEndDateActive(),frequency:this.getFrequency(),frequencies:e}}setFrequency(e){this.frequency=e}setAmount(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.frequency;this.getDonationItemFrequency(t).setAmount(e)}setAmountHint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.frequency;this.getDonationItemFrequency(t).setAmountHint(e)}setEndDateActive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.frequency;this.getDonationItemFrequency(t).setEndDateActive(e)}getDonationItemFrequency(e){const t=this.donationItemFrequenciesMap.get(e);if(!t)throw new Error(`Donation item frequency not found for frequency: ${e}`);return t}}class uk{constructor(e){this.frequency=e.frequency,this.config=e.config,this.strategies=e.strategies,this.defaultAmount=this.getInitialDefaultAmount(e.initialCurrency)}getDefaultAmount(){return this.defaultAmount}setDefaultAmount(e){this.defaultAmount=e}convertAmount(e,t,n){return this.strategies.default.calculate(e,t,n)}handleCurrencyChange(e,t){this.defaultAmount=this.strategies.default.calculate(this.defaultAmount,e,t)}getInitialDefaultAmount(e){return this.getInitialStrategy().calculate(this.config.frequencies[this.frequency].defaultAmount,this.config.defaultCurrency,e)}getInitialStrategy(){return this.config.ai.isEnabled?this.config.ai.shouldDisableAmountAI?this.strategies.default:this.strategies.ai:this.strategies.default}}function dk(e,t){return t*(1+e/100)}function hk(e,t){let n=[e/4,e/3,e/2,e,1.3*e];return 3===t.length&&(n=[e/2,e]),t=t.sort(((e,t)=>e-t)),n.forEach(((e,n)=>{const i=n+1;t[i]<5e4&&(t[i]=t[i]*(1+e/100))})),t=t.sort(((e,t)=>t-e))}function mk(e,t){return t===ra.ASC?e.sort(((e,t)=>e-t)):t===ra.DESC?e.sort(((e,t)=>t-e)):e}class pk{constructor(e){this.config=e.config,this.frequencyMinimalAmount=e.frequencyMinimalAmount,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService,this.trend=e.config.ai.trend[e.frequency]}calculate(e,t,n){if(null===e)return e;if(this.shouldUseNullAmount())return null;const i=this.calculateConvertedAmount(e,t,n),s=this.calculateAIAmount(i,n);return this.calculateBeautifiedAmount(s,n)}shouldUseNullAmount(){return!1===this.config.ai.companyExperiments.settings.hasDefault&&!0!==this.config.ai.companyExperiments.shouldDisableHasDefault}calculateConvertedAmount(e,t,n){return this.currencyService.convert(e,t,n,!0,this.config.ai.userCountryCode)}calculateAIAmount(e,t){return this.trend?this.calculateAIAmountByTrend(e,t):this.calculateAIAmountByXFactor(e)}calculateAIAmountByTrend(e,t){const n=this.currencyService.convert(this.trend,this.config.defaultCurrency,t),i=this.calculateMinimalAIAmountByTrend(e);return Math.max(n,i)}calculateMinimalAIAmountByTrend(e){return e-e/pk.AMOUNT_DECREASE_PERCENTAGE_THRESHOLD}calculateAIAmountByXFactor(e){return dk(this.config.ai.xFactor,e)}calculateBeautifiedAmount(e,t){return this.suggestionsService.beautify(e,t,this.frequencyMinimalAmount.getMinimalAmount())}}pk.AMOUNT_DECREASE_PERCENTAGE_THRESHOLD=10;class gk{constructor(e){this.frequencyMinimalAmount=e.frequencyMinimalAmount,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService}calculate(e,t,n){if(null===e)return e;if(t===n)return e;const i=this.currencyService.convert(e,t,n);return this.suggestionsService.beautify(i,n,this.frequencyMinimalAmount.getMinimalAmount())}}class yk{constructor(e){this.config=e.config,this.frequencyAmountHintsSelector=e.frequencyAmountHintsSelector,this.frequencyMinimalAmount=e.frequencyMinimalAmount,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService,this.amountHintsInDefaultCurrency=this.frequencyAmountHintsSelector.getSelectedAmountHints(),this.amountHints=this.calculate(e.initialCurrency)}getAmountHints(){return this.amountHints}getDefaultAmountHint(){var e,t;return null!==(t=null===(e=this.amountHints)||void 0===e?void 0:e.find((e=>e.default)))&&void 0!==t?t:null}setAmountHints(e,t){this.frequencyAmountHintsSelector.setSelectedAmountHints(e),this.amountHintsInDefaultCurrency=this.frequencyAmountHintsSelector.getSelectedAmountHints(),this.amountHints=this.calculate(t)}setDefaultAmountHint(e,t){this.frequencyAmountHintsSelector.setDefaultAmountHint(e),this.amountHintsInDefaultCurrency=this.frequencyAmountHintsSelector.getSelectedAmountHints(),this.amountHints=this.calculate(t)}handleCurrencyChange(e){this.amountHints=this.calculate(e)}calculate(e){if(!this.amountHintsInDefaultCurrency)return null;if(this.config.defaultCurrency===e)return this.amountHintsInDefaultCurrency;const t=this.frequencyMinimalAmount.getMinimalAmount(),n=this.amountHintsInDefaultCurrency.map((e=>e.amount)).map((t=>this.currencyService.convert(t,this.config.defaultCurrency,e))),i=this.suggestionsService.beautify(n,e,t);return this.amountHintsInDefaultCurrency.map(((e,t)=>Object.assign(Object.assign({},e),{amount:i[t]})))}}class fk{calculateSelectedAmountHintsIds(e,t){if(e.length<6)throw new Error("Hints count is less than 6");const n=e.filter((e=>t.includes(e.id))),i=e.filter((e=>!t.includes(e.id)));for(;n.length<3;){const e=Math.floor(Math.random()*i.length);n.push(i[e]),i.splice(e,1)}return n.sort(((e,t)=>e.amount-t.amount)).slice(0,3).map((e=>e.id))}calculateDefaultAmountHintId(e,t){return t[Math.floor(Math.random()*t.length)]}}class vk{calculateSelectedAmountHintsIds(e){const t=e.filter((e=>e.active));if(t.length<3)throw new Error("Active hints count is less than 3");return t.sort(((e,t)=>e.amount-t.amount)).slice(0,3).map((e=>e.id))}calculateDefaultAmountHintId(e,t){var n;const i=e.filter((e=>t.includes(e.id))).find((e=>e.default));return null!==(n=null==i?void 0:i.id)&&void 0!==n?n:t[0]}}class Sk{constructor(e){this.frequency=e.frequency,this.config=e.config,this.currencyService=e.currencyService,this.selectionStrategies=e.strategies,this.availableAmountHints=this.calculateAvailableAmountHints(),this.selectionStrategy=this.calculateSelectionStrategy(),this.selectedAmountHintsIds=this.calculateSelectedAmountHintsIds(),this.defaultAmountHintId=this.calculateDefaultAmountHintId()}getSelectedAmountHints(){if(!this.availableAmountHints||!this.selectedAmountHintsIds)return null;const e=[];for(const t of this.selectedAmountHintsIds){const n=this.availableAmountHints.find((e=>e.id===t));n&&e.push(Object.assign(Object.assign({},n),{default:n.id===this.defaultAmountHintId}))}return e}setSelectedAmountHints(e){if(!this.availableAmountHints)return;const t=e.filter((e=>{var t;return null===(t=this.availableAmountHints)||void 0===t?void 0:t.some((t=>t.id===e))}));this.selectedAmountHintsIds=this.calculateSelectedAmountHintsIds(t),this.defaultAmountHintId=this.calculateDefaultAmountHintId()}setDefaultAmountHint(e){this.availableAmountHints&&this.selectedAmountHintsIds&&this.selectedAmountHintsIds.some((t=>t===e))&&(this.defaultAmountHintId=e)}calculateAvailableAmountHints(){const e=this.config.frequencies[this.frequency];if(!e.hintsEnabled)return null;const t=e.suggestedAmountHints;return t&&t.length?t.map(((e,n)=>{const i=function({index:e,frequency:t,enabledAI:n,lastAmount:i}){const s=t===qn.ONCE,a=n?s?Oi:_i:s?Ii:ki,o=a.length;return o>=e+1?a[e]:i?(r=i+xi)%xi==0?r:Math.ceil(r/xi)*xi:a[o-1]+(e+1-o)*xi;var r}({index:n,frequency:this.frequency,enabledAI:this.config.ai.isEnabled,lastAmount:t[t.length-1].amount}),s=e.amount||i,a=this.currencyService.convert(s,this.config.defaultCurrency,"USD");return Object.assign(Object.assign({},e),{amount:s,amountUsd:a})})):null}calculateSelectionStrategy(){return this.config.ai.isEnabled?this.selectionStrategies.ai:this.selectionStrategies.default}calculateSelectedAmountHintsIds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.availableAmountHints?this.selectionStrategy.calculateSelectedAmountHintsIds(this.availableAmountHints,e):null}calculateDefaultAmountHintId(){return this.availableAmountHints&&this.selectedAmountHintsIds?this.selectionStrategy.calculateDefaultAmountHintId(this.availableAmountHints,this.selectedAmountHintsIds):null}}class Ek{constructor(e){this.frequency=e.frequency,this.config=e.config,this.strategies=e.strategies,this.strategy=this.getInitialStrategy(),this.amountSuggestionsInDefaultCurrency=this.getInitialAmountSuggestionsInDefaultCurrency(),this.amountSuggestions=this.calculate(e.initialCurrency)}getAmountSuggestions(){return this.amountSuggestions}getAmountSuggestionsInDefaultCurrency(){return this.amountSuggestionsInDefaultCurrency}setAmountSuggestions(e,t,n){n&&(this.strategy=this.strategies.default),this.amountSuggestionsInDefaultCurrency=e,this.amountSuggestions=t}handleCurrencyChange(e){this.amountSuggestions=this.calculate(e)}getInitialStrategy(){return this.config.ai.isEnabled?this.config.ai.shouldDisableSuggestionsAI?this.strategies.default:this.strategies.ai:this.strategies.default}getInitialAmountSuggestionsInDefaultCurrency(){const e=this.config.frequencies[this.frequency].amountOptions;return Ni[this.frequency].map(((t,n)=>e[n]||t))}calculate(e){return this.strategy.calculate(this.amountSuggestionsInDefaultCurrency,e)}}class Ak{constructor(e){this.config=e.config,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService,this.frequencyMinimalAmount=e.frequencyMinimalAmount}calculate(e,t){let n=[...e];const i=this.frequencyMinimalAmount.getMinimalAmount();return n=this.convertAmountsToCurrency(n,t),n=hk(this.config.ai.xFactor,n),n=this.applyMultiplierAndMinimalAmount(n,i),n=this.suggestionsService.beautify(n,t,i),n=this.applyAscSort(n),n}get shouldApplySuggestionsMultiplier(){return!this.config.ai.companyExperiments.shouldDisableMultiplySuggestions&&Boolean(this.config.ai.companyExperiments.settings.multiplySuggestions)}get shouldApplyAscSort(){return!this.config.ai.companyExperiments.shouldDisableAscSort&&Boolean(this.config.ai.companyExperiments.settings.ascSort)}convertAmountsToCurrency(e,t){return this.config.defaultCurrency===t?e:e.map((e=>this.currencyService.convert(e,this.config.defaultCurrency,t,!0,this.config.ai.userCountryCode)))}applyMultiplierAndMinimalAmount(e,t){return e.map((e=>{let n=e;return this.shouldApplySuggestionsMultiplier&&(n=e*Ak.SUGGESTIONS_MULTIPLIER),Math.max(n,t)}))}applyAscSort(e){return mk([...e],this.shouldApplyAscSort?ra.ASC:ra.DESC)}}Ak.SUGGESTIONS_MULTIPLIER=1.4;class Ck{constructor(e){this.config=e.config,this.frequencyMinimalAmount=e.frequencyMinimalAmount,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService}calculate(e,t){if(this.config.defaultCurrency===t)return e;const n=e.map((e=>this.currencyService.convert(e,this.config.defaultCurrency,t,!1)));return this.suggestionsService.beautify(n,t,this.minimalAmount)}get minimalAmount(){return this.frequencyMinimalAmount.getMinimalAmount()}}function bk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=new Date(e),n=new Date(Date.parse(t.toISOString())+1e3*t.getTimezoneOffset()*60);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)}class Pk{constructor(e){const t=bk(),n=e.config.frequencies[e.frequency].endDate;this.endDate=n?bk(n):null,this.hasEndDate=e.config.frequencies[e.frequency].hasEndDate,this.shouldShow=this.hasEndDate&&!!this.endDate&&this.endDate>=t}}class Nk{constructor(e){this.frequency=e.frequency,this.config=e.config,this.currencyService=e.currencyService,this.minimalAmountInDefaultCurrency=this.getMinimalAmountInDefaultCurrency(),this.minimalAmount=this.calculate(e.initialCurrency)}getMinimalAmount(){return this.minimalAmount}handleCurrencyChange(e){this.minimalAmount=this.calculate(e)}getMinimalAmountInDefaultCurrency(){var e;return Math.max(null!==(e=this.config.frequencies[this.frequency].minAmount)&&void 0!==e?e:0,this.currencyService.getMinAmount(this.config.defaultCurrency))}calculate(e){const t=this.currencyService.convert(this.minimalAmountInDefaultCurrency,this.config.defaultCurrency,e);return this.currencyService.ceil(t,e)}}class Dk{constructor(e){this.frequencyServicesMap=new Map,this.donationItemsMap=new Map,this.config=e.config,this.initializeFrequencyServices(e),this.initializeDonationItems()}get isMultipleDonationItems(){return this.donationItemsMap.size>1}getDonationItems(){return[...this.donationItemsMap.values()].map((e=>e.getDto()))}getDonationItemsAmount(){let e=0,t=!1;for(const n of this.donationItemsMap.values()){const i=n.getAmount();"number"==typeof i&&(t=!0),e+=null!=i?i:0}return t?e:null}setDonationItemFrequency(e,t){this.getDonationItem(e).setFrequency(t)}setDonationItemAmount(e,t,n){const i=this.getDonationItem(e);i.setAmount(t,n),i.setAmountHint(null,n)}setDonationItemAmountHint(e,t,n,i){const s=this.getDonationItem(e);s.setAmountHint(t,n),void 0!==i&&s.setAmount(i,n)}setDonationItemEndDateActive(e,t,n){this.getDonationItem(e).setEndDateActive(t,n)}addDonationItem(){const e=this.createDonationItem(),t=e.getId();return this.donationItemsMap.set(t,e),t}removeDonationItem(e){this.donationItemsMap.delete(e)}getFrequencyMinimalAmount(e){const{frequencyMinimalAmount:t}=this.getFrequencyServices(e);return t.getMinimalAmount()}getFrequencyDefaultAmount(e){const{frequencyAmount:t}=this.getFrequencyServices(e);return t.getDefaultAmount()}getFrequencyAmountSuggestions(e){const{frequencyAmountSuggestions:t}=this.getFrequencyServices(e);return t.getAmountSuggestions()}getFrequencyAmountSuggestionsInDefaultCurrency(e){const{frequencyAmountSuggestions:t}=this.getFrequencyServices(e);return t.getAmountSuggestionsInDefaultCurrency()}getFrequencyAmountHints(e){const{frequencyAmountHints:t}=this.getFrequencyServices(e);return t.getAmountHints()}getFrequencyEndDate(e){const{frequencyEndDate:t}=this.getFrequencyServices(e);return t}setFrequencyDefaultAmount(e,t){const{frequencyAmount:n}=this.getFrequencyServices(e);n.setDefaultAmount(t)}setFrequencyAmountSuggestions(e,t,n,i){const{frequencyAmountSuggestions:s}=this.getFrequencyServices(e);s.setAmountSuggestions(t,n,i)}setFrequencyAmountHints(e,t,n){const{frequencyAmountHints:i}=this.getFrequencyServices(e);i.setAmountHints(t,n)}setFrequencyDefaultAmountHint(e,t,n){const{frequencyAmountHints:i}=this.getFrequencyServices(e);i.setDefaultAmountHint(t,n)}handleCurrencyChange(e,t){this.handleFrequencyServicesCurrencyChange(e,t),this.handleDonationItemsCurrencyChange(e,t)}initializeFrequencyServices(e){Object.values(qn).forEach((t=>{const n=(e=>{const t=(e=>new Nk({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,currencyService:e.currencyService}))({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,currencyService:e.currencyService}),n=(e=>{const t=new gk({frequencyMinimalAmount:e.frequencyMinimalAmount,currencyService:e.currencyService,suggestionsService:e.suggestionsService}),n=new pk({frequency:e.frequency,config:e.config,frequencyMinimalAmount:e.frequencyMinimalAmount,currencyService:e.currencyService,suggestionsService:e.suggestionsService});return new uk({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,strategies:{default:t,ai:n}})})({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,frequencyMinimalAmount:t,currencyService:e.currencyService,suggestionsService:e.suggestionsService}),i=(e=>{const t=new Ck({config:e.config,frequencyMinimalAmount:e.frequencyMinimalAmount,currencyService:e.currencyService,suggestionsService:e.suggestionsService}),n=new Ak({config:e.config,frequencyMinimalAmount:e.frequencyMinimalAmount,currencyService:e.currencyService,suggestionsService:e.suggestionsService});return new Ek({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,strategies:{default:t,ai:n}})})({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,frequencyMinimalAmount:t,currencyService:e.currencyService,suggestionsService:e.suggestionsService}),s=(e=>{const t=new vk,n=new fk,i=new Sk({frequency:e.frequency,config:e.config,currencyService:e.currencyService,strategies:{default:t,ai:n}});return new yk({initialCurrency:e.initialCurrency,config:e.config,frequencyAmountHintsSelector:i,frequencyMinimalAmount:e.frequencyMinimalAmount,currencyService:e.currencyService,suggestionsService:e.suggestionsService})})({frequency:e.frequency,initialCurrency:e.initialCurrency,config:e.config,frequencyMinimalAmount:t,currencyService:e.currencyService,suggestionsService:e.suggestionsService}),a=(e=>new Pk({frequency:e.frequency,config:e.config}))({frequency:e.frequency,config:e.config});return{frequencyMinimalAmount:t,frequencyAmount:n,frequencyAmountSuggestions:i,frequencyAmountHints:s,frequencyEndDate:a}})({frequency:t,initialCurrency:e.initialCurrency,config:e.config,currencyService:e.currencyService,suggestionsService:e.suggestionsService});this.frequencyServicesMap.set(t,n)}))}handleFrequencyServicesCurrencyChange(e,t){Object.values(qn).forEach((n=>{const{frequencyMinimalAmount:i,frequencyAmount:s,frequencyAmountSuggestions:a,frequencyAmountHints:o}=this.getFrequencyServices(n);i.handleCurrencyChange(t),s.handleCurrencyChange(e,t),a.handleCurrencyChange(t),o.handleCurrencyChange(t)}))}initializeDonationItems(){const e=this.createDonationItem(),t=e.getId();this.donationItemsMap.set(t,e)}createDonationItem(){const e={},t=this.donationItemsMap.size>0;return Object.values(qn).forEach((n=>{var i;const{frequencyAmount:s,frequencyAmountHints:a}=this.getFrequencyServices(n),o=s.getDefaultAmount(),r=a.getDefaultAmountHint(),l=t?null:null!==(i=null==r?void 0:r.amount)&&void 0!==i?i:o;e[n]={amount:l,amountHint:r,isEndDateActive:!0}})),new ck({defaultFrequency:this.getDefaultFrequency(),frequencies:e})}handleDonationItemsCurrencyChange(e,t){this.donationItemsMap.forEach((n=>{Object.values(qn).forEach((i=>{var s,a;const{frequencyAmount:o,frequencyAmountHints:r}=this.getFrequencyServices(i),l=r.getAmountHints(),c=n.getAmount(i),u=n.getAmountHint(i),d=o.convertAmount(c,e,t),h=null!==(s=null==l?void 0:l.find((e=>e.id===(null==u?void 0:u.id))))&&void 0!==s?s:null;n.setAmount(null!==(a=null==h?void 0:h.amount)&&void 0!==a?a:d,i),n.setAmountHint(h,i)}))}))}getFrequencyServices(e){const t=this.frequencyServicesMap.get(e);if(!t)throw new Error(`Frequency services are not found for frequency: ${e}`);return t}getDonationItem(e){const t=this.donationItemsMap.get(e);if(!t)throw new Error(`Donation item is not found for id: ${e}`);return t}getDefaultFrequency(){const e=Object.values(qn).find((e=>this.config.frequencies[e].default));if(!e)throw new Error("Default frequency is not found");return e}}class Tk extends ak{static get defaultValidationResult(){return{isValid:!0,fields:{amount:{isValid:!0,errors:{required:!1,min:!1,max:!1}},donationItems:{isValid:!0,items:[]}}}}constructor(e,t,n,i,s){super(e),this.checkoutConfiguration=e,this.currencyService=t,this.transactionCosts=s,this.donationItemsAvailability=new Map,this.distributionWeights=[],this.feeCoveringSuggestionSnapshot=sC.ONLY_NO,this.donationCurrency=ji({checkoutConfiguration:e}),this.donationItems=function(e){var t;const{initialCurrency:n,checkoutConfiguration:i,currencyService:s,suggestionsService:a,userSession:o}=e,r=i.campaign.config.experimentsSettings[i.infrastructureParams.isMobile?Is.MOBILE:Is.DESKTOP];return new Dk({initialCurrency:n,config:{frequencies:Ys(i.campaign.config).frequencies,defaultCurrency:i.campaign.config.defaultCurrency,ai:{isEnabled:i.campaign.config.enableAI&&!i.infrastructureParams.showcase,shouldDisableAmountAI:i.hasExternalAmount,trend:i.campaign.config.trend,xFactor:vs(o,i.infrastructureParams.isMobile),userCountryCode:null!==(t=i.user.address.countryCode)&&void 0!==t?t:sn.UNITED_STATES,companyExperiments:{settings:r,shouldDisableMultiplySuggestions:i.isLauncher}}},currencyService:s,suggestionsService:a})}({initialCurrency:this.donationCurrency.getCurrency(),checkoutConfiguration:e,currencyService:t,suggestionsService:n,userSession:i}),this.synchronizeFee()}get amount(){let e=0,t=!1;for(const n of this.availableDonationItemsDto){const i=n.amount;"number"==typeof i&&(t=!0),e+=null!=i?i:0}return t?e:null}get totalInUSD(){return this.currencyService.convert(this.total,this.currency,"USD")}get totalInDefaultCurrency(){return this.currencyService.convert(this.total,this.currency,this.checkoutConfiguration.defaultCurrency)}get fee(){return this.transactionCosts.getFee(this.availableDonationItemsDto,this.currency)}get fees(){return this.transactionCosts.getFees(this.availableDonationItemsDto,this.currency)}get processingFee(){return this.transactionCosts.getProcessingFee(this.availableDonationItemsDto,this.currency)}get processingFees(){return this.transactionCosts.getProcessingFees(this.availableDonationItemsDto,this.currency)}get feeCoveringSuggestion(){return this.feeCoveringSuggestionSnapshot}get frequency(){return this.getInitialDonationItem().frequency}get currency(){return this.donationCurrency.getCurrency()}get allDefaultAmounts(){const e={};return Object.values(qn).forEach((t=>{e[t]=this.donationItems.getFrequencyDefaultAmount(t)})),e}get allAmountSuggestions(){const e={};return Object.values(qn).forEach((t=>{e[t]=this.donationItems.getFrequencyAmountSuggestions(t)})),e}get allAmountHints(){const e={};return Object.values(qn).forEach((t=>{e[t]=this.donationItems.getFrequencyAmountHints(t)})),e}get amountHint(){const e=this.getInitialDonationItem().frequencies[this.frequency].amountHint;return e?Object.assign(Object.assign({},e),{default:!0}):null}get maxAmount(){const e=(0,Na.Bm)(this.currency),t="9".repeat(e);return parseInt(t,10)}get total(){const e=this.checkoutConfiguration.infrastructureParams.showcase?1e4:0;return this.transactionCosts.getTotal(this.availableDonationItemsDto,this.currency)||this.transactionCosts.getTotalForAmount(e,this.currency)}get guessedCurrency(){return this.donationCurrency.getGuessedCurrency()}get isFeeCovered(){return this.transactionCosts.isCovered}get isCustomFeeCoveredValue(){return this.transactionCosts.isCustomCoveredValue}get amountInUSD(){return this.amount?this.currencyService.convert(this.amount,this.currency,"USD"):null}get includeFees(){return this.transactionCosts.includeFees}get isDonationEndDateActive(){return this.getInitialDonationItem().frequencies[this.frequency].isEndDateActive}get donationItemsDto(){return this.donationItems.getDonationItems()}get availableDonationItemsDto(){return this.donationItemsDto.filter((e=>{var t;return null===(t=this.donationItemsAvailability.get(e.id))||void 0===t||t}))}get maxDonationItems(){return 5}get isMultipleDonations(){return this.donationItems.isMultipleDonationItems}get getFullFee(){var e,t,n;return null!==(n=null===(t=(e=this.transactionCosts).getFullFee)||void 0===t?void 0:t.call(e,this.availableDonationItemsDto,this.currency))&&void 0!==n?n:0}get partialFee(){var e,t,n;return null!==(n=null===(t=(e=this.transactionCosts).getPartialFee)||void 0===t?void 0:t.call(e,this.availableDonationItemsDto,this.currency))&&void 0!==n?n:0}get coverageLevel(){return this.isFeeCovered?this.transactionCosts.coverageLevel?this.transactionCosts.coverageLevel:fN.FULL:fN.NONE}getFrequencyDefaultAmount(e){return this.donationItems.getFrequencyDefaultAmount(e)}getFrequencyDefaultTotal(e){const t=this.getFrequencyDefaultAmount(e);return this.transactionCosts.getTotalForAmount(null!=t?t:0,this.currency)}getFrequencyAmountSuggestions(e){return this.donationItems.getFrequencyAmountSuggestions(e)}getFrequencyAmountSuggestionsInDefaultCurrency(e){return this.donationItems.getFrequencyAmountSuggestionsInDefaultCurrency(e)}getFrequencyMinimalAmount(e){return this.donationItems.getFrequencyMinimalAmount(e)}getFrequencyMinimalTotal(e){const t=this.getFrequencyMinimalAmount(e);return this.transactionCosts.getTotalForAmount(t,this.currency)}getFrequencyAmountHints(e){const t=this.donationItems.getFrequencyAmountHints(e);return t?t.map((e=>{var t;return Object.assign(Object.assign({},e),{default:(null===(t=this.amountHint)||void 0===t?void 0:t.id)===e.id})})):null}getFrequencyDonationEndDate(e){return this.donationItems.getFrequencyEndDate(e)}addDonation(){var e;const t=this.donationItems.addDonationItem(),n=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation;this.donationItems.setDonationItemFrequency(t,this.frequency);const i=this.getFrequencyDefaultAmount(this.frequency),s=void 0!==(null==n?void 0:n.amount)&&null!==n.amount;this.checkoutConfiguration.canModifyAmount&&!this.checkoutConfiguration.forceAllowModifyAmount&&!s||(this.donationItems.setDonationItemAmount(t,i,this.frequency),this.setCurrentDistributionWeights())}removeDonation(e){this.donationItems.removeDonationItem(e),this.setCurrentDistributionWeights()}setDonationsAmount(e){if(this.donationItems.isMultipleDonationItems)this.setDistributedByWeightsAmounts(e);else{const t=this.getInitialDonationItem();this.setDonationAmountByFrequency(t.id,e)}this.synchronizeFee()}setDonationsAmountHint(e){if(this.setDefaultAmountsApplied(),this.donationItems.isMultipleDonationItems){this.setDistributedByWeightsAmounts(e.amount);for(const t of this.donationItems.getDonationItems())this.donationItems.setDonationItemAmountHint(t.id,e,t.frequency)}else{const t=this.getInitialDonationItem();this.donationItems.setDonationItemAmountHint(t.id,e,this.frequency,e.amount)}this.synchronizeFee()}setDonationsFrequency(e){for(const t of this.donationItems.getDonationItems())this.donationItems.setDonationItemFrequency(t.id,e);!this.isCurrencyEditableForFrequency(e)&&this.setCurrency(this.checkoutConfiguration.defaultCurrency),this.synchronizeFee()}setCurrency(e){const t=this.currency,n=this.getFrequencyDefaultAmount(this.frequency),i=this.amount,s=this.amountHint;this.donationCurrency.setCurrency(e),this.donationItems.handleCurrencyChange(t,e),(this.donationItems.isMultipleDonationItems||n!==i&&!s)&&this.setDonationsAmount(i),this.synchronizeFee()}setFeeCovered(e,t){this.transactionCosts.isCovered=e,void 0!==(null==t?void 0:t.isCustomFeeCoveredValue)&&(this.transactionCosts.isCustomCoveredValue=t.isCustomFeeCoveredValue),this.snapshotFeeCoveringSuggestion()}setFeeCoverageLevel(e,t){var n,i;null===(i=(n=this.transactionCosts).setFeeCoverageLevel)||void 0===i||i.call(n,e,t),this.snapshotFeeCoveringSuggestion()}setFrequencyDefaultAmount(e,t){const n=this.getInitialDonationItem();this.donationItems.setFrequencyDefaultAmount(e,t),this.donationItems.setDonationItemAmount(n.id,t,e),this.synchronizeFee()}setFrequencyAmountSuggestions(e,t,n,i){this.donationItems.setFrequencyAmountSuggestions(e,t,n,i)}setFrequencyAmountHints(e,t,n){this.donationItems.setFrequencyAmountHints(e,t,n)}setFrequencyAmountHint(e,t){const n=this.getInitialDonationItem();this.donationItems.setDonationItemAmountHint(n.id,t,e,t.amount),this.synchronizeFee()}setDonationsEndDateActive(e){for(const t of this.donationItems.getDonationItems())this.donationItems.setDonationItemEndDateActive(t.id,e)}setDonationAmount(e,t){this.setDonationAmountByFrequency(e,t),this.setCurrentDistributionWeights(),this.synchronizeFee()}getValidationResult(){const e=null!==this.amount,t=!e||this.validateMinAmount(),n=!e||this.validateMaxAmount(),i={isValid:t&&n&&e,errors:{min:!t,max:!n,required:!e}},s=this.validateDonationItems();return{isValid:i.isValid,fields:{amount:i,donationItems:s}}}snapshotFeeCoveringSuggestion(){this.isCustomFeeCoveredValue||(this.includeFees!==sC.ONLY_NO?this.includeFees!==sC.ONLY_YES?this.feeCoveringSuggestionSnapshot=this.isFeeCovered?sC.DEFAULT_YES:sC.DEFAULT_NO:this.feeCoveringSuggestionSnapshot=sC.ONLY_YES:this.feeCoveringSuggestionSnapshot=sC.ONLY_NO)}getDTO(){return{amount:this.amount||0,currency:this.currency,frequency:this.frequency,total:this.total}}setDefaultAmountsApplied(){for(const e of Object.values(qn))this.frequency!==e&&(this.getFrequencyAmountHints(e)?this.setDefaultAmountHintAppliedForFrequency(e):this.setDefaultAmountAppliedForFrequency(e))}synchronizeFee(){this.transactionCosts.calculateFeeAvailability({donations:this.donationItems.getDonationItems(),currency:this.currency}),this.isCustomFeeCoveredValue||this.includeFees!==sC.SMART_COVERING||this.transactionCosts.calculateSmartFeeCovering({amountInUSD:this.amountInUSD,frequency:this.frequency}),this.snapshotFeeCoveringSuggestion()}isCurrencyEditableForFrequency(e){const t=this.checkoutConfiguration.campaign.config;return e===qn.ONCE?t.currencyEnabled:t.currencyEnabled&&t.currencyEnabledRecurrings}setDonationItemsAvailability(e){this.donationItemsAvailability=e}setCurrentDistributionWeights(){this.distributionWeights=this.availableDonationItemsDto.map((e=>e.amount))}getInitialDonationItem(){const[e]=this.donationItems.getDonationItems();return e}validateMinAmount(){return this.validateDonationItemMinAmount(this.amount)}validateMaxAmount(){return this.validateDonationItemMaxAmount(this.amount)}validateDonationItems(){const e=this.availableDonationItemsDto.map((e=>this.validateDonationItem(e)));return{isValid:e.every((e=>e.isValid)),items:e}}validateDonationItem(e){const t=null!==e.amount,n=!t||this.validateDonationItemMinAmount(e.amount),i=!t||this.validateDonationItemMaxAmount(e.amount),s={isValid:n&&i&&t,errors:{min:!n,max:!i,required:!t}};return{isValid:s.isValid,amount:s}}validateDonationItemMinAmount(e){const t=this.getFrequencyMinimalAmount(this.frequency);return!!e&&e>=t}validateDonationItemMaxAmount(e){if(null===e)return!0;const{length:t}=e.toString();return t<=(0,Na.Bm)(this.currency)}setDefaultAmountAppliedForFrequency(e){const t=this.donationItems.getFrequencyDefaultAmount(e);for(const n of this.donationItems.getDonationItems())this.donationItems.setDonationItemAmount(n.id,t,e)}setDefaultAmountHintAppliedForFrequency(e){var t,n;const i=null!==(n=null===(t=this.donationItems.getFrequencyAmountHints(e))||void 0===t?void 0:t.find((e=>e.default)))&&void 0!==n?n:null;for(const t of this.donationItems.getDonationItems())this.donationItems.setDonationItemAmountHint(t.id,i,e,null==i?void 0:i.amount)}setDonationAmountByFrequency(e,t){const n=this.getFrequencyDefaultAmount(this.frequency)===t;for(const i of Object.values(qn)){const s=this.getFrequencyDefaultAmount(i);this.donationItems.setDonationItemAmount(e,n?s:t,i)}}setDistributedByWeightsAmounts(e){if(null===e){for(const e of this.availableDonationItemsDto)this.setDonationAmountByFrequency(e.id,null);return}const t=this.getPrecision(),n=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===t.length)return[];const i=Math.pow(10,n);e=Math.round(e*i),t=t.slice(0);let s=0;const a=[];for(let e=0;e<t.length;++e){const n=t[e];null!==n&&(s+=n,a.push(e))}if(0===s){0===a.length&&a.push(0),s=a.length;for(const e of a)t[e]=1}const o=[];let r=0;for(const n of t){if(null===n){o.push(null);continue}const t=Math.floor(n*e/s);r+=t,o.push(t)}const l=Math.floor(e-r);for(let e=0;e<l;++e){const t=a[e];o[t]=o[t]+1}for(let e=0;e<o.length;++e){const t=o[e];null!==t&&(o[e]=t/i)}return o}(e,this.distributionWeights,t);for(let e=0;e<this.availableDonationItemsDto.length;++e)this.setDonationAmountByFrequency(this.availableDonationItemsDto[e].id,n[e])}getPrecision(){return this.checkoutConfiguration.company.allowCentsForCharges?0:-1*this.currencyService.getDigits(this.currency)}}var kk;!function(e){e.WORLDWIDE="worldwide",e.ACCOUNT_COUNTRY="accountCountry"}(kk||(kk={}));const Ik=[" ","","","","","","","","","","","","","\u2028","","","","\t","\n","\f","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\ufeff","","","C","9","3","4","5","6","7","8","9","A","1","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","0"];function _k(e){const t=new Set([...Ik," "]);let n=0,i=e.length;for(;n<i&&t.has(e.charAt(n));)n++;for(;i>n&&t.has(e.charAt(i-1));)i--;return e.slice(n,i)}const Ok=(e,t)=>!!e&&e.length>=t,xk=e=>!!e&&/^(?!anonymous$)([^!_@#$%^*+=~[\]{};:\\|?`]+$)/i.test(e);class wk{constructor(){this._availableBenefits=[],this._isChosenBenefitRemoved=!1}get availableBenefits(){return this._availableBenefits}get isChosenBenefitRemoved(){return this._isChosenBenefitRemoved}setAvailableBenefits(e){this._availableBenefits=e}setChosenBenefitRemoved(e){this._isChosenBenefitRemoved=e}}function Rk(e){return e.company.key===aS.EVERYTOWN_FOR_GUN_SAFETY}function Mk(e){return e.infrastructureParams.env===BD.h.STAGING&&e.company.key===aS.STAGING_FORWARD_BLUE||e.company.key===aS.END_CITIZEN_UNITED||e.company.key===aS.PROGRESSIVE_TURNOUT_PROJECT||e.company.key===aS.FORWARD_BLUE}class Lk extends sk{static get defaultValidationResult(){return{isValid:!0,fields:{firstName:{isValid:!0,errors:{required:!1,minLength:!1,characters:!1}},lastName:{isValid:!0,errors:{required:!1,minLength:!1,characters:!1}},line1:{isValid:!0,errors:{required:!1}},line2:{isValid:!0,errors:{required:!1}},city:{isValid:!0,errors:{required:!1}},region:{isValid:!0,errors:{required:!1}},postal:{isValid:!0,errors:{required:!1}},countryCode:{isValid:!0,errors:{required:!1}},sublocality:{isValid:!0,errors:{required:!1}},administrativeArea:{isValid:!0,errors:{required:!1}}}}}static validateLine1(e){const t=!e.isDeliveryRequired||!!e.line1;return{isValid:t,errors:{required:!t}}}static validateLine2(){return{isValid:!0,errors:{required:!1}}}static validateCity(e){const t=!(e.isDeliveryRequired||e.line1)||!!e.city;return{isValid:t,errors:{required:!t}}}static validateCountryCode(e){const t=!(e.isDeliveryRequired||e.line1)||!!e.countryCode;return{isValid:t,errors:{required:!t}}}static validateSublocality(e){const t=e.countryCode===Ci.MEXICO,n=!(e.isDeliveryRequired&&t&&!e.sublocality);return{isValid:n,errors:{required:!n}}}static validateAdministrativeArea(e){const t=e.countryCode===Ci.MEXICO,n=!(e.isDeliveryRequired&&t&&!e.administrativeArea);return{isValid:n,errors:{required:!n}}}constructor(e,t,n,i,s,a){super(e),this.checkoutConfiguration=e,this.addressService=t,this.addressValidationAPI=n,this.countriesService=i,this.mailingAddressCustomization=s,this.nameValidationSettings=a,this._benefits=[],this._chosenBenefitKey=null,this._chosenOptionVariantIds=new Map,this._isDeliveryShown=!1,this._isDeliveryUsed=!1,this._firstName="",this._lastName="",this._line1="",this._line2="",this._city="",this._postal="",this._region="",this._countryCode=this.getDefaultCountryCode(),this._sublocality="",this._administrativeArea="",this._computed=null,this.shouldAutofillRegion&&(this._region=this.formatGeoIpRegion(this.checkoutConfiguration.user.address.region,this.countryCode)),this._benefits=this.convertCampaignCheckoutBenefitsToCheckoutBenefits(),this._benefits.forEach((e=>{var t;const n=null===(t=e.option)||void 0===t?void 0:t.variants.find((e=>e.chosen));n&&this._chosenOptionVariantIds.set(e.key,n.publicId)}))}get isEnabled(){return this.availableBenefits.length>0}get benefits(){return this._benefits.map((e=>this.enrichBenefitWithChosenState(e)))}get availableBenefits(){return this.computed.availableBenefits.filter((e=>e.active)).map((e=>this.enrichBenefitWithChosenState(e)))}get chosenBenefit(){var e;return null!==(e=this.availableBenefits.find((e=>e.chosen)))&&void 0!==e?e:null}get isChosenBenefitRemoved(){return!this.chosenBenefit&&!!this._chosenBenefitKey}get isDeliveryRequired(){return!!this.chosenBenefit&&this.chosenBenefit.delivery.required}get isDeliveryShown(){return this._isDeliveryShown}get isDeliveryUsed(){return this._isDeliveryUsed}get firstName(){return this._firstName.substring(0,this.nameValidationSettings.MAX_LENGTH)}get lastName(){return this._lastName.substring(0,this.nameValidationSettings.MAX_LENGTH)}get fullName(){return`${this.firstName} ${this.lastName}`.trim()}get line1(){return this._line1}get line2(){return this._line2}get city(){return this._city}get postal(){return this._postal}get region(){return this._region}get countryCode(){return this._countryCode}get sublocality(){return this._sublocality}get administrativeArea(){return this._administrativeArea}get computed(){return this._computed||(this._computed=new wk),this._computed}getBenefit(e){var t;return null!==(t=this.availableBenefits.find((t=>t.key===e)))&&void 0!==t?t:null}setChosenBenefit(e){this.computed.setChosenBenefitRemoved(!1),this._chosenBenefitKey=e}removeChosenBenefit(){this._chosenBenefitKey=null}setOptionVariant(e,t){this.computed.availableBenefits.find((t=>t.key===e))&&this._chosenOptionVariantIds.set(e,t)}setDeliveryShown(e){this._isDeliveryShown=e}setDeliveryUsed(e){this._isDeliveryUsed=e}setFirstName(e){this._firstName=e}setFirstNameIfEmpty(e){this.firstName.trim()||this.setFirstName(e)}setLastName(e){this._lastName=e}setLastNameIfEmpty(e){this.lastName.trim()||this.setLastName(e)}setFullName(e){const t=e.split(" ").filter(Boolean),n=t[0],i=t[t.length-1];n&&(this.setFirstName(n),t.length>1&&i?this.setLastName(i):this.setLastName(n))}setFullNameIfEmpty(e){this.fullName.trim()||this.setFullName(e)}setLine1(e){this._line1=e}setLine1IfEmpty(e){this.line1.trim()||this.setLine1(e)}setLine2(e){this._line2=e}setLine2IfEmpty(e){this.line2.trim()||this.setLine2(e)}setCity(e){this._city=e}setCityIfEmpty(e){this.city.trim()||this.setCity(e)}setPostal(e){this._postal=e}setPostalIfEmpty(e){this.postal.trim()||this.setPostal(e)}setRegion(e){this._region=e}setRegionIfEmpty(e){this.region.trim()||this.setRegion(e)}setCountryCode(e){const t=this.mailingAddressCustomization.getPredefinedRegions({country:this.countryCode}),n=this.mailingAddressCustomization.getPredefinedRegions({country:e}),i=this.mailingAddressCustomization.isRegionEnabled({country:e});(t||n||!i)&&(this._region=""),this._countryCode=e}setCountryCodeIfEmptyAddress(e){this.line1.trim()||this.setCountryCode(e)}setSublocality(e){this._sublocality=e}setSublocalityIfEmpty(e){this.sublocality.trim()||this.setSublocality(e)}setAdministrativeArea(e){this._administrativeArea=e}setAdministrativeAreaIfEmpty(e){this.administrativeArea.trim()||this.setAdministrativeArea(e)}getDetails(e,t){return this.addressService.getDetails({place:e,restrictCountries:[this.countryCode],sessionToken:t})}getSubplaces(e){return this.addressService.getSubplaces(Object.assign({},e))}getPlaces(e){return this.addressService.getPlaces(Object.assign({},e))}isServerValidationRequired(){return!this.checkoutConfiguration.infrastructureParams.showcase&&!!this.isDeliveryRequired&&!!this.line1}getDTO(){const e={isEnabled:this.isEnabled,benefits:this.benefits,availableBenefits:this.availableBenefits,chosenBenefit:this.chosenBenefit,isDeliveryRequired:this.isDeliveryRequired,isDeliveryShown:this.isDeliveryShown,isDeliveryUsed:this.isDeliveryUsed,firstName:_k(this.firstName),lastName:_k(this.lastName),line1:this.line1.trim(),city:this.city.trim(),region:this.region.trim(),postal:this.postal.trim(),countryCode:this.countryCode},t=this.line2.trim();t&&(e.line2=t);const n=this.sublocality.trim();n&&(e.sublocality=n);const i=this.administrativeArea.trim();return i&&(e.administrativeArea=i),e}getValidationResult(){const e=this.getDTO(),t=this.validateFirstName(e),n=this.validateLastName(e),i=Lk.validateLine1(e),s=Lk.validateLine2(),a=Lk.validateCity(e),o=this.validateRegion(e),r=this.validatePostal(e),l=Lk.validateCountryCode(e),c=Lk.validateSublocality(e),u=Lk.validateAdministrativeArea(e),d=t.isValid&&n.isValid,h=i.isValid&&s.isValid&&a.isValid&&o.isValid&&r.isValid&&l.isValid&&c.isValid&&u.isValid;return{isValid:d&&h,fields:{firstName:t,lastName:n,line1:i,line2:s,city:a,region:o,postal:r,countryCode:l,sublocality:c,administrativeArea:u}}}getAddressValidationResult(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i;const{validated:s,valid:a}=yield this.addressValidationAPI.validate({benefitDeliveryAddress:{used:this.isDeliveryUsed,showed:this.isDeliveryRequired,data:{firstName:this.firstName,lastName:this.lastName,address:{line1:this.line1,line2:this.line2,city:this.city,region:this.region,postal:this.postal,countryCode:this.countryCode,sublocality:this.sublocality,administrativeArea:this.administrativeArea},eta:null===(t=null===(e=this.chosenBenefit)||void 0===e?void 0:e.delivery)||void 0===t?void 0:t.eta,region:null===(i=null===(n=this.chosenBenefit)||void 0===n?void 0:n.delivery)||void 0===i?void 0:i.region}}});return!s||a}))}hasSubplacesToFind(e){return this.addressService.shouldFindSubplaces({place:e,restrictCountries:[this.countryCode]})}removeDeliveryAddress(){this._isDeliveryUsed=!1,this._region="",this._postal="",this._countryCode=this.getDefaultCountryCode(),this._line1="",this._line2="",this._city="",this._firstName="",this._lastName="",this._sublocality="",this._administrativeArea=""}get shouldAutofillRegion(){return!!this.checkoutConfiguration.infrastructureParams.livemode&&!!this.mailingAddressCustomization.isRegionEnabled({country:this.countryCode})}formatGeoIpRegion(e,t){const n=this.mailingAddressCustomization.getPredefinedRegions({country:t});if(!n)return e;let i;if(Array.isArray(n))i=n.find((t=>{let{name:n}=t;return n.toLowerCase()===e.toLowerCase()}));else for(const t of Object.values(n))if(i=t.find((t=>{let{name:n}=t;return n.toLowerCase()===e.toLowerCase()})),i)break;return i?i.code:""}getDefaultCountryCode(){return Mk(this.checkoutConfiguration)||Rk(this.checkoutConfiguration)||this.isUSCountyCode(this.checkoutConfiguration.user.address.countryCode)?Ci.UNITED_STATES_OF_AMERICA:this.checkoutConfiguration.user.address.countryCode?this.checkoutConfiguration.user.address.countryCode:this.countriesService.getMailingAddressCountriesList()[0].countryCode}validateFirstName(e){if(!e.isDeliveryRequired)return Lk.defaultValidationResult.fields.firstName;const t=Ok(e.firstName,this.nameValidationSettings.MIN_LENGTH),n=xk(e.firstName);return{isValid:t&&n,errors:{required:!e.firstName,minLength:!t,characters:!n}}}validateLastName(e){if(!e.isDeliveryRequired)return Lk.defaultValidationResult.fields.lastName;const t=Ok(e.lastName,this.nameValidationSettings.MIN_LENGTH),n=xk(e.lastName);return{isValid:t&&n,errors:{required:!e.lastName,minLength:!t,characters:!n}}}validateRegion(e){let t=e.isDeliveryRequired||!!e.line1;this.mailingAddressCustomization.isRegionRequired({country:e.countryCode})||(t=!1);const n=!t||!!e.region;return{isValid:n,errors:{required:!n}}}validatePostal(e){let t,n=e.isDeliveryRequired||!!e.line1||!!e.postal;if(this.mailingAddressCustomization.isPostalCodeRequired({country:e.countryCode})||(n=!1),n){const n=this.mailingAddressCustomization.getPostalCodeValidation({country:e.countryCode});t=n?n.test(e.postal):!!e.postal}else t=!0;return{isValid:t,errors:{required:!t}}}isUSCountyCode(e){return io["US Territories"].some((t=>{let{code:n}=t;return n===e}))}convertCampaignCheckoutBenefitsToCheckoutBenefits(){var e;return(null!==(e=this.checkoutConfiguration.campaign.benefits)&&void 0!==e?e:[]).map((e=>this.convertCampaignCheckoutBenefitToCheckoutBenefit(e)))}convertCampaignCheckoutBenefitToCheckoutBenefit(e){var t,n;const i=e.delivery.region===kk.ACCOUNT_COUNTRY&&e.delivery.required?this.checkoutConfiguration.company.country:void 0,s=Ys(e);return Object.assign(Object.assign({},s),{chosen:!1,delivery:Object.assign(Object.assign({},s.delivery),{country:i,countryName:i?null===(t=this.countriesService.getMailingAddressCountriesList().find((e=>e.countryCode===i)))||void 0===t?void 0:t.countryName:void 0}),chosenOptionVariant:null,isAvailableOnlyInOneFrequency:1===Object.values(null!==(n=e.eligibilityCriterias)&&void 0!==n?n:{}).length})}enrichBenefitWithChosenState(e){return Object.assign(Object.assign({},e),{chosen:this.isBenefitChosen(e),option:this.enrichOptionWithChosenState(e),chosenOptionVariant:this.getChosenOptionVariant(e)})}isBenefitChosen(e){return!this.computed.isChosenBenefitRemoved&&e.key===this._chosenBenefitKey}getChosenOptionVariant(e){var t,n;const i=null!==(n=null===(t=e.option)||void 0===t?void 0:t.variants.find((t=>t.publicId===this._chosenOptionVariantIds.get(e.key))))&&void 0!==n?n:null;return i?Object.assign(Object.assign({},i),{chosen:!0}):null}enrichOptionWithChosenState(e){return e.option?Object.assign(Object.assign({},e.option),{variants:e.option.variants.map((t=>Object.assign(Object.assign({},t),{chosen:t.publicId===this._chosenOptionVariantIds.get(e.key)})))}):e.option}}class Fk{constructor(){this._isPhoneNumberConsentEnabled=!1,this._isMailingAddressConsentEnabled=!1,this._gdprPolicy={customizedConsent:{basedOnGeoCountry:!1,basedOnGeoAndAddressRegion:!1},generalConsent:{basedOnGeoCountry:!1,basedOnGeoAndAddressRegion:!1}}}get isPhoneNumberConsentEnabled(){return this._isPhoneNumberConsentEnabled}get isMailingAddressConsentEnabled(){return this._isMailingAddressConsentEnabled}get gdprPolicy(){return this._gdprPolicy}setPhoneNumberConsentEnabled(e){this._isPhoneNumberConsentEnabled=e}setMailingAddressConsentEnabled(e){this._isMailingAddressConsentEnabled=e}setGDPRPolicy(e){this._gdprPolicy=e}}var Uk,jk,Bk,Gk,qk,Vk;(Uk||(Uk={})).NONE="",function(e){e.AUSTRALIA="AU",e.AUSTRIA="AT",e.BELGIUM="BE",e.BRAZIL="BR",e.BULGARIA="BG",e.CANADA="CA",e.CROATIA="HR",e.CYPRUS="CY",e.CZECH_REPUBLIC="CZ",e.DENMARK="DK",e.ESTONIA="EE",e.FINLAND="FI",e.FRANCE="FR",e.GERMANY="DE",e.GREECE="GR",e.HONG_KONG="HK",e.HUNGARY="HU",e.INDIA="IN",e.INDONESIA="ID",e.IRELAND="IE",e.ITALY="IT",e.JAPAN="JP",e.LATVIA="LV",e.LITHUANIA="LT",e.LUXEMBOURG="LU",e.MALAYSIA="MY",e.MALTA="MT",e.MEXICO="MX",e.NETHERLANDS="NL",e.NEW_ZEALAND="NZ",e.NORWAY="NO",e.POLAND="PL",e.PORTUGAL="PT",e.ROMANIA="RO",e.SINGAPORE="SG",e.SLOVAKIA="SK",e.SLOVENIA="SI",e.SPAIN="ES",e.SWEDEN="SE",e.SWITZERLAND="CH",e.THAILAND="TH",e.UNITED_ARAB_EMIRATES="AE",e.UNITED_KINGDOM="GB",e.UNITED_STATES="US",e.GIBRALTAR="GI",e.LIECHTENSTEIN="LI",e.PHILIPPINES="PH",e.ISRAEL="IL"}(jk||(jk={}));class Hk{}!function(e){e.MR="Mr",e.MRS="Mrs",e.MISS="Miss",e.MS="Ms",e.MX="Mx",e.SIR="Sir",e.PROF="Prof",e.DR="Dr",e.REV="Rev",e.FR="Fr",e.DCN="Dcn",e.BR="Br",e.SR="Sr"}(Bk||(Bk={})),function(e){e.M="M",e.MME="Mme",e.MLLE="Mlle",e.AUTRE="Autre",e.MX="Mx"}(Gk||(Gk={})),function(e){e.HERR="Herr",e.FRAU="Frau",e.DR="Dr",e.PROF="Prof"}(qk||(qk={})),function(e){e.HERR="Herr",e.FRAU="Frau"}(Vk||(Vk={}));class Kk extends Hk{constructor(){super(...arguments),this.isEnabled=!0,this.titles=Qk(Object.values(Vk))}}class Yk extends Hk{constructor(){super(...arguments),this.isEnabled=!1,this.titles=[]}}const zk=Array.from(new Set([Uk.NONE,...Object.values(Bk),...Object.values(Gk),...Object.values(qk),...Object.values(Vk)]));class Wk extends Hk{constructor(){super(...arguments),this.isEnabled=!0,this.titles=Qk(Object.values(Gk))}}class $k extends Hk{constructor(){super(...arguments),this.isEnabled=!0,this.titles=Qk(Object.values(qk))}}class Xk extends Hk{constructor(){super(...arguments),this.isEnabled=!0,this.titles=Qk(Object.values(Bk))}}function Qk(e){return[Uk.NONE,...e]}var Zk={isAvailableCustomerTitle:function(e){return!!e&&zk.includes(e)}},Jk=function(e){return function(e,t){switch(e){case jk.UNITED_KINGDOM:return new Xk;case jk.FRANCE:return new Wk;case jk.GERMANY:return new $k;case jk.AUSTRIA:return new Kk;case jk.CANADA:return t===jt.D.FR_CA?new Wk:new Yk;default:return new Yk}}(e.companyCountry,e.companyDefaultLocale)};const eI=[qk.DR,qk.PROF];class tI extends Hk{constructor(e){super(),this.originalLogic=e,this.filteredTitles=this.originalLogic.titles.filter((e=>!eI.includes(e)))}get isEnabled(){return this.originalLogic.isEnabled}get titles(){return this.filteredTitles}}tI.COMPANY_KEY="ACUQBXBA";class nI extends Hk{constructor(e,t){super(),this.originalLogic=e,this.filteredTitles=this.originalLogic.titles.filter((e=>!t.includes(e)))}get isEnabled(){return this.originalLogic.isEnabled}get titles(){return this.filteredTitles}}const iI=[Gk.MLLE,Gk.MX];var sI,aI,oI,rI,lI,cI,uI,dI,hI,mI,pI,gI,yI,fI,vI,SI,EI,AI,CI,bI,PI,NI=function(e){const t=Jk(e);switch(e.companyCountry){case jk.FRANCE:return new nI(t,iI);case jk.CANADA:return e.companyDefaultLocale===jt.D.FR_CA?new nI(t,iI):t;case jk.GERMANY:return e.companyKey===tI.COMPANY_KEY?new tI(t):t;default:return t}};class DI extends sk{static get defaultValidationResult(){return{isValid:!0,fields:{title:{isValid:!0,errors:{required:!1}}}}}constructor(e){super(e),this.checkoutConfiguration=e,this._title=Uk.NONE;const t=this.checkoutConfiguration.company;this._customerTitlesLogic=NI({companyKey:t.key,companyCountry:t.country,companyDefaultLocale:t.localization.defaultLocale})}get isEnabled(){return this.checkoutConfiguration.campaign.config.customerTitle.show&&this._customerTitlesLogic.isEnabled}get isRequired(){return this.checkoutConfiguration.campaign.config.customerTitle.required&&this.isEnabled}get title(){return this._title}get titleList(){return this._customerTitlesLogic.titles}setTitle(e){this._title=e}getDTO(){return{title:this.title}}getValidationResult(){const e=!this.isRequired||Zk.isAvailableCustomerTitle(this.title);return{isValid:e,fields:{title:{isValid:e,errors:{required:!e}}}}}}class TI{constructor(){this._availableGoals=new Map,this._singleSelectedGoal=null,this._selectedGoalsAvailability=[],this._isDesignationReadOnly=!1,this._isDesignationEditable=!1}get availableGoals(){return this._availableGoals}get singleSelectedGoal(){return this._singleSelectedGoal}get selectedGoalsAvailability(){return this._selectedGoalsAvailability}get isDesignationReadOnly(){return this._isDesignationReadOnly}get isDesignationEditable(){return this._isDesignationEditable}setAvailableGoals(e){this._availableGoals.clear();for(const t of e)this._availableGoals.set(t.id,t)}setSingleSelectedGoal(e){this._singleSelectedGoal=e}setSelectedGoalsAvailability(e){this._selectedGoalsAvailability=e}setDesignationReadOnly(e){this._isDesignationReadOnly=e}setDesignationEditable(e){this._isDesignationEditable=e}}class kI extends sk{constructor(){super(...arguments),this._email=""}static get defaultValidationResult(){return{isValid:!0,fields:{email:{isValid:!0,errors:{email:!1,required:!1}}}}}get email(){return this._email}get emailConsent(){return{isEnabled:this.checkoutConfiguration.featureConfig.emailConsent}}setEmail(e){this._email=e}setEmailIfEmpty(e){this.email.trim()||this.setEmail(e)}getValidationResult(){const e=this.getDTO(),t=Ia(e.email),n={isValid:t,errors:{required:!e.email,email:!t}};return{isValid:n.isValid,fields:{email:n}}}getValidOrEmptyEmail(){return this.getValidationResult().isValid?this.email:""}getDTO(){return{email:this.email.trim()}}}class II extends sk{static get defaultValidationResult(){return{isValid:!0,fields:{firstName:{isValid:!0,errors:{required:!1,minLength:!1,characters:!1}},lastName:{isValid:!0,errors:{required:!1,minLength:!1,characters:!1}}}}}constructor(e,t){super(e),this.checkoutConfiguration=e,this.validationSettings=t,this._firstName="",this._lastName=""}get firstName(){return this._firstName.substring(0,this.validationSettings.MAX_LENGTH)}get lastName(){return this._lastName.substring(0,this.validationSettings.MAX_LENGTH)}get fullName(){return`${this.firstName} ${this.lastName}`.trim()}setFirstName(e){this._firstName=e}setFirstNameIfEmpty(e){this.firstName.trim()||this.setFirstName(e)}setLastName(e){this._lastName=e}setLastNameIfEmpty(e){this.lastName.trim()||this.setLastName(e)}setFullName(e){const t=e.split(" ").filter(Boolean),n=t[0],i=t[t.length-1];n&&(this.setFirstName(n),t.length>1&&i?this.setLastName(i):this.setLastName(n))}setFullNameIfEmpty(e){this.fullName.trim()||this.setFullName(e)}getValidationResult(){const e=this.getDTO(),t=Ok(e.firstName,this.validationSettings.MIN_LENGTH),n=xk(e.firstName),i={isValid:t&&n,errors:{required:!e.firstName,minLength:!t,characters:!n}},s=Ok(e.lastName,this.validationSettings.MIN_LENGTH),a=xk(e.lastName),o={isValid:s&&a,errors:{required:!e.lastName,minLength:!s,characters:!a}};return{isValid:i.isValid&&o.isValid,fields:{firstName:i,lastName:o}}}getDTO(){return{firstName:_k(this.firstName),lastName:_k(this.lastName)}}}class _I{constructor(){this._isEnabled=!1,this._dtdFrequency=qn.MONTHLY,this._dtdCurrency="USD",this._dtdInitialAmount=null}get isEnabled(){return this._isEnabled}get dtdFrequency(){return this._dtdFrequency}get dtdCurrency(){return this._dtdCurrency}get dtdInitialAmount(){return this._dtdInitialAmount}setAvailability(e){this._isEnabled=e}setParams(e){this._dtdFrequency=e.dtdFrequency,this._dtdCurrency=e.dtdCurrency,this._dtdInitialAmount=e.dtdInitialAmount}}class OI{constructor(){this._isEnabled=!1}get isEnabled(){return this._isEnabled}setAvailability(e){this._isEnabled=e}}class xI{constructor(){this._isEnabled=!1,this._isRequired=!1}get isEnabled(){return this._isEnabled}get isRequired(){return this._isRequired}setAvailability(e){this._isEnabled=e.isEnabled,this._isRequired=e.isRequired}}class wI extends sk{static get defaultValidationResult(){return{isValid:!0,fields:{line1:{isValid:!0,errors:{required:!1}},line2:{isValid:!0,errors:{required:!1}},city:{isValid:!0,errors:{required:!1}},region:{isValid:!0,errors:{required:!1}},postal:{isValid:!0,errors:{required:!1}},countryCode:{isValid:!0,errors:{required:!1}},sublocality:{isValid:!0,errors:{required:!1}},administrativeArea:{isValid:!0,errors:{required:!1}}}}}static validateLine1(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=!e.isRequired&&!t||!!e.line1;return{isValid:n,errors:{required:!n}}}static validateLine2(){return{isValid:!0,errors:{required:!1}}}static validateCity(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=!(e.isRequired||t||e.line1)||!!e.city;return{isValid:n,errors:{required:!n}}}static validateCountryCode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=!(e.isRequired||t||e.line1)||!!e.countryCode;return{isValid:n,errors:{required:!n}}}static validateSublocality(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.countryCode===Ci.MEXICO,i=!((e.isRequired||t)&&n&&!e.sublocality);return{isValid:i,errors:{required:!i}}}static validateAdministrativeArea(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.countryCode===Ci.MEXICO,i=!((e.isRequired||t)&&n&&!e.administrativeArea);return{isValid:i,errors:{required:!i}}}constructor(e,t,n,i,s){super(e),this.checkoutConfiguration=e,this.addressService=t,this.addressValidationAPI=n,this.countriesService=i,this.mailingAddressCustomization=s,this._line1="",this._line2="",this._city="",this._postal="",this._region="",this._countryCode=this.getDefaultCountryCode(),this._sublocality="",this._administrativeArea="",this._isSkipped=!1,this._computed=null,this.shouldAutofillRegion&&(this._region=this.formatGeoIpRegion(this.checkoutConfiguration.user.address.region,this.countryCode))}get isEnabled(){return this.computed.isEnabled}get isRequired(){return this.computed.isRequired}get line1(){return this._line1}get line2(){return this._line2}get city(){return this._city}get postal(){return this._postal}get region(){return this._region}get countryCode(){return this._countryCode}get sublocality(){return this._sublocality}get administrativeArea(){return this._administrativeArea}get isSkipped(){return this._isSkipped}get computed(){return this._computed||(this._computed=new xI),this._computed}setLine1(e){this._line1=e}setLine1IfEmpty(e){this.line1.trim()||this.setLine1(e)}setLine2(e){this._line2=e}setLine2IfEmpty(e){this.line2.trim()||this.setLine2(e)}setCity(e){this._city=e}setCityIfEmpty(e){this.city.trim()||this.setCity(e)}setPostal(e){this._postal=e}setPostalIfEmpty(e){this.postal.trim()||this.setPostal(e)}setRegion(e){this._region=e}setRegionIfEmpty(e){this.region.trim()||this.setRegion(e)}setCountryCode(e){const t=this.mailingAddressCustomization.getPredefinedRegions({country:this.countryCode}),n=this.mailingAddressCustomization.getPredefinedRegions({country:e}),i=this.mailingAddressCustomization.isRegionEnabled({country:e});(t||n||!i)&&(this._region=""),this._countryCode=e}setCountryCodeIfEmptyAddress(e){this.line1.trim()||this.setCountryCode(e)}setSublocality(e){this._sublocality=e}setSublocalityIfEmpty(e){this.sublocality.trim()||this.setSublocality(e)}setAdministrativeArea(e){this._administrativeArea=e}setAdministrativeAreaIfEmpty(e){this.administrativeArea.trim()||this.setAdministrativeArea(e)}getDetails(e,t){return this.addressService.getDetails({place:e,restrictCountries:[this.countryCode],sessionToken:t})}getSubplaces(e){return this.addressService.getSubplaces(Object.assign({},e))}getPlaces(e){return this.addressService.getPlaces(Object.assign({},e))}isServerValidationRequired(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!this.checkoutConfiguration.infrastructureParams.showcase&&(this.isRequired||!!this.line1||e)}getDTO(){const e={isRequired:this.isRequired,line1:this.line1.trim(),city:this.city.trim(),region:this.region.trim(),postal:this.postal.trim(),countryCode:this.countryCode},t=this.line2.trim();t&&(e.line2=t);const n=this.sublocality.trim();n&&(e.sublocality=n);const i=this.administrativeArea.trim();return i&&(e.administrativeArea=i),e}getValidationResult(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getDTO(),n=wI.validateLine1(t,e),i=wI.validateLine2(),s=wI.validateCity(t,e),a=this.validateRegion(t,e),o=this.validatePostal(t,e),r=wI.validateCountryCode(t,e),l=wI.validateSublocality(t,e),c=wI.validateAdministrativeArea(t,e);return{isValid:n.isValid&&i.isValid&&s.isValid&&a.isValid&&o.isValid&&r.isValid&&l.isValid&&c.isValid,fields:{line1:n,line2:i,city:s,region:a,postal:o,countryCode:r,sublocality:l,administrativeArea:c}}}getAddressValidationResult(){return(0,d.sH)(this,void 0,void 0,(function*(){const{validated:e,valid:t}=yield this.addressValidationAPI.validate({line1:this.line1,line2:this.line2,city:this.city,region:this.region,postal:this.postal,countryCode:this.countryCode,sublocality:this.sublocality,administrativeArea:this.administrativeArea});return!e||t}))}hasSubplacesToFind(e){return this.addressService.shouldFindSubplaces({place:e,restrictCountries:[this.countryCode]})}setSkipped(e){this._isSkipped=e}get shouldAutofillRegion(){return!!this.checkoutConfiguration.infrastructureParams.livemode&&!!this.mailingAddressCustomization.isRegionEnabled({country:this.countryCode})}formatGeoIpRegion(e,t){const n=this.mailingAddressCustomization.getPredefinedRegions({country:t});if(!n)return e;let i;if(Array.isArray(n))i=n.find((t=>{let{name:n}=t;return n.toLowerCase()===e.toLowerCase()}));else for(const t of Object.values(n))if(i=t.find((t=>{let{name:n}=t;return n.toLowerCase()===e.toLowerCase()})),i)break;return i?i.code:""}getDefaultCountryCode(){return Mk(this.checkoutConfiguration)||Rk(this.checkoutConfiguration)||this.isUSCountyCode(this.checkoutConfiguration.user.address.countryCode)?Ci.UNITED_STATES_OF_AMERICA:this.checkoutConfiguration.user.address.countryCode?this.checkoutConfiguration.user.address.countryCode:this.countriesService.getMailingAddressCountriesList()[0].countryCode}validateRegion(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.isRequired||t||!!e.line1;this.mailingAddressCustomization.isRegionRequired({country:e.countryCode})||(n=!1);const i=!n||!!e.region;return{isValid:i,errors:{required:!i}}}validatePostal(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.isRequired||n||!!e.line1||!!e.postal;if(this.mailingAddressCustomization.isPostalCodeRequired({country:e.countryCode})||(i=!1),i){const n=this.mailingAddressCustomization.getPostalCodeValidation({country:e.countryCode});t=n?n.test(e.postal):!!e.postal}else t=!0;return{isValid:t,errors:{required:!t}}}isUSCountyCode(e){return io["US Territories"].some((t=>{let{code:n}=t;return n===e}))}}class RI extends sk{constructor(){super(...arguments),this._isActive=!1,this._companyName=""}static get defaultValidationResult(){return{isValid:!0,fields:{onBehalfOf:{isValid:!0,errors:{required:!1,minLength:!1}}}}}get isEnabled(){return this.checkoutConfiguration.campaign.config.showBehalfOf}get isActive(){return this._isActive}get companyName(){return this.isActive?this._companyName:""}get isOnBehalfOf(){return!!this.isEnabled&&Boolean(this.companyName)}setIsActive(e){this._isActive=e}setCompanyName(e){this._companyName=e}getDTO(){return{companyName:this.companyName}}getValidationResult(){const e=!this.isEnabled||!this.isActive||this.validateCompanyName();return{isValid:e,fields:{onBehalfOf:{isValid:e,errors:{required:!(!this.isEnabled||!this.isActive||this.companyName),minLength:!e}}}}}validateCompanyName(){return!(!this.companyName||this.companyName.length<2||this.companyName.match(/^\d+$/)||"mrs."===this.companyName.toLowerCase())}}class MI{constructor(){this._allowedPaymentMethods={[Gn.CARD]:{available:!1,visible:!1},[Gn.APPLE_PAY]:{available:!1,visible:!1},[Gn.GOOGLE_PAY]:{available:!1,visible:!1},[Gn.VENMO]:{available:!1,visible:!1},[Gn.PAYPAL]:{available:!1,visible:!1},[Gn.US_BANK_ACCOUNT]:{available:!1,visible:!1},[Gn.AU_BECS]:{available:!1,visible:!1},[Gn.UK_BACS]:{available:!1,visible:!1},[Gn.SEPA]:{available:!1,visible:!1},[Gn.IDEAL]:{available:!1,visible:!1},[Gn.ACSS]:{available:!1,visible:!1},[Gn.CRYPTO]:{available:!0,visible:!0}}}get allowedPaymentMethods(){return this._allowedPaymentMethods}setAllowedPaymentMethods(e){this._allowedPaymentMethods=e}}class LI extends sk{constructor(){super(...arguments),this._phone=null,this._countryCode=this.getDefaultCountryCode(),this._cleanPhone=null}static get defaultValidationResult(){return{isValid:!0,fields:{phone:{isValid:!0,errors:{required:!1,invalid:!1}}}}}get isEnabled(){return this.checkoutConfiguration.campaign.config.showPhone}get isRequired(){return this.checkoutConfiguration.campaign.config.phoneRequired}get phone(){return this._phone}get countryCode(){return this._countryCode}get isLegalTextEnabled(){return this.checkoutConfiguration.campaign.config.showPhoneLegalText}get phoneLegalText(){return this.checkoutConfiguration.campaign.config.phoneLegalText}get isFullPhoneNumberFilled(){return Boolean(this.phone&&this.countryCode)}setPhone(e){this._phone=e}setPhoneIfEmpty(e){var t;(null===(t=this.phone)||void 0===t?void 0:t.trim())||this.setPhone(e)}setCountryCode(e){this._countryCode=e}setCountryCodeIfEmptyPhone(e){var t;(null===(t=this.phone)||void 0===t?void 0:t.trim())||this.setCountryCode(e)}setCleanPhone(e){this._cleanPhone=e}getDTO(){return{phone:this.isEnabled?this._cleanPhone||"":null}}getValidationResult(){const e=this.isRequired&&!this.phone,t=(this.isRequired||!!this.phone)&&!function(e){if(!e)return!1;const t=e.replace(/[^\d]/g,"");return t.length>=7&&t.length<=15}(this.phone),n=!e&&!t;return{isValid:n,fields:{phone:{isValid:n,errors:{required:e,invalid:t}}}}}getDefaultCountryCode(){return Mk(this.checkoutConfiguration)||Rk(this.checkoutConfiguration)?sn.UNITED_STATES:this.checkoutConfiguration.user.address.countryCode}}class FI{constructor(){this._isEnabled=!1,this._upsellStartDate="",this._upsellFrequency=qn.MONTHLY,this._upsellCurrency="",this._upsellMinAmount=0,this._upsellAmount=0}get isEnabled(){return this._isEnabled}get upsellStartDate(){return this._upsellStartDate}get upsellFrequency(){return this._upsellFrequency}get upsellCurrency(){return this._upsellCurrency}get upsellMinAmount(){return this._upsellMinAmount}get upsellAmount(){return this._upsellAmount}setAvailability(e){this._isEnabled=e}setParams(e){this._upsellStartDate=e.upsellStartDate,this._upsellFrequency=e.upsellFrequency,this._upsellCurrency=e.upsellCurrency,this._upsellMinAmount=e.upsellMinAmount,this._upsellAmount=e.upsellAmount}}class UI{constructor(){this._isEnabled=!1,this._upsellFrequency=qn.MONTHLY,this._upsellCurrency="USD",this._upsellHighAmount=null,this._upsellLowAmount=null,this._upsellInitialAmount=null}get isEnabled(){return this._isEnabled}get upsellFrequency(){return this._upsellFrequency}get upsellCurrency(){return this._upsellCurrency}get upsellHighAmount(){return this._upsellHighAmount}get upsellLowAmount(){return this._upsellLowAmount}get upsellInitialAmount(){return this._upsellInitialAmount}setAvailability(e){this._isEnabled=e}setParams(e){this._upsellFrequency=e.upsellFrequency,this._upsellCurrency=e.upsellCurrency,this._upsellHighAmount=e.upsellHighAmount,this._upsellLowAmount=e.upsellLowAmount,this._upsellInitialAmount=e.upsellInitialAmount}}!function(e){e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e.ERROR="error"}(sI||(sI={})),function(e){e.PAYMENT="payment",e.MAILING_ADDRESS="mailing_address"}(aI||(aI={}));class jI extends sk{static isQuestionValid(e){return!e.required||jI.isRequiredQuestionValid(e)}static isRequiredQuestionValid(e){return e.type===Pd.CHECKBOX?!0===e.answer:e.type===Pd.MULTIOPTION&&Array.isArray(e.answer)?!!e.answer.filter(Boolean).length:Boolean(e.answer)}constructor(e){if(super(e),this.checkoutConfiguration=e,this._questions=new Map,e.campaign.config.showQuestions&&this.campaign.config.questions)for(const e of this.campaign.config.questions){const t=e.options||[];let n=e.key;this.checkoutConfiguration.showcase&&!n&&(n=e.id),this._questions.set(n,{answer:Array.isArray(e.answer)?[...e.answer]:e.answer,code:e.code,createdAt:e.createdAt,key:n,id:e.id,options:[...t],question:e.question,required:e.required,type:e.type})}}get isEnabled(){return!!this.questions.size&&this.campaign.config.showQuestions}get questions(){return this.isMandatoryQuestionsScreenEnabled?new Map([...this._questions.entries()].filter((e=>{let[t]=e;return this.questionsKeys.retiredOrUnemployed!==t&&this.questionsKeys.occupation!==t&&this.questionsKeys.employer!==t}))):this._questions}get mandatoryQuestions(){return{retiredOrUnemployed:this._questions.get(this.questionsKeys.retiredOrUnemployed),occupation:this._questions.get(this.questionsKeys.occupation),employer:this._questions.get(this.questionsKeys.employer)}}get isMandatoryQuestionsScreenEnabled(){return!!Mk(this.checkoutConfiguration)&&this._questions.has(this.questionsKeys.retiredOrUnemployed)&&this._questions.has(this.questionsKeys.occupation)&&this._questions.has(this.questionsKeys.employer)}get isMandatoryQuestionsValid(){const{retiredOrUnemployed:e,occupation:t,employer:n}=this.mandatoryQuestions;return e&&t&&n?e.answer?{isValid:!0,fields:{}}:{isValid:Boolean(t.answer)&&Boolean(n.answer),fields:{[this.questionsKeys.occupation]:{isValid:Boolean(t.answer)},[this.questionsKeys.employer]:{isValid:Boolean(n.answer)}}}:{isValid:!1,fields:{}}}getDTO(){return{questions:Ys([...this._questions.values()])}}getValidationResult(){return this.getQuestionsValidationResultByKeys([...this.questions.keys()])}getQuestionsValidationResultByKeys(e){const t={};return[...this.questions.values()].filter((t=>{let{key:n}=t;return e.includes(n)})).forEach((e=>{t[e.key]={isValid:jI.isQuestionValid(e)}})),{isValid:Object.values(t).every((e=>{let{isValid:t}=e;return t})),fields:t}}setAnswer(e,t){this.getQuestion(e).answer=t}getQuestion(e){const t=this._questions.get(e);if(!t)throw new BI(e);return t}getAnswer(e){return this.getQuestion(e).answer}get campaign(){return this.checkoutConfiguration.campaign}get companyKey(){return this.checkoutConfiguration.company.key}get questionsKeys(){return this.companyKey===aS.END_CITIZEN_UNITED?{retiredOrUnemployed:"QDKWLQGN",occupation:"QFJDQ7JR",employer:"QMTQ2X7E"}:this.companyKey===aS.PROGRESSIVE_TURNOUT_PROJECT?{retiredOrUnemployed:"Q7KCBLMH",occupation:"QKR8TNQ4",employer:"QSSD3YFM"}:{retiredOrUnemployed:"QC4PW2SJ",occupation:"Q25P4T3S",employer:"Q2BQW728"}}}class BI extends Error{constructor(e){super(`Question not found: ${e}`)}}class GI{constructor(){this._isEnabled=!1}get isEnabled(){return this._isEnabled}setAvailability(e){this._isEnabled=e}}class qI extends sk{constructor(){super(...arguments),this._isAccepted=this.checkoutConfiguration.campaign.config.termsChecked}static get defaultValidationResult(){return{isValid:!0,fields:{isAccepted:{isValid:!0,errors:{required:!1}}}}}get isEnabled(){return this.checkoutConfiguration.campaign.config.showTerms}get text(){return this.checkoutConfiguration.campaign.config.termsText}get isAccepted(){return this._isAccepted}setAccepted(e){this._isAccepted=e}getValidationResult(){const e=!this.isEnabled||this.isAccepted;return{isValid:e,fields:{isAccepted:{isValid:e,errors:{required:!e}}}}}getDTO(){return{isAccepted:this.isEnabled?this.isAccepted:void 0}}}!function(e){e[e.IN_HONOR_OF_MAX_LENGTH=50]="IN_HONOR_OF_MAX_LENGTH",e[e.SENDER_NAME_MAX_LENGTH=200]="SENDER_NAME_MAX_LENGTH"}(oI||(oI={}));class VI{static getInHonorOfMaxLength(){return oI.IN_HONOR_OF_MAX_LENGTH}static getSenderNameMaxLength(){return oI.SENDER_NAME_MAX_LENGTH}}class HI extends Error{constructor(e){super("DataPoint Validation Failed"),this.validationResult=e}}function KI(e){return e.instant&&!e.microdeposits.enabled}function YI(e){return!e.instant&&e.microdeposits.enabled&&e.microdeposits.type===hI.AUTOMATIC}function zI(e){return!e.instant&&e.microdeposits.enabled&&e.microdeposits.type===hI.MICRODEPOSITS}function WI(e){return e.instant&&e.microdeposits.enabled&&e.microdeposits.type===hI.MICRODEPOSITS}function $I(e){return e.instant&&e.microdeposits.enabled&&e.microdeposits.type===hI.AUTOMATIC}function XI(e){return e>=9500}!function(e){e.THE_ADVENTURE_PROJECT="5a8b26d4f9891300017cc0fc"}(rI||(rI={})),function(e){e[e.MONEY_LEGACY_MIN=0]="MONEY_LEGACY_MIN",e[e.MONEY_MIN=200]="MONEY_MIN",e[e.MONEY_MAX=500]="MONEY_MAX",e[e.MONEY_DEFAULT=200]="MONEY_DEFAULT",e[e.CRYPTO_MIN=200]="CRYPTO_MIN",e[e.CRYPTO_MAX=1e3]="CRYPTO_MAX",e[e.CRYPTO_DEFAULT=500]="CRYPTO_DEFAULT"}(lI||(lI={})),function(e){e.ALWAYS="always",e.NEVER="never"}(cI||(cI={})),function(e){e.PER_INSTALLMENT="perInstallment",e.NONE="none"}(uI||(uI={})),function(e){e.UPPER="upper",e.PROPER="proper"}(dI||(dI={})),(PI=hI||(hI={})).AUTOMATIC="automatic",PI.MICRODEPOSITS="microdeposits",function(e){e.OFF="off",e.OPTIONAL="optional",e.REQUIRED="required"}(mI||(mI={})),function(e){e.INVALID_SSO_MODE="Invalid SSO mode.",e.TWO_FACTOR_AUTH_NOT_ALLOWED_WITH_SSS_REQUIRED="Cannot fulfill 2FA with SSO Required.",e.DOESNT_MATCH_RECORDS="The information you entered doesn't match our records.",e.COULDNT_MATCH_USER="We couldn't match this user email with an email from your identity provider.",e.USER_HAS_ANOTHER_ACTIVE_IDP_SESSION="Authentication failed. The email address used in the identity provider is different from the one you used to start the verification on the Dashboard. Make sure you use the same email in both places.",e.ENTITY_ID_ISSUE="The specified Issuer ID does not match the data in the IdP. Please check and ensure you've entered the correct Issuer ID.",e.EXPIRED_REQUEST="The authentication request has expired. The request is no longer valid as the allowed time has passed. Please re-authenticate to proceed.",e.CERTIFICATE_ISSUE="There was an issue validating the certificate. Ensure that your certificate is valid and correctly configured in your IdP.",e.SIGNATURE_ISSUE="The signature method used is not supported by our system. Please check and change the signature method in your IdP."}(pI||(pI={})),function(e){e.DOESNT_MATCH_RECORDS="DOESNT_MATCH_RECORDS",e.COULDNT_MATCH_USER="COULDNT_MATCH_USER"}(gI||(gI={})),function(e){e.ISSUER_ID="The specified Issuer ID does not match the data in the IdP. Please check and ensure you've entered the correct Issuer ID.",e.IDP_URL="The provided Identity provider URL is invalid or unreachable. Please verify the URL and ensure your IdP is accessible.",e.CERTIFICATE="There was an issue validating the certificate. Ensure that your certificate is valid and correctly configured in your IdP.",e.DEFAULT="An error occurred. Please try again later."}(yI||(yI={})),function(e){e.USER_HAS_ANOTHER_SSO="Your account has at least one user who is already using SSO to log into another account. Delete them from your account to enable SSO.",e.NO_VERIFIED_DOMAINS="SSO cant be set to Required because no domains have been verified for this account yet.",e.USER_HAS_UNVERIFIED_EMAIL_DOMAIN="Your account has at least one user with an email address that belongs to an unverified domain. You should either enable SSO as Optional, verify the domains used by these users, or delete the users from your account.",e.BAD_SSO_CONFIGURATION="Bad SSO configuration.",e.CURRENT_USER_CANNOT_ENABLE_SSO="SSO cannot be set as required because {admin_email} is already using SSO authentication in another account."}(fI||(fI={})),function(e){e.ONLY_SSO_RESET_NOT_ALLOWED="This profile only uses SSO for login, so password reset is not possible."}(vI||(vI={})),function(e){e.USER_NOT_FOUND="User was not found"}(SI||(SI={})),function(e){e.RATE_LIMIT_IP_EXCEEDED="Too many attempts to log in from your IP address. Please try again later.",e.RATE_LIMIT_EMAIL_EXCEEDED="Too many attempts to log in from your IP address. Please try again later."}(EI||(EI={})),function(e){e.CHANGE_EMAIL_SSO_RESTRICTION_ERROR="changeEmailSsoRestrictionError",e.UPDATE_SSO_MODE_ERROR="UpdateSsoModeError",e.INVITE_USER_SSO_RESTRICTION_ERROR="inviteUserSsoRestrictionError"}(AI||(AI={})),function(e){e.NOT_SUCCESS="SAML response is not successful",e.WRONG_SAML_VERSION="SAML version is not 2.0",e.NO_ISSUE_INSTANT="IssueInstant is not found",e.INVALID_ISSUE_INSTANT="IssueInstant is invalid",e.NO_ISSUER="Issuer is not found or invalid",e.NO_ASSERTION="Assertion is not found",e.NO_SIGNATURE="Signature is not found or invalid",e.NO_EMAIL="Email is not found",e.NO_RESPONSE="Response is not found"}(CI||(CI={})),function(e){e.DEFAULT="Incorrect email or password."}(bI||(bI={}));const QI={[Wl.DONOR_NAME]:II,[Wl.DONOR_EMAIL]:kI,[Wl.MAILING_ADDRESS]:wI,[Wl.TRIBUTE]:class extends sk{constructor(){super(...arguments),this._isActive=!this.isOptional,this._isOriented=!this.isOptional,this._tributeName=""}get isEnabled(){return this.checkoutConfiguration.campaign.config.tribute.show}get isOptional(){return this.checkoutConfiguration.campaign.config.tribute.optional}get isActive(){return this._isActive}get isFilled(){return this.isActive&&!!this.tributeeName}get labelType(){return this.checkoutConfiguration.campaign.config.tribute.labelType}get isSharingEnabled(){const{showEmail:e,showAddress:t}=this.checkoutConfiguration.campaign.config.tribute;return e||t}get isTributeOriented(){return this._isOriented}get tributeeName(){var e;return null===(e=this._tributeName)||void 0===e?void 0:e.substring(0,VI.getInHonorOfMaxLength())}get type(){return Ma.NONE}setActive(e){this._isActive=e}setTributeeName(e){(e.trim()||""===e)&&(this._tributeName=e)}setOriented(e){this._isOriented=e}getDTO(){return{inHonorOf:this.tributeeName,type:this.type,labelType:this.labelType,isActive:this.isActive}}},[Wl.PROCESS]:class extends sk{constructor(e,t){super(e),this.checkoutConfiguration=e,this._flowType=t,this._status=sI.IN_PROGRESS,this._completedData=null,this._errorData=null,this._isVoiceFlow=!1}get flowType(){return this._flowType}get status(){return this._status}get completedData(){return this._completedData}get errorData(){return this._errorData}get isInProgress(){return this._status===sI.IN_PROGRESS}get isCompleted(){return this._status===sI.COMPLETED}get isError(){return this._status===sI.ERROR}get hasPaymentError(){var e;return(null===(e=this._errorData)||void 0===e?void 0:e.errorType)===aI.PAYMENT}get hasMailingAddressError(){var e;return(null===(e=this._errorData)||void 0===e?void 0:e.errorType)===aI.MAILING_ADDRESS}get isVoiceFlow(){return this._isVoiceFlow}setInProgress(){this._status=sI.IN_PROGRESS,this._completedData=null,this._errorData=null}setCompleted(e){this._status=sI.COMPLETED,this._completedData=e,this._errorData=null}setError(e){this._status=sI.ERROR,this._completedData=null,this._errorData=e}setVoiceFlow(e){this._isVoiceFlow=e}},[tk.DONATION]:Tk,[tk.GIFT_AID]:class extends sk{constructor(){super(...arguments),this._isShowed=!1,this._isAccepted=!1,this._computed=null}get isEnabled(){return this.computed.isEnabled}get legalText(){return this.checkoutConfiguration.campaign.config.giftAid.legalText}get isShowed(){return this._isShowed}get isAccepted(){return this._isAccepted}get computed(){return this._computed||(this._computed=new OI),this._computed}setShowed(){this._isShowed=!0}setAccepted(e){this._isAccepted=e}},[Wl.QUESTIONS]:jI,[Wl.COMMENT]:class extends sk{constructor(){super(...arguments),this._isRequired=!1,this._isActive=this.checkoutConfiguration.commentSettings.isActive,this._prevComment="",this._comment=""}get isEnabled(){return this.checkoutConfiguration.campaign.config.showComment}get isRequired(){return this._isRequired}get isActive(){return this._isActive}get prevComment(){return this._prevComment}get comment(){return this._comment}setIsRequired(e){this._isRequired=e}setIsActive(e){this._isActive=e}setPrevComment(){this._prevComment=this.comment}setComment(e){this._comment=e}getDTO(){return{isActive:this.isActive,comment:this.comment}}},[Wl.DESIGNATION]:class extends sk{static get defaultValidationResult(){return{isValid:!0,fields:{goal:{isValid:!0,errors:{required:!1}}}}}constructor(e){var t,n;super(e),this.checkoutConfiguration=e,this._goalKey=null,this.savedOneTimeGoalKey=null,this.savedRecurringGoalKey=null,this._goalKey=null!==(n=null===(t=this.checkoutConfiguration.fundraisingPage)||void 0===t?void 0:t.designation)&&void 0!==n?n:null}get isEnabled(){return!!this.goals.length&&this.displayGoal===la.SELECT}get goalKey(){return this._goalKey}get isDesignationModifiable(){return this.checkoutConfiguration.canModifyDesignation}get goals(){return this.checkoutConfiguration.campaign.config.goals}get goalName(){var e;return(null===(e=this.selectedGoal)||void 0===e?void 0:e.name)||null}get goalCode(){var e;return(null===(e=this.selectedGoal)||void 0===e?void 0:e.code)||null}get selectedGoal(){return this.isEnabled&&this.goals.find((e=>e.key===this.goalKey))||null}get isRecurringAllowed(){var e;if(!this.isEnabled)return!0;const t=null===(e=this.selectedGoal)||void 0===e?void 0:e.repeat;return!t||t!==js.ONE_TIME}getDTO(){return{goalKey:this.isEnabled?this.goalKey:null,goalName:this.isEnabled?this.goalName:null,allowRecurring:this.isRecurringAllowed}}setGoalKey(e,t){const n=this.goals.find((t=>t.key===e));n&&this.isGoalAllowedToShow(n,t)&&(this._goalKey=e,this.saveGoalKeyByRepeat(t))}hasSelectedGoalWithRepeat(e){var t,n,i;return this.checkoutConfiguration.preselectDesignation?(null===(i=this.selectedGoal)||void 0===i?void 0:i.repeat)===e:(null===(t=this.selectedGoal)||void 0===t?void 0:t.repeat)===e||(null===(n=this.selectedGoal)||void 0===n?void 0:n.repeat)===js.ALL}setComputedGoalKeyByGoalRepeat(e){var t,n;this.isEnabled&&((null===(t=this.externalGoal)||void 0===t?void 0:t.repeat)!==js.ALL&&(null===(n=this.externalGoal)||void 0===n?void 0:n.repeat)!==e?this.checkoutConfiguration.preselectDesignation||1===this.getAllowedGoals(e).length?this.preselectDesignation(e):this._goalKey=null:this._goalKey=this.externalGoal.key)}isGoalAllowedToShow(e,t){return!!this.isEnabled&&(e.repeat===t||e.repeat===js.ALL)}isDesignationChangeable(e){return!!this.isEnabled&&!(e<=1||!this.isDesignationModifiable)}getGoalRepeatValidationResult(e){const t=!this.isEnabled||this.isGoalValid(e),n={isValid:t,errors:{required:!t}};return{isValid:n.isValid,fields:{goal:n}}}isDesignationShowable(e){return this.isEnabled&&!!this.getAllowedGoalsByFrequency(e).length}isEditable(e){return this.isDesignationChangeable(this.getAllowedGoalsByFrequency(e).length)}getAllowedGoalsByFrequency(e){return this.getAllowedGoals(e)}get displayGoal(){return this.checkoutConfiguration.campaign.config.displayGoal}get externalGoal(){return this.isEnabled&&this.goals.find((e=>{var t,n,i,s;return e.key===(null===(i=null===(n=null===(t=this.checkoutConfiguration.external)||void 0===t?void 0:t.state)||void 0===n?void 0:n.designation)||void 0===i?void 0:i.id)||e.key===(null===(s=this.checkoutConfiguration.fundraisingPage)||void 0===s?void 0:s.designation)}))||null}preselectDesignation(e){var t,n,i,s,a,o;const r=this.getSavedGoalByRepeat(e),l=this.getSavedGoalByRepeat(e===js.ONE_TIME?js.RECURRING:js.ONE_TIME);this._goalKey=null!==(o=null!==(s=null!==(n=null!==(t=null==r?void 0:r.key)&&void 0!==t?t:(null==l?void 0:l.repeat)===js.ALL?l.key:null)&&void 0!==n?n:null===(i=this.goals.find((t=>t.default===e)))||void 0===i?void 0:i.key)&&void 0!==s?s:null===(a=this.goals.find((e=>e.default===js.ALL)))||void 0===a?void 0:a.key)&&void 0!==o?o:null}getSavedGoalByRepeat(e){var t;const n=e===js.ONE_TIME?this.savedOneTimeGoalKey:this.savedRecurringGoalKey;return null!==(t=this.goals.find((e=>e.key===n)))&&void 0!==t?t:null}saveGoalKeyByRepeat(e){e!==js.ONE_TIME?this.savedRecurringGoalKey=this.goalKey:this.savedOneTimeGoalKey=this.goalKey}isGoalValid(e){return!(!this.selectedGoal&&this.getAllowedGoals(e).length>0)}getAllowedGoals(e){return this.goals.filter((t=>this.isGoalAllowedToShow(t,e)))}},[Wl.DESIGNATIONS]:class extends sk{constructor(e){super(e),this.checkoutConfiguration=e,this._allGoals=new Map,this._allGoalsById=new Map,this._selectedGoals=[],this._defaultGoals={[js.ONE_TIME]:null,[js.RECURRING]:null},this._savedGoals={[js.ONE_TIME]:null,[js.RECURRING]:null},this._computed=new TI,this.initializeDefaultGoals()}get defaultGoals(){return this._defaultGoals}get savedGoals(){return this._savedGoals}get computed(){return this._computed}get allGoals(){return this._allGoals}get allGoalsById(){return this._allGoalsById}get availableGoals(){return Array.from(this._computed.availableGoals.values())}get goals(){const e=new Map(this._computed.availableGoals);for(const t of this.selectedGoals)e.delete(t.id);return Array.from(e.values())}get selectedGoals(){const e=this._selectedGoals.length>1,t=this.isGoalAvailable(this._selectedGoals[0]);return e||t?[...this._selectedGoals]:null!==this._computed.singleSelectedGoal?[this._computed.singleSelectedGoal]:[]}get selectedGoalsAvailability(){return this._computed.selectedGoalsAvailability}get isEnabled(){return this._allGoals.size>0}get isDesignationReadOnly(){return this._computed.isDesignationReadOnly}get isDesignationEditable(){return this._computed.isDesignationEditable}getValidationResult(){return this.validateEmptyGoals()}setAllGoals(e){this._allGoals=new Map,this._allGoalsById=new Map;for(const t of e)this._allGoals.set(t.key,t),this._allGoalsById.has(t.id)||this._allGoalsById.set(t.id,t)}setSelectedGoals(e,t){var n;const i=[];for(const t of e){const e=null!==(n=this._allGoals.get(t.key))&&void 0!==n?n:this._allGoalsById.get(t.id);e&&i.push(Object.assign(Object.assign({},e),t))}this._selectedGoals=i,this.trySaveSelectedGoals(t)}addSelectedGoal(e){this.setSelectedGoals([...this.selectedGoals,e])}removeSelectedGoal(e){let t=this.selectedGoals.filter((t=>t.id!==e));t.length<=1&&!this.isGoalAvailable(t[0])&&(t=[]),this.setSelectedGoals(t)}validateEmptyGoals(){const e=this.selectedGoals.some(((e,t)=>this.computed.selectedGoalsAvailability[t].isAvailable));return{isValid:e,fields:{goals:[{isValid:e,errors:{required:!e}}]}}}isGoalAvailable(e){return!!e&&this._computed.availableGoals.has(e.id)}initializeDefaultGoals(){const e=this.checkoutConfiguration.campaign.config.defaultGoals;this.setDefaultGoals(e.map((e=>this.mapResolvedConfigDefaultGoal(e))))}setDefaultGoals(e){switch(this._defaultGoals={[js.ONE_TIME]:null,[js.RECURRING]:null},this.checkoutConfiguration.campaign.config.displayGoal){case la.WITHOUT:break;case la.SELECT:this.setSelectDefaultGoals(e);break;default:this.setAssignDefaultGoals(e)}}setAssignDefaultGoals(e){if(this.checkoutConfiguration.campaign.config.defaultGoals.length>1&&e.every((e=>null===e.frequency))){const t=e.find((e=>null!==e.default));e=t?[t]:[e[0]]}if(1===e.length){const t=Object.assign({},e[0]);return t.default=js.ALL,t.repeat=js.ALL,this._defaultGoals[js.ONE_TIME]=t,void(this._defaultGoals[js.RECURRING]=t)}for(const t of e){if(null===t.frequency)continue;const e=tT(t.frequency);this._defaultGoals[e]=t}}setSelectDefaultGoals(e){for(const t of e)t.default&&t.default!==js.ALL?this._defaultGoals[t.default]=t:t.default===js.ALL&&(this._defaultGoals[js.ONE_TIME]=t,this._defaultGoals[js.RECURRING]=t)}mapResolvedConfigDefaultGoal(e){var t;const n=ZD();return{id:e.key,key:n,name:e.localization,code:e.code,parentId:null,parentKey:null,repeat:e.repeat,default:e.default,frequency:null!==(t=e.frequency)&&void 0!==t?t:null,isGroup:!1}}trySaveSelectedGoals(e){if(e===js.ALL)return;if(1!==this._selectedGoals.length)return;const t=this._selectedGoals[0];t.repeat!==js.ALL?this._savedGoals[t.repeat]=t:e&&(this._savedGoals[e]=t)}},[tk.PAYMENT_OPTIONS]:class extends sk{constructor(){super(...arguments),this._clientPaymentMethod=null,this._selectedPaymentOption=null,this._preSelectedPaymentOption=null,this._preSelectedFastTrackPaymentOption=null,this._paymentMethodCountry=null,this._isFastTrackFlow=!1,this._checkedPaymentMethods={[Gn.APPLE_PAY]:!1,[Gn.GOOGLE_PAY]:!1,[Gn.VENMO]:!1},this._computed=null}get allowedPaymentMethods(){return Object.assign(Object.assign({},this.computed.allowedPaymentMethods),{[Gn.VENMO]:Object.assign(Object.assign({},this.computed.allowedPaymentMethods[Gn.VENMO]),{visible:this.computed.allowedPaymentMethods[Gn.VENMO].visible&&this._checkedPaymentMethods[Gn.VENMO]}),[Gn.APPLE_PAY]:Object.assign(Object.assign({},this.computed.allowedPaymentMethods[Gn.APPLE_PAY]),{visible:this.computed.allowedPaymentMethods[Gn.APPLE_PAY].visible&&this._checkedPaymentMethods[Gn.APPLE_PAY]}),[Gn.GOOGLE_PAY]:Object.assign(Object.assign({},this.computed.allowedPaymentMethods[Gn.GOOGLE_PAY]),{visible:this.computed.allowedPaymentMethods[Gn.GOOGLE_PAY].visible&&this._checkedPaymentMethods[Gn.GOOGLE_PAY]&&!this._checkedPaymentMethods[Gn.APPLE_PAY]})})}get clientPaymentMethod(){return this._clientPaymentMethod}get selectedPaymentOption(){return this._selectedPaymentOption}get preSelectedPaymentOption(){return this._preSelectedPaymentOption}get preSelectedFastTrackPaymentOption(){return this._preSelectedFastTrackPaymentOption}get paymentMethodCountry(){return this._paymentMethodCountry}get computed(){return this._computed||(this._computed=new MI),this._computed}get isFastTrackFlow(){return this._isFastTrackFlow}setPaymentMethodChecked(e){this._checkedPaymentMethods[e]=!0}setPaymentMethod(e){this._clientPaymentMethod=e}setPaymentOption(e){this._selectedPaymentOption=e}setPreSelectedPaymentOption(e){this._preSelectedPaymentOption=e}setPreSelectedFastTrackPaymentOption(e){this._preSelectedFastTrackPaymentOption=e}setPaymentMethodCountry(e){this._paymentMethodCountry=e}setFastTrackFlow(e){this._isFastTrackFlow=e}getDTO(){return{clientPaymentMethod:this.clientPaymentMethod,selectedPaymentOption:this.selectedPaymentOption,allowedPaymentMethods:this.allowedPaymentMethods,preSelectedPaymentOption:this.preSelectedPaymentOption,preSelectedFastTrackPaymentOption:this.preSelectedFastTrackPaymentOption,paymentMethodCountry:this.paymentMethodCountry}}},[tk.PRE_DONATION_UPSELL]:class extends sk{constructor(e,t){super(e),this.checkoutConfiguration=e,this.currencyService=t,this._suggestedIsEnabled=null,this._upsellSuggestedHighAmount=null,this._upsellSuggestedLowAmount=null,this._isShowed=!1,this._upsellShowedFromCurrency="USD",this._upsellShowedFromAmount=null,this._isAccepted=!1,this._computed=null}get isEnabled(){return null!==this._suggestedIsEnabled?this._suggestedIsEnabled:this.computed.isEnabled}get upsellFrequency(){return this.computed.upsellFrequency}get upsellCurrency(){return this.computed.upsellCurrency}get upsellHighAmount(){return null!==this._upsellSuggestedHighAmount?this._upsellSuggestedHighAmount:this.computed.upsellHighAmount}get upsellHighAmountInUsd(){return this.upsellHighAmount?this.currencyService.convert(this.upsellHighAmount,this.upsellCurrency,"USD"):null}get upsellLowAmount(){return null!==this._upsellSuggestedLowAmount?this._upsellSuggestedLowAmount:this.computed.upsellLowAmount}get upsellLowAmountInUsd(){return this.upsellLowAmount?this.currencyService.convert(this.upsellLowAmount,this.upsellCurrency,"USD"):null}get upsellInitialAmount(){return this.computed.upsellInitialAmount}get upsellInitialAmountInUsd(){return this.upsellInitialAmount?this.currencyService.convert(this.upsellInitialAmount,this.upsellCurrency,"USD"):null}get isShowed(){return this._isShowed}get upsellShowedFromCurrency(){return this._upsellShowedFromCurrency}get upsellShowedFromAmount(){return this._upsellShowedFromAmount}get isAccepted(){return this._isAccepted}get computed(){return this._computed||(this._computed=new UI),this._computed}setSuggestedAvailability(e){this._suggestedIsEnabled=e}setSuggestedAmounts(e,t){this._upsellSuggestedHighAmount=e,this._upsellSuggestedLowAmount=t}removeSuggestedAvailability(){this._suggestedIsEnabled=null}removeSuggestedAmounts(){this._upsellSuggestedHighAmount=null,this._upsellSuggestedLowAmount=null}setShowed(){this._isShowed=!0,this._upsellShowedFromCurrency=this.upsellCurrency,this._upsellShowedFromAmount=this.upsellInitialAmount}setAccepted(){this._isAccepted=!0}setRejected(){this._isAccepted=!1}},[Wl.PHONE_NUMBER]:LI,[Wl.TERMS_AND_CONDITIONS]:qI,[Wl.REMIND_ME_LATER]:class extends sk{constructor(){super(...arguments),this._used=us.NOT_GIVEN,this._shown=!1,this._computed=null}get isEnabled(){return this.computed.isEnabled}get used(){return this._used}get isShown(){return this._shown}get computed(){return this._computed||(this._computed=new GI),this._computed}setState(e){if(e.used!==us.NOT_GIVEN&&!e.shown)throw new Error("RemindMeLaterDataPoint: used without shown");this._used=e.used,this._shown=e.shown}getDTO(){return{used:this.used,shown:this.isShown}}},[Wl.ON_BEHALF_OF]:RI,[Wl.DONATE_ANONYMOUS]:class extends sk{constructor(){super(...arguments),this._anonymousChecked=!1}get isEnabled(){return this.checkoutConfiguration.campaign.config.showAnonymous}get isAnonymousChecked(){return this._anonymousChecked}setAnonymousChecked(e){this._anonymousChecked=e}getDTO(){return{isAnonymousChecked:this.isAnonymousChecked}}},[tk.UK_BACS]:class extends sk{constructor(){super(...arguments),this._sortCode="",this._accountNumber="",this._accountHolderName="",this._termsAccepted=!0}get sortCode(){return this._sortCode}get accountNumber(){return this._accountNumber}get accountHolderName(){return this._accountHolderName}get isTermsAccepted(){return this._termsAccepted}setSortCode(e){this._sortCode=e}setAccountNumber(e){this._accountNumber=e}setAccountHolderName(e){this._accountHolderName=e}setTermsAccepted(e){this._termsAccepted=e}getDTO(){const e=this.getValidationResult();if(!e.isValid)throw new HI(e);return{termsAccepted:this.isTermsAccepted,sortCode:this.sortCode,accountNumber:this.accountNumber,accountHolderName:this.accountHolderName}}getValidationResult(){const e=this.isSortCodeValid(),t=this.isAccountNumberValid(),n=this.isAccountHolderNameValid();return{isValid:e&&t&&n&&this.isTermsAccepted,fields:{sortCode:{isValid:e},accountNumber:{isValid:t},accountHolderName:{isValid:n},isTermsAccepted:{isValid:this.isTermsAccepted}}}}isSortCodeValid(){return!!(this.sortCode&&this.sortCode.length>=6&&this.sortCode.length<=6)}isAccountNumberValid(){return!!(this.accountNumber&&this.accountNumber.length>=4&&this.accountNumber.length<=17)}isAccountHolderNameValid(){return!!this.accountHolderName}},[tk.POST_DONATION_UPSELL]:class extends sk{constructor(e,t,n){super(e),this.checkoutConfiguration=e,this.postDonationUpsellMlSuggestion=t,this.currencyService=n,this._isAccepted=!1,this._isShowed=!1,this._upsellCustomAmount=void 0,this._computed=null}get isEnabled(){return this.computed.isEnabled}get isAccepted(){return this._isAccepted}get isShowed(){return this._isShowed}get upsellStartDate(){return this.computed.upsellStartDate}get upsellFrequency(){return this.computed.upsellFrequency}get upsellCurrency(){return this.computed.upsellCurrency}get upsellMinAmount(){return this.computed.upsellMinAmount}get upsellMaxAmount(){const e=this.currencyService.getDigits(this.upsellCurrency),t=(0,Na.Bm)(this.upsellCurrency),n=Number("9".repeat(t));return Math.floor(n/Math.pow(10,e))*Math.pow(10,e)}get upsellAmount(){return void 0!==this._upsellCustomAmount?this._upsellCustomAmount:this.mlSuggestedAmount.isFallback?this.computed.upsellAmount:this.mlSuggestedAmount.amount}get upsellAmountInUSD(){return this.upsellAmount?this.currencyService.convert(this.upsellAmount,this.upsellCurrency,"USD"):this.upsellAmount}get computed(){return this._computed||(this._computed=new FI),this._computed}get isMinAmountValid(){return!!this.upsellAmount&&this.upsellAmount>=this.upsellMinAmount}get isMaxAmountValid(){return!this.upsellAmount||this.upsellAmount<=this.upsellMaxAmount}setUpsellCustomAmount(e){this._upsellCustomAmount=e}setAccepted(){this._isAccepted=!0}setShowed(){this._isShowed=!0}getDTO(){var e;const t=null!==(e=this.upsellAmount)&&void 0!==e?e:0;return{isAccepted:this.isAccepted,isShowed:this.isShowed,upsellStartDate:this.upsellStartDate,upsellFrequency:this.upsellFrequency,upsellCurrency:this.upsellCurrency,upsellAmount:t,upsellTip:0,upsellTotal:t}}get mlSuggestedAmount(){return this.postDonationUpsellMlSuggestion.getAdjustedAmountSuggestion()}},[tk.US_BANK_ACCOUNT]:class extends sk{constructor(){super(...arguments),this._routingNumber="",this._accountNumber="",this._accountHolderName="",this._verificationType=null,this._financialInstitution="",this._accountType=lD.INDIVIDUAL}get routingNumber(){return this._routingNumber}get accountNumber(){return this._accountNumber}get accountNumberLast4(){return this.accountNumber.length>4?this.accountNumber.slice(-4):this.accountNumber}get accountHolderName(){return this._accountHolderName}get verificationType(){return this._verificationType}get financialInstitution(){return this._financialInstitution}get accountType(){return this._accountType}get usBankAccountVerificationSetup(){const e=this.checkoutConfiguration.company.stripe.usBankAccount.verification;return{isInstantOnly:KI(e),isAbavOnly:YI(e),isMicroDepositOnly:zI(e),isInstantAndMicroDeposit:WI(e),isInstantAndAbav:$I(e)}}setRoutingNumber(e){this._routingNumber=e}setAccountNumber(e){this._accountNumber=e}setAccountHolderName(e){this._accountHolderName=e}setVerificationType(e){this._verificationType=e}setFinancialInstitution(e){this._financialInstitution=e}setAccountType(e){this._accountType=e}getDTO(){const e=this.getValidationResult();if(!e.isValid)throw new HI(e);return{routingNumber:this.routingNumber,accountNumber:this.accountNumber,accountNumberLast4:this.accountNumberLast4,accountHolderName:this.accountHolderName,accountType:this.accountType,verificationType:this.verificationType,financialInstitution:this.financialInstitution}}getValidationResult(){const e=this.isRoutingNumberValid(),t=this.isAccountNumberValid(),n=this.isAccountHolderNameValid();return{isValid:e&&t&&n,fields:{routingNumber:{isValid:e},accountNumber:{isValid:t},accountHolderName:{isValid:n},financialInstitution:{isValid:this.isFinancialInstitutionValid()},verificationType:{isValid:this.isVerificationTypeValid()}}}}isRoutingNumberValid(){return!(!this.routingNumber||9!==this.routingNumber.length)}isAccountNumberValid(){return!!(this.accountNumber&&this.accountNumber.length>=5&&this.accountNumber.length<=17)}isFinancialInstitutionValid(){return!!this.financialInstitution}isVerificationTypeValid(){return null===this.verificationType||"descriptor_code"===this.verificationType||"amounts"===this.verificationType}isAccountHolderNameValid(){return!(this.usBankAccountVerificationSetup.isMicroDepositOnly||this.usBankAccountVerificationSetup.isAbavOnly||this.usBankAccountVerificationSetup.isInstantAndAbav)||!!this.accountHolderName}},[tk.DTD]:class extends sk{constructor(e,t,n,i){super(e),this.checkoutConfiguration=e,this.currencyService=t,this.doubleTheDonationApi=n,this.transactionCosts=i,this._employerId=0,this._employerName="",this._employerRatio=[1,1],this._employerRawMinAmount=0,this._isUpsellShowed=!1,this._isUpsellAccepted=!1,this._isSkipped=!1,this._snapshot=this.createSnapshot(),this._computed=null}get isEnabled(){return this.computed.isEnabled}get isIntegrationEnabled(){return this.checkoutConfiguration.integrations.dtdEnabled}get dtdFrequency(){return this.computed.dtdFrequency}get dtdCurrency(){return this.computed.dtdCurrency}get dtdInitialAmount(){return this.computed.dtdInitialAmount}get dtdInitialTotal(){var e;return this.transactionCosts.getTotalForAmount(null!==(e=this.dtdInitialAmount)&&void 0!==e?e:0,this.dtdCurrency)}get dtdInitialTotalDoubled(){return this.dtdInitialTotal+this.dtdInitialTotal/this.employerRatio[0]*this.employerRatio[1]}get employerId(){return this._employerId}get employerName(){return this._employerName}get employerRatio(){return this._employerRatio}get employerRawMinAmount(){return this._employerRawMinAmount}get employerMinAmount(){return this.currencyService.convert(this.currencyService.fromFloat(this.employerRawMinAmount,"USD"),"USD",this.dtdCurrency)}get employerUpsellAmount(){return this.employerUpsellTotal-this.transactionCosts.getProcessingFeeForAmount(this.employerMinAmount,this.dtdCurrency)}get employerUpsellTotal(){return this.currencyService.ceil(this.transactionCosts.getTotalForAmount(this.employerMinAmount,this.dtdCurrency),this.dtdCurrency)}get employerUpsellTotalDoubled(){return this.employerUpsellTotal+this.employerUpsellTotal/this.employerRatio[0]*this.employerRatio[1]}get isUpsellShowed(){return this._isUpsellShowed}get isUpsellAccepted(){return this._isUpsellAccepted}get isSkipped(){return this._isSkipped}get snapshot(){return this._snapshot}get computed(){return this._computed||(this._computed=new _I),this._computed}getEmployersByName(e){return this.doubleTheDonationApi.getCompanies(e)}setEmployerName(e){this._employerName=e}setEmployerData(e){this._employerId=e.id,this._employerName=e.company_name,this._employerRawMinAmount=e.minimumMatchedAmount,this._employerRatio=e.ratio,this._snapshot=this.createSnapshot()}removeEmployerData(){this._employerId=0,this._employerName="",this._employerRawMinAmount=0,this._employerRatio=[1,1],this._snapshot=this.createSnapshot()}setUpsellShowed(e){this._isUpsellShowed=e}setUpsellAccepted(){this._isUpsellAccepted=!0}setSkipped(){this._isSkipped=!0}removeState(){this._isUpsellAccepted=!1,this._isSkipped=!1,this._snapshot=this.createSnapshot()}createSnapshot(){return{dtdCurrency:this.dtdCurrency,dtdInitialAmount:this.dtdInitialAmount,dtdInitialTotal:this.dtdInitialTotal,employerRatio:this.employerRatio,employerRawMinAmount:this.employerRawMinAmount,employerMinAmount:this.employerMinAmount,employerUpsellTotal:this.employerUpsellTotal,employerUpsellTotalDoubled:this.employerUpsellTotalDoubled}}},[Wl.COMMUNICATION_CONSENT]:class extends sk{constructor(){super(...arguments),this._isGeneralConsentAccepted=this.consentConfig.general.checkedByDefault,this._customizedConsentAcceptance={[ks.EMAIL]:this.consentConfig.customized.checkedByDefault,[ks.PHONE_CALLS]:this.consentConfig.customized.checkedByDefault,[ks.SMS]:this.consentConfig.customized.checkedByDefault,[ks.POSTAL_MAIL]:this.consentConfig.customized.checkedByDefault,[ks.SOCIAL_MEDIA]:this.consentConfig.customized.checkedByDefault},this._isGeneralConsentShown=!1,this._isCustomizedConsentShown=!1,this._computed=null}get isGeneralConsentEnabled(){const e=this.type===bs.GENERAL;return!(!e||!this.checkoutConfiguration.showcase)||(e&&this.consentConfig.general.showIfRequiredByLaw?this.isGeneralConsentRequiredByLawVisible():e)}get isCustomizedConsentEnabled(){const e=this.type===bs.CUSTOMIZED,t=!this.customizedConsent||Object.values(this.customizedConsent).every((e=>!e.isEnabled));return!!e&&!t&&(!this.consentConfig.customized.showIfRequiredByLaw||this.isCustomizedConsentRequiredByLawVisible())}get generalConsent(){return{isAccepted:this._isGeneralConsentAccepted}}get customizedConsent(){return{[ks.EMAIL]:{isEnabled:this.consentConfig.customized.channels.email.ask,isAccepted:this._customizedConsentAcceptance[ks.EMAIL]},[ks.PHONE_CALLS]:{isEnabled:this.consentConfig.customized.channels.phoneCalls.ask&&this.computed.isPhoneNumberConsentEnabled,isAccepted:this._customizedConsentAcceptance[ks.PHONE_CALLS]},[ks.SMS]:{isEnabled:this.consentConfig.customized.channels.sms.ask&&this.computed.isPhoneNumberConsentEnabled,isAccepted:this._customizedConsentAcceptance[ks.SMS]},[ks.POSTAL_MAIL]:{isEnabled:this.consentConfig.customized.channels.postalMail.ask&&this.computed.isMailingAddressConsentEnabled,isAccepted:this._customizedConsentAcceptance[ks.POSTAL_MAIL]},[ks.SOCIAL_MEDIA]:{isEnabled:this.consentConfig.customized.channels.socialMedia.ask,isAccepted:this._customizedConsentAcceptance[ks.SOCIAL_MEDIA]}}}get isGeneralConsentShown(){return this._isGeneralConsentShown}get isCustomizedConsentShown(){return this._isCustomizedConsentShown}get isAnyConsentAccepted(){const e=this.isGeneralConsentEnabled&&this.isGeneralConsentShown&&this.generalConsent.isAccepted,t=this.isCustomizedConsentEnabled&&this.isCustomizedConsentShown&&Object.values(this.customizedConsent).some((e=>e.isAccepted));return e||t}get computed(){return this._computed||(this._computed=new Fk),this._computed}isGeneralConsentRequiredByLawVisible(){const{generalConsent:e}=this.computed.gdprPolicy;return e.basedOnGeoCountry||e.basedOnGeoAndAddressRegion}isCustomizedConsentRequiredByLawVisible(){const{customizedConsent:e}=this.computed.gdprPolicy;return e.basedOnGeoCountry||e.basedOnGeoAndAddressRegion}getDTO(){return{type:this.type,generalConsent:this.generalConsent,customizedConsent:this.customizedConsent,isGeneralConsentShown:this.isGeneralConsentShown,isCustomizedConsentShown:this.isCustomizedConsentShown}}setGeneralConsentAccepted(e){this._isGeneralConsentAccepted=e}setCustomizedConsentAccepted(e,t){this._customizedConsentAcceptance[e]=t}setAllConsentsRejected(){this._isGeneralConsentAccepted=!1,Object.values(ks).forEach((e=>{this._customizedConsentAcceptance[e]=!1}))}setGeneralConsentShown(){this._isGeneralConsentShown=!0}setCustomizedConsentShown(){this._isCustomizedConsentShown=!0}get type(){return this.consentConfig.type}get consentConfig(){return this.checkoutConfiguration.campaign.config.consent}},[Wl.CUSTOMER_TITLE]:DI,[tk.BENEFITS]:Lk,[Xu.DONATION]:rk,[Xu.CRYPTO_WALLET]:class extends sk{constructor(){super(...arguments),this._address=""}get address(){return this._address}setAddress(e){this._address=e}}};class ZI{constructor(e){this.sessionAPI=e}getCompanies(e){return(0,d.sH)(this,void 0,void 0,(function*(){return(yield this.getDtdCompanies(e)).map((e=>({id:e.payload.id,company_name:e.payload.company_name,ratio:e.payload.ratio,minimumMatchedAmount:e.payload.minimumMatchedAmount})))}))}getDtdCompanies(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{return(yield this.sessionAPI.get("dtd",{search:e},{delay:200,retries:5,cancelSimilar:!0})).data}catch(e){return[]}}))}}class JI{constructor(e,t){this.whole=e,this.currency=t,this.fractional=this.whole/Math.pow(10,this.currency.digits)}plus(e){if(e.currency.equalTo(this.currency))return new JI(this.whole+e.whole,this.currency);throw new Error(`Currency mismatch: added ${e.currency} is not equal to ${this.currency}`)}isZero(){return 0===this.whole}[Symbol.toPrimitive](e){return"string"===e?this.whole.toString():this.whole}toString(){return this.whole.toString()}valueOf(){return this.whole}}class e_{constructor(e,t){this.digits=t,this.code=e.toUpperCase()}equalTo(e){return String(this)===String(e).toUpperCase()}[Symbol.toPrimitive](){return this.code}toString(){return this.code}}class t_ extends JI{}class n_{constructor(e){this.whole=e,this.percent=e/100,this.fractional=e/1e4}plus(e){if(this.percent+e.percent>100)throw new Error("PercentFee value can not be grater than 100");return new n_(this.whole+e.whole)}[Symbol.toPrimitive](e){return"string"===e?this.fractional.toString():this.fractional}toString(){return this.fractional.toString()}valueOf(){return this.fractional}}class i_{constructor(e){this.converter=e}makeFixedFee(e,t){return new t_(e,this.makeCurrency(t))}makeAmount(e,t){return new JI(e,this.makeCurrency(t))}makePercentFee(e){return new n_(e)}makeCurrency(e){return new e_(e,this.converter.getDigits(e))}}class s_{constructor(e){this.converter=e,this.valueObjectsFactory=new i_(e)}calculate(e,t){const n=this.valueObjectsFactory.makeAmount(e.amount,e.currency);return n.isZero()?0:this.roundFee(t.getFeeValue(n))}roundFee(e){return e<500&&(e=10*Math.ceil(e/10)),e>500&&(e=100*Math.ceil(e/100)),e}}class a_{constructor(e,t,n){this.percentFee=e,this.fixedFee=t,this.converter=n}getFeeValue(e){const t=this.converter.convertFeeCurrency(Number(this.fixedFee),this.fixedFee.currency.code,e.currency.code),n=new t_(t,e.currency);return Math.round(Number(e)*Number(this.percentFee)+Number(n))}}class o_ extends t_{constructor(e){super(Math.min(e.whole*o_.ACSS_FEE_PERCENT,o_.ACSS_MAX_FEE_VALUE),new e_("CAD",2))}}o_.ACSS_MAX_FEE_VALUE=500,o_.ACSS_FEE_PERCENT=.008;class r_ extends n_{constructor(e){let t=r_.PERCENT;e&&(t=r_.PERCENT*r_.COEFF+e.whole*(1-r_.COEFF)),super(t)}}r_.PERCENT=350,r_.COEFF=.1;class l_ extends t_{constructor(e){super(Math.min(e.whole*l_.FEE_PERCENT,l_.MAX_FEE_VALUE),new e_("USD",2))}}var c_,u_,d_,h_,m_,p_,g_,y_,f_,v_,S_,E_,A_,C_,b_,P_,N_,D_,T_,k_,I_,__,O_,x_,w_,R_,M_,L_,F_,U_,j_,B_,G_;l_.MAX_FEE_VALUE=500,l_.FEE_PERCENT=.008,function(e){e.BITCOIN="bitcoin",e.ETHEREUM="ethereum",e.BITCOINCASH="bitcoincash",e.LITECOIN="litecoin",e.ZCASH="zcash",e.FILECOIN="filecoin",e.DOGECOIN="dogecoin",e.TEZOS="tezos",e.SOLANA="solana",e.POLKADOT="polkadot"}(c_||(c_={})),function(e){e.PENDING="pending",e.FAILED="failed",e.SUCCESS="success",e.REFUNDED="refunded"}(u_||(u_={})),function(e){e.FAIL="fail",e.FAIL_NOT_ELIGIBLE="fail_not_eligible",e.WAIT_FOR_TRANSFER="wait_for_transfer",e.SUCCEED="succeed"}(d_||(d_={})),function(e){e.PENDING="pending",e.SUCCESS="success",e.FAILED="failed"}(h_||(h_={})),function(e){e.ACH="ach",e.GOOGLE_PAY="android_pay",e.APPLE_PAY="apple_pay",e.CLICK_TO_PAY="masterpass",e.PLAID="plaid"}(m_||(m_={})),function(e){e.CARD="card",e.BANK_ACCOUNT="bank_account",e.PAYPAL="paypal",e.VENMO="venmo",e.SOURCE="source",e.AU_BECS="au_becs_debit",e.UK_BACS="bacs_debit",e.ACSS="acss_debit",e.SEPA="sepa_debit",e.IDEAL="ideal",e.CRYPTO="crypto",e.STOCK="stock",e.US_BANK_ACCOUNT="us_bank_account"}(p_||(p_={})),function(e){e.CHARGEABLE="chargeable",e.NEW="new",e.VERIFICATION_FAILED="verification_failed",e.VERIFIED="verified",e.VALIDATED="validated",e.ERRORED="errored"}(g_||(g_={})),function(e){e.STRIPE="stripe",e.PAYPAL="paypal",e.GEMINI="gemini",e.MANUAL_BROKERAGE="manualBrokerage",e.COINBASE_COMMERCE="coinbaseCommerce"}(y_||(y_={})),function(e){e.STRIPE_TOKEN="stripeToken",e.STRIPE_PAYMENT_METHOD="stripePaymentMethod"}(f_||(f_={})),function(e){e.ACTIVE="active",e.CANCELLED="cancelled",e.FAILED="failed"}(v_||(v_={})),function(e){e.RETRYING="retrying",e.ACH_VERIFICATION_REQUIRED="ach_verification_required",e.SCHEDULED="scheduled",e.PAUSED="paused",e.CANCELLED_BY_COMPANY="cancelled_by_company",e.CANCELLED_BY_CUSTOMER="cancelled_by_customer",e.CANCELLED_BY_TERMINATION_FLOW="cancelled_by_termination_flow",e.CANCELLED_BY_DISPUTE_LOST="cancelled_by_dispute_lost",e.CANCELLED_BY_LIMIT="cancelled_by_limit",e.ACH_VERIFICATION_FAILED="ach_verification_failed",e.ACH_VERIFICATION_EXPIRED="ach_verification_expired",e.PAYMENT_METHOD_INVALIDATED="payment_method_invalidated",e.FAILED_BY_INSUFFICIENT="failed_by_insufficient_data"}(S_||(S_={})),function(e){e.CARD="card",e.BANK_ACCOUNT="bank_account",e.US_BANK_ACCOUNT="us_bank_account",e.AU_BECS="au_becs_debit",e.UK_BACS="bacs_debit",e.ACSS="acss_debit",e.SEPA="sepa_debit",e.IDEAL="ideal"}(E_||(E_={})),function(e){e.VISA="Visa",e.VISA_ELECTRON="Visa Electron",e.MASTER_CARD="MasterCard",e.AMERICAN_EXPRESS="American Express",e.DINERS_CLUB="Diners Club",e.DISCOVER="Discover",e.JCB="JCB",e.UNION_PAY="UnionPay"}(A_||(A_={})),function(e){e.VISA="visa",e.AMERICAN_EXPRESS="amex",e.MASTERCARD="mastercard",e.DISCOVER="discover"}(C_||(C_={})),function(e){e[e.STANDARD=290]="STANDARD",e[e.NON_PROFIT=220]="NON_PROFIT"}(b_||(b_={})),function(e){e[e.AUTO=-1]="AUTO",e[e.NEVER=0]="NEVER",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX"}(P_||(P_={})),function(e){e.NEW="new",e.VALIDATED="validated",e.VERIFIED="verified",e.FAILED="verification_failed",e.ERRORED="errored"}(N_||(N_={})),function(e){e.INDIVIDUAL="individual",e.COMPANY="company"}(D_||(D_={})),function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.DISABLED="disabled"}(T_||(T_={})),function(e){e.REQUIRES_ACTION="requires_action",e.REQUIRES_CONFIRMATION="requires_confirmation",e.REQUIRES_PAYMENT_METHOD="requires_payment_method",e.REQUIRES_CAPTURE="requires_capture",e.PROCESSING="processing",e.SUCCEEDED="succeeded",e.CANCELLED="canceled"}(k_||(k_={})),function(e){e.ACTIVE="active",e.INACTIVE="inactive"}(I_||(I_={})),function(e){e.ACH_VERIFICATION_REQUIRED="ach_verification_required",e.ACH_VERIFICATION_FAILED="ach_verification_failed",e.ACH_VERIFICATION_CANCELLED="ach_verification_cancelled",e.ACH_VERIFICATION_EXPIRED="ach_verification_expired",e.UNKNOWN_ERROR="unknown_error",e.DEACTIVATED_ON_PROVIDER_SIDE="deactivated_on_provider_side",e.ACCOUNT_CLOSED="account_closed",e.ACCOUNT_FROZEN="account_frozen",e.AUTHENTICATION_REQUIRED="authentication_required",e.BANK_ACCOUNT_RESTRICTED="bank_account_restricted",e.CARD_DECLINED="card_declined",e.DEBIT_NOT_AUTHORIZED="debit_not_authorized",e.EXPIRED_CARD="expired_card",e.FUN_WRONG_PAYMENT_METHOD="fun_wrong_payment_method",e.INCORRECT_CVC="incorrect_cvc",e.INCORRECT_NUMBER="incorrect_number",e.INCORRECT_ZIP="incorrect_zip",e.INSUFFICIENT_FUNDS="insufficient_funds",e.INVALID_ACCOUNT_NUMBER="invalid_account_number",e.NO_ACCOUNT="no_account",e.PROCESSING_ERROR="processing_error",e.RESOURCE_MISSING="resource_missing",e.MANDATE_INACTIVE="mandate_inactive",e.STRIPE_CUSTOMER_REQUIRED="stripe_customer_required",e.STRIPE_CUSTOMER_NONE="stripe_customer_none"}(__||(__={})),function(e){e.PAYMENT_METHOD_INVALIDATED="fun_payment_method_invalidated",e.CHARGE_VERIFICATION_CANCELLED="fun_verification_cancel",e.PAYMENT_METHOD_VERIFICATION_EXPIRED="fun_verification_expired",e.PAYMENT_METHOD_VERIFICATION_FAILED="fun_verification_failed",e.CHARGE_VERIFICATION_CANCELLED_BY_COMPANY="fun_verification_cancel_by_company",e.CHARGE_VERIFICATION_CANCELLED_BY_SUPPORTER="fun_verification_cancel_by_supporter",e.PAYMENT_WAS_CANCELLED="fun_payment_was_cancelled",e.ACCOUNT_WAS_TERMINATED="fun_account_was_terminated"}(O_||(O_={})),function(e){e.DUPLICATE_DONATION="duplicate_donation",e.FRAUD="fraud",e.REQUESTED_BY_SUPPORTER="requested_by_supporter",e.EXPIRED_UNCAPTURED_CHARGE="expired_uncaptured_charge",e.OTHER="other"}(x_||(x_={})),function(e){e.UPDATE_SUBSCRIPTION_CUSTOMER_ADDRESS="update_subscription_customer_address",e.UPDATE_SUBSCRIPTION_QUESTIONS="update_subscription_questions",e.UPDATE_RECURRING_PLAN_AMOUNT="update_recurring_plan_amount",e.UPDATE_RECURRING_PLAN_CUSTOM_FIELDS="update_recurring_plan_custom_fields",e.UPDATE_RECURRING_PLAN_PERSONAL_INFORMATION="update_recurring_plan_personal_information",e.UPDATE_SUBSCRIPTION_UTM="update_subscription_utm",e.UPDATE_SUBSCRIPTION_GOAL="update_subscription_goal",e.UPDATE_RECURRING_PLAN_LIMITS="update_recurring_plan_limits",e.UPDATE_SUBSCRIPTION_WIDGET="update_subscription_widget",e.UPDATE_RECURRING_PLAN_PAYMENT_METHOD="update_recurring_plan_payment_method",e.CANCEL_RECURRING_PLAN="cancel_recurring_plan",e.PAUSE_RECURRING_PLAN="pause_recurring_plan",e.UPDATE_CHARGE_CUSTOMER_ADDRESS="update_charge_customer_address",e.UPDATE_DONATION_PERSONAL_INFORMATION="update_donation_personal_information",e.UPDATE_CHARGE_RECEIPT="update_charge_receipt",e.UPDATE_CHARGE_CUSTOM_FIELDS="update_charge_custom_fields",e.UPDATE_CHARGE_GOAL="update_charge_goal",e.UPDATE_DONATION_CAMPAIGN="update_donation_campaign",e.UPDATE_DONATION_QUESTIONS="update_donation_questions",e.REFUND_APPLICATION_FEE="refund_application_fee",e.UPDATE_CUSTOMER_NAME="update_customer_name",e.CANCEL_STRIPE_SUBSCRIPTION="cancel_stripe_subscription",e.CREATE_PAD_PAYMENT_METHOD="create_pad_payment_method"}(w_||(w_={})),function(e){e.PAYPAL_ERROR="PAYPAL_ERROR",e.PAYPAL_REQUEST_ERROR="PAYPAL_REQUEST_ERROR",e.REFUND_FAILED_INSUFFICIENT_FUNDS="REFUND_FAILED_INSUFFICIENT_FUNDS",e.TRANSACTION_REFUSED="TRANSACTION_REFUSED",e.TRANSACTION_ALREADY_REFUNDED="TRANSACTION_ALREADY_REFUNDED",e.USER_ACCOUNT_RESTRICTED="USER_ACCOUNT_RESTRICTED",e.INTERNAL="INTERNAL",e.UNAVAILABLE="UNAVAILABLE",e.EXECUTE_AGREEMENT_BUYER_NOT_ACCEPTED="EXECUTE_AGREEMENT_BUYER_NOT_ACCEPTED",e.ORDER_EXPIRED="ORDER_EXPIRED",e.VALIDATION_ERROR="VALIDATION_ERROR"}(R_||(R_={})),function(e){e.PAYPAL_PAYER_BLACKLISTED="PAYPAL_PAYER_BLACKLISTED"}(M_||(M_={})),function(e){let t;!function(e){let t,n,i,s,a,o,r,l,c,u;!function(e){e.CREATED="charge.created",e.PENDING="charge.pending",e.REFUNDED="charge.refunded",e.FAILED="charge.failed",e.UPDATED="charge.updated",e.SUCCESS="charge.success",e.SUCCESS_EARLY_FRAUD_WARNING="charge.success_early_fraud_warning",e.PENDING_ACH_VERIFICATION_REQUIRED="charge.pending_ach_verification_required",e.PENDING_INCOMPLETE="charge.pending_incomplete",e.PENDING_SCHEDULED="charge.pending_scheduled",e.PENDING_WAITING_FOR_TRANSFER="charge.pending_waiting_for_transfer",e.PENDING_PAYPAL_ACTION_REQUIRED="charge.pending_paypal_action_required",e.PENDING_RETRYING="charge.pending_retrying",e.PERSONAL_DATA_DELETED="charge.personal_data_deleted",e.SUCCESS_DISPUTE_CREATED="charge.success_dispute_created",e.SUCCESS_DISPUTE_LOST="charge.success_dispute_lost",e.SUCCESS_DISPUTE_WON="charge.success_dispute_won",e.SUCCESS_DISPUTE_IN_REVIEW="charge.success_dispute_in_review"}(t=e.EChargeEvent||(e.EChargeEvent={})),function(e){e.ACTIVATED="subscription.activated",e.SCHEDULED="subscription.scheduled",e.FAILED="subscription.failed",e.COMPLETED="subscription.completed",e.CANCELLED="subscription.cancelled",e.TERMS_UPDATED="subscription.subscription_terms.updated",e.DETAILS_UPDATED="subscription.details.updated",e.PAUSED="subscription.paused",e.RETRYING="subscription.retrying",e.PERSONAL_DATA_DELETED="subscription.personal_data_deleted"}(n=e.ESubscriptionEvent||(e.ESubscriptionEvent={})),function(e){e.PENDING="charge_attempt.pending",e.SUCCESS="charge_attempt.success",e.FAILED="charge_attempt.failed"}(i=e.EChargeAttemptEvent||(e.EChargeAttemptEvent={})),function(e){e.ACTIVATE="payment_method.active",e.DEACTIVATE="payment_method.inactive",e.CREATED="payment_method.created",e.UPDATED="payment_method.updated",e.PERSONAL_DATA_DELETED="payment_method.personal_data_deleted"}(s=e.EPaymentMethodEvent||(e.EPaymentMethodEvent={})),function(e){e.CREATED="donation_benefit.created",e.UPDATED="donation_benefit.updated",e.PERSONAL_DATA_DELETED="donation_benefit.personal_data_deleted"}(a=e.EDonationBenefitEvent||(e.EDonationBenefitEvent={})),function(e){e.CREATED="tribute.created",e.UPDATED="tribute.updated",e.SHARED="tribute.shared",e.PERSONAL_DATA_DELETED="tribute.personal_data_deleted"}(o=e.ETributeEvent||(e.ETributeEvent={})),function(e){e.CREATED="abandoned_donation.created",e.OPEN="abandoned_donation.open",e.CANCELLED="abandoned_donation.cancelled",e.COMPLETED="abandoned_donation.completed",e.PERSONAL_DATA_DELETED="abandoned_donation.personal_data_deleted"}(r=e.EAbandonedDonationEvent||(e.EAbandonedDonationEvent={})),function(e){e.PERSONAL_DATA_DELETED="customer.personal_data_deleted",e.CREATED="customer.created",e.UPDATED="customer.updated"}(l=e.ECustomerEvent||(e.ECustomerEvent={})),function(e){e.PENDING="payment_attempt.pending",e.FAILED="payment_attempt.failed",e.SUCCEEDED="payment_attempt.succeeded"}(c=e.EPaymentAttemptEvent||(e.EPaymentAttemptEvent={})),function(e){e.CREATED="payment_intent.created",e.FAILED="payment_intent.failed",e.PAYMENT_FAILED="payment_intent.payment_failed",e.SUCCEEDED="payment_intent.succeeded",e.CANCELED="payment_intent.canceled",e.UPDATED="payment_intent.updated",e.REFUNDED="payment_intent.refunded",e.CAPTURED="payment_intent.captured"}(u=e.EPaymentIntentEvent||(e.EPaymentIntentEvent={}))}(t=e.DomainEvent||(e.DomainEvent={}))}(L_||(L_={})),function(e){e.REQUIRES_PAYMENT="requires_payment",e.REQUIRES_CAPTURE="requires_capture",e.REQUIRES_PAYMENT_METHOD_VERIFICATION="requires_payment_method_verification",e.FAILED="failed",e.SUCCEEDED="succeeded",e.CANCELED="canceled",e.PROCESSING="processing"}(F_||(F_={})),function(e){e.SUCCEEDED="succeeded",e.PENDING="pending",e.FAILED="failed"}(U_||(U_={})),function(e){e.CARD_ATTEMPTS="card_attempts",e.BANK_ATTEMPTS="bank_attempts",e.SESSION_CARD_COUNT="session_card_count",e.CLIENT_CARD_COUNT="client_card_count",e.IP_CARD_COUNT="ip_card_count",e.COMPANY_SMALL_AMOUNT_ATTEMPTS="company_small_amount_attempts",e.IP_BANK_ATTEMPTS="ip_bank_attempts",e.IP_AND_ROUTING_BANK_ATTEMPTS="ip_and_routing_bank_attempts",e.BRAND_BANK_ATTEMPTS="brand_bank_attempts",e.NOT_FILLED_IDENTIFIERS="not_filled_identifiers",e.INVALID_PAGE_VIEW_ID="invalid_page_view_id",e.INVALID_CHECKOUT_VIEW_ID="invalid_checkout_view_id",e.BRAND_AND_EMAIL_ATTEMPTS="brand_and_email_attempts",e.COMPANY_AND_LAST4_ATTEMPTS="company_and_last4_attempts",e.DUMMY_REASON="dummy_reason",e.PERSONAL_INFORMATION_MISSING="personal_information_missing",e.TOO_MANY_RETRIES="surplusRetries",e.TOO_MANY_ATTEMPTS="surplusAttempts",e.NO_CHECKOUT_EVENTS="invalidCheckoutEvents",e.INVALID_PAGE_VIEW_ID_LEGACY="invalidPageViewId",e.INVALID_CHECKOUT_VIEW_ID_LEGACY="invalidCheckoutViewId",e.IP_ACSS_ATTEMPTS="ip_acss_attempts",e.ACSS_ATTEMPTS="acss_attempts",e.ACSS_ATTEMPTS_FOR_BRAND="acss_attempts_for_brand",e.ACSS_ATTEMPTS_FOR_BRAND_AND_EMAIL="acss_attempts_for_brand_and_email",e.ACSS_ATTEMPTS_FOR_COMPANY_AND_LAST4="acss_attempts_for_company_and_last4"}(j_||(j_={}));class q_{constructor(e,t,n,i,s,a){this.stripeFee=e,this.applicationFee=t,this.fixedFee=n,this.paymentMethod=i,this.cardBrand=s,this.converter=a}get isNonProfitFee(){return this.stripeFee.whole===b_.NON_PROFIT}getPaymentMethodFee(e){switch(this.paymentMethod){case Gn.US_BANK_ACCOUNT:return new l_(e);case Gn.ACSS:return new o_(e)}}get isAmex(){return this.cardBrand===C_.AMERICAN_EXPRESS}getFeeValue(e){const t=this.getPaymentMethodFee(e);if(t)return Number(e)*Number(this.applicationFee)+Number(t);if(this.isNonProfitFee&&this.isAmex){const t=this.applicationFee.plus(new r_);return Number(t)*Number(e)}const n=this.converter.convertFeeCurrency(Number(this.fixedFee),this.fixedFee.currency.code,e.currency.code),i=new t_(n,e.currency),s=this.applicationFee.plus(this.stripeFee);return Number(e)*Number(s)+Number(i)}}class V_{constructor(e,t,n,i,s){this.stripeFee=e,this.applicationFee=t,this.fixedFee=n,this.companyParams=i,this.converter=s}get isUsCountry(){return"US"===this.companyParams.country}isCompanyCurrency(e){return e.currency.equalTo(this.companyParams.defaultCurrency)}isFixedFeeInDonationCurrency(e){return e.currency.equalTo(this.fixedFee.currency)}getFeeValue(e){let t=1;this.isCompanyCurrency(e)||(this.stripeFee=this.stripeFee.plus(new n_(100))),this.isFixedFeeInDonationCurrency(e)||(t=V_.FEE_CURRENCY_RATE_MULTIPLIER);const n=this.isUsCountry?new r_(this.stripeFee):this.stripeFee,i=this.applicationFee.plus(n),s=this.converter.convertFeeCurrency(Number(this.fixedFee),this.fixedFee.currency.code,e.currency.code,t),a=new t_(s,e.currency),o=Number(e),r=(o+Number(a))/(1-Number(i))/o-1;return Math.round(o*Math.round(1e4*r)/1e4)}}V_.FEE_CURRENCY_RATE_MULTIPLIER=1.03;class H_{constructor(e,t,n){this.feeCalculator=n,e.validate(t),this.valueObjectsFactory=this.feeCalculator.valueObjectsFactory,this.converter=this.feeCalculator.converter,this.companyParams=t.companyParams,this.customFixedFee=this.valueObjectsFactory.makeFixedFee(t.customFixedFee,t.companyParams.defaultCurrency),this.customFeePercent=this.valueObjectsFactory.makePercentFee(t.customFeePercent),this.applicationFeePercent=this.valueObjectsFactory.makePercentFee(t.applicationFeePercent),this.stripeFeePercent=this.valueObjectsFactory.makePercentFee(t.stripeFee.percent),this.fixedFee=this.valueObjectsFactory.makeFixedFee(t.stripeFee.fixed,t.stripeFee.currency)}getFeeForDashboard(e,t){let n;return n=this.companyParams.useCustomFee?new a_(this.customFeePercent,this.customFixedFee,this.converter):t.fromVirtualTerminal?new q_(this.stripeFeePercent,this.applicationFeePercent,this.fixedFee,t.paymentMethod,t.cardBrand,this.converter):new V_(this.stripeFeePercent,this.applicationFeePercent,this.fixedFee,this.companyParams,this.converter),this.feeCalculator.calculate(e,n)}getFeeForWidget(e){let t;return t=this.companyParams.useCustomFee?new a_(this.customFeePercent,this.customFixedFee,this.converter):new V_(this.stripeFeePercent,this.applicationFeePercent,this.fixedFee,this.companyParams,this.converter),this.feeCalculator.calculate(e,t)}getFeeWithoutFixedForWidget(e){let t;return t=this.companyParams.useCustomFee?new a_(this.customFeePercent,new t_(0,this.fixedFee.currency),this.converter):new V_(this.stripeFeePercent,this.applicationFeePercent,new t_(0,this.fixedFee.currency),this.companyParams,this.converter),this.feeCalculator.calculate(e,t)}getFeeForVirtualTerminal(e,t){let n;return n=this.companyParams.useCustomFee?new a_(this.customFeePercent,this.customFixedFee,this.converter):new q_(this.stripeFeePercent,this.applicationFeePercent,this.fixedFee,t.paymentMethod,t.cardBrand,this.converter),this.feeCalculator.calculate(e,n)}}class K_{constructor(){this.schema=new Ko({applicationFeePercent:{type:Number,required:!0},customFeePercent:{type:Number,required:!0},customFixedFee:{type:Number,required:!0},stripeFee:{percent:{type:Number,required:!0},fixed:{type:Number,required:!0},currency:{type:String,required:!0}},companyParams:{defaultCurrency:{type:String,required:!0},country:{type:String,required:!0},useCustomFee:{type:Boolean,required:!0}}})}validate(e){const t=this.schema.validate(e,{typecast:!1});if(t.length){const n=t.map((t=>{const n=So()(e,t.path);return`${t.path}: ${n} ${t.message}`})).join("\n");throw new Error(n)}}}class Y_{constructor(e,t){this.checkoutConfiguration=e,this.multiDonationsCalculator=t,this._isEnabled=!0,this._isCovered=this.isFeeCoveredByDefault,this._isCustomCoveredValue=!1}get includeFees(){return this._isEnabled?this.checkoutConfiguration.campaign.config.includeFees:sC.ONLY_NO}get isCovered(){return!!this._isEnabled&&this._isCovered}get isCustomCoveredValue(){return this._isCustomCoveredValue}set isCovered(e){this._isCovered=e}set isCustomCoveredValue(e){this._isCustomCoveredValue=e}calculateSmartFeeCovering(e){this._isCovered=this.shouldCoverFee(e.amountInUSD,e.frequency)}calculateFeeAvailability(e){this._isEnabled=this.shouldEnableFee(e.donations,e.currency)}getFee(e,t){return this.multiDonationsCalculator.calculateMultipleFee(e,t).totalFee}getFees(e,t){return this.multiDonationsCalculator.calculateMultipleFee(e,t).donations}getTotal(e,t){const n=this.getAmount(e);return this.isCovered?n+this.getFee(e,t):n}getProcessingFee(e,t){return this.isCovered?this.getFee(e,t):0}getProcessingFees(e,t){const n=this.getFees(e,t);if(!this.isCovered)for(const e of Object.keys(n))n[e]=0;return n}getFeeForAmount(e,t){return this.multiDonationsCalculator.calculateFee(e,t)}getTotalForAmount(e,t){return this.isCovered?e+this.getFeeForAmount(e,t):e}getProcessingFeeForAmount(e,t){return this.isCovered?this.getFeeForAmount(e,t):0}get isFeeCoveredByDefault(){return[sC.DEFAULT_YES,sC.ONLY_YES].includes(this.includeFees)}shouldCoverFee(e,t){var n;if(e=null!=e?e:0,t===qn.ONCE&&e>=1e5)return!1;const i=this.checkoutConfiguration.infrastructureParams,s=this.checkoutConfiguration.user,a=null==i?void 0:i.OS,o="Mac OS"===a,r="iOS"===a,l=(null===(n=null==s?void 0:s.address)||void 0===n?void 0:n.countryCode)===sn.UNITED_STATES;return!(l&&e>=25e3&&e<1e5&&!r&&!o||!l&&e>=1e4&&e<1e5&&!r&&!o)}shouldEnableFee(e,t){return!(this.getAmount(e)+this.getFee(e,t)>99999999)}getAmount(e){let t=0,n=!1;for(const i of e){const e=i.amount;"number"==typeof e&&(n=!0),t+=null!=e?e:0}return n?t:0}}class z_ extends Y_{constructor(e,t){super(e,t),this._coverageLevel=fN.FULL,this.isCovered?this._coverageLevel=fN.FULL:this._coverageLevel=fN.NONE}get coverageLevel(){return this._coverageLevel}set coverageLevel(e){this._coverageLevel=e}setFeeCoverageLevel(e,t){this.coverageLevel=e,e===fN.NONE?super.isCovered=!1:super.isCovered=!0,void 0!==(null==t?void 0:t.isCustomFeeCoveredValue)&&(super.isCustomCoveredValue=t.isCustomFeeCoveredValue)}getFee(e,t){return this.coverageLevel===fN.PARTIAL?this.getPartialFee(e,t):super.getFee(e,t)}getFullFee(e,t){return super.getFee(e,t)}getPartialFee(e,t){return super.getFee(e.map((e=>Object.assign(Object.assign({},e),{amount:(null==e?void 0:e.amount)?e.amount/2:null}))),t)}getTotalForAmount(e,t){if(!this.isCovered)return e;const n=this.coverageLevel===fN.PARTIAL?e/2:e;return e+this.getFeeForAmount(n,t)}getProcessingFees(e,t){let n=this.getFees(e,t);if(this.coverageLevel===fN.PARTIAL){const i=e.map((e=>Object.assign(Object.assign({},e),{amount:(null==e?void 0:e.amount)?e.amount/2:null})));n=this.getFees(i,t)}if(!this.isCovered)for(const e of Object.keys(n))n[e]=0;return n}}class W_{constructor(e){this.feeCalculator=e}calculateFee(e,t){return this.feeCalculator.getFeeForWidget({amount:e,currency:t})}calculateMultipleFee(e,t){const n={};let i=!1,s=0;for(const a of e){let e;a.frequency===qn.ONCE?i?e=this.calculateSingleDonationFeeWithoutFixed(a,t):(i=!0,e=this.calculateSingleDonationFee(a,t)):e=this.calculateSingleDonationFee(a,t),n[a.id]=e,s+=e}return{donations:n,totalFee:s}}calculateSingleDonationFee(e,t){var n;return this.feeCalculator.getFeeForWidget({amount:null!==(n=e.amount)&&void 0!==n?n:0,currency:t})}calculateSingleDonationFeeWithoutFixed(e,t){var n;return this.feeCalculator.getFeeWithoutFixedForWidget({amount:null!==(n=e.amount)&&void 0!==n?n:0,currency:t})}}class $_{constructor(){this.MIN_LENGTH=2,this.MAX_LENGTH=Xh.NAME_MAX_LENGTH}}class X_ extends $_{constructor(){super(...arguments),this.MIN_LENGTH=Xh.NAME_MIN_LENGTH}}X_.LOCALES=[jt.D.ZH_TW,jt.D.ZH_CN,jt.D.JA,jt.D.KO],function(e){e[e.PERSONAL_INFORMATION=1]="PERSONAL_INFORMATION"}(B_||(B_={}));class Q_{static resolveSetting(e,t){if(e===B_.PERSONAL_INFORMATION)return function(e){return X_.LOCALES.includes(e.localeCode)?new X_:new $_}(t);throw new Error(`Unknown setting ${e}`)}constructor(e){this.personalInformation=Q_.resolveSetting(B_.PERSONAL_INFORMATION,e)}}class Z_{static isDonorNameDataPoint(e,t){return t===Wl.DONOR_NAME}static isFiatDonationDataPoint(e,t){return t===tk.DONATION}static isCryptoDonationDataPoint(e,t){return t===Xu.DONATION}static isPreDonationUpsellDataPoint(e,t){return t===tk.PRE_DONATION_UPSELL}static isPostDonationUpsellDataPoint(e,t){return t===tk.POST_DONATION_UPSELL}static isDTDDataPoint(e,t){return t===tk.DTD}static isProcessDataPoint(e,t){return t===Wl.PROCESS}static isMailingAddressDataPoint(e,t){return t===Wl.MAILING_ADDRESS}static isBenefitsDataPoint(e,t){return t===tk.BENEFITS}constructor(e,t,n,i,s,a,o,r,l,c,u){this.checkoutConfiguration=e,this.currencyService=t,this.addressService=n,this.suggestionsService=i,this.intl=s,this.userSession=a,this.sessionAPI=o,this.mailingAddressCustomization=r,this.params=l,this.postDonationUpsellMlSuggestion=c,this.experiments=u}create(e){const t=this.getDataPoint(e);return Z_.isFiatDonationDataPoint(t,e)||Z_.isCryptoDonationDataPoint(t,e)?function(e,t,n,i,s,a){switch(a.flowType){case $n.MONEY:return new Tk(e,t,n,i,s);case $n.CRYPTO:return new rk(e,t,n);default:throw new Bs.HP(a.flowType)}}(this.checkoutConfiguration,this.currencyService,this.suggestionsService,this.userSession,this.transactionCosts,{flowType:this.params.flowType}):Z_.isPreDonationUpsellDataPoint(t,e)?new t(this.checkoutConfiguration,this.currencyService):Z_.isPostDonationUpsellDataPoint(t,e)?new t(this.checkoutConfiguration,this.postDonationUpsellMlSuggestion,this.currencyService):Z_.isDTDDataPoint(t,e)?new t(this.checkoutConfiguration,this.currencyService,this.doubleTheDonationAPI,this.transactionCosts):Z_.isDonorNameDataPoint(t,e)?new t(this.checkoutConfiguration,this.validationSettings.personalInformation):Z_.isMailingAddressDataPoint(t,e)?new t(this.checkoutConfiguration,this.addressService,this.addressValidationAPI,this.countriesService,this.mailingAddressCustomization):Z_.isProcessDataPoint(t,e)?new t(this.checkoutConfiguration,this.params.flowType):Z_.isBenefitsDataPoint(t,e)?new t(this.checkoutConfiguration,this.addressService,this.addressValidationAPI,this.countriesService,this.mailingAddressCustomization,this.validationSettings.personalInformation):new t(this.checkoutConfiguration)}get transactionCosts(){return this._transactionCosts||(this._transactionCosts=this.createTransactionCosts()),this._transactionCosts}get countriesService(){return this._countriesService||(this._countriesService=this.createCountriesService()),this._countriesService}get doubleTheDonationAPI(){return this.createDoubleTheDonationAPI()}get validationSettings(){return this.createValidationSettings()}get addressValidationAPI(){return this.createAddressValidationAPI()}get feeCoverageSelectionExperimentInTestGroup(){return this.checkoutConfiguration.checkoutType===Kn.PAGE?this.experiments.get(u.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT).isTestGroup:this.experiments.get(u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT).isTestGroup}getDataPoint(e){return QI[e]}createTransactionCosts(){return function(e){let{checkoutConfiguration:t,currencyService:n,isFeeCoverageSelectionExperimentInTestGroup:i=!1}=e;const s=(o=t.company,r=n,new H_(new K_,{customFixedFee:o.coverFees.amount,customFeePercent:o.coverFees.percent,applicationFeePercent:o.applicationFees.money,stripeFee:o.stripeFee,companyParams:{country:o.country||"US",defaultCurrency:o.defaultCurrency,useCustomFee:o.coverFees.custom}},new s_(r))),a=new W_(s);var o,r;return i?new z_(t,a):new Y_(t,a)}({checkoutConfiguration:this.checkoutConfiguration,currencyService:this.currencyService,isFeeCoverageSelectionExperimentInTestGroup:this.feeCoverageSelectionExperimentInTestGroup})}createCountriesService(){return(0,nk.g)({intl:this.intl,excludePalestineFromCountriesList:this.checkoutConfiguration.featureConfig.excludePalestineFromCountriesList})}createDoubleTheDonationAPI(){return new ZI(this.sessionAPI)}createAddressValidationAPI(){return new ik(this.sessionAPI)}createValidationSettings(){return new Q_({localeCode:this.checkoutConfiguration.environmentConfig.locale})}}class J_{constructor(e){this.dataPointFactory=e,this.dataPoints=new Map}getDataPoint(e){let t=this.dataPoints.get(e);return void 0===t&&(t=this.registerDataPoint(e)),t}registerDataPoint(e){const t=this.dataPointFactory.create(e);return this.dataPoints.set(e,t),t}}class eO{constructor(e,t){this.checkoutState=e,this.params=t}get(){return this.checkoutState.mailingAddress.dataPoint.isEnabled?this.params.screenSet.mailingAddress:this.params.screenSet.privacy}}!function(e){e.NONE="none",e.RANDOM="random"}(G_||(G_={}));const tO=e=>{const{type:t,generalConsent:n,isGeneralConsentShown:i}=e;return t===bs.GENERAL?{type:Ns.GENERAL,general:(s=i,a=n.isAccepted,s?a?Ts.OPTED_IN:Ts.OPTED_OUT:Ts.NOT_SUBMITTED),customized:{email:Ts.NOT_SUBMITTED,phoneCalls:Ts.NOT_SUBMITTED,postalMail:Ts.NOT_SUBMITTED,sms:Ts.NOT_SUBMITTED,socialMedia:Ts.NOT_SUBMITTED}}:{type:Ns.GENERAL,general:Ts.NOT_SUBMITTED,customized:{email:Ts.NOT_SUBMITTED,phoneCalls:Ts.NOT_SUBMITTED,postalMail:Ts.NOT_SUBMITTED,sms:Ts.NOT_SUBMITTED,socialMedia:Ts.NOT_SUBMITTED}};var s,a};class nO{constructor(e,t,n,i){this.checkoutState=e,this.checkoutConfiguration=t,this.sessionAPI=n,this.widgetSessionConsentService=i,this._closed=!1,this.sessionClosePromise=null,this._screenHistory=[],this._sessionRestoreData=null,this.widgetSessionConsentService.setSessionAPI(this.sessionAPI)}get closed(){return this._closed}get closing(){return!!this.sessionClosePromise}get screenHistory(){return this._screenHistory}get sessionRestoreData(){return this._sessionRestoreData}get sessionConsent(){return this.widgetSessionConsentService.getCurrentConsent()}updateSessionWidgetDefaults(){}closeSession(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.closed&&!this.checkoutConfiguration.infrastructureParams.showcase){if(this.widgetSessionConsentService.unsubscribeFromConsentUpdates(),this.sessionClosePromise)return this.sessionClosePromise;this.sessionClosePromise=this.sessionAPI.close();try{yield this.sessionClosePromise,this._closed=!0}finally{this.sessionClosePromise=null}}}))}abandonSession(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.remindMeLaterDataPoint.getDTO(),t=this.checkoutState.privacy.donorEmailDataPoint.getDTO(),n={remindMeLater:{shown:e.shown,used:e.used}};return t.email&&(n.email=t.email),this.sessionAPI.abandon(n)}))}setScreenHistory(e){this._screenHistory=e}setRestoreSessionData(e){this._sessionRestoreData=e,this.sessionAPI.setRestoreSessionData(e)}get remindMeLaterDataPoint(){return this.checkoutState.remindMeLater.dataPoint}}class iO extends nO{updateSession(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.infrastructureParams.showcase)return wn.success({});const t=this.checkoutState.tribute.dataPoint,n=this.checkoutState.comment.dataPoint,i=this.activeGoal,s=this.donationDataPoint.getDTO(),a=this.getDonationAmount(this.donationDataPoint,e),o=this.donorNameDataPoint.getDTO(),r=this.donorEmailDataPoint.getDTO(),l=this.customerTitleDataPoint.getDTO(),c=this.phoneNumberDataPoint.getDTO(),u=t.getDTO(),d=this.questionsDataPoint.getDTO(),h=this.termsAndConditionsDataPoint.getDTO(),m=this.onBehalfOfDataPoint.getDTO(),p=this.donateAnonymousDataPoint.getDTO(),g=this.checkoutState.communicationConsent.dataPoint.getDTO();return this.sessionAPI.update({donationType:$n.CRYPTO,comment:n.isActive?n.comment:"",tribute:u.inHonorOf&&u.isActive?{labelType:u.labelType,type:u.type,inHonorOf:u.inHonorOf}:null,questions:d.questions,customer:{firstName:o.firstName,lastName:o.lastName,title:l.title,email:r.email,phone:c.phone,onBehalfOf:m.companyName,anonymousChecked:p.isAnonymousChecked,termsChecked:h.isAccepted,consent:tO(g)},donation:{frequency:qn.ONCE,amount:a.amount,currency:s.currency,total:a.total,publicFee:0,goalKey:i.goalKey,goalName:i.goalName,hintsVariantName:G_.NONE,hintDescription:"",_suggestedAmountHint:null,donationItems:[{amount:a.amount,fee:0,frequency:qn.ONCE,goalKey:i.goalKey,hintsVariantName:G_.NONE,hintDescription:"",_suggestedAmountHint:null}]},checkoutDefaults:this.getCheckoutDefaults(this.donationDataPoint),screenHistory:[],marketingCookieConsent:this.sessionConsent})}))}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}get activeGoal(){const e=this.designationsDataPoint.selectedGoals;if(e.length>0){const t=e[0];return{goalKey:t.id,goalName:t.name}}return{goalKey:null,goalName:null}}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get phoneNumberDataPoint(){return this.checkoutState.privacy.phoneNumberDataPoint}get customerTitleDataPoint(){return this.checkoutState.privacy.customerTitleDataPoint}get termsAndConditionsDataPoint(){return this.checkoutState.privacy.termsAndConditionsDataPoint}get onBehalfOfDataPoint(){return this.checkoutState.privacy.onBehalfOfDataPoint}get donateAnonymousDataPoint(){return this.checkoutState.privacy.donateAnonymousDataPoint}get questionsDataPoint(){return this.checkoutState.questions.dataPoint}getCheckoutDefaults(e){return{amountOptions:this.checkoutConfiguration.defaultAmountOptions,defaultAmounts:this.checkoutConfiguration.defaultAmounts,frequency:e.frequency,currency:e.currency,frequencyAmountOptions:this.checkoutConfiguration.campaign.config.frequencies[e.frequency].amountOptions,defaultAmount:this.checkoutConfiguration.defaultAmounts[e.frequency]||0}}getDonationAmount(e,t){if((null==t?void 0:t.canUseAmountDefaults)&&!e.amount)return{amount:e.getDefaultAmountInCurrency(),total:e.getDefaultTotalInCurrency()};const n=e.getDTO();return{amount:n.amount,total:n.total}}}var sO;!function(e){e.ONCE="once",e.DAILY="daily",e.WEEKLY="weekly",e.BIWEEKLY="biweekly",e.EVERY_4_WEEKS="every4weeks",e.MONTHLY="monthly",e.BIMONTHLY="bimonthly",e.QUARTERLY="quarterly",e.SEMIANNUAL="semiannual",e.ANNUAL="annual"}(sO||(sO={}));class aO extends vr{constructor(e,t){super(),this.payload={checkoutIsRecurring:e.frequency!==sO.ONCE?1:0,checkoutCurrency:e.currency,checkoutAmount:e.amount,checkoutPresets:e.amountOptions[e.frequency],elementKey:t.elementKey,elementType:t.elementType,elementReminderKey:t.elementReminderKey}}}class oO extends aO{constructor(e,t,n,i,s,a){super(e,t),this.merge({checkoutScreen:n,chargeKey:i.chargeKey,chargeInUSDAmount:i.chargeInUSDAmount,chargeInDefaultCurrencyAmount:i.chargeInDefaultCurrencyAmount,chargeAmount:i.chargeAmount,chargeCurrency:i.chargeCurrency,chargeFeeCovered:i.chargeFeeCovered?1:0,chargePaymentMethod:i.chargePaymentMethod,chargeIsRecurring:i.chargeIsRecurring?1:0,chargeHasComment:i.chargeHasComment?1:0,chargeHasTribute:i.chargeHasTribute?1:0,chargeGoal:i.chargeGoal,chargeCampaignKey:i.chargeCampaignKey,duration:s,eventComment:a})}get eventType(){return"checkoutCharge"}}class rO extends aO{constructor(e,t,n,i,s){super(e,t),this.merge({checkoutScreen:n,checkoutClickElement:i,clickAHref:null==s?void 0:s.link,clickDOMPath:null==s?void 0:s.path,clickText:null==s?void 0:s.text})}get eventType(){return"checkoutClick"}}class lO extends aO{constructor(e,t,n){super(e,t),this.merge({checkoutScreen:n})}get eventType(){return"checkoutClose"}}class cO extends aO{constructor(e,t,n){super(e,t),this.merge({customEventType:n.customEventType,customEventData:JSON.stringify(n.customEventData)})}get eventType(){return"customEvent"}}class uO extends aO{constructor(e,t,n,i,s,a,o,r,l){super(e,t),this.merge({checkoutScreen:n,checkoutError:i,chargePaymentMethod:s,duration:a,customEventData:JSON.stringify({paymentErrorCode:o,paymentErrorType:r,paymentErrorDeclineCode:l})})}get eventType(){return"checkoutError"}}class dO extends aO{constructor(e,t,n,i,s){super(e,t),this.payload.askPagePosition=s||null,this.merge({checkoutScreen:n,eventComment:i})}get eventType(){return"checkoutScreenView"}}class hO extends aO{constructor(e,t,n,i){super(e,t),this.merge({duration:n,eventComment:i})}get eventType(){return"checkoutView"}}class mO extends aO{constructor(e,t,n,i,s,a){super(e,t),this.merge({checkoutScreen:n,paymentIntentId:i.paymentIntentId,donationItems:JSON.stringify(i.donationItems),chargeInUSDAmount:i.chargeInUSDAmount,chargeInDefaultCurrencyAmount:i.chargeInDefaultCurrencyAmount,chargeAmount:i.chargeAmount,chargeCurrency:i.chargeCurrency,chargeFeeCovered:i.chargeFeeCovered?1:0,chargePaymentMethod:i.chargePaymentMethod,chargeIsRecurring:i.chargeIsRecurring?1:0,chargeHasComment:i.chargeHasComment?1:0,chargeHasTribute:i.chargeHasTribute?1:0,chargeCampaignKey:i.chargeCampaignKey,duration:s,eventComment:a})}get eventType(){return"donationComplete"}}function pO(e,t){let n=e;for(;;){if(t(n))return n;if(!n.parentNode)return;n=n.parentNode}}function gO(e,t){if(e.getAttribute)return e.getAttribute("data-"+t)||void 0}function yO(e,t){if(!e)return;if("test"===t&&e.FUN_SPLIT_TESTING_NAME)return{name:e.FUN_SPLIT_TESTING_NAME,node:e};if("variant"===t&&e.FUN_SPLIT_TESTING_VARIANT_NAME)return{name:e.FUN_SPLIT_TESTING_VARIANT_NAME,node:e};const n=gO(e,`fun-${t}`);if(n)return{name:n,node:e};const i=e.getAttribute("href")||"",s=/#FUN/.test(i),a=/#X/.test(i);if(s||a){const n=function(e){if(!e)return null;if(!dr.test(e))return null;const t=/(#.+?)$/.exec(e);if(!t)return null;const n=t[0],i=dr.exec(n);if(!i)return null;const s=i[1],a=Er(n),o={key:s};return Object.assign(o,a),o}(i);if(n&&n.key&&n[t])return{name:n[t],node:e}}}class fO{constructor(e){this.node=e,this.path="",this.purePath=this.createPath(this.node),this.convertPathToString(this.purePath),this.extractDataFromNode(),this.extractSplitTest()}createPath(e){let t=e;const n=[];for(;!(t instanceof HTMLHtmlElement)&&t.parentNode;)n.push(t),t=t.parentNode;return n}convertPathToString(e){this.path=e.map((e=>{if(e.tagName&&e.nodeName&&"HTML"!==e.tagName){const t=e.classList?[].slice.call(e.classList):[];return e.tagName.toLowerCase()+(t.length?"."+t.join("."):"")}return!1})).filter(Boolean).reverse().join(" ")}extractDataFromNode(){const e=this.findExtractableNode();if(!e)return;const t=e.innerText||e.textContent||e.value;if(this.text=t?t.replace(/\s+/g," ").trim().substr(0,200):void 0,e instanceof HTMLAnchorElement)this.link=e.href;else{let t=e;for(;t;){if(t.href){this.link=t.href;break}t=t.parentNode}}}findExtractableNode(){return this.purePath.find((e=>{if(e.nodeType!==Node.ELEMENT_NODE)return!1;const t=e.tagName.toLowerCase();return-1!==["a","button"].indexOf(t)||"input"===t&&-1!==["submit","button"].indexOf(e.type)}))}extractSplitTest(){const e=function(e){if(!function(e){if(!e)return!1;const t=pO(e,(e=>Boolean(e.FUN_SPLIT_TESTING)));return Boolean(t)}(e))return;const t=function(e){const t=pO(e,(e=>Boolean(e.FUN_SPLIT_TESTING_NAME||gO(e,"fun-test"))));return yO(e,"test")||yO(t,"test")}(e),n=function(e){const t=pO(e,(e=>Boolean(e.FUN_SPLIT_TESTING_VARIANT_NAME||gO(e,"fun-variant"))));return yO(e,"variant")||yO(t,"variant")}(e);return t&&n?{test:t.name,variant:n.name}:void 0}(this.node);e&&(this.test=e.test,this.variant=e.variant)}}class vO extends rr{constructor(e,t,n,i,s,a,o){super(s,a,o),this.currencyService=e,this.checkoutState=t,this.checkoutUIState=n,this.screenDataFormatter=i,this.checkoutConfiguration=s,this.sessionTokenService=a,this.params=o}createCheckoutViewEvent(){var e,t,n;const i={isAmountFromElement:Boolean((null===(e=this.checkoutConfiguration.external.element)||void 0===e?void 0:e.key)&&(null===(n=null===(t=this.checkoutConfiguration.external.state)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.amount))};return new hO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.getOpeningTime(),i)}createCheckoutScreenViewEvent(e){const t={renderDuration:null};return e.transitionStartedAt&&e.transitionFinishedAt&&(t.transitionDuration=e.transitionFinishedAt.getTime()-e.transitionStartedAt.getTime()),e.renderedAt&&e.transitionFinishedAt&&(t.renderDuration=e.renderedAt.getTime()-e.transitionFinishedAt.getTime()),this.checkoutConfiguration.isRestoredByWidgetSession&&(t.isRestoredByWidgetSession=!0),new dO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,t,e.askPagePosition)}createCheckoutChargeEvent(e){var t,n;const i=null!==(t=e.donationIds[0])&&void 0!==t?t:e.donationId,s=this.designationsDataPoint.selectedGoals.filter(((e,t)=>{var n;return null===(n=this.designationsDataPoint.selectedGoalsAvailability[t])||void 0===n?void 0:n.isAvailable})),a=null===(n=s[0])||void 0===n?void 0:n.id;return new oO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,{chargeKey:i,chargeInUSDAmount:this.donationDataPoint.totalInUSD||0,chargeInDefaultCurrencyAmount:this.donationDataPoint.totalInDefaultCurrency,chargeAmount:this.donationDataPoint.total,chargeCurrency:this.donationDataPoint.currency,chargeFeeCovered:!1,chargePaymentMethod:e.clientPaymentMethod,chargeIsRecurring:this.donationDataPoint.frequency!==qn.ONCE,chargeHasComment:this.commentDataPoint.isActive&&!!this.commentDataPoint.comment,chargeHasTribute:this.tributeDataPoint.isFilled,chargeGoal:a||void 0,chargeCampaignKey:this.checkoutConfiguration.campaign.key},e.duration)}createCheckoutDonationCompleteEvent(e){var t,n;const i=[{chargeId:e.donationIds[0],goalId:null===(t=this.designationsDataPoint.selectedGoals[0])||void 0===t?void 0:t.id,amount:null!==(n=this.donationDataPoint.total)&&void 0!==n?n:0,amountInUSD:this.donationDataPoint.totalInUSD}];return new mO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,{paymentIntentId:e.paymentIntentId,donationItems:i,chargeInUSDAmount:this.donationDataPoint.totalInUSD||0,chargeInDefaultCurrencyAmount:this.donationDataPoint.totalInDefaultCurrency,chargeAmount:this.donationDataPoint.total,chargeCurrency:this.donationDataPoint.currency,chargeFeeCovered:!1,chargePaymentMethod:e.clientPaymentMethod,chargeIsRecurring:this.donationDataPoint.frequency!==qn.ONCE,chargeHasComment:this.commentDataPoint.isActive&&!!this.commentDataPoint.comment,chargeHasTribute:this.tributeDataPoint.isFilled,chargeCampaignKey:this.checkoutConfiguration.campaign.key},e.duration)}createCheckoutErrorEvent(e){return new uO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,e.errorMessage,Gn.CRYPTO,e.durationTime)}createCheckoutCloseEvent(){return new lO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName)}createCheckoutClickEvent(e){return new rO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,e.elementName||"other",new fO(e.target))}createCheckoutCustomEvent(e){return new cO(this.checkoutEventPayParams,this.checkoutEventElementParams,{customEventType:e.type,customEventData:"data"in e?e.data:void 0})}getCommonEventPayload(){var e,t;const n=this.getCurrentScreenData();return Object.assign(Object.assign({},super.getCommonEventPayload()),{donationType:this.processDataPoint.flowType,checkoutFrequency:this.donationDataPoint.frequency,checkoutDefaultAmount:null!==(e=this.donationDataPoint.defaultAmount)&&void 0!==e?e:0,checkoutInUSDAmount:null!==(t=this.donationDataPoint.amountInUSD)&&void 0!==t?t:0,checkoutCurrencyRate:this.currencyService.getRate(this.donationDataPoint.currency),checkoutScreen:null==n?void 0:n.screenName,checkoutScreenData:n&&this.checkoutUIState?JSON.stringify(this.screenDataFormatter.format(n.screenName,n.screenData,this.screenFormatterData,this.checkoutUIState,this.checkoutConfiguration)):void 0})}get screenFormatterData(){return{donation:{amount:this.donationDataPoint.amount,currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency,defaultAmount:this.donationDataPoint.defaultAmount},tribute:{isActive:this.tributeDataPoint.isActive}}}get checkoutEventPayParams(){var e;const t={};for(const e of Object.values(qn))t[e]=[];return{frequency:this.donationDataPoint.frequency,currency:this.donationDataPoint.currency,amount:null!==(e=this.donationDataPoint.amount)&&void 0!==e?e:0,amountOptions:t}}get checkoutEventElementParams(){return{elementKey:this.checkoutConfiguration.element.key,elementType:this.checkoutConfiguration.element.type,elementReminderKey:this.checkoutConfiguration.element.reminderKey}}get checkoutScreenName(){var e;return(null===(e=this.getCurrentScreenData())||void 0===e?void 0:e.screenName)||""}get processDataPoint(){return this.checkoutState.process.dataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}}class SO{constructor(e){this.sessionAPI=e}pay(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.sessionAPI.post("pay",{paymentMethod:null==e?void 0:e.paymentMethod})}))}hold(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=Object.assign({},e);return this.sessionAPI.post("hold",t,{rejectsOnInvalid:!0})}))}status(){return(0,d.sH)(this,void 0,void 0,(function*(){try{return(yield this.sessionAPI.get("status",{},{retries:5,delay:200,rejectsOnInvalid:!0})).completed}catch(e){throw new Error("Payment was not started")}}))}}const EO={amount:0,currency:"USD",isFallback:!0};class AO{constructor(e,t,n){this.sessionApi=e,this.currencyService=t,this.suggestions=n,this._amountSuggestion=EO,this._originalAmountSuggestion=EO}getOriginalAmountSuggestion(){return this._originalAmountSuggestion}getAdjustedAmountSuggestion(){return this._amountSuggestion}fetchAmountSuggestion(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{const t=yield this.sessionApi.post("getPduAmount",e);if(wn.isSuccess(t)){const n=t.successResult;this._originalAmountSuggestion=n,this._amountSuggestion=this.adjustSuggestion(n,e.minRecurringAmount)}else this._originalAmountSuggestion=EO,this._amountSuggestion=EO}catch(e){this._originalAmountSuggestion=EO,this._amountSuggestion=EO}}))}adjustSuggestion(e,t){const{amount:n,currency:i}=e;if(n<t)return Object.assign(Object.assign({},e),{amount:t});const s=this.currencyService.convert(AO.MAX_AMOUNT_IN_USD,"USD",i);return n>s?Object.assign(Object.assign({},e),{amount:this.suggestions.beautify(s,i)}):Object.assign(Object.assign({},e),{amount:n})}}AO.MAX_AMOUNT_IN_USD=1e5;class CO{constructor(e,t,n,i){this.globalWindow=e,this.checkoutConfiguration=t,this.currencyService=n,this.checkoutState=i}getUrl(){var e,t,n,i,s,a;if(this.isShowcase)return null;const o=this.resolveTargetConfig(),r=o.type===Cs.REDIRECT,l=(null===(e=this.checkoutConfiguration.external.campaign)||void 0===e?void 0:e.successUrl)||(r?o.redirect.url:null),c=null===(t=this.processDataPoint.completedData)||void 0===t?void 0:t.donationIds,u=null===(n=this.processDataPoint.completedData)||void 0===n?void 0:n.donationId;if(!l)return null;const d={amount:this.currencyService.toFloatUnformattedStr(this.donationDataPoint.total,this.donationDataPoint.currency),monthly:(null===(i=this.postDonationUpsellDataPoint)||void 0===i?void 0:i.isAccepted)||this.donationDataPoint.frequency===qn.MONTHLY,donationId:null!==(s=(null==c?void 0:c.join(","))||u)&&void 0!==s?s:"",currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency,lang:(0,Gt.Qk)(this.checkoutConfiguration.environmentConfig.locale)};r&&!o.redirect.includeSupporterData||(d.supporterFirstName=this.donorNameDataPoint.firstName,d.supporterLastName=this.donorNameDataPoint.lastName,d.supporterEmail=this.donorEmailDataPoint.email);const h=this.designationsDataPoint.selectedGoals.filter(((e,t)=>{var n;return null===(n=this.designationsDataPoint.selectedGoalsAvailability[t])||void 0===n?void 0:n.isAvailable}));d.designationName=h.map((e=>e.name)).join(",")||"",d.designationId=h.map((e=>e.id)).join(",")||"",(null===(a=this.processDataPoint.completedData)||void 0===a?void 0:a.tributeId)&&(d.tributeId=this.processDataPoint.completedData.tributeId);try{const e=this.createURL(l);for(const t in d)if(Object.prototype.hasOwnProperty.call(d,t)){const n=d[t];e.searchParams.append(t,String(n))}return e.toString()}catch(e){return console.error("Invalid redirect URL"),null}}canRedirect(){return!!this.getUrl()}tryRedirect(e){const t=this.getUrl();return t?new Promise((()=>{this.redirect(t,e)})):Promise.resolve()}redirect(e,t){t.disarmCloseGuard(),this.globalWindow.location.replace(e)}get isShowcase(){return this.checkoutConfiguration.infrastructureParams.showcase}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get postDonationUpsellDataPoint(){return this.checkoutState instanceof cT?this.checkoutState.postDonationUpsell.dataPoint:null}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}createURL(e){return"/"===e[0]&&(e=this.globalWindow.location.origin+e),/^https?:\/\//m.test(e)||(e="https://"+e),new URL(e)}resolveTargetConfig(){return this.checkoutConfiguration.checkoutType===Kn.PAGE&&this.checkoutConfiguration.campaignPage.thankYouScreen?this.checkoutConfiguration.campaignPage.thankYouScreen:this.checkoutConfiguration.campaign.config.thankYouScreen}}class bO extends Error{constructor(e){super(`Component "${e} doesnt defined, unable to preload`)}}class PO{constructor(e){this.componentsMap=e,this.componentImports=new Set}add(e){return this.assertComponentDefined(e),this.componentImports.add(this.componentsMap[e]),this}load(){for(const e of this.componentImports)e()}assertComponentDefined(e){if(!this.componentsMap[e])throw new bO(e)}}class NO{constructor(e,t){this.loadableComponents=e,this.campaignConfig=t}preload(){return this.configureLoadableComponents(),this.loadableComponents.load()}}var DO;!function(e){e.PHONE_INPUT="PrivacyPhoneInput"}(DO||(DO={}));class TO extends NO{configureLoadableComponents(){this.campaignConfig.showPhone&&this.loadableComponents.add(DO.PHONE_INPUT)}}const kO={[DO.PHONE_INPUT]:()=>Promise.all([n.e(624),n.e(842)]).then(n.bind(n,8842))};function IO(e){const t=new PO(kO);return new TO(t,e)}class _O{constructor(e,t,n){var i;this.componentsPreloader=e,this.checkoutState=t,this.showPaymentLoader=!1,this.askPageActiveTab=Ql.CAUSE,this.pagesOfQuestionsScreen=0,this.showCheckoutStepsSuccess=!1,this.cookiePreferencesModalShown=!1,this.cookiePreferencesModalInitiatorElement=null,this.isDonationFormVisibleTrackEventBlocked=!1,this._showCloseButton=!0,this.firstScreen=n.screens.firstScreen,this.unrestrictedExitScreens=n.screens.unrestrictedExitScreens,this.mobileExitScreens=n.screens.mobileExitScreens,this.alwaysRenderedScreens=n.screens.alwaysRenderedScreens,this.screensWithoutTributeBadge=n.screens.screensWithoutTributeBadge,this.mobileScreensWithoutAskTitle=n.screens.mobileScreensWithoutAskTitle,this.mobileScreensWithAskText=n.screens.mobileScreensWithAskText,this.mobileScreensWithoutFaqLinks=n.screens.mobileScreensWithoutFaqLinks,this.mobileScreensWithoutAskPage=n.screens.mobileScreensWithoutAskPage,this.screensWithoutAskOverlay=n.screens.screensWithoutAskOverlay,this.canNotGoBackScreens=n.screens.canNotGoBackScreens,this.alwaysShowCloseButtonScreens=n.screens.alwaysShowCloseButtonScreens,this.conditionallyShowCloseButtonScreens=n.screens.conditionallyShowCloseButtonScreens,this.finalUnavailableScreens=null===(i=null==n?void 0:n.screens)||void 0===i?void 0:i.finalUnavailableScreens}get showCloseButton(){return this._showCloseButton}get showFAQLinks(){return!0}preloadComponents(){return this.componentsPreloader.preload()}setCloseButtonVisibility(e,t){this._showCloseButton=!t.includes(this.firstScreen)&&this.conditionallyShowCloseButtonScreens.includes(e)||this.alwaysShowCloseButtonScreens.includes(e),this.checkoutState.syncUpdate()}setShowCheckoutStepsSuccess(e){this.showCheckoutStepsSuccess=e,this.checkoutState.syncUpdate()}isUnrestrictedExitScreen(e){return this.unrestrictedExitScreens.includes(e)}isMobileExitScreen(e){return this.mobileExitScreens.includes(e)}isScreenWithoutTributeBadge(e){return this.screensWithoutTributeBadge.includes(e)}isMobileScreenWithoutAskTitle(e){return this.mobileScreensWithoutAskTitle.includes(e)}isMobileScreenWithAskText(e){return this.mobileScreensWithAskText.includes(e)}isMobileScreenWithoutFaqLinks(e){return this.mobileScreensWithoutFaqLinks.includes(e)}isMobileScreenWithoutAskPage(e){return this.mobileScreensWithoutAskPage.includes(e)}isScreenWithoutAskOverlay(e){return this.screensWithoutAskOverlay.includes(e)}isCanNotGoBackScreen(e){return this.canNotGoBackScreens.includes(e)}isFinalAvailableScreen(e){return void 0!==this.finalUnavailableScreens&&!this.finalUnavailableScreens.includes(e)}}class OO extends _O{}const xO=[wl.THANK_YOU],wO=[],RO=[wl.THANK_YOU,wl.BLOCKED],MO=[wl.THANK_YOU],LO=[wl.THANK_YOU],FO=[],UO=[wl.THANK_YOU],jO=[],BO=[],GO=$u.CRYPTO_CURRENCY,qO=[...MO,$u.CRYPTO_CURRENCY],VO=[...FO,$u.CRYPTO_CURRENCY],HO=[...BO,$u.CRYPTO_CURRENCY],KO=[$u.CRYPTO_CURRENCY,wl.THANK_YOU,wl.BLOCKED],YO=[wl.COMMENT],zO=[...RO,wl.QUESTIONS,$u.CRYPTO_CURRENCY],WO=[...xO,$u.CRYPTO_CURRENCY],$O=[...UO],XO=[...jO],QO=[wl.THANK_YOU],ZO=[...wO],JO=[],ex="facebook",tx="twitter",nx="linkedin",ix="email";function sx(e,t){if(void 0!==t){let n="?";return e.includes("?")&&(n="&"),`${e}${n}ref=${t}`}return e}function ax(e,t,n,i,s){let a="";switch(e){case nx:return a=bi.stringify({mini:"true",url:sx(t,s),summary:n}),`https://www.linkedin.com/shareArticle?${a}`;case tx:return a=bi.stringify({url:sx(t,s),text:n}),`https://twitter.com/intent/tweet?${a}`;case ex:return a=bi.stringify({u:sx(t,s),quote:n}),`https://www.facebook.com/sharer.php?${a}`;case ix:return a=bi.stringify({body:_N([n,t],"\n"),subject:i||""}),`mailto:?${a}`;default:return""}}var ox,rx;!function(e){e.TWITTER="twitter",e.FACEBOOK="facebook",e.LINKEDIN="linkedin",e.EMAIL="email",e.MORE="more"}(ox||(ox={}));class lx{constructor(e){this.sharingApiParams=e}get isSharingEnabled(){const{email:e,twitter:t,linkedin:n,facebook:i,copyLink:s}=this.sharingChannels;return e||t||n||i||s}get sharingChannels(){return this.sharingApiParams.sharingChannels}get shareLink(){const e=this.sharingApiParams.sharingLink;return e?/^https?:\/\//m.test(e)?e:"https://"+e:window.location.href}get sharingText(){return this.sharingApiParams.sharingText||""}share(e,t,n){if(this.sharingApiParams.showcase)return;const i=this.getSharingLink(e,t,n);window.open(i,"_blank","location=yes,height=400,width=550,scrollbars=yes,status=yes")}getSharingLink(e,t,n){const i=function(e,t){const n=new URL(e),i={[Mg.FACEBOOK]:ox.FACEBOOK,[Mg.LINKEDIN]:ox.LINKEDIN,[Mg.TWITTER]:ox.TWITTER,[Mg.EMAIL]:ox.EMAIL,[Mg.MORE]:ox.MORE,[Mg.LINK]:null};return i[t]?(n.searchParams.set("sharingVendor",i[t]),n.toString()):e}(this.shareLink,e),s=this.sharingApiParams.sharingText||"";switch(e){case Mg.TWITTER:return ax(tx,i,s,void 0,n);case Mg.LINKEDIN:return ax(nx,i,s,void 0,n);case Mg.FACEBOOK:return ax(ex,i,s,void 0,n);case Mg.EMAIL:return ax(ix,i,s,t);case Mg.MORE:return i;case Mg.LINK:return this.shareLink;default:throw new Error(`Unknown sharing type ${e}`)}}}function cx(e){var t;return e.checkoutType===Kn.PAGE&&(null===(t=e.campaignConfig)||void 0===t?void 0:t.campaignPage)?new lx({sharingChannels:Object.assign(Object.assign({},e.campaignConfig.campaignPage.thankYouScreen.sharing.channels),{copyLink:!1}),sharingLink:e.campaignConfig.campaignPage.thankYouScreen.sharing.link,showcase:e.isShowcase,sharingText:e.campaignConfig.campaignPage.thankYouScreen.sharing.text}):new lx({sharingChannels:Object.assign(Object.assign({},e.campaignConfig.thankYouScreen.sharing.channels),{copyLink:!1}),sharingLink:e.campaignConfig.thankYouScreen.sharing.link,showcase:e.isShowcase,sharingText:e.campaignConfig.thankYouScreen.sharing.text})}!function(e){e.PENDING_STATE_CHANGED="pendingStateChanged",e.SUBMIT="submit",e.SKIP="skip"}(rx||(rx={}));class ux extends zD{constructor(e,{name:t},n){super(),this.flow=e,this.debug=n,this._pending=!1,this.updateListeners=new Set,this.name=t}get data(){return{}}get pending(){return this._pending}set pending(e){this._pending=e,this.emit(rx.PENDING_STATE_CHANGED,this._pending)}dispose(){this.removeUpdateListeners(),this.removeAllListeners()}onUpdate(e){this.updateListeners.add(e)}removeUpdateListener(e){this.updateListeners.delete(e)}beforeLeave(e){return Promise.resolve(!0)}beforeEnter(){return Promise.resolve()}getScreenData(){return{}}leave(){return this.flow.next()}submit(){this.emit(rx.SUBMIT)}skip(){this.emit(rx.SKIP)}syncUpdate(){this.triggerUpdate()}update(){this.scheduleUpdate()}triggerUpdate(){this.updateListeners.forEach((e=>e()))}scheduleUpdate(){void 0!==this.updateTimeout&&window.clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.triggerUpdate()}),ux.UPDATE_DEBOUNCE_MS)}removeUpdateListeners(){this.updateListeners.clear()}}ux.UPDATE_DEBOUNCE_MS=250;class dx extends ux{constructor(e){let{flow:t,name:n,checkoutService:i,checkoutState:s,debug:a,intl:o,subscriptionPeriodLabelsService:r,currencyService:l,experiments:c}=e;super(t,{name:n},a),this.checkoutService=i,this.checkoutState=s,this.intl=o,this.subscriptionPeriodLabelsService=r,this.currencyService=l,this.experiments=c,this.viewState=(0,Hs.Ay)(this.getInitialViewState(),(e=>e)),this.on(rx.PENDING_STATE_CHANGED,(e=>{"boolean"==typeof e&&this.setLocked(e)}))}getScreenData(){return this.viewState}leave(e){return this.name!==this.flow.getCurrentScreen().name?Promise.resolve():this.flow.next({getMandatoryAllowance:()=>this.checkoutService.shouldFindMandatoryScreen,direction:null==e?void 0:e.direction,omitBeforeLeave:null==e?void 0:e.omitBeforeLeave})}produceViewState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.viewState=(0,Hs.Ay)(this.viewState,e),t||this.syncUpdate()}setLocked(e){e?(this.flow.lock(),this.produceViewState((e=>{e.locked=!0}))):(this.flow.unlock(),this.produceViewState((e=>{e.locked=!1})))}withPending(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.pending=!0;const t=yield e();return this.pending=!1,t}))}}class hx extends dx{getInitialViewState(){return{locked:!1}}}class mx extends dx{beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState.comment.setIsRequired(!1),this.produceViewState((e=>{e.comment=this.commentDataPoint.comment}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.updateSession({canUseAmountDefaults:!0}),!0}))}setComment(e){this.produceViewState((t=>{t.comment=e}))}submitComment(){this.checkoutState.comment.saveComment(this.viewState.comment),this.leave({direction:ku.BACKWARD})}getInitialViewState(){return{locked:!1,comment:""}}get commentDataPoint(){return this.checkoutState.comment.dataPoint}}const px=(e=16,t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")=>{let n="";for(let i=0;i<e;i+=1)n+=t[Math.floor(Math.random()*t.length)];return n};var gx=n(211);class yx extends dx{constructor(e,t,n,i){super(i),this.countriesService=e,this.mailingAddressCustomization=t,this.tracker=n,this.addressSessionToken=px()}get isOnBehalfOf(){return this.checkoutState.privacy.onBehalfOfDataPoint.isOnBehalfOf}get isCountryFieldDisabled(){return Mk(this.checkoutService.checkoutConfiguration)||Rk(this.checkoutService.checkoutConfiguration)}getStates(e){return this.mailingAddressCustomization.getPredefinedRegions({country:e})}getAriaErrorMessage(e){return this.intl.translate("mailingAddressScreen.addressForm.error.required",{field:e})}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutState instanceof cT){const e=this.flow.getHistoricalScreens(),t=this.checkoutState.benefits.dataPoint.isDeliveryRequired,n=e.includes(Vn.PAYMENT_OPTIONS)||e.includes(Vn.FAST_TRACK_PAYMENT_OPTIONS),i=!t&&!this.mailingAddressDataPoint.isRequired;if(!n&&i)return this.flow.prev()}this.checkoutState.mailingAddress.setSkipped(!1);const e=this.countriesService.getMailingAddressCountriesList();if(this.produceViewState((t=>{var n,i,s,a,o;t.isRequired=this.mailingAddressDataPoint.isRequired,t.isEnabled=this.mailingAddressDataPoint.isEnabled,t.isPaymentScreen=this.isPaymentScreen,t.isCryptoFlow=this.isCryptoFlow,t.line1=this.mailingAddressDataPoint.line1,t.line2=this.mailingAddressDataPoint.line2,t.postal=this.mailingAddressDataPoint.postal,t.city=this.mailingAddressDataPoint.city,t.region=this.mailingAddressDataPoint.region,t.sublocality=null!==(n=this.mailingAddressDataPoint.sublocality)&&void 0!==n?n:"",t.administrativeArea=null!==(i=this.mailingAddressDataPoint.administrativeArea)&&void 0!==i?i:"",t.countryCode=this.mailingAddressDataPoint.countryCode,t.countryName=null!==(a=null===(s=e.find((e=>e.countryCode===this.mailingAddressDataPoint.countryCode)))||void 0===s?void 0:s.countryName)&&void 0!==a?a:"",t.countries=e,t.isRegionEnabled=this.isRegionEnabled(this.mailingAddressDataPoint.countryCode),t.isLayoutPostalCodeFirst=this.isLayoutPostalCodeFirst(this.mailingAddressDataPoint.countryCode),t.isAlternativeLabels=this.isAlternativeLabels(this.mailingAddressDataPoint.countryCode),t.isSublocalityVisible=this.isSublocalityVisible(this.mailingAddressDataPoint.countryCode),t.isAdministrativeAreaVisible=this.isAdministrativeAreaVisible(this.mailingAddressDataPoint.countryCode),t.benefitIsRegionEnabled=this.isRegionEnabled(this.mailingAddressDataPoint.countryCode),t.benefitIsLayoutPostalCodeFirst=this.isLayoutPostalCodeFirst(this.mailingAddressDataPoint.countryCode),t.isPostalCodeVisible=this.isPostalCodeVisible(this.mailingAddressDataPoint.countryCode),t.formattedAmount=this.intl.formatCurrency(null!==(o=this.donationDataPoint.total)&&void 0!==o?o:0,{currency:this.donationDataPoint.currency,display:"trimzeroes"}),t.frequency=this.donationDataPoint.frequency})),this.checkoutState instanceof cT){const e=this.checkoutState.benefits,t=this.checkoutState.privacy.donorNameDataPoint;e.setFullNameIfEmpty(t.fullName),!this.mailingAddressDataPoint.isEnabled&&e.dataPoint.isDeliveryRequired&&this.setBenefitDeliveryUsed(!0),this.produceViewState((t=>{var n,i,s;t.benefitDeliveryAddress.isEnabled=e.dataPoint.isEnabled,t.benefitDeliveryAddress.isRequired=e.dataPoint.isDeliveryRequired,t.benefitDeliveryAddress.isUsed=e.dataPoint.isDeliveryUsed,t.benefitDeliveryAddress.region=e.dataPoint.region,t.benefitDeliveryAddress.city=e.dataPoint.city,t.benefitDeliveryAddress.postal=e.dataPoint.postal,t.benefitDeliveryAddress.countryCode=e.dataPoint.countryCode,t.benefitDeliveryAddress.line1=e.dataPoint.line1,t.benefitDeliveryAddress.line2=e.dataPoint.line2,t.benefitDeliveryAddress.firstName=e.dataPoint.firstName,t.benefitDeliveryAddress.lastName=e.dataPoint.lastName,t.benefitDeliveryAddress.sublocality=e.dataPoint.sublocality,t.benefitDeliveryAddress.administrativeArea=e.dataPoint.administrativeArea,t.benefitDeliveryAddress.regionConstraint=null!==(s=null===(i=null===(n=e.dataPoint.chosenBenefit)||void 0===n?void 0:n.delivery)||void 0===i?void 0:i.country)&&void 0!==s?s:null,t.benefitIsRegionEnabled=this.isRegionEnabled(e.dataPoint.countryCode),t.benefitIsLayoutPostalCodeFirst=this.isLayoutPostalCodeFirst(e.dataPoint.countryCode),t.isBenefitPostalCodeVisible=this.isPostalCodeVisible(e.dataPoint.countryCode)}))}this.processDataPoint.hasMailingAddressError&&(this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage,e.additionalPayErrorMessage=this.checkoutService.additionalPayErrorMessage})),this.checkoutState.process.setInProgress())}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s,a,o,r,l;if(this.pending)return!1;this.pending=!0;const c=null!==(t=null===(e=this.benefitsDataPoint)||void 0===e?void 0:e.isDeliveryRequired)&&void 0!==t&&t,u=null!==(i=null===(n=this.benefitsDataPoint)||void 0===n?void 0:n.isDeliveryUsed)&&void 0!==i&&i,d=c&&!u,h=u?null===(s=this.benefitsDataPoint)||void 0===s?void 0:s.countryCode:this.mailingAddressDataPoint.countryCode,m=!!(null===(o=null===(a=this.benefitsDataPoint)||void 0===a?void 0:a.chosenBenefit)||void 0===o?void 0:o.delivery.country)&&!!h&&h!==(null===(l=null===(r=this.benefitsDataPoint)||void 0===r?void 0:r.chosenBenefit)||void 0===l?void 0:l.delivery.country),p=this.validateMailingAddressOnClient(d),g=this.validateBenefitDeliveryAddressOnClient(m);if(!p||!g)return this.pending=!1,!1;if(!d&&p&&this.produceViewState((e=>{e.validation=wI.defaultValidationResult})),!(yield this.validateMailingAddressOnServer(d)))return this.pending=!1,!1;const y=this.removeChosenBenefitAndDeliveryAddressIfRestrictionMismatch(c,m);return(yield this.validateBenefitDeliveryAddressOnServer())?(d&&!y&&this.forceSaveBenefitDeliveryAddress(),this.checkoutService.updateSession(),this.isPaymentScreen?this.pay():(this.pending=!1,!0)):(this.pending=!1,!1)}))}skip(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.pending=!0,this.checkoutState instanceof cT&&(this.checkoutState.benefits.removeChosenBenefit(),this.checkoutState.benefits.resetDeliveryAddress()),this.checkoutState.mailingAddress.setSkipped(!0),this.checkoutService.updateSession(),this.isPaymentScreen?(yield this.pay())?this.leave({omitBeforeLeave:!0}):void 0:(this.pending=!1,this.leave({omitBeforeLeave:!0}))}))}search(e,t){return(0,d.sH)(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){if(!n.isAutocompleteEnabled())return;if(!n.isGetPlacesDataValid(e))return;n.produceViewState((e=>{e.isLoadingPlaces=!0}));const s=yield n.getPlaces(e,t,i);n.produceViewState((e=>{const t=n.sanitizePlaces(s);i?e.benefitPlaces=t:e.places=t,e.isLoadingPlaces=!1}))}()}))}getPlaceById(e){const t=this.viewState.places.find((t=>t.innerId===e));if(!t)throw new Error(`No place with selected innerId "${e}"`);return t}getBenefitPlaceById(e){const t=this.viewState.benefitPlaces.find((t=>t.innerId===e));if(!t)throw new Error(`No place with selected innerId "${e}"`);return t}shouldFindSubplaces(e){return this.mailingAddressDataPoint.hasSubplacesToFind(e)}retrieveSubplaces(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){const n="line1"===t?this.viewState.line1:this.viewState.postal;return this.search(n,e)}))}retrieveDetails(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n;let i;try{i=yield this.mailingAddressDataPoint.getDetails(e,this.addressSessionToken)}finally{this.addressSessionToken=px()}this.setLine1(i.line1),this.setCity(i.city),this.isPostalCodeAutocompleteEnabled(this.mailingAddressDataPoint.countryCode)&&this.setPostal(i.postal),"string"==typeof i.line2&&this.setLine2(i.line2),i.region&&this.setRegion(i.region),i.countryCode===Ci.MEXICO&&(this.setSublocality(null!==(t=i.sublocality)&&void 0!==t?t:""),this.setAdministrativeArea(null!==(n=i.administrativeArea)&&void 0!==n?n:"")),this.produceViewState((e=>{var t,n;e.line1=this.mailingAddressDataPoint.line1,e.line2=this.mailingAddressDataPoint.line2,e.city=this.mailingAddressDataPoint.city,e.region=this.mailingAddressDataPoint.region,e.postal=this.mailingAddressDataPoint.postal,e.validation=wI.defaultValidationResult,e.sublocality=null!==(t=this.mailingAddressDataPoint.sublocality)&&void 0!==t?t:"",e.administrativeArea=null!==(n=this.mailingAddressDataPoint.administrativeArea)&&void 0!==n?n:""}))}))}changeLine1(e){this.setLine1(e),this.produceViewState((e=>{e.validation.fields.line1.isValid||(e.validation.fields.line1=wI.defaultValidationResult.fields.line1),e.line1=this.mailingAddressDataPoint.line1}))}changeLine2(e){this.setLine2(e),this.produceViewState((e=>{e.validation.fields.line2.isValid||(e.validation.fields.line2=wI.defaultValidationResult.fields.line2),e.line2=this.mailingAddressDataPoint.line2}))}changeCity(e){this.setCity(e),this.produceViewState((e=>{e.validation.fields.city.isValid||(e.validation.fields.city=wI.defaultValidationResult.fields.city),e.city=this.mailingAddressDataPoint.city}))}changeRegion(e){this.setRegion(e),this.produceViewState((e=>{e.validation.fields.region.isValid||(e.validation.fields.region=wI.defaultValidationResult.fields.region),e.region=this.mailingAddressDataPoint.region}))}changePostalCode(e){this.setPostal(e),this.produceViewState((e=>{e.validation.fields.postal.isValid||(e.validation.fields.postal=wI.defaultValidationResult.fields.postal),e.postal=this.mailingAddressDataPoint.postal}))}changeSublocality(e){this.setSublocality(e),this.produceViewState((e=>{var t;e.validation.fields.sublocality.isValid||(e.validation.fields.sublocality=wI.defaultValidationResult.fields.sublocality),e.sublocality=null!==(t=this.mailingAddressDataPoint.sublocality)&&void 0!==t?t:""}))}changeAdministrativeArea(e){this.setAdministrativeArea(e),this.produceViewState((e=>{var t;e.validation.fields.administrativeArea.isValid||(e.validation.fields.administrativeArea=wI.defaultValidationResult.fields.administrativeArea),e.administrativeArea=null!==(t=this.mailingAddressDataPoint.administrativeArea)&&void 0!==t?t:""}))}changeSelectedCountry(e){const t=this.isLayoutPostalCodeFirst(this.mailingAddressDataPoint.countryCode),n=this.isRegionEnabled(this.mailingAddressDataPoint.countryCode),i=this.viewState.countries.find((t=>t.countryCode===e));i&&(this.setCountryCode(e),this.setRegion(this.getPredefinedMailingAddressRegion(e,t,n)),this.produceViewState((t=>{t.countryCode=this.mailingAddressDataPoint.countryCode,t.countryName=i.countryName,t.region=this.mailingAddressDataPoint.region,t.places.splice(0,t.places.length),t.isRegionEnabled=this.isRegionEnabled(this.mailingAddressDataPoint.countryCode),t.isLayoutPostalCodeFirst=this.isLayoutPostalCodeFirst(this.mailingAddressDataPoint.countryCode),t.isAlternativeLabels=this.isAlternativeLabels(e),t.isSublocalityVisible=this.isSublocalityVisible(e),t.isAdministrativeAreaVisible=this.isAdministrativeAreaVisible(e),t.isPostalCodeVisible=this.isPostalCodeVisible(e)})))}getPredefinedMailingAddressRegion(e,t,n){return this.getPredefinedRegion(e,t,n,this.mailingAddressDataPoint.countryCode,this.mailingAddressDataPoint.region)}getPredefinedBenefitAddressRegion(e,t,n){return this.benefitsDataPoint?this.getPredefinedRegion(e,t,n,this.benefitsDataPoint.countryCode,this.benefitsDataPoint.region):""}shouldFindBenefitSubplaces(e){var t,n;return null!==(n=null===(t=this.benefitsDataPoint)||void 0===t?void 0:t.hasSubplacesToFind(e))&&void 0!==n&&n}retrieveBenefitSubplaces(e,t){const n="line1"===t?this.viewState.benefitDeliveryAddress.line1:this.viewState.benefitDeliveryAddress.postal;return this.search(n,e,!0)}retrieveBenefitDetails(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n;if(!this.benefitsDataPoint)return;let i;try{i=yield this.benefitsDataPoint.getDetails(e,this.addressSessionToken)}finally{this.addressSessionToken=px()}this.setBenefitLine1(i.line1),this.setBenefitCity(i.city),this.isPostalCodeAutocompleteEnabled(this.benefitsDataPoint.countryCode)&&this.setBenefitPostal(i.postal),"string"==typeof i.line2&&this.setBenefitLine2(i.line2),i.region&&this.setBenefitRegion(i.region),i.countryCode===Ci.MEXICO&&(this.setBenefitSublocality(null!==(t=i.sublocality)&&void 0!==t?t:""),this.setBenefitAdministrativeArea(null!==(n=i.administrativeArea)&&void 0!==n?n:"")),this.produceViewState((e=>{this.benefitsDataPoint&&(e.benefitDeliveryAddress.line1=this.benefitsDataPoint.line1,e.benefitDeliveryAddress.line2=this.benefitsDataPoint.line2,e.benefitDeliveryAddress.city=this.benefitsDataPoint.city,e.benefitDeliveryAddress.region=this.benefitsDataPoint.region,e.benefitDeliveryAddress.postal=this.benefitsDataPoint.postal,e.benefitValidation=Lk.defaultValidationResult,e.benefitDeliveryAddress.sublocality=this.benefitsDataPoint.sublocality,e.benefitDeliveryAddress.administrativeArea=this.benefitsDataPoint.administrativeArea)}))}))}changeBenefitDeliveryUsed(e){this.setBenefitDeliveryUsed(e),this.produceViewState((t=>{t.benefitDeliveryAddress.isUsed=e}))}changeBenefitFirstName(e){this.setBenefitFirstName(e),this.produceViewState((t=>{t.benefitValidation.fields.firstName.isValid||(t.benefitValidation.fields.firstName=Lk.defaultValidationResult.fields.firstName),t.benefitDeliveryAddress.firstName=e}))}changeBenefitLastName(e){this.setBenefitLastName(e),this.produceViewState((t=>{t.benefitValidation.fields.lastName.isValid||(t.benefitValidation.fields.lastName=Lk.defaultValidationResult.fields.lastName),t.benefitDeliveryAddress.lastName=e}))}changeBenefitLine1(e){this.setBenefitLine1(e),this.produceViewState((t=>{t.benefitValidation.fields.line1.isValid||(t.benefitValidation.fields.line1=Lk.defaultValidationResult.fields.line1),t.benefitDeliveryAddress.line1=e}))}changeBenefitLine2(e){this.setBenefitLine2(e),this.produceViewState((t=>{t.benefitValidation.fields.line2.isValid||(t.benefitValidation.fields.line2=Lk.defaultValidationResult.fields.line2),t.benefitDeliveryAddress.line2=e}))}changeBenefitCity(e){this.setBenefitCity(e),this.produceViewState((t=>{t.benefitValidation.fields.city.isValid||(t.benefitValidation.fields.city=Lk.defaultValidationResult.fields.city),t.benefitDeliveryAddress.city=e}))}changeBenefitRegion(e){this.setBenefitRegion(e),this.produceViewState((t=>{t.benefitValidation.fields.region.isValid||(t.benefitValidation.fields.region=Lk.defaultValidationResult.fields.region),t.benefitDeliveryAddress.region=e}))}changeBenefitPostal(e){this.setBenefitPostal(e),this.produceViewState((t=>{t.benefitValidation.fields.postal.isValid||(t.benefitValidation.fields.postal=Lk.defaultValidationResult.fields.postal),t.benefitDeliveryAddress.postal=e}))}changeBenefitCountryCode(e){if(!this.benefitsDataPoint)return;const t=this.isLayoutPostalCodeFirst(this.benefitsDataPoint.countryCode),n=this.isRegionEnabled(this.benefitsDataPoint.countryCode),i=this.viewState.countries.find((t=>t.countryCode===e));i&&(this.setBenefitCountryCode(e),this.setBenefitRegion(this.getPredefinedBenefitAddressRegion(e,t,n)),this.produceViewState((s=>{s.benefitValidation.fields.countryCode.isValid||(s.benefitValidation.fields.countryCode=Lk.defaultValidationResult.fields.countryCode),s.benefitDeliveryAddress.countryCode=e,s.benefitDeliveryAddress.countryName=i.countryName,s.benefitDeliveryAddress.region=this.getPredefinedBenefitAddressRegion(e,t,n),s.benefitIsLayoutPostalCodeFirst=this.isLayoutPostalCodeFirst(e),s.benefitIsRegionEnabled=this.isRegionEnabled(e),s.isBenefitPostalCodeVisible=this.isPostalCodeVisible(e)})))}changeBenefitSublocality(e){this.setBenefitSublocality(e),this.produceViewState((t=>{t.benefitValidation.fields.sublocality.isValid||(t.benefitValidation.fields.sublocality=Lk.defaultValidationResult.fields.sublocality),t.benefitDeliveryAddress.sublocality=e}))}changeBenefitAdministrativeArea(e){this.setBenefitAdministrativeArea(e),this.produceViewState((t=>{t.benefitValidation.fields.administrativeArea.isValid||(t.benefitValidation.fields.administrativeArea=Lk.defaultValidationResult.fields.administrativeArea),t.benefitDeliveryAddress.administrativeArea=e}))}trackBenefitDeliveryCountryIsIncorrect(){this.tracker.trackCheckoutCustomEvent({type:Ee.BENEFIT_DELIVERY_COUNTRY_IS_INCORRECT})}getInitialViewState(){return{locked:!1,isRequired:!1,isEnabled:!1,isPaymentScreen:!0,isCryptoFlow:!1,processingState:Xl.IDLE,hasServerValidationError:!1,line1:"",line2:"",city:"",region:"",postal:"",countryCode:Ci.UNITED_STATES_OF_AMERICA,countryName:"",sublocality:"",administrativeArea:"",isLayoutPostalCodeFirst:!1,isRegionEnabled:!1,isAlternativeLabels:!1,isSublocalityVisible:!1,isAdministrativeAreaVisible:!1,benefitIsLayoutPostalCodeFirst:!1,benefitIsRegionEnabled:!1,isPostalCodeVisible:!0,isBenefitPostalCodeVisible:!0,countries:[],places:[],benefitPlaces:[],isLoadingPlaces:!1,shakeKey:0,validation:wI.defaultValidationResult,benefitValidation:Lk.defaultValidationResult,formattedAmount:"",frequency:qn.MONTHLY,benefitDeliveryAddress:{isRequired:!1,isEnabled:!1,isUsed:!1,regionConstraint:null,firstName:"",lastName:"",line1:"",line2:"",city:"",region:"",postal:"",countryCode:Ci.UNITED_STATES_OF_AMERICA,countryName:"",sublocality:"",administrativeArea:""}}}get processDataPoint(){return this.checkoutState.process.dataPoint}get mailingAddressDataPoint(){return this.checkoutState.mailingAddress.dataPoint}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}get isCryptoFlow(){return this.checkoutService.type===$n.CRYPTO}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get benefitsStateController(){return this.checkoutState instanceof cT?this.checkoutState.benefits:null}get benefitsDataPoint(){var e,t;return null!==(t=null===(e=this.benefitsStateController)||void 0===e?void 0:e.dataPoint)&&void 0!==t?t:null}isLayoutPostalCodeFirst(e){return this.mailingAddressCustomization.isLayoutPostalCodeFirst({country:e})}isRegionEnabled(e){return this.mailingAddressCustomization.isRegionEnabled({country:e})}isPostalCodeVisible(e){return this.mailingAddressCustomization.isPostalCodeVisible({country:e})}isPostalCodeAutocompleteEnabled(e){return this.mailingAddressCustomization.isPostalCodeAutocompleteEnabled({country:e})}isAlternativeLabels(e){return this.mailingAddressCustomization.isAlternativeLabels({country:e})}isSublocalityVisible(e){return e===Ci.MEXICO}isAdministrativeAreaVisible(e){return e===Ci.MEXICO}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}validateMailingAddressOnClient(e){const t=this.mailingAddressDataPoint.getValidationResult(e);return!!t.isValid||(this.produceViewState((e=>{e.validation=t,e.shakeKey+=1})),this.pending=!1,!1)}validateMailingAddressOnServer(e){return(0,d.sH)(this,void 0,void 0,(function*(){return!this.mailingAddressDataPoint.isServerValidationRequired(e)||(this.pending=!0,this.setProcessingState(Xl.PENDING),(yield this.mailingAddressDataPoint.getAddressValidationResult())?(this.setProcessingState(Xl.SUCCESS),this.pending=!1,!0):(this.produceViewState((e=>{e.shakeKey+=1,e.hasServerValidationError=!0})),this.setProcessingState(Xl.ERROR),this.pending=!1,!1))}))}validateBenefitDeliveryAddressOnClient(e){if(e)return!0;if(this.checkoutState instanceof cT){const e=this.checkoutState.benefits;if(!e.dataPoint.isDeliveryUsed)return!0;const t=e.dataPoint.getValidationResult();if(!t.isValid)return this.produceViewState((e=>{e.benefitValidation=t,e.shakeKey+=1})),!1}return!0}validateBenefitDeliveryAddressOnServer(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!(this.checkoutState instanceof cT))return!0;const e=this.checkoutState.benefits;return!e.dataPoint.isDeliveryUsed||(!e.dataPoint.isServerValidationRequired()||(this.pending=!0,this.setProcessingState(Xl.PENDING),(yield e.dataPoint.getAddressValidationResult())?(this.setProcessingState(Xl.SUCCESS),this.pending=!1,!0):(this.produceViewState((e=>{e.shakeKey+=1,e.hasServerValidationError=!0})),this.setProcessingState(Xl.ERROR),!1)))}))}removeChosenBenefitAndDeliveryAddressIfRestrictionMismatch(e,t){const n=e&&t;return n&&this.checkoutState instanceof cT&&(this.checkoutState.benefits.removeChosenBenefit(),this.checkoutState.benefits.resetDeliveryAddress()),n}forceSaveBenefitDeliveryAddress(){var e;this.setBenefitCountryCode(this.mailingAddressDataPoint.countryCode),this.setBenefitRegion(this.mailingAddressDataPoint.region),this.setBenefitCity(this.mailingAddressDataPoint.city),this.setBenefitPostal(this.mailingAddressDataPoint.postal),this.setBenefitLine1(this.mailingAddressDataPoint.line1),this.setBenefitLine2(this.mailingAddressDataPoint.line2),null===(e=this.benefitsDataPoint)||void 0===e||e.getAddressValidationResult()}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){this.pending=!0,this.setProcessingState(Xl.PENDING);const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(e)?(this.isCryptoFlow||(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave)),this.pending=!1,!0):e.failureResult.shouldLeave?(this.pending=!1,!0):(this.produceViewState((e=>{e.payErrorMessage=this.checkoutService.payErrorMessage,e.additionalPayErrorMessage=this.checkoutService.additionalPayErrorMessage})),this.setProcessingState(Xl.ERROR),this.pending=!1,!1)}))}getPlaces(e,t){return(0,d.sH)(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){const s={input:n.prepareGetPlacesText(e),restrictCountries:i?[n.viewState.benefitDeliveryAddress.countryCode]:[n.viewState.countryCode],sessionToken:n.addressSessionToken},a=i&&n.benefitsDataPoint;return t?a?n.benefitsDataPoint.getSubplaces(Object.assign({place:t},s)):n.mailingAddressDataPoint.getSubplaces(Object.assign({place:t},s)):a?n.benefitsDataPoint.getPlaces(Object.assign({},s)):n.mailingAddressDataPoint.getPlaces(Object.assign({},s))}()}))}getPredefinedRegion(e,t,n,i,s){var a,o;const r=this.getStates(e);if(r){if(Array.isArray(r))return null===(a=r[0])||void 0===a?void 0:a.code;const e=r[Object.keys(r)[0]],t=null===(o=null==e?void 0:e[0])||void 0===o?void 0:o.code;if(t)return t}const l=this.isLayoutPostalCodeFirst(i),c=this.isRegionEnabled(i);return t!==l||n!==c?"":s}sanitizePlaces(e){const t=[];for(const n of e)t.push(Object.assign(Object.assign({},n),{innerId:(0,gx.Ak)()}));return t}isAutocompleteEnabled(){return this.mailingAddressCustomization.isAutocompleteEnabled({company:this.checkoutService.checkoutConfiguration.company.key})}isGetPlacesDataValid(e){return Boolean(this.prepareGetPlacesText(e))&&Boolean(this.addressSessionToken)}prepareGetPlacesText(e){return e.trim()}setLine1(e){this.checkoutState.mailingAddress.setLine1(e)}setLine2(e){this.checkoutState.mailingAddress.setLine2(e)}setCity(e){this.checkoutState.mailingAddress.setCity(e)}setCountryCode(e){this.checkoutState.mailingAddress.setCountryCode(e)}setRegion(e){this.checkoutState.mailingAddress.setRegion(e)}setPostal(e){this.checkoutState.mailingAddress.setPostal(e)}setSublocality(e){this.checkoutState.mailingAddress.setSublocality(e)}setAdministrativeArea(e){this.checkoutState.mailingAddress.setAdministrativeArea(e)}setBenefitDeliveryUsed(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setDeliveryUsed(e)}setBenefitFirstName(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setFirstName(e)}setBenefitLastName(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setLastName(e)}setBenefitLine1(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setLine1(e)}setBenefitLine2(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setLine2(e)}setBenefitCity(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setCity(e)}setBenefitRegion(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setRegion(e)}setBenefitPostal(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setPostal(e)}setBenefitCountryCode(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setCountryCode(e)}setBenefitSublocality(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setSublocality(e)}setBenefitAdministrativeArea(e){this.checkoutState instanceof cT&&this.checkoutState.benefits.setAdministrativeArea(e)}}class fx extends dx{beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){const e={};for(const[t,n]of Object.entries(this.mandatoryQuestions))e[t]={key:n.key,type:n.type,required:n.required,code:n.code,question:n.question,answer:n.answer,options:[...n.options],id:n.id,createdAt:n.createdAt};this.produceViewState((t=>{t.mandatoryQuestions=e}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.isMandatoryQuestionsValid;return e.isValid?(this.checkoutService.updateSession(),!0):(this.produceViewState((t=>{for(const[n,{isValid:i}]of Object.entries(e.fields))t.questionErrors[n]=!i;t.shakeKey+=1})),!1)}))}answerMandatoryQuestion(e,t,n){this.checkoutState.questions.setAnswer(e,t);const i=this.questionsDataPoint.getAnswer(e),s=this.mandatoryQuestions[n];this.produceViewState((t=>{t.questionErrors[e]=!1,t.mandatoryQuestions[n]=s?Object.assign(Object.assign({},s),{answer:i}):void 0}))}getInitialViewState(){return{locked:!1,mandatoryQuestions:{},questionErrors:{},shakeKey:0}}get mandatoryQuestions(){return this.questionsDataPoint.mandatoryQuestions}get questionsDataPoint(){return this.checkoutState.questions.dataPoint}get isMandatoryQuestionsValid(){return this.questionsDataPoint.isMandatoryQuestionsValid}}const vx=[Gn.APPLE_PAY,Gn.CARD,Gn.PAYPAL,Gn.GOOGLE_PAY,Gn.VENMO,Gn.US_BANK_ACCOUNT,Gn.UK_BACS,Gn.AU_BECS,Gn.ACSS,Gn.SEPA,Gn.IDEAL];function Sx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,i=0;for(const s of e)if(n++,s.visible&&i++,i===t)return n;return-1}const Ex=[{country:sn.NETHERLANDS,paymentMethod:Gn.IDEAL,targetShownPositionIndex:1},{country:sn.UNITED_KINGDOM,paymentMethod:Gn.UK_BACS,targetShownPositionIndex:1},{country:sn.GERMANY,paymentMethod:Gn.SEPA,targetShownPositionIndex:2}];class Ax{constructor(e){this.paymentMethodSorterParams=e}sort(e){const t=Object.entries(e).map((e=>{let[t,n]=e;return{paymentMethod:t,available:n.available,visible:n.visible}})),n=this.getDefaultSortedPaymentMethods(),i=t.sort(((e,t)=>(n.includes(e.paymentMethod)?n.indexOf(e.paymentMethod):1/0)-(n.includes(t.paymentMethod)?n.indexOf(t.paymentMethod):1/0)));return this.processSpecialCases(i),i}getDefaultSortedPaymentMethods(){return vx}processSpecialCases(e){var t;for(const{country:n,paymentMethod:i,targetShownPositionIndex:s}of Ex){if((null===(t=this.paymentMethodSorterParams)||void 0===t?void 0:t.specificCompanyCountry)!==n)continue;const a=Sx(e,s),o=e.findIndex((e=>e.paymentMethod===i)),r=e[o];e.splice(o,1),e.splice(a,0,r)}}}class Cx{constructor(e){this.checkoutConfiguration=e,this._paymentMethodSorter=null}get paymentMethodSorter(){return this._paymentMethodSorter||(this._paymentMethodSorter=new Ax({specificCompanyCountry:this.checkoutConfiguration.company.country})),this._paymentMethodSorter}getPaymentButtons(e){const t={available:[],visible:[]};return this.paymentMethodSorter.sort(e).forEach((e=>{let{paymentMethod:n,available:i,visible:s}=e;n===Gn.APPLE_PAY&&i&&(t.available.push(ch.APPLE_PAY),s&&t.visible.push(ch.APPLE_PAY)),n!==Gn.PAYPAL||this.checkoutConfiguration.campaign.config.phoneRequired||i&&(t.available.push(ch.PAYPAL),s&&t.visible.push(ch.PAYPAL)),n===Gn.GOOGLE_PAY&&i&&(t.available.push(ch.GOOGLE_PAY),s&&t.visible.push(ch.GOOGLE_PAY))})),t}}class bx extends dx{constructor(e){super(e),this._fastTrackPaymentOptionsViewService=null,this.paymentService=e.paymentService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.tryStartFastTrackExperiment(),this.tryToExposeFastTrackExperiment(),this.isFastTrackActive&&(this.resetFastTrackOptions(),this.syncPaymentButtons(),this.initializePaymentOptions()),this.produceViewState((e=>{var t;e.isPaymentScreen=this.isPaymentScreen,e.firstName=this.donorNameDataPoint.firstName,e.lastName=this.donorNameDataPoint.lastName,e.email=this.donorEmailDataPoint.email,e.emailConsent.isEnabled=this.donorEmailDataPoint.emailConsent.isEnabled,e.showPhone=this.phoneNumberDataPoint.isEnabled,e.phoneRequired=this.phoneNumberDataPoint.isRequired,e.phone=this.phoneNumberDataPoint.phone,e.phoneLegalText=this.phoneNumberDataPoint.phoneLegalText,e.showPhoneLegalText=this.phoneNumberDataPoint.isLegalTextEnabled,e.userCountryCode=this.phoneNumberDataPoint.countryCode,e.showAnonymous=this.donateAnonymousDataPoint.isEnabled,e.anonymousChecked=this.donateAnonymousDataPoint.isAnonymousChecked,e.processingState=Xl.IDLE,e.generalConsent={isAccepted:this.communicationConsentDataPoint.generalConsent.isAccepted,isEnabled:this.communicationConsentDataPoint.isGeneralConsentEnabled},e.onBehalfOf.companyName=this.onBehalfOfDataPoint.companyName,e.onBehalfOf.isEnabled=this.onBehalfOfDataPoint.isEnabled,e.onBehalfOf.isActive=this.onBehalfOfDataPoint.isActive,e.termsAndConditions.text=this.termsAndConditionsDataPoint.text,e.termsAndConditions.isEnabled=this.termsAndConditionsDataPoint.isEnabled,e.termsAndConditions.isAccepted=this.termsAndConditionsDataPoint.isAccepted;const{showPhone:n}=e,i=this.getAllOptionsEnabled({showPhone:n,showAnonymous:e.showAnonymous,showMailingListSubscription:e.mailingListSubscription.show,showTermsAndConditions:e.termsAndConditions.isEnabled,customerTitleEnabled:this.customerTitleDataPoint.isEnabled,onBehalfOfEnabled:e.onBehalfOf.isEnabled});e.allOptionsEnabled=i,e.customerTitle.title=this.customerTitleDataPoint.title,e.customerTitle.list=this.customerTitleDataPoint.titleList,e.customerTitle.isEnabled=this.customerTitleDataPoint.isEnabled,e.customerTitle.isRequired=this.customerTitleDataPoint.isRequired,e.donation.formattedAmount=this.intl.formatCurrency(null!==(t=this.donationDataPoint.total)&&void 0!==t?t:0,{currency:this.donationDataPoint.currency,display:"trimzeroes"}),e.donation.frequency=this.donationDataPoint.frequency,e.autoFocus=this.getAutoFocusConfig(e.customerTitle.isEnabled),e.isPhoneCountryCodeDisabled=this.isCountryCodeDisabled()}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){var e;if(this.pending)return!1;this.pending=!0;let t=!1;if(null===(e=this.paymentOptionsDataPoint)||void 0===e?void 0:e.isFastTrackFlow)return this.setProcessingState(Xl.IDLE),this.pending=!1,!0;if(this.produceViewState((e=>{e.validation.customerTitle=this.customerTitleDataPoint.getValidationResult(),e.validation.donorName=this.donorNameDataPoint.getValidationResult(),e.validation.donorEmail=this.donorEmailDataPoint.getValidationResult(),e.validation.phone=this.phoneNumberDataPoint.getValidationResult(),e.validation.isAccepted=this.termsAndConditionsDataPoint.getValidationResult(),e.validation.onBehalfOf=this.onBehalfOfDataPoint.getValidationResult(),t=this.checkHasError(e),t&&(e.shakeKey+=1)})),t)return this.pending=!1,!1;this.setProcessingState(Xl.PENDING);const n=yield this.checkoutService.updateSession();if(wn.isFailure(n)&&n.failureResult.customerEmailError)return yield this.startServerErrorFlow(),!1;if(!this.isPaymentScreen)return this.setProcessingState(Xl.IDLE),this.pending=!1,!0;const i=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(i)?(this.isCryptoFlow||(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave)),this.pending=!1,!0):i.failureResult.shouldLeave?(this.pending=!1,!0):(this.produceViewState((e=>{e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText"),e.additionalPayErrorMessage=this.checkoutService.additionalPayErrorMessage||""})),this.setProcessingState(Xl.ERROR),this.pending=!1,!1)}))}changeCompanyName(e){this.checkoutState.privacy.setOnBehalfOfCompanyName(e),this.produceViewState((e=>{e.validation.onBehalfOf.isValid||(e.validation.onBehalfOf=RI.defaultValidationResult),e.onBehalfOf.companyName=this.onBehalfOfDataPoint.companyName}))}changeCustomerTitle(e){this.checkoutState.privacy.setDonorTitle(e),this.produceViewState((e=>{e.validation.customerTitle.isValid||(e.validation.customerTitle=DI.defaultValidationResult),e.customerTitle.title=this.customerTitleDataPoint.title}))}changeFirstName(e){this.checkoutState.privacy.setDonorFirstName(e),this.produceViewState((e=>{e.validation.donorName.fields.firstName.isValid||(e.validation.donorName.fields.firstName=II.defaultValidationResult.fields.firstName),e.firstName=this.donorNameDataPoint.firstName}))}changeLastName(e){this.checkoutState.privacy.setDonorLastName(e),this.produceViewState((e=>{e.validation.donorName.fields.lastName.isValid||(e.validation.donorName.fields.lastName=II.defaultValidationResult.fields.lastName),e.lastName=this.donorNameDataPoint.lastName}))}changeEmail(e){this.checkoutState.privacy.setDonorEmail(e),this.produceViewState((e=>{e.validation.donorEmail.fields.email.isValid||(e.validation.donorEmail.fields.email=kI.defaultValidationResult.fields.email),e.email=this.donorEmailDataPoint.email}))}changePhone(e){this.checkoutState.privacy.setPhoneNumber(e),this.produceViewState((e=>{e.validation.phone.isValid||(e.validation.phone=LI.defaultValidationResult),e.phone=this.phoneNumberDataPoint.phone}))}changePlainPhone(e){this.checkoutState.privacy.setPhoneCleanNumber(e)}changeCountryCode(e){this.checkoutState.privacy.setPhoneCountryCode(e),this.produceViewState((e=>{e.userCountryCode=this.phoneNumberDataPoint.countryCode}))}toggleOnBehalfOf(){this.checkoutState.privacy.setOnBehalfOfActive(!this.onBehalfOfDataPoint.isActive),this.produceViewState((e=>{e.onBehalfOf.isActive=this.onBehalfOfDataPoint.isActive,e.isPaymentScreen=this.isPaymentScreen}))}toggleTermsAndConditionsAccepted(){this.checkoutState.privacy.setTermsAndConditionsAccepted(!this.termsAndConditionsDataPoint.isAccepted),this.produceViewState((e=>{var t;(null===(t=e.validation.isAccepted)||void 0===t?void 0:t.isValid)||(e.validation.isAccepted=qI.defaultValidationResult),e.termsAndConditions.isAccepted=this.termsAndConditionsDataPoint.isAccepted}))}toggleAnonymousChecked(){this.checkoutState.privacy.setDonateAnonymousChecked(!this.donateAnonymousDataPoint.isAnonymousChecked),this.produceViewState((e=>{e.anonymousChecked=this.donateAnonymousDataPoint.isAnonymousChecked}))}toggleGeneralConsentChecked(e){this.checkoutState.communicationConsent.setGeneralConsentState(e),this.produceViewState((e=>{e.generalConsent.isAccepted=this.communicationConsentDataPoint.generalConsent.isAccepted}))}setGeneralConsentShown(){this.checkoutState.communicationConsent.setGeneralConsentShown()}clearEmailServerError(){this.produceViewState((e=>{e.serverErrors.email=!1,e.processingState=Xl.IDLE}))}chooseFastTrackPaymentOptionOrProceedToNextScreen(e){this.isFastTrackActive&&this.checkoutState instanceof cT&&(this.checkoutState.paymentOptions.setFastTrackFlow(!0),this.isFastTrackTestGroup1&&e&&(this.checkoutState.paymentOptions.setPreSelectedFastTrackPaymentOption(e),this.leave()),this.isFastTrackTestGroup2&&this.leave())}syncPaymentButtons(){this.syncButtonsAvailability()}isFastTrackEnabled(){return!!this.paymentOptionsDataPoint&&(this.fastTrackCampaignPagesExperiment.isEnabled({isCustomerTitleEnabled:this.checkoutState.privacy.customerTitleDataPoint.isEnabled,allowedPaymentMethods:this.paymentOptionsDataPoint.allowedPaymentMethods,isPhoneRequired:this.phoneNumberDataPoint.isRequired})?this.fastTrackCampaignPagesExperiment.isTestGroup:this.checkoutService.checkoutConfiguration.checkoutType===Kn.MODAL&&this.canFastTrackBeEnabled())}getInitialViewState(){return{shakeKey:0,validation:{customerTitle:DI.defaultValidationResult,donorName:II.defaultValidationResult,donorEmail:kI.defaultValidationResult,onBehalfOf:RI.defaultValidationResult,phone:LI.defaultValidationResult,isAccepted:qI.defaultValidationResult},serverErrors:{},showPhone:!1,phoneRequired:!1,showPhoneLegalText:!1,phoneLegalText:"",showAnonymous:!1,anonymousChecked:!1,mailingListSubscription:{checked:!1,show:!1,text:""},textIsVisible:!1,allOptionsEnabled:!1,firstName:"",lastName:"",email:"",emailConsent:{isEnabled:!1},phone:null,isPaymentScreen:!1,payErrorMessage:"",additionalPayErrorMessage:"",userCountryCode:sn.UNITED_STATES,processingState:Xl.IDLE,termsAndConditions:{isAccepted:!1,isEnabled:!1,text:""},onBehalfOf:{isEnabled:!1,isActive:!1,companyName:""},customerTitle:{title:Uk.NONE,list:[],isEnabled:!1,isRequired:!1},locked:!1,donation:{formattedAmount:"",frequency:qn.MONTHLY},autoFocus:this.createDefaultAutoFocusConfig(),generalConsent:{isAccepted:!1,isEnabled:!1},availableFastTrackPaymentOptions:[],fastTrackButtonOptions:Object.fromEntries(Object.values([ch.APPLE_PAY,ch.GOOGLE_PAY,ch.PAYPAL]).map((e=>[e,{visible:!1}])))}}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}get isFiatFlow(){return this.checkoutService.type===$n.MONEY}get isCryptoFlow(){return this.checkoutService.type===$n.CRYPTO}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get termsAndConditionsDataPoint(){return this.checkoutState.privacy.termsAndConditionsDataPoint}get phoneNumberDataPoint(){return this.checkoutState.privacy.phoneNumberDataPoint}get donateAnonymousDataPoint(){return this.checkoutState.privacy.donateAnonymousDataPoint}get onBehalfOfDataPoint(){return this.checkoutState.privacy.onBehalfOfDataPoint}get customerTitleDataPoint(){return this.checkoutState.privacy.customerTitleDataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get paymentOptionsDataPoint(){return this.checkoutState instanceof cT?this.checkoutState.paymentOptions.paymentOptionsDataPoint:null}get communicationConsentDataPoint(){return this.checkoutState.communicationConsent.dataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get isApplePay(){var e;return(null===(e=this.paymentOptionsDataPoint)||void 0===e?void 0:e.clientPaymentMethod)===Gn.APPLE_PAY}get isMobile(){return this.checkoutService.checkoutConfiguration.infrastructureParams.isMobile}get fastTrackPaymentOptionsViewService(){return this._fastTrackPaymentOptionsViewService||(this._fastTrackPaymentOptionsViewService=new Cx(this.checkoutService.checkoutConfiguration)),this._fastTrackPaymentOptionsViewService}get isFastTrackActive(){return this.checkoutService.checkoutConfiguration.checkoutType===Kn.MODAL?this.isFastTrackEnabled():this.fastTrackCampaignPagesExperiment.isTestGroup}get isFastTrackTestGroup1(){return this.checkoutService.checkoutConfiguration.checkoutType===Kn.MODAL?this.isFastTrackEnabled():this.fastTrackCampaignPagesExperiment.isTestGroup1}get isFastTrackTestGroup2(){return this.fastTrackCampaignPagesExperiment.isTestGroup2}get fastTrackCampaignPagesExperiment(){return this.experiments.get(u.FAST_TRACK_CAMPAIGN_PAGES_EXPERIMENT)}getAllOptionsEnabled(e){let{showPhone:t,showAnonymous:n,showMailingListSubscription:i,showTermsAndConditions:s,customerTitleEnabled:a,onBehalfOfEnabled:o}=e;return!!(a&&t&&o&&n&&i&&s)}checkHasError(e){return Object.keys(e.validation).some((t=>{const n=e.validation[t];return!!n&&!n.isValid}))}startServerErrorFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.serverErrors.email=!0,e.shakeKey+=1,e.processingState=Xl.ERROR})),this.pending=!1}))}setProcessingState(e){return this.produceViewState((t=>{t.processingState=e})),this}getAutoFocusConfig(e){const t=this.createDefaultAutoFocusConfig();return e&&(t.firstName=!1,t.customerTitle=!0),t}createDefaultAutoFocusConfig(){return{customerTitle:!1,firstName:!0}}syncButtonsAvailability(){if(!this.paymentOptionsDataPoint)return;const e=this.fastTrackPaymentOptionsViewService.getPaymentButtons(this.paymentOptionsDataPoint.allowedPaymentMethods);this.produceViewState((t=>{const n=e.available;Jo()(t.availableFastTrackPaymentOptions,n)||(t.availableFastTrackPaymentOptions=n);for(const[n,i]of Object.entries(t.fastTrackButtonOptions))i.visible=e.visible.some((e=>e===n))}))}resetFastTrackOptions(){this.checkoutState instanceof cT&&(this.checkoutState.paymentOptions.setPreSelectedFastTrackPaymentOption(null),this.checkoutState.paymentOptions.setFastTrackFlow(!1))}tryStartFastTrackExperiment(){this.paymentOptionsDataPoint&&this.fastTrackCampaignPagesExperiment.tryStart({isCustomerTitleEnabled:this.checkoutState.privacy.customerTitleDataPoint.isEnabled,allowedPaymentMethods:this.paymentOptionsDataPoint.allowedPaymentMethods,isPhoneRequired:this.phoneNumberDataPoint.isRequired})}tryToExposeFastTrackExperiment(){this.fastTrackCampaignPagesExperiment.tryToExpose()}isCountryCodeDisabled(){return Mk(this.checkoutService.checkoutConfiguration)||Rk(this.checkoutService.checkoutConfiguration)}initializePaymentOptions(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;yield null===(e=this.paymentService)||void 0===e?void 0:e.ensurePaymentMethodsInitialized(),this.syncPaymentButtons()}))}canFastTrackBeEnabled(){var e,t,n;if(!this.paymentOptionsDataPoint)return!1;if(!this.isMobile)return!1;if(this.donationDataPoint.frequency!==qn.ONCE)return!1;if(this.checkoutState.privacy.customerTitleDataPoint.isEnabled)return!1;const i=null===(e=this.paymentOptionsDataPoint.allowedPaymentMethods[Gn.GOOGLE_PAY])||void 0===e?void 0:e.visible,s=null===(t=this.paymentOptionsDataPoint.allowedPaymentMethods[Gn.APPLE_PAY])||void 0===t?void 0:t.visible,a=null===(n=this.paymentOptionsDataPoint.allowedPaymentMethods[Gn.PAYPAL])||void 0===n?void 0:n.visible;return!(!i&&!s&&a&&this.phoneNumberDataPoint.isRequired)&&(i||s||a)}}class Px extends dx{get showBackButton(){const e=1!==this.viewState.page||this.flow.canGoBack,t=this.checkoutService.checkoutConfiguration.infrastructureParams.isMobile;return{header:!t&&e,footer:t&&e}}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.questions=[...this.questionsDataPoint.questions.entries()].map((e=>{let[t,n]=e;return{key:t,type:n.type,required:n.required,code:n.code,question:n.question,answer:n.answer,page:null,options:[...n.options]}})),e.isMeasuring=!0}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.viewState.page,t=this.viewState.questions.filter((t=>{let{page:n}=t;return n===e})),n=this.questionsDataPoint.getQuestionsValidationResultByKeys(t.map((e=>{let{key:t}=e;return t})));return n.isValid?this.viewState.questions.some((t=>{let{page:n}=t;return null===n||n>e}))?(this.produceViewState((e=>{e.page+=1})),yield this.checkoutService.updateSession(),!1):(this.checkoutService.updateSession(),!0):(this.produceViewState((e=>{for(const[t,{isValid:i}]of Object.entries(n.fields))e.questionErrors[t]=!i;e.shakeKey+=1})),!1)}))}back(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.viewState.page;if(1===e&&this.flow.canGoBack)return this.flow.prev();this.produceViewState((t=>{for(const n of t.questions)n.page===e&&(t.questionErrors[n.key]=!1);t.page-=1}))}))}answerQuestion(e,t){this.checkoutState.questions.setAnswer(e,t),this.produceViewState((t=>{const n=t.questions.find((t=>t.key===e));if(!n)throw new Error(`No question with such key: "${e}"`);t.questionErrors[e]=!1;const i=this.questionsDataPoint.getAnswer(e);Array.isArray(i)?Array.isArray(n.answer)?n.answer.splice(0,n.answer.length,...i):n.answer=[...i]:n.answer=i}))}navigateInShowcaseToPage(e){if(!this.viewState.isShowcase)throw new Error("Can be used only in showcase");this.produceViewState((t=>{t.page=e}))}completeMeasurement(e){if(e.size!==this.viewState.questions.length)throw new Error('"questionIndexesToPages" map should have the same length as questions array');this.produceViewState((t=>{for(const[n,i]of e)void 0!==t.questions[n]&&(t.questions[n].page=i,this.viewState.isShowcase&&(t.page=i));const n=this.checkoutService.checkoutConfiguration.showcase,i=n&&n.currentQuestionsPage;i&&(t.page=i),t.isMeasuring=!1}));const t=this.getPagesOfQuestionsScreen(e);return this.checkoutService.checkoutUIState.pagesOfQuestionsScreen=t,t}getInitialViewState(){return{locked:!1,page:1,questions:[],hasBackButton:!0,isMeasuring:!1,questionErrors:{},shakeKey:0,isShowcase:this.checkoutService.checkoutConfiguration.infrastructureParams.showcase}}get questionsDataPoint(){return this.checkoutState.questions.dataPoint}getPagesOfQuestionsScreen(e){const t=[...e.values()];return t[t.length-1]}}class Nx extends dx{beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.resetToDefaultState(),this.checkoutService.updateSession({canUseAmountDefaults:!0}),this.checkoutService.abandonSession();const e={used:us.NO,shown:!0};this.checkoutState.remindMeLater.setState(e)}))}resetToDefaultState(){const e={used:us.NOT_GIVEN,shown:!0};this.checkoutState.remindMeLater.setState(e)}updateEmail(e){this.checkoutState.privacy.setDonorEmail(e),this.produceViewState((t=>{t.email.isValid||(t.email.isValid=kI.defaultValidationResult.fields.email.isValid),t.email.value=e}))}updateIsTermsAndConditionsAccepted(e){this.checkoutState.privacy.setTermsAndConditionsAccepted(e),this.produceViewState((t=>{t.termsAndConditions.isValid||(t.termsAndConditions.isValid=qI.defaultValidationResult.fields.isAccepted.isValid),t.termsAndConditions.isAccepted=e}))}save(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING);const e=this.donorEmailDataPoint.getValidationResult().isValid,t=this.termsAndConditionsDataPoint.getValidationResult().isValid,n=this.remindMeLaterDataPoint.getValidationResult().isValid,i=e&&t&&n;if(this.produceViewState((n=>{n.email.isValid=e,n.termsAndConditions.isValid=t,i||(n.shakeKey+=1)})),!i)return this.setProcessingState(Xl.IDLE),this.pending=!1,!1;const s={used:us.YES,shown:!0};this.checkoutState.remindMeLater.setState(s);const a=yield this.checkoutService.updateSession({canUseAmountDefaults:!0});if(wn.isFailure(a)&&a.failureResult.customerEmailError)return this.showEmailServerValidationError(),this.pending=!1,!1;const o=yield this.checkoutService.abandonSession();return wn.isFailure(o)&&o.failureResult.customerEmailError?(this.showEmailServerValidationError(),this.pending=!1,!1):(this.setProcessingState(Xl.SUCCESS),this.pending=!1,!0)}))}saveOnClose(){this.donorEmailDataPoint.getValidationResult().isValid||this.updateEmail(""),this.termsAndConditionsDataPoint.getValidationResult().isValid||this.updateIsTermsAndConditionsAccepted(!1),this.checkoutService.updateSession({canUseAmountDefaults:!0}),this.checkoutService.abandonSession()}clearEmailServerError(){this.produceViewState((e=>{e.serverErrors.email=!1,e.processingState=Xl.IDLE}))}getInitialViewState(){return{locked:!1,email:{value:this.donorEmailDataPoint.email,isValid:!0},termsAndConditions:{isAccepted:this.termsAndConditionsDataPoint.isAccepted,isValid:!0,text:this.termsAndConditionsDataPoint.text},isTermsAndConditionsEnabled:this.termsAndConditionsDataPoint.isEnabled,processingState:Xl.IDLE,serverErrors:{},shakeKey:0}}get remindMeLaterDataPoint(){return this.checkoutState.remindMeLater.dataPoint}get termsAndConditionsDataPoint(){return this.checkoutState.privacy.termsAndConditionsDataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}showEmailServerValidationError(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.serverErrors.email=!0,e.shakeKey+=1}))}}const Dx=[/memor/i,//,//,//,/mind/i,/nagedacht/i,/muist/i,/mmoir/i,/gedenk/i,/megemlkez/i,/memor/i,//,//,/minn/i,/pami/i,/memr/i,//i,/memori/i,/minn/i];class Tx{constructor(e){this.checkoutConfiguration=e.checkoutConfiguration,this.isTributeFilled=e.isTributeFilled,this.selectedDesignation=e.selectedDesignation}get trackingData(){return{type:this.getCampaignEmotionalType(),reasons:{tributeIsFilled:this.isTributeFilled,designationIsSad:this.isDesignationSad(this.selectedDesignation),emotionalType:this.checkoutConfiguration.emotionalType}}}getCampaignEmotionalType(){return this.checkoutConfiguration.checkoutType===Kn.MODAL&&!this.checkoutConfiguration.getAskPageConfig().show||!this.checkoutConfiguration.emotionalType?hs.NEUTRAL:this.isHappyCampaign()?hs.HAPPY:this.isSadCampaign()?hs.SAD:hs.NEUTRAL}isHappyCampaign(){const e=!this.selectedDesignation||!this.isDesignationSad(this.selectedDesignation),t=this.checkoutConfiguration.emotionalType===ds.POSITIVE;return e&&t&&!this.isTributeFilled}isSadCampaign(){const e=!!this.selectedDesignation&&this.isDesignationSad(this.selectedDesignation),t=this.checkoutConfiguration.emotionalType===ds.NEGATIVE;return e||t||this.isTributeFilled}isDesignationSad(e){return!!e&&Dx.some((t=>t.test(e)))}}class kx extends ii{constructor(){super(...arguments),this._allowedFrequencies=[qn.ONCE,qn.MONTHLY]}get isTestGroup(){return this.isActive&&(this.isVariant(ee.TEST_1)||this.isVariant(ee.TEST_2)||this.isVariant(ee.TEST_3)||this.isVariant(ee.TEST_4))}get testGroupVariantName(){return this.isActive&&!this.isControlGroup&&this.variantName?this.variantName:null}get isControlGroup(){return this.isActive&&this.isVariant(ee.CONTROL)}get allowedFrequencies(){return this._allowedFrequencies}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!(e.currencies.length>1)&&(!!e.isEnabledCampaignAi&&(!e.isEnabledCampaignHints&&(!e.p2pUsed&&!!e.enabledFrequencies.every((e=>this.allowedFrequencies.includes(e))))))}}class Ix extends ii{constructor(){super(...arguments),this._allowedFrequencies=[qn.ONCE,qn.MONTHLY]}get isTestGroup(){return this.isActive&&(this.isVariant(te.TEST_1)||this.isVariant(te.TEST_2)||this.isVariant(te.TEST_3)||this.isVariant(te.TEST_4))}get testGroupVariantName(){return this.isActive&&!this.isControlGroup&&this.variantName?this.variantName:null}get isControlGroup(){return this.isActive&&this.isVariant(te.CONTROL)}get allowedFrequencies(){return this._allowedFrequencies}isVariantTestGroup(e){return this.isActive&&this.isVariant(e)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!(e.currencies.length>1)&&(!!e.isEnabledCampaignAi&&(!e.isEnabledCampaignHints&&(!e.p2pUsed&&!!e.enabledFrequencies.every((e=>this.allowedFrequencies.includes(e))))))}}var _x,Ox;!function(e){e[e.STRATEGY_10=10]="STRATEGY_10",e[e.STRATEGY_15=15]="STRATEGY_15",e[e.STRATEGY_20=20]="STRATEGY_20",e[e.STRATEGY_25=25]="STRATEGY_25"}(_x||(_x={}));class xx extends ii{constructor(e){super(e),this._strategy=this.getRandomStrategy()}get strategy(){return this._strategy}tryStart(){this.isActive||this.start()}isEnabled(){return this.isTestGroup}getCustomAmount(e){let{amount:t,minAmount:n,currency:i,suggestionsService:s}=e;const a=this.calculateCustomAmount(t,n);return s.beautify(a,i)}sendPDUAmountStrategyEvent(){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_POST_DONATION_UPSELL_COLLECT_DATASET_AMOUNT_STRATEGY,data:{amountStrategy:this.strategy}})}get isTestGroup(){return this.isActive&&this.isVariant(L.TEST)}calculateCustomAmount(e,t){return Math.max(t,e*this.strategy/100)}getRandomStrategy(){const e=[_x.STRATEGY_10,_x.STRATEGY_15,_x.STRATEGY_20,_x.STRATEGY_25];return e[Math.floor(Math.random()*e.length)]}}!function(e){e[e.STRATEGY_10=10]="STRATEGY_10",e[e.STRATEGY_15=15]="STRATEGY_15",e[e.STRATEGY_20=20]="STRATEGY_20",e[e.STRATEGY_25=25]="STRATEGY_25"}(Ox||(Ox={}));class wx extends ii{constructor(e){super(e),this._strategy=this.getRandomStrategy()}get strategy(){return this._strategy}tryStart(){this.isActive||this.start()}isEnabled(){return this.isTestGroup}getCustomAmount(e){let{amount:t,minAmount:n,currency:i,suggestionsService:s}=e;const a=this.calculateCustomAmount(t,n);return s.beautify(a,i)}sendPDUAmountStrategyEvent(){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_POST_DONATION_UPSELL_COLLECT_DATASET_AMOUNT_STRATEGY,data:{amountStrategy:this.strategy}})}get isTestGroup(){return this.isActive&&this.isVariant(M.TEST)}calculateCustomAmount(e,t){return Math.max(t,e*this.strategy/100)}getRandomStrategy(){const e=[Ox.STRATEGY_10,Ox.STRATEGY_15,Ox.STRATEGY_20,Ox.STRATEGY_25];return e[Math.floor(Math.random()*e.length)]}}class Rx extends ii{constructor(){super(...arguments),this.exposed=!1}get isTestGroup(){return this.isActive&&this.isVariant(Z.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return e.includeFees===sC.SMART_COVERING&&!e.isCustomFeeCoveredValue}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}exposure(){this.exposed||(this.exposed=!0,super.exposure())}}class Mx extends ii{constructor(){super(...arguments),this.exposed=!1}get isTestGroup(){return this.isActive&&this.isVariant(Q.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return e.includeFees===sC.SMART_COVERING&&!e.isCustomFeeCoveredValue}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}exposure(){this.exposed||(this.exposed=!0,super.exposure())}}class Lx extends ii{constructor(){super(...arguments),this.isFallback=!1,this.exposed=!1}get isTestGroup(){return this.isActive&&this.isVariant(D.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return e.includeFees===sC.SMART_COVERING&&!e.isCustomFeeCoveredValue}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}trackSmartCoveringFeeResponse(e){this.isActive&&this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_SMART_COVERING_FEE_V2_RESPONSE,data:e})}exposure(){this.exposed||(this.exposed=!0,super.exposure())}}class Fx extends ii{constructor(){super(...arguments),this.isFallback=!1,this.exposed=!1}get isTestGroup(){return this.isActive&&(this.isVariant(N.TEST_1)||this.isVariant(N.TEST_2))}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return e.includeFees===sC.SMART_COVERING&&!e.isCustomFeeCoveredValue}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}trackSmartCoveringFeeResponse(e){this.isActive&&this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_SMART_COVERING_FEE_V2_RESPONSE,data:e})}exposure(){this.exposed||(this.exposed=!0,super.exposure())}}class Ux extends ii{get isTestGroup(){return this.isActive&&this.isVariant(_.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!!e.isPostDonationUpsellEnabled&&!!e.isPaid&&!!Ux.ALLOWED_CURRENCIES.includes(e.currency)}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}trackAmountSuggestion(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_POST_DONATION_UPSELL_AMOUNT_SUGGESTION,data:e})}}Ux.ALLOWED_CURRENCIES=["USD"];class jx extends ii{get isTestGroup(){return this.isActive&&this.isVariant(I.TEST)}tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}canBeStarted(e){return!!e.isPostDonationUpsellEnabled&&!!e.isPaid&&!!jx.ALLOWED_CURRENCIES.includes(e.currency)}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}trackAmountSuggestion(e){this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_POST_DONATION_UPSELL_AMOUNT_SUGGESTION,data:e})}}jx.ALLOWED_CURRENCIES=["USD"];class Bx extends pT{constructor(e,t,n,i,s,a,o,r,l,c,d,h,m,p,g,y,f,v,S,E,A,C,b,P,N,D){super(e,t,a,n,i,o,r,l,c,d,m,p,g,y,f,v,E,A,D),this._checkoutConfiguration=e,this.checkoutState=t,this.sessionService=n,this._sessionAPI=i,this.paymentService=s,this._checkoutUIState=a,this.tracker=o,this.currencyService=r,this.intl=l,this.iframeWindow=c,this.sentry=d,this.paymentFlowManager=h,this.paymentScreen=m,this.eventEmitter=p,this.checkoutAPIBridge=g,this.debug=y,this.experiments=f,this.paymentAPI=v,this.postDonationUpsellAPI=S,this.logger=E,this._redirectApi=A,this.postDonationUpsellMlSuggestion=C,this.smartCoveringFeeDecider=b,this.suggestionsService=P,this.pduAmountsService=N,this.params=D,this.shouldFindMandatoryScreen=!1,this.experiments.register(u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT,jx),this.experiments.register(u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT,Ux),this.experiments.register(u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT,kx),this.experiments.register(u.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT,Ix),this.experiments.register(u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT,wx),this.experiments.register(u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT,xx),this.initializeCheckoutStepsExperiments(),this.initializeSmartCoveringFeeCheckoutV4Experiment()}get type(){return this.checkoutState.process.dataPoint.flowType}get checkoutUIState(){return this._checkoutUIState}get isPaymentStarted(){return this.paymentService.isIDEALPaymentStarted()}getPaymentScreen(e,t){return this.paymentScreen.get(e,t)}dispose(){return this.paymentFlowManager.destroy()}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.infrastructureParams.showcase)return wn.fail({});const e=this.paymentOptionsDataPoint.clientPaymentMethod,t=yield this.resolvePaymentFlow(e);let n;try{yield this.sessionService.updateSession(),n=yield t.hold()}catch(e){return wn.fail({shouldLeave:!1})}return wn.isFailure(n)?(this.payErrorMessage=n.failureResult.message,wn.fail({shouldLeave:!1})):wn.success(void 0)}))}pay(e){return(0,d.sH)(this,arguments,void 0,(function(e){var t=this;let{screen:n,predictedNextScreen:i,shouldSaveScreenHistory:s=!1,isFastTrackFlow:a=!1}=e;return function*(){var e,o,r;if(t.checkoutConfiguration.infrastructureParams.showcase)return wn.fail({});t.checkoutState.process.setInProgress(),t.payErrorTitle=void 0,t.payErrorMessage=void 0,t.additionalPayErrorMessage=void 0;const l=t.paymentOptionsDataPoint.clientPaymentMethod,c=yield t.resolvePaymentFlow(l),u=Date.now(),d=yield t.sessionService.updateSession({shouldSaveScreenHistory:s});if(wn.isFailure(d))return t.payErrorMessage=t.intl.translate("common.errorOccurredText"),a&&t.trackPaymentMethodPersonalDataValidationErrors(),wn.fail({});if(a){const e=t.checkoutState.privacy.donorNameDataPoint.getValidationResult(),n=t.checkoutState.privacy.phoneNumberDataPoint.getValidationResult(),i=t.checkoutState.mailingAddress.dataPoint.getValidationResult(),s=t.checkoutState.privacy.donorEmailDataPoint.getValidationResult();if(!(e.isValid&&n.isValid&&i.isValid&&s.isValid))return t.trackPaymentMethodPersonalDataValidationErrors(),wn.fail({});if(t.checkoutState.mailingAddress.dataPoint.isServerValidationRequired()&&!(yield t.checkoutState.mailingAddress.dataPoint.getAddressValidationResult()))return t.trackPaymentMethodPersonalDataValidationErrors(),wn.fail({})}let h;try{h=yield c.pay()}catch(e){return t.shouldFindMandatoryScreen=!0,t.payErrorMessage=t.intl.translate("common.errorOccurredText"),t.capturePayErrorToSentry(e),t.tracker.trackCheckoutError({errorMessage:t.payErrorMessage,durationTime:u-Date.now()}),wn.fail({shouldLeave:t.checkoutState.process.dataPoint.hasPaymentError&&l===Gn.CARD})}if(wn.isFailure(h)){t.shouldFindMandatoryScreen=!0,t.payErrorTitle=h.failureResult.title,t.payErrorMessage=h.failureResult.message,t.additionalPayErrorMessage=h.failureResult.additionalMessage;const e=t.payErrorMessage||(l===Gn.CARD?t.intl.translate("creditCard.error.title"):t.intl.translate("common.errorOccurredText"));return t.tracker.trackCheckoutError({errorMessage:e,errorCode:h.failureResult.code,errorType:h.failureResult.type,errorDeclineCode:h.failureResult.declineCode,durationTime:u-Date.now()}),wn.fail({shouldLeave:h.failureResult.shouldLeave})}return h.successResult.data?(t.checkoutState.process.setCompleted({donationId:h.successResult.data.donationId,customerId:h.successResult.data.customerId,tributeId:h.successResult.data.tributeId,tributeDonorPortalLink:h.successResult.data.tributeDonorPortalLink,recurringId:h.successResult.data.recurringId,donationIds:(null===(e=h.successResult.data.donationItems)||void 0===e?void 0:e.map((e=>e.donationId)))||[],recurringIds:(null===(o=h.successResult.data.donationItems)||void 0===o?void 0:o.map((e=>e.recurringId)))||[]}),t.handleDonationCompleted({donationId:h.successResult.data.donationId,paymentIntentId:h.successResult.data.paymentIntentId,donationIds:(null===(r=h.successResult.data.donationItems)||void 0===r?void 0:r.map((e=>e.donationId)))||[],clientPaymentMethod:l||Gn.CARD,duration:u-Date.now(),screen:n}),yield t.handlePaymentRedirect(i),yield t.fetchPostDonationUpsellScreenDecision(),yield t.performPDUAmountsV3Experiment(),wn.success(void 0)):wn.fail({shouldLeave:!1})}()}))}saveCheckoutClosePublicParams(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;const t=this.checkoutState.remindMeLater.dataPoint.getDTO(),n=this.checkoutState.benefits.dataPoint.getDTO(),i=yield this.getPublicCheckoutDonationParams(),s=yield this.getCommonPublicCheckoutIntentParams(n.chosenBenefit);s&&(s.checkoutSettings.modifyDesignation=this.checkoutConfiguration.canModifyDesignation,s.checkoutSettings.designation=null===(e=this.designationsDataPoint.selectedGoals[0])||void 0===e?void 0:e.id,s.isSavedEmailOnExit=t.used),this.checkoutAPIBridge.setDonationParams(i),this.checkoutAPIBridge.setIntentParams(s)}))}acceptPostDonationUpsell(){var e;const t=this.postDonationUpsellDataPoint.getDTO(),n=null===(e=this.designationsDataPoint.selectedGoals[0])||void 0===e?void 0:e.id;return this.postDonationUpsellAPI.update({donation:{total:t.upsellTotal,tip:t.upsellTip,amount:t.upsellAmount,currency:t.upsellCurrency},goalKey:null!=n?n:"",firstChargeAt:t.upsellStartDate,period:t.upsellFrequency})}ensureFrequencyEnabled(e){if(this.checkoutConfiguration.enabledFrequencies.includes(e))return;if(this.isMultipleRecurringFrequencyEnabled()&&e===qn.ANNUAL)return;let t,n;this.preDonationUpsellDataPoint.isAccepted?(t=qn.ONCE,n=this.preDonationUpsellDataPoint.upsellInitialAmount):(t=this.checkoutConfiguration.defaultFrequency,n=this.donationDataPoint.getFrequencyDefaultAmount(t)),this.checkoutState.donation.setDonationsFrequency(t),this.checkoutState.donation.setDonationsAmount(n)}isSmartCoveringFeeExperimentEnabled(){const e={includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue};return!!this.smartCoveringFeeCampaignPagesExperimentV2.isEnabled(e)}exposeSmartCoveringFeeExperimentV2(){const e={includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue};this.smartCoveringFeeCampaignPagesExperimentV2.canBeStarted(e)&&this.smartCoveringFeeCampaignPagesExperimentV2.exposure()}exposureSmartCoveringFeeV4Experiment(){const e={includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue};this.smartCoveringFeeCheckoutV4Experiment.canBeStarted(e)&&this.smartCoveringFeeCheckoutV4Experiment.exposure(),this.smartCoveringFeeCampaignPagesV4Experiment.canBeStarted(e)&&this.smartCoveringFeeCampaignPagesV4Experiment.exposure()}fetchFeeCoveringSuggestion(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.checkoutType===Kn.MODAL)return;if(this.isCustomFeeCovered)return;if(!this.isSmartCoveringFeeExperimentEnabled())return;const t=yield this.createGetSmartCoveringFeePayload();if(null===t)return;let n;n=(null==e?void 0:e.debounced)?yield this.smartCoveringFeeDecider.debouncedFetchDecision(t):yield this.smartCoveringFeeDecider.fetchDecision(t);const i=n.response;n.fromCache||this.smartCoveringFeeCampaignPagesExperimentV2.trackSmartCoveringFeeResponse(i),i.isFallback?this.smartCoveringFeeCampaignPagesExperimentV2.isFallback=!0:(this.smartCoveringFeeCampaignPagesExperimentV2.isFallback=!1,this.checkoutState.donation.setFeeCovered(i.feeCoveringSuggestion===sC.DEFAULT_YES))}))}initialize(){const e=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,d.sH)(this,void 0,void 0,(function*(){e.initialize.call(this),this.initializeSmartCoveringFeeExperiments(),this.paymentService.ensurePaymentMethodsInitialized()}))}tryStartMlAmountPresetsV5Experiment(e){this.amountPresetsPagesV5Experiment.tryStart(e),this.amountPresetsCheckoutV5Experiment.tryStart(e)}isMlAmountPresetsV5ExperimentEnabled(){return this.amountPresetsPagesV5Experiment.isTestGroup||this.amountPresetsCheckoutV5Experiment.isTestGroup}getMlAmountPresetsV5ExperimentTestGroup(){return this.amountPresetsPagesV5Experiment.testGroupVariantName||this.amountPresetsCheckoutV5Experiment.testGroupVariantName}isMlAmountPresetsPagesV5ControlGroupEnabled(){return this.amountPresetsPagesV5Experiment.isControlGroup}exposeMlAmountPresetsV5Experiment(){this.amountPresetsPagesV5Experiment.exposure(),this.amountPresetsCheckoutV5Experiment.exposure()}getMlAmountPresetsV5ExperimentAllowedFrequencies(){return this.amountPresetsPagesV5Experiment.isTestGroup?this.amountPresetsPagesV5Experiment.allowedFrequencies:null}exposeMultipleRecurringPlanCheckoutExperiment(){this.multipleRecurringPlanCheckoutExperiment.exposure()}isMultipleRecurringPlanCheckoutExperimentEnabled(){return this.multipleRecurringPlanCheckoutExperiment.isTestGroup}isMultipleRecurringPlanTestGroup2(){return this.multipleRecurringPlanCheckoutExperiment.isTestGroup2}isMultipleRecurringPlanTestGroup1(){return this.multipleRecurringPlanCheckoutExperiment.isTestGroup1}stripeLinkExperimentExpose(){this.stripeLinkCheckoutExperiment.exposure(),this.stripeLinkPagesExperiment.exposure()}tryToCloneOnceFrequencyToAnnual(){if(!this.isMultipleRecurringFrequencyEnabled())return;this.checkoutConfiguration.cloneOnceFrequencyToAnnual();const e=this.donationDataPoint.getFrequencyDefaultAmount(qn.ONCE),t=this.donationDataPoint.getFrequencyAmountSuggestions(qn.ONCE),n=this.donationDataPoint.getFrequencyAmountSuggestionsInDefaultCurrency(qn.ONCE),i=this.donationDataPoint.getFrequencyAmountHints(qn.ONCE),s=null==i?void 0:i.find((e=>{var t;return e.id===(null===(t=this.donationDataPoint.amountHint)||void 0===t?void 0:t.id)}));this.checkoutState.donation.setFrequencyDefaultAmount(qn.ANNUAL,e),this.checkoutState.donation.setFrequencyAmountSuggestions(qn.ANNUAL,n,t,!1),this.checkoutState.donation.setFrequencyAmountHints(qn.ANNUAL,(null==i?void 0:i.map((e=>e.id)))||[],this.donationDataPoint.currency),s&&this.checkoutState.donation.setFrequencyAmountHint(qn.ANNUAL,s)}sendSentryLog(e,t){this.sentry.captureException(e,Object.assign({level:"warning"},t))}getDonationParams(){var e;return{amount:this.donationDataPoint.amount||0,total:this.donationDataPoint.total,currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency,publicFee:this.donationDataPoint.processingFee,canModifyAmount:this.checkoutConfiguration.canModifyAmount,feeCovered:this.donationDataPoint.isFeeCovered,selectedHintId:null===(e=this.donationDataPoint.amountHint)||void 0===e?void 0:e.id,availableDonationItemsDto:this.donationDataPoint.availableDonationItemsDto,processingFees:this.donationDataPoint.processingFees}}getPublicCheckoutDonationParams(){return this.getCommonPublicCheckoutDonationParams({clientPaymentMethod:this.paymentOptionsDataPoint.clientPaymentMethod,employerName:this.dtdDataPoint.employerName})}get isMlPostDonationUpsellV3ExperimentEnabled(){return!!this.smartDPUCheckoutV3Experiment.isEnabled(this.smartPDUV3ExperimentParams)||!!this.smartPDUCampaignPagesV3Experiment.isEnabled(this.smartPDUV3ExperimentParams)}get smartPDUV3ExperimentParams(){return{isPostDonationUpsellEnabled:this.postDonationUpsellDataPoint.isEnabled,isPaid:this.isPaid}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get postDonationUpsellDataPoint(){return this.checkoutState.postDonationUpsell.dataPoint}get preDonationUpsellDataPoint(){return this.checkoutState.preDonationUpsell.dataPoint}get paymentOptionsDataPoint(){return this.checkoutState.paymentOptions.paymentOptionsDataPoint}get dtdDataPoint(){return this.checkoutState.doubleTheDonation.dataPoint}get smartPostDonationUpsellCheckoutExperiment(){return this.experiments.get(u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT)}get smartPostDonationUpsellCampaignPagesExperiment(){return this.experiments.get(u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT)}get smartDPUCheckoutV3Experiment(){return this.experiments.get(u.SMART_PDU_CHECKOUT_V_3_EXPERIMENT)}get smartPDUCampaignPagesV3Experiment(){return this.experiments.get(u.SMART_PDU_CAMPAIGN_PAGES_V_3_EXPERIMENT)}get amountPresetsPagesV5Experiment(){return this.experiments.get(u.AMOUNT_PRESETS_PAGES_V_5_EXPERIMENT)}get amountPresetsCheckoutV5Experiment(){return this.experiments.get(u.AMOUNT_PRESETS_CHECKOUT_V_5_EXPERIMENT)}get stripeLinkCheckoutExperiment(){return this.experiments.get(u.STRIPE_LINK_CHECKOUT_EXPERIMENT)}get stripeLinkPagesExperiment(){return this.experiments.get(u.STRIPE_LINK_PAGES_EXPERIMENT)}get smartPostDonationUpsellExperimentParams(){return{isPostDonationUpsellEnabled:this.postDonationUpsellDataPoint.isEnabled,isPaid:this.isPaid,currency:this.donationDataPoint.currency}}get isSmartPostDonationUpsellEnabled(){return!!this.smartPostDonationUpsellCheckoutExperiment.isEnabled(this.smartPostDonationUpsellExperimentParams)||!!this.smartPostDonationUpsellCampaignPagesExperiment.isEnabled(this.smartPostDonationUpsellExperimentParams)}get smartCoveringFeeCampaignPagesExperimentV2(){return this.experiments.get(u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT)}get smartCoveringFeeCampaignPagesV4Experiment(){return this.experiments.get(u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT)}get smartCoveringFeeCheckoutV4Experiment(){return this.experiments.get(u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT)}get multipleRecurringPlanCheckoutExperiment(){return this.experiments.get(u.MULTIPLE_RECURRING_PLAN_CHECKOUT_EXPERIMENT)}get isCustomFeeCovered(){return this.donationDataPoint.isCustomFeeCoveredValue}isMultipleRecurringFrequencyEnabled(){return!!this.isMultipleRecurringPlanCheckoutExperimentEnabled()||this.checkoutConfiguration.checkoutType!==Kn.MODAL&&(this.checkoutConfiguration.tryToEnableMultipleRecurringFrequency(),this.checkoutConfiguration.isMultipleRecurringFrequencyEnabled)}tryStartMlPostDonationUpsellV3Experiment(){this.smartDPUCheckoutV3Experiment.tryStart(this.smartPDUV3ExperimentParams),this.smartPDUCampaignPagesV3Experiment.tryStart(this.smartPDUV3ExperimentParams)}exposureMlPostDonationUpsellV3Experiment(){this.smartDPUCheckoutV3Experiment.exposure(),this.smartPDUCampaignPagesV3Experiment.exposure()}trackPostDonationUpsellAmountSuggestion(e){this.smartPostDonationUpsellCheckoutExperiment.isEnabled(this.smartPostDonationUpsellExperimentParams)&&this.smartPostDonationUpsellCheckoutExperiment.trackAmountSuggestion(e),this.smartPostDonationUpsellCampaignPagesExperiment.isEnabled(this.smartPostDonationUpsellExperimentParams)&&this.smartPostDonationUpsellCampaignPagesExperiment.trackAmountSuggestion(e)}tryStartSmartPostDonationUpsellExperiment(){this.smartPostDonationUpsellCheckoutExperiment.tryStart(this.smartPostDonationUpsellExperimentParams),this.smartPostDonationUpsellCampaignPagesExperiment.tryStart(this.smartPostDonationUpsellExperimentParams)}performPDUAmountsV3Experiment(){return(0,d.sH)(this,void 0,void 0,(function*(){this.tryStartMlPostDonationUpsellV3Experiment(),this.exposureMlPostDonationUpsellV3Experiment(),this.isMlPostDonationUpsellV3ExperimentEnabled&&(yield this.pduAmountsService.tryFetchSuggestion())&&(this.pduAmountsService.tryApplySuggestion(),this.pduAmountsService.tryTrackSuggestion())}))}fetchPostDonationUpsellScreenDecision(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;if(this.tryStartSmartPostDonationUpsellExperiment(),!this.isSmartPostDonationUpsellEnabled)return;const n=new Date;yield this.postDonationUpsellMlSuggestion.fetchAmountSuggestion({eventTime:(new Date).toISOString(),checkoutCurrency:this.donationDataPoint.currency,checkoutAmount:null!==(e=this.donationDataPoint.amount)&&void 0!==e?e:0,checkoutInUsdAmount:null!==(t=this.donationDataPoint.amountInUSD)&&void 0!==t?t:0,clientTimeZone:Bi(),clientHour:n.getHours(),clientWeekday:n.getDay(),clientLocale:this.intl.locale,minRecurringAmount:this.postDonationUpsellDataPoint.upsellMinAmount,campaignKey:this.checkoutConfiguration.campaign.key});const i=this.postDonationUpsellMlSuggestion.getOriginalAmountSuggestion();i.isFallback||this.trackPostDonationUpsellAmountSuggestion(i)}))}initializeSmartCoveringFeeExperiments(){this.experiments.register(u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT,Lx),this.experiments.get(u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_2_EXPERIMENT).tryStart({includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue}),this.experiments.register(u.SMART_COVERING_FEE_CHECKOUT_V_2_EXPERIMENT,Fx)}resolvePaymentFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.paymentService.resolvePaymentFlow(e)}))}createGetSmartCoveringFeePayload(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;if(null===this.donationDataPoint.amountInUSD||null===this.donationDataPoint.getFrequencyDefaultAmount(this.donationDataPoint.frequency))return null;const n=this.currencyService.convert(this.checkoutConfiguration.defaultAmounts[this.donationDataPoint.frequency]||0,this.checkoutConfiguration.defaultCurrency,"USD");return{amountInUSD:this.donationDataPoint.amountInUSD,defaultAmountInUSD:n,currency:this.donationDataPoint.currency,companyKey:this.checkoutConfiguration.company.key,campaignKey:this.checkoutConfiguration.campaign.key,clientLocale:this.intl.locale,history:window.history.length,trackerClientId:this.tracker.clientId,elementLocale:this.checkoutConfiguration.element.locale,clientTimeZone:Bi(),battery:null!==(t=null===(e=this.tracker.page)||void 0===e?void 0:e.toObject().clientBatteryLevel)&&void 0!==t?t:0}}))}initializeCheckoutStepsExperiments(){const e=this.experiments.get(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT),t=this.experiments.get(u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT);e.tryStart({flowType:this.type,isMobile:this.checkoutConfiguration.infrastructureParams.isMobile}),t.tryStart({flowType:this.type,isMobile:this.checkoutConfiguration.infrastructureParams.isMobile})}initializeSmartCoveringFeeCheckoutV4Experiment(){this.experiments.register(u.SMART_COVERING_FEE_CAMPAIGN_PAGES_V_4_EXPERIMENT,Rx),this.experiments.register(u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT,Mx),this.smartCoveringFeeCheckoutV4Experiment.tryStart({includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue}),this.smartCoveringFeeCampaignPagesV4Experiment.tryStart({includeFees:this.checkoutConfiguration.campaign.config.includeFees,isCustomFeeCoveredValue:this.donationDataPoint.isCustomFeeCoveredValue})}trackPaymentMethodPersonalDataValidationErrors(){this.tracker.trackCheckoutCustomEvent({type:Ee.PAYMENT_METHOD_PERSONAL_DATA_VALIDATION_ERROR,data:{paymentMethod:this.checkoutState.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod,firstName:{filled:!!this.checkoutState.privacy.donorNameDataPoint.firstName},lastName:{filled:!!this.checkoutState.privacy.donorNameDataPoint.lastName},email:{filled:!!this.checkoutState.privacy.donorEmailDataPoint.email},phoneNumber:{shown:this.checkoutState.privacy.phoneNumberDataPoint.isEnabled,required:this.checkoutState.privacy.phoneNumberDataPoint.isRequired,filled:!!this.checkoutState.privacy.phoneNumberDataPoint.phone},mailingAddressRequired:this.checkoutState.mailingAddress.dataPoint.isRequired,line1:{filled:!!this.checkoutState.mailingAddress.dataPoint.line1},line2:{filled:!!this.checkoutState.mailingAddress.dataPoint.line2},city:{filled:!!this.checkoutState.mailingAddress.dataPoint.city},postal:{filled:!!this.checkoutState.mailingAddress.dataPoint.postal},region:{value:this.checkoutState.mailingAddress.dataPoint.region,filled:!!this.checkoutState.mailingAddress.dataPoint.region},country:{value:this.checkoutState.mailingAddress.dataPoint.countryCode,filled:!!this.checkoutState.mailingAddress.dataPoint.countryCode}}})}}class Gx extends dx{constructor(e,t,n){super(n),this.redirectApi=e,this.sharingApi=t,this._emotionalTypeService=null,this.suggestionsService=n.suggestionsService}get periodLabelPdu(){return this.pduRecurringTypes[this.viewState.postDonationUpsell.period]}get hasTribute(){return this.tributeDataPoint.isActive&&!!this.tributeDataPoint.tributeeName}get hasPostDonationUpsell(){var e,t;return null!==(t=null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.isAccepted)&&void 0!==t&&t}get thankYouTitle(){return this.intl.translate("common.thankYouTitle",{name:this.checkoutService.checkoutConfiguration.infrastructureParams.showcase?"John":this.checkoutState.privacy.donorNameDataPoint.firstName})}get descriptionPdu(){return this.intl.translate("thankYouScreen.postDonationUpsell.description",{amount:this.getFormattedAmount(this.viewState.total,this.viewState.currency)})}get descriptionSharing(){switch(this.viewState.flowType){case $n.MONEY:return this.descriptionSharingFiat;case $n.CRYPTO:return this.intl.safeTranslate("thankYouScreen.description.once",{amount:this.viewState.formattedTotal});default:{const e=this.viewState.flowType;throw new Error(`Unknown flow type "${e}"`)}}}get descriptionTribute(){if(this.donationDataPoint instanceof Tk){const e=this.donationDataPoint.frequency,t=this.donationDataPoint.getFrequencyDonationEndDate(e);if(e!==qn.ONCE&&t.shouldShow&&t.endDate&&this.donationDataPoint.isDonationEndDateActive){const n=this.intl.formatDate(t.endDate,{type:Qr.SHORT_WITH_YEAR}),i=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.tribute.recurring.withEndDate":"thankYouScreen.description.tribute.recurring.withEndDate";return this.intl.safeTranslate(i,{amount:this.viewState.formattedTotal,recurringType:this.getRecurringTypeDescriptionAdjective(e),date:n,dedicatedTo:this.viewState.tribute.inHonorOf})}}if(!this.checkoutService.checkoutConfiguration.infrastructureParams.showcase&&this.donationDataPoint instanceof Tk){const e=this.donationDataPoint.frequency;if(e!==qn.ONCE){const t=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.tribute.recurring.default":"thankYouScreen.description.tribute.recurring.default";return this.intl.safeTranslate(t,{amount:this.viewState.formattedTotal,recurringType:this.getRecurringTypeDescriptionAdjective(e),dedicatedTo:this.viewState.tribute.inHonorOf})}}const e=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.tribute.once":"thankYouScreen.description.tribute.once";return this.intl.safeTranslate(e,{amount:this.viewState.formattedTotal,dedicatedTo:this.viewState.tribute.inHonorOf})}get descriptionUpsell(){if(this.hasPostDonationUpsell)return this.intl.safeTranslate("thankYouScreen.description.upsell",{amount:this.viewState.formattedTotal,recurringType:this.viewState.postDonationUpsell.recurringType,date:this.viewState.postDonationUpsell.formattedStartDate,guaranteedAmount:this.viewState.postDonationUpsell.formattedAmount})}get multipleDonationsList(){var e,t;if(!this.isMultipleDonations)return[];const n=this.designationsDataPoint.selectedGoals.filter(((e,t)=>this.designationsDataPoint.selectedGoalsAvailability[t].isAvailable)),i=[];for(const[s,a]of this.availableDonationItems.entries()){const o=(null!==(e=a.amount)&&void 0!==e?e:0)+(null!==(t=this.processingFees[a.id])&&void 0!==t?t:0);i.push({goalName:n[s].name,totalLabel:this.getFormattedAmount(o,this.donationDataPoint.currency),total:o})}return i.sort(((e,t)=>e.total-t.total))}get postDonationCelebrationAnimationTrackingData(){return this.emotionalTypeService.trackingData}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.tryStartCollectDatasetPostDonationUpsellAmountExperimentV3(),this.tryToApplyCollectDatasetPostDonationUpsellAmountExperimentV3(),(!this.postDonationUpsellDataPoint||!this.postDonationUpsellDataPoint.isEnabled)&&(yield this.redirectIfNeeded());const e=this.donationDataPoint.total||0,t=this.donationDataPoint.currency;this.produceViewState((n=>{var i,s;n.currency=t,n.total=e,n.formattedTotal=this.getFormattedAmount(n.total,n.currency),n.emotionalType=this.emotionalTypeService.getCampaignEmotionalType(),n.tributeDonorPortalLink=null!==(s=null===(i=this.processDataPoint.completedData)||void 0===i?void 0:i.tributeDonorPortalLink)&&void 0!==s?s:"",n.tribute.inHonorOf=this.tributeDataPoint.tributeeName,n.tribute.makeAnotherDonation=this.variant===$l.TRIBUTE,n.tribute.completeDedication=this.variant===$l.TRIBUTE,n.variant=this.variant;const{email:a,twitter:o,linkedin:r,facebook:l}=this.sharingApi.sharingChannels;n.sharing.showEmail=this.variant===$l.SHARING&&a,n.sharing.showTwitter=this.variant===$l.SHARING&&o,n.sharing.showLinkedin=this.variant===$l.SHARING&&r,n.sharing.showFacebook=this.variant===$l.SHARING&&l,n.sharing.sharingText=this.sharingApi.sharingText,n.postDonationUpsell.recurringType=this.postDonationUpsellRecurringType,n.postDonationUpsell.formattedAmount=this.postDonationUpsellFormattedAmount,n.postDonationUpsell.formattedStartDate=this.postDonationUpsellFormattedStartDate,this.postDonationUpsellDataPoint&&(n.postDonationUpsell.recurringMinAmount=this.postDonationUpsellDataPoint.upsellMinAmount,n.postDonationUpsell.upsellMaxAmount=this.postDonationUpsellDataPoint.upsellMaxAmount,n.postDonationUpsell.amount=this.postDonationUpsellDataPoint.upsellAmount,n.postDonationUpsell.amountInUSD=this.postDonationUpsellDataPoint.upsellAmountInUSD,n.postDonationUpsell.startDate=this.postDonationUpsellDataPoint.upsellStartDate,n.postDonationUpsell.displayPduScreen=this.postDonationUpsellDataPoint.isEnabled,n.postDonationUpsell.shown=this.postDonationUpsellDataPoint.isEnabled)})),this.exposureSmartPostDonationUpsellExperimentV2(),yield this.setCheckoutStepsSuccessAndWaitForAnimation()}))}pduAccept(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutService instanceof Bx&&this.checkoutState instanceof cT&&!this.checkoutService.checkoutConfiguration.infrastructureParams.showcase&&!this.pending){if(this.pending=!0,yield this.isPduAmountValid())return(yield this.checkoutService.acceptPostDonationUpsell())?(this.checkoutState.postDonationUpsell.setAccepted(),this.pending=!1,this.closePduScreen()):(this.produceViewState((e=>{e.postDonationUpsell.confirmError=!0})),void(this.pending=!1));this.pending=!1}}))}isPduAmountValid(){return(0,d.sH)(this,void 0,void 0,(function*(){return!!this.viewState.postDonationUpsell.isAmountValid||(this.produceViewState((e=>{e.postDonationUpsell.shakeKey+=1})),!1)}))}changePduAmount(e){if(!(this.checkoutService instanceof Bx&&this.checkoutState instanceof cT&&this.postDonationUpsellDataPoint))return;const t=this.postDonationUpsellDataPoint;this.checkoutState.postDonationUpsell.setUpsellCustomAmount(e),this.produceViewState((n=>{n.postDonationUpsell.amount=e,n.postDonationUpsell.amountInUSD=t.upsellAmountInUSD})),this.validatePduAmount()}validatePduAmount(){if(!this.postDonationUpsellDataPoint)return;const e=this.postDonationUpsellDataPoint.isMinAmountValid,t=this.postDonationUpsellDataPoint.isMaxAmountValid;this.produceViewState((n=>{n.postDonationUpsell.isAmountValid=e&&t,n.postDonationUpsell.errors.min=!e,n.postDonationUpsell.errors.max=!t}))}makePduAmountInputVisible(){this.produceViewState((e=>{e.postDonationUpsell.showAmountInput=!0}))}hidePduAmountInput(){this.produceViewState((e=>{e.postDonationUpsell.showAmountInput=!1}))}getSharingLink(e){return this.sharingApi.getSharingLink(e,this.intl.translate("thankYouScreen.share.emailSubject"))}share(e,t){this.sharingApi.share(e,this.intl.translate("thankYouScreen.share.emailSubject"),t)}pduSetShowedInSession(){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState instanceof cT&&(this.checkoutService.checkoutConfiguration.infrastructureParams.showcase||(this.checkoutState.postDonationUpsell.setShowed(),yield this.checkoutService.updateSession(),yield this.checkoutService.tryCloseSession()))}))}makeAnotherDonation(){}closePduScreen(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.redirectIfNeeded(),this.produceViewState((e=>{e.postDonationUpsell.displayPduScreen=!1,e.postDonationUpsell.recurringType=this.postDonationUpsellRecurringType,e.postDonationUpsell.formattedAmount=this.postDonationUpsellFormattedAmount,e.postDonationUpsell.formattedStartDate=this.postDonationUpsellFormattedStartDate}))}))}getRecurringTypeDescriptionAdjective(e){var t;return null!==(t={[qn.DAILY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.daily.adjective"),[qn.WEEKLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.weekly.adjective"),[qn.BIWEEKLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.biweekly.adjective"),[qn.EVERY_4_WEEKS]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.every4weeks.adjective"),[qn.MONTHLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.monthly.adjective"),[qn.BIMONTHLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.bimonthly.adjective"),[qn.QUARTERLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.quarterly.adjective"),[qn.SEMIANNUAL]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.semiannual.adjective"),[qn.ANNUAL]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.annual.adjective")}[e])&&void 0!==t?t:""}getRecurringTypeDescriptionAdverb(e){var t;return null!==(t={[qn.DAILY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.daily.adverb"),[qn.WEEKLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.weekly.adverb"),[qn.BIWEEKLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.biweekly.adverb"),[qn.EVERY_4_WEEKS]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.every4weeks.adverb"),[qn.MONTHLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.monthly.adverb"),[qn.BIMONTHLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.bimonthly.adverb"),[qn.QUARTERLY]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.quarterly.adverb"),[qn.SEMIANNUAL]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.semiannual.adverb"),[qn.ANNUAL]:this.intl.safeTranslate("widgetSubscriptionPeriodLabel.annual.adverb")}[e])&&void 0!==t?t:""}getInitialViewState(){return{locked:!1,variant:$l.SHARING,currency:"USD",total:0,formattedTotal:"",emotionalType:hs.NEUTRAL,sharing:{showFacebook:!0,showTwitter:!0,showLinkedin:!0,showEmail:!0,sharingText:""},tribute:{inHonorOf:"",makeAnotherDonation:!0,completeDedication:!0},postDonationUpsell:{formattedAmount:"",formattedStartDate:"",recurringType:"",amount:0,amountInUSD:0,period:qn.MONTHLY,showAmountInput:!1,confirmError:!1,recurringMinAmount:0,upsellMaxAmount:0,startDate:(new Date).toString(),isAmountValid:!0,errors:{min:!1,max:!1},shakeKey:0,isShowcase:!1,displayPduScreen:!1,shown:!1},tributeDonorPortalLink:"",flowType:this.checkoutService.type}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get postDonationUpsellDataPoint(){return this.checkoutState instanceof cT?this.checkoutState.postDonationUpsell.dataPoint:null}get descriptionSharingFiat(){const e=this.donationDataPoint.frequency;if(this.donationDataPoint instanceof Tk){const t=this.donationDataPoint.getFrequencyDonationEndDate(e);if(e!==qn.ONCE&&t.shouldShow&&t.endDate&&this.donationDataPoint.isDonationEndDateActive){const n=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.recurring.withEndDate":"thankYouScreen.description.recurring.withEndDate",i=this.intl.formatDate(t.endDate,{type:Qr.SHORT_WITH_YEAR});return this.intl.safeTranslate(n,{amount:this.viewState.formattedTotal,recurringType:this.getRecurringTypeDescriptionAdjective(e),date:i})}}if(!this.checkoutService.checkoutConfiguration.infrastructureParams.showcase&&this.donationDataPoint instanceof Tk&&e!==qn.ONCE){const t=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.recurring.default":"thankYouScreen.description.recurring.default";return this.intl.safeTranslate(t,{amount:this.viewState.formattedTotal,recurringType:this.getRecurringTypeDescriptionAdjective(e)})}const t=this.isMultipleDonations?"thankYouScreen.multipleDonations.description.once":"thankYouScreen.description.once";return this.intl.safeTranslate(t,{amount:this.viewState.formattedTotal})}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}get availableDonationItems(){return this.donationDataPoint instanceof Tk?this.donationDataPoint.availableDonationItemsDto:[]}get isMultipleDonations(){return this.donationDataPoint instanceof Tk&&this.donationDataPoint.isMultipleDonations}get processingFees(){return this.donationDataPoint instanceof Tk?this.donationDataPoint.processingFees:{}}get postDonationUpsellFormattedAmount(){var e;return this.getFormattedAmount((null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.upsellAmount)||0,this.donationDataPoint.currency)}get postDonationUpsellFormattedStartDate(){var e;return this.intl.formatDate((null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.upsellStartDate)||"",{type:Qr.LONG})}get postDonationUpsellRecurringType(){var e;return(null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.upsellFrequency)?this.getRecurringTypeDescriptionAdverb(this.postDonationUpsellDataPoint.upsellFrequency):""}get isSharingEnabled(){return this.sharingApi.isSharingEnabled}get variant(){return this.hasTribute&&this.tributeDataPoint.isSharingEnabled?$l.TRIBUTE:this.isSharingEnabled?$l.SHARING:$l.DEFAULT}get pduRecurringTypes(){return{[qn.DAILY]:this.intl.translate("widgetSubscriptionPeriodLabel.daily.adverb"),[qn.WEEKLY]:this.intl.translate("widgetSubscriptionPeriodLabel.weekly.adverb"),[qn.BIWEEKLY]:this.intl.translate("widgetSubscriptionPeriodLabel.biweekly.adverb"),[qn.EVERY_4_WEEKS]:this.intl.translate("widgetSubscriptionPeriodLabel.every4weeks.adverb"),[qn.MONTHLY]:this.intl.translate("widgetSubscriptionPeriodLabel.monthly.adverb"),[qn.BIMONTHLY]:this.intl.translate("widgetSubscriptionPeriodLabel.bimonthly.adverb"),[qn.QUARTERLY]:this.intl.translate("widgetSubscriptionPeriodLabel.quarterly.adverb"),[qn.SEMIANNUAL]:this.intl.translate("widgetSubscriptionPeriodLabel.semiannual.adverb"),[qn.ANNUAL]:this.intl.translate("widgetSubscriptionPeriodLabel.annual.adverb")}}get emotionalTypeService(){var e,t;return this._emotionalTypeService||(this._emotionalTypeService=new Tx({checkoutConfiguration:this.checkoutService.checkoutConfiguration,isTributeFilled:this.tributeDataPoint.isFilled,selectedDesignation:null===(t=null===(e=this.checkoutState.designation)||void 0===e?void 0:e.dataPoint)||void 0===t?void 0:t.goalName})),this._emotionalTypeService}get collectDatasetPostDonationUpsellAmountCheckoutExperimentV3(){return this.experiments.get(u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CHECKOUT_V_3_EXPERIMENT)}get collectDatasetPostDonationUpsellAmountCampaignPagesExperimentV3(){return this.experiments.get(u.COLLECT_DATASET_POST_DONATION_UPSELL_AMOUNT_CAMPAIGN_PAGES_V_3_EXPERIMENT)}tryStartCollectDatasetPostDonationUpsellAmountExperimentV3(){var e;(null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.isEnabled)&&(this.collectDatasetPostDonationUpsellAmountCheckoutExperimentV3.tryStart(),this.collectDatasetPostDonationUpsellAmountCampaignPagesExperimentV3.tryStart())}exposureSmartPostDonationUpsellExperimentV2(){var e;if(!(null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.isEnabled))return;const t=this.experiments.get(u.SMART_POST_DONATION_UPSELL_CAMPAIGN_PAGES_V_2_EXPERIMENT),n=this.experiments.get(u.SMART_POST_DONATION_UPSELL_CHECKOUT_V_2_EXPERIMENT);t.exposure(),n.exposure()}tryToApplyCollectDatasetPostDonationUpsellAmountExperimentV3(){var e,t;if(!(this.checkoutState instanceof cT))return;if(!(null===(e=this.postDonationUpsellDataPoint)||void 0===e?void 0:e.isEnabled))return;let n=null;if(this.collectDatasetPostDonationUpsellAmountCheckoutExperimentV3.active&&(n=this.collectDatasetPostDonationUpsellAmountCheckoutExperimentV3),this.collectDatasetPostDonationUpsellAmountCampaignPagesExperimentV3.active&&(n=this.collectDatasetPostDonationUpsellAmountCampaignPagesExperimentV3),!n||!this.donationDataPoint.amount||!this.suggestionsService)return;n.exposure();const i=n.getCustomAmount({amount:this.donationDataPoint.amount,minAmount:(null===(t=this.postDonationUpsellDataPoint)||void 0===t?void 0:t.upsellMinAmount)||0,currency:this.donationDataPoint.currency,suggestionsService:this.suggestionsService});this.checkoutState.postDonationUpsell.setUpsellCustomAmount(i),n.sendPDUAmountStrategyEvent()}isCheckoutStepsExperimentActive(){const e=this.experiments.get(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT),t=this.experiments.get(u.CHECKOUT_STEPS_CAMPAIGN_PAGES_EXPERIMENT);return e.isTestGroup()||t.isTestGroup()}setCheckoutStepsSuccessAndWaitForAnimation(){return new Promise((e=>this.checkoutService.checkoutConfiguration.infrastructureParams.showcase?e():this.isCheckoutStepsExperimentActive()?this.checkoutService.checkoutUIState.showCheckoutStepsSuccess?e():(this.checkoutService.checkoutUIState.setShowCheckoutStepsSuccess(!0),FD(300).then((()=>{e()}))):e()))}redirectIfNeeded(){return(0,d.sH)(this,void 0,void 0,(function*(){this.redirectApi.canRedirect()?(yield this.checkoutService.tryCloseSession(),yield this.redirectApi.tryRedirect(this.checkoutService)):this.checkoutService.tryCloseSession()}))}getFormattedAmount(e,t){return this.intl.formatAmount({amount:e,currency:t,currencyFormat:Yt.EXPLICIT,numberFormat:Kt.TRIM})}}class qx{constructor(e,t,n,i,s){this.donationDataPoint=e,this.designationsDataPoint=t,this.currencyService=n,this.tracker=i,this.checkoutConfiguration=s}convertToUSD(e){return null===e?0:this.currencyService.convert(e,this.donationDataPoint.currency,"USD")}getGoalParentId(e){var t;const n=this.designationsDataPoint.allGoalsById.get(e);return null!==(t=null==n?void 0:n.parentId)&&void 0!==t?t:null}}class Vx extends qx{constructor(e,t,n,i,s){super(e,t,n,i,s)}getDonationItemsTrackingData(e,t){var n,i,s,a,o;const r=null===(i=null===(n=this.designationsDataPoint.selectedGoalsAvailability[0])||void 0===n?void 0:n.isAvailable)||void 0===i||i,l=null!==(a=null===(s=this.designationsDataPoint.selectedGoals[0])||void 0===s?void 0:s.id)&&void 0!==a?a:null;return[{donationItemId:ZD(),amount:{value:null!==(o=this.donationDataPoint.amount)&&void 0!==o?o:0,valueInUSD:this.convertToUSD(this.donationDataPoint.amount),isFilled:Boolean(this.donationDataPoint.amount),isEditable:!0},goal:{id:r?l:null,isEditable:r&&!e&&!t,parentGroupId:this.getGoalParentId(l)}}]}}class Hx{constructor(e){this.tracker=e,this._scrollUsedTrackSended=!1,this._checkoutScreenData={isOpened:!1,searchInput:{isVisible:!1},scroll:{isVisible:!1},items:{goals:{count:0},groups:{level1:{count:0},level2:{count:0}}},clickedGoal:{id:null,level:0},clickedGroup:{id:null,level:0,hasChildrenGroups:!1,isOpened:!1}}}trackDesignationScrollUsed(){this._scrollUsedTrackSended||(this.tracker.trackCheckoutCustomEvent({type:Ee.DESIGNATION_TREE_SCROLL_USED,data:{designationTree:{scroll:!0}}}),this._scrollUsedTrackSended=!0)}trackDesignationSearchFinished(e,t){var n,i,s,a;const o={goals:{count:t.currentSize},groups:{level1:{count:null!==(i=null===(n=t.currentCounts[0])||void 0===n?void 0:n.groups)&&void 0!==i?i:0},level2:{count:null!==(a=null===(s=t.currentCounts[1])||void 0===s?void 0:s.groups)&&void 0!==a?a:0}}};this.tracker.trackCheckoutCustomEvent({type:Ee.DESIGNATION_TREE_SEARCH_RESULT,data:{designationTree:{searchString:e,result:o}}})}getCheckoutScreenData(){return this._checkoutScreenData}setListOpen(e){this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{isOpened:e})}setSearchInputVisible(e){this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{searchInput:{isVisible:e}})}setScrollVisible(e){this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{scroll:{isVisible:e}})}setClickedGoal(e){this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{clickedGoal:{id:e.id,level:e.level+1}})}setClickedGroup(e,t){const n=e.nodes.some((e=>!e.isLeaf));this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{clickedGroup:{id:e.id,level:e.level+1,hasChildrenGroups:n,isOpened:t}})}setItems(e){var t,n,i,s;this._checkoutScreenData=Object.assign(Object.assign({},this._checkoutScreenData),{items:{goals:{count:e.currentSize},groups:{level1:{count:null!==(n=null===(t=e.currentCounts[0])||void 0===t?void 0:t.groups)&&void 0!==n?n:0},level2:{count:null!==(s=null===(i=e.currentCounts[1])||void 0===i?void 0:i.groups)&&void 0!==s?s:0}}}})}}class Kx extends dx{constructor(e,t,n){super(e),this.designationsFetcher=t,this.tracker=n,this.designationTreeTrackingService=new Hx(this.tracker),this.donationItemsTrackingService=new Vx(this.donationDataPoint,this.designationsDataPoint,this.currencyService,this.tracker,this.checkoutService.checkoutConfiguration)}addComment(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutState.comment.setIsRequired(!0),this.leave({omitBeforeLeave:!0})}))}validateDesignation(){const e=this.designationDataPoint.getGoalRepeatValidationResult(this.getGoalRepeat(this.viewState.frequency));this.produceViewState((t=>{t.designation.isValid=e.isValid,t.errors.designation.required=e.fields.goal.errors.required}))}validateDesignations(){if(this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.WITHOUT)return;if(this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.ASSIGN&&0===this.checkoutService.checkoutConfiguration.campaign.config.defaultGoals.length)return;const e=this.designationsDataPoint.getValidationResult();this.produceViewState((t=>{t.errors.designations.required=e.fields.goals[0].errors.required,t.designations.isValid=e.isValid}))}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.currencyCode=this.donationDataPoint.currency,e.currencyName=this.currencyService.getName(this.donationDataPoint.currency),e.currencies=this.donationDataPoint.currencyList.map((e=>({code:e,name:this.currencyService.getName(e),type:e}))),e.defaultFiatCurrency=this.donationDataPoint.defaultFiatCurrency,e.frequency=qn.ONCE,e.amount=this.donationDataPoint.amount||null,e.amountInUsd=this.donationDataPoint.amountInUSD||0,e.amountInDefaultFiat=this.donationDataPoint.amountInDefaultFiat,e.minAmount=this.donationDataPoint.minAmount,e.tribute.show=this.tributeDataPoint.isEnabled,e.tribute.isActive=this.tributeDataPoint.isActive,e.tribute.labelType=this.tributeDataPoint.labelType,e.tribute.sharingEnabled=this.tributeDataPoint.isSharingEnabled,e.tribute.name=this.tributeDataPoint.tributeeName,e.tribute.isFilled=this.tributeDataPoint.isFilled,e.tribute.isOptional=this.tributeDataPoint.isOptional,e.tribute.isTributeOriented=this.tributeDataPoint.isTributeOriented,e.designation.show=this.designationDataPoint.isEnabled,e.designation.goalKey=this.designationDataPoint.goalKey,e.designation.goal=this.designationDataPoint.selectedGoal,e.designation.goals=this.designationDataPoint.getAllowedGoalsByFrequency(this.getGoalRepeat(e.frequency)),e.designation.shouldShowDesignation=this.designationDataPoint.isDesignationShowable(this.getGoalRepeat(e.frequency)),e.designation.isEditable=this.designationDataPoint.isEditable(this.getGoalRepeat(e.frequency)),e.designations.availableGoals=this.designationsDataPoint.availableGoals,e.designations.selectedGoals=this.designationsDataPoint.selectedGoals,e.designations.goals=this.designationsDataPoint.goals,e.designations.defaultGoals=this.designationsDataPoint.defaultGoals,e.designations.isOptionsLoading=!1,e.designations.isValueLoading=!1,e.designations.isValid=!0,e.comment.isEnabled=this.commentDataPoint.isEnabled,e.comment.content=this.commentDataPoint.comment,e.comment.prevContent=this.commentDataPoint.prevComment,e.livemode=this.checkoutService.livemode,e.isCryptoAccountConnected=!!this.checkoutService.company.cryptoProvider,e.tracking.donationItems=this.getDonationItemsTrackingData()})),this.tryFetchDesignationGoals().catch((()=>{this.produceViewState((e=>{e.designations.isOptionsLoading=!1,e.designations.isValueLoading=!1}))}))}))}changeAmount(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState.donation.setAmount(e),this.checkoutService.syncUpdateCheckoutState();const t=this.donationDataPoint.getValidationResult();this.produceViewState((n=>{n.amount=e,n.amountInUsd=this.donationDataPoint.amountInUSD||0,n.amountInDefaultFiat=this.donationDataPoint.amountInDefaultFiat,n.isDefaultAmount=!1,n.errors.amount.required=!1,n.errors.amount.min&&(n.errors.amount.min=t.fields.amount.errors.min),n.errors.amount.max&&(n.errors.amount.max=t.fields.amount.errors.max),n.tracking.donationItems=this.getDonationItemsTrackingData()}))}))}validateAmount(){const e=this.donationDataPoint.getValidationResult();this.produceViewState((t=>{t.isAmountValid=e.fields.amount.isValid,t.errors.amount.min=e.fields.amount.errors.min,t.errors.amount.max=e.fields.amount.errors.max,t.errors.amount.required=e.fields.amount.errors.required}))}savePrevComment(){this.checkoutService.checkoutConfiguration.infrastructureParams.showcase||this.checkoutState.comment.savePrevComment()}changeCryptoCurrency(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState.donation.setCurrency(e),this.viewState.isDefaultAmount&&(this.checkoutState.donation.setAmountByDefault(e),this.produceViewState((e=>{e.amount=this.donationDataPoint.total,e.tracking.donationItems=this.getDonationItemsTrackingData()}))),this.checkoutService.syncUpdateCheckoutState(),this.produceViewState((t=>{t.currencyCode=e,t.currencyName=this.currencyService.getName(e),t.amountInUsd=this.donationDataPoint.amountInUSD||0,t.amountInDefaultFiat=this.donationDataPoint.amountInDefaultFiat}))}))}toggleTribute(){this.checkoutState.tribute.setActive(!this.tributeDataPoint.isActive),this.checkoutService.syncUpdateCheckoutState(),this.produceViewState((e=>{e.tribute.isActive=this.tributeDataPoint.isActive,e.tribute.isFilled=this.tributeDataPoint.isFilled}))}changeTributeName(e){this.checkoutState.tribute.setTributeeName(e),this.checkoutService.syncUpdateCheckoutState(),this.produceViewState((e=>{e.tribute.name=this.tributeDataPoint.tributeeName,e.tribute.isFilled=this.tributeDataPoint.isFilled}))}changeGoal(e){this.checkoutState.designation.setGoal(e),this.produceViewState((e=>{e.designation.goalKey=this.designationDataPoint.goalKey,e.designation.goal=this.designationDataPoint.selectedGoal})),this.validateDesignation()}setDesignationsSelectedGoal(e){const t=this.getGoalRepeat(this.viewState.frequency);this.checkoutState.designations.setSelectedGoals([e],t),this.produceViewState((e=>{e.designations.availableGoals=this.designationsDataPoint.availableGoals,e.designations.goals=this.designationsDataPoint.goals,e.designations.selectedGoals=this.designationsDataPoint.selectedGoals,e.tracking.donationItems=this.getDonationItemsTrackingData()})),this.validateDesignations()}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){return!this.pending&&(this.pending=!0,this.produceViewState((e=>{e.processingState=Xl.PENDING})),this.validateAmount(),this.validateDesignation(),this.validateDesignations(),this.viewState.isAmountValid?this.viewState.designations.isValid?(this.checkoutService.updateSession(),this.hold()):(this.produceViewState((e=>{e.designationShakeKey+=1,e.processingState=Xl.IDLE})),this.pending=!1,!1):(this.produceViewState((e=>{e.processingState=Xl.IDLE})),this.pending=!1,!1))}))}isDesignationReadOnly(){return this.designationsDataPoint.isDesignationReadOnly}isDesignationEditable(){return this.designationsDataPoint.isDesignationEditable}trackDesignationScrollUsed(){this.designationTreeTrackingService.trackDesignationScrollUsed()}trackDesignationSearchFinished(e,t){this.designationTreeTrackingService.trackDesignationSearchFinished(e,t),this.designationTreeTrackingService.setItems(t),this.setDesignationTreeTrackingData()}setTrackingDesignationListOpen(e,t){this.designationTreeTrackingService.setListOpen(e),e&&this.designationTreeTrackingService.setItems(t),this.setDesignationTreeTrackingData()}setTrackingDesignationSearchInputVisible(e){this.designationTreeTrackingService.setSearchInputVisible(e),this.setDesignationTreeTrackingData()}setTrackingDesignationListScrollVisible(e){this.designationTreeTrackingService.setScrollVisible(e),this.setDesignationTreeTrackingData()}setTrackingDesignationClickedGoal(e){this.designationTreeTrackingService.setClickedGoal(e),this.setDesignationTreeTrackingData()}setTrackingDesignationClickedGroup(e,t){e&&(this.designationTreeTrackingService.setClickedGroup(e,t),this.setDesignationTreeTrackingData())}setTrackingDesignationItems(e){this.designationTreeTrackingService.setItems(e),this.setDesignationTreeTrackingData()}setDesignationTreeTrackingData(){const e=this.designationTreeTrackingService.getCheckoutScreenData();this.produceViewState((t=>{t.tracking.designationTree=e}),!1)}getInitialViewState(){return{processingState:Xl.IDLE,locked:!1,amount:null,amountInUsd:0,amountInDefaultFiat:0,minAmount:Kx.MIN_DONATION_AMOUNT_IN_USD,maxAmount:Kx.MAX_DONATION_AMOUNT_IN_USD,isAmountValid:!0,currencyCode:"BTC",currencyName:this.currencyService.getName("BTC"),defaultFiatCurrency:"USD",frequency:qn.ONCE,errors:{amount:{min:!1,max:!1,required:!1},payment:{status:!1},designation:{required:!1},designations:{required:!1}},tribute:{name:"",isActive:!1,show:!1,labelType:cf.IN_HONOR_MEMORY,sharingEnabled:!1,isFilled:!1,inHonorOfMaxLength:VI.getInHonorOfMaxLength(),isOptional:!1,isTributeOriented:!1},designation:{show:!1,goalKey:null,goals:[],isEditable:!0,isValid:!0,shouldShowDesignation:!1,goal:null},designations:{isMultipleEnabled:!1,availableGoals:[],goals:[],selectedGoals:[],selectedGoalsAvailability:[],defaultGoals:{[js.RECURRING]:null,[js.ONE_TIME]:null},isOptionsLoading:!1,isValueLoading:!1,isValid:!0},currencies:[],enabledFlows:{money:this.checkoutService.checkoutConfiguration.enabledFlows.money},comment:{isEnabled:this.checkoutService.campaignConfig.showComment,content:"",prevContent:""},flowType:this.checkoutService.type,livemode:!0,isCryptoAccountConnected:!0,isDefaultAmount:!0,designationShakeKey:0,tracking:{donationItems:[],designationTree:{isOpened:!1,searchInput:{isVisible:!1},scroll:{isVisible:!1},items:{goals:{count:0},groups:{level1:{count:0},level2:{count:0}}},clickedGoal:{id:null,level:0},clickedGroup:{id:null,level:0,hasChildrenGroups:!1,isOpened:!1}}}}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.checkoutService.hold();return this.pending=!1,!wn.isFailure(e)||(this.handleHoldError(e),!1)}))}handleHoldError(e){wn.isSuccess(e)||this.produceViewState((e=>{e.errors.payment.status=!0,e.errors.payment.title=this.intl.translate("common.errorOccurredText"),e.errors.payment.message="",e.processingState=Xl.ERROR}))}getGoalRepeat(e){return e===qn.ONCE?js.ONE_TIME:js.RECURRING}tryFetchDesignationGoals(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;const n=null===(t=null===(e=this.checkoutService.checkoutConfiguration.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.id;void 0!==n&&this.produceViewState((e=>{e.designations.isValueLoading=!0})),this.produceViewState((e=>{e.designations.isOptionsLoading=!0})),yield this.tryFetchGoals(n),this.produceViewState((e=>{e.designations.availableGoals=this.designationsDataPoint.availableGoals,e.designations.goals=this.designationsDataPoint.goals,e.designations.selectedGoals=this.designationsDataPoint.selectedGoals,e.designations.isOptionsLoading=!1,e.designations.isValueLoading=!1}))}))}tryFetchGoals(e){return(0,d.sH)(this,void 0,void 0,(function*(){void 0!==e?yield this.withPending((()=>this.designationsFetcher.tryFetchGoals())):yield this.designationsFetcher.tryFetchGoals()}))}hasSelectedDesignations(){return this.designationsDataPoint.selectedGoals.length>0}isDesignationNotShown(){return!!this.hasSelectedDesignations()&&this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.ASSIGN&&!this.checkoutService.checkoutConfiguration.campaign.config.showDesignation}getDonationItemsTrackingData(){return this.donationItemsTrackingService.getDonationItemsTrackingData(this.isDesignationReadOnly(),this.isDesignationNotShown())}}Kx.MIN_DONATION_AMOUNT_IN_USD=100,Kx.MAX_DONATION_AMOUNT_IN_USD=1e8;class Yx extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.checkoutState.cryptoWallet.dataPoint.address;if(!e)throw new Error("cryptoAddress was not set");this.produceViewState((t=>{var n;t.formattedAmount=this.intl.formatCurrency(null!==(n=this.donationDataPoint.total)&&void 0!==n?n:0,{display:"trimzeroes",currency:this.donationDataPoint.currency,withoutPrefix:!0,withoutSuffix:!0}),t.currencyCode=this.donationDataPoint.currency,t.walletAddress=e,t.networkName=this.donationDataPoint.currencyNetworkData.networkName,t.protocol=this.donationDataPoint.currencyNetworkData.protocol})),this.leaveOnSuccessfulPayment()}))}getInitialViewState(){return{locked:!1,formattedAmount:"0",walletAddress:"",currencyCode:"",networkName:"",protocol:""}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}leaveOnSuccessfulPayment(){const e=setInterval((()=>{this.checkoutService.isPaymentCompleted&&(clearInterval(e),this.leave())}),5e3)}}const zx={[$u.CRYPTO_CURRENCY]:class extends Kx{},[$u.CRYPTO_WALLET]:class extends Yx{},[wl.COMMENT]:class extends mx{},[wl.PRIVACY]:class extends bx{},[wl.THANK_YOU]:class extends Gx{},[wl.REMIND_ME]:class extends Nx{},[wl.MAILING_ADDRESS]:class extends yx{},[wl.MANDATORY_QUESTIONS]:class extends fx{},[wl.QUESTIONS]:class extends Px{},[wl.BLOCKED]:class extends hx{}};class Wx{static isCryptoCurrencyScreenController(e,t){return t===$u.CRYPTO_CURRENCY}static isCryptoWalletScreenController(e,t){return t===$u.CRYPTO_WALLET}static isThankYouScreenController(e,t){return t===wl.THANK_YOU}static isMailingAddressScreenController(e,t){return t===wl.MAILING_ADDRESS}static isBlockedScreenController(e,t){return t===wl.BLOCKED}constructor(e,t,n,i,s,a,o,r,l,c){this.checkoutService=e,this.checkoutState=t,this.intl=n,this.debug=i,this.currencyService=s,this.subscriptionPeriodLabelsService=a,this.mailingAddressCustomization=o,this.experiments=r,this.designationsFetcher=l,this.tracker=c}create(e,t){const n=zx[e],i={name:e,flow:t,checkoutService:this.checkoutService,checkoutState:this.checkoutState,debug:this.debug,intl:this.intl,subscriptionPeriodLabelsService:this.subscriptionPeriodLabelsService,currencyService:this.currencyService,experiments:this.experiments};return Wx.isCryptoCurrencyScreenController(n,e)?new n(Object.assign({},i),this.designationsFetcher,this.tracker):Wx.isCryptoWalletScreenController(n,e)?new n(Object.assign({},i)):Wx.isThankYouScreenController(n,e)?new n(this.redirectApi,this.sharingApi,i):Wx.isMailingAddressScreenController(n,e)?new n(this.countriesService,this.mailingAddressCustomization,this.tracker,i):(Wx.isBlockedScreenController(n,e),new n(i))}get redirectApi(){return this.checkoutService.redirectApi}get sharingApi(){return this._sharingApi||(this._sharingApi=cx({checkoutType:this.checkoutService.checkoutConfiguration.checkoutType,isShowcase:this.checkoutService.checkoutConfiguration.infrastructureParams.showcase,campaignConfig:this.checkoutService.campaignConfig})),this._sharingApi}get countriesService(){return this._countriesService||(this._countriesService=(0,nk.g)({intl:this.intl,excludePalestineFromCountriesList:this.checkoutService.checkoutConfiguration.featureConfig.excludePalestineFromCountriesList})),this._countriesService}}class $x{constructor(e){this.options=e,this._screensHistoryForRestore=[]}getScreensHistoryForRestore(){return this._screensHistoryForRestore}setScreensHistoryForRestore(e){this._screensHistoryForRestore=e}getCustomExternalParamsScreen(){var e;const{checkoutConfiguration:t,isValidScreen:n}=this.options,i=null===(e=t.external.flow)||void 0===e?void 0:e.screen;return void 0!==i&&n(i)?i:void 0}getInitialScreenFromHistory(){const e=this.getScreensHistoryForRestore();if(0===e.length)return null;const t=e[e.length-1];return this.options.isValidScreen(t)?t:null}}class Xx extends $x{getInitialScreen(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.isCompanyBlocked())return wl.BLOCKED;const e=this.getCustomExternalParamsScreen();return void 0!==e?e:$u.CRYPTO_CURRENCY}))}isCompanyBlocked(){return Boolean(this.options.checkoutConfiguration.company.blockedAt)}}const Qx=$u.CRYPTO_CURRENCY;function Zx(e){return function(t){return e.some((e=>e===t))}}const Jx=Zx([$u.CRYPTO_CURRENCY,$u.CRYPTO_WALLET,wl.COMMENT,wl.PRIVACY,wl.THANK_YOU,wl.MAILING_ADDRESS,wl.MANDATORY_QUESTIONS,wl.QUESTIONS,wl.BLOCKED]),ew=e=>{let{showDesignation:t,displayGoal:n,defaultGoals:i,frequency:s}=e;return(t||n!==la.ASSIGN)&&i[s!==qn.ONCE?js.RECURRING:js.ONE_TIME]?{isVisible:!0}:{isVisible:!1}};var tw;function nw(e){if(Hl()&&e.rateMatching)return e.rateMatching.enabled?{enabled:e.rateMatching.enabled,isSponsorLogoShown:e.rateMatching.isSponsorLogoShown,isDonationLessThanMin:e.rateMatching.isDonationLessThanMin,isDonationEqualMin:e.rateMatching.isDonationEqualMin,isDonationOverMaxLimit:e.rateMatching.isDonationOverMaxLimit,isDaysCountdownShown:e.rateMatching.isDaysCountdownEnabled,isHourCountdownShown:e.rateMatching.isHourCountdownEnabled}:{enabled:!1,isSponsorLogoShown:!1,isDonationLessThanMin:!1,isDonationEqualMin:!1,isDonationOverMaxLimit:!1,isDaysCountdownShown:!1,isHourCountdownShown:!1}}!function(e){e.FUNDRAISER="fundraiser",e.CAMPAIGN="campaign"}(tw||(tw={}));const iw=[Vn.DONATE,Vn.DOUBLE,Vn.GIFT_AID,Vn.PAYMENT_OPTIONS,Vn.UK_BACS,Vn.UPSELL,Vn.COMMUNICATION_CONSENT,wl.COMMENT,wl.MAILING_ADDRESS,wl.PRIVACY,wl.THANK_YOU,wl.REMIND_ME,$u.CRYPTO_CURRENCY,Vn.FAST_TRACK_PAYMENT_OPTIONS];class sw{format(e,t,n,i,s){return function(e,t,n,i,s){if(a=e,!iw.some((e=>e===a)))return{};var a;switch(e){case Vn.DONATE:return function(e,t,n,i){var s,a,o,r;const l=i.getAskPageConfig(),c=[e.leftButtonFrequency,e.rightButtonFrequency];return e.donation.showAnnualTab&&c.push(qn.ANNUAL),{isFiatEnabled:!0,isCryptoEnabled:e.enabledFlows.crypto,frequency:{value:e.donation.frequency,options:c,editable:e.donation.canModifyFrequency,isEndDateActive:e.donation.showDonationEndDate?e.donation.isDonationEndDateActive:null},amountOptions:{selected:e.donation.amountOptions.includes(null!==(s=e.donation.amount)&&void 0!==s?s:0),values:e.donation.amountOptions,shown:e.donation.canModifyAmount&&!e.donation.hintOptions},amount:{filled:!!e.donation.amount,value:null!==(a=e.donation.amount)&&void 0!==a?a:0,editable:e.donation.canModifyAmount,hasExternalAmount:i.hasExternalAmount},currency:{value:e.donation.currency,editable:e.donation.canSelectCurrency},tribute:{filled:e.tribute.isFilled,type:e.tribute.show?e.tribute.labelType:null,shown:e.tribute.show},comment:{shown:e.comment.isEnabled,filled:!!e.comment.content},goal:{value:null,editable:!1,shown:!1},askPage:{shown:l.show},fundraisingPage:{shown:Boolean((null===(o=i.fundraisingPage)||void 0===o?void 0:o.key)&&n.askPageActiveTab===Ql.FUNDRAISER),isTabsShown:l.showTabs,fundraiserImageType:l.fundraiserImage?tw.FUNDRAISER:tw.CAMPAIGN},hint:t.donation.currentHint&&{amount:t.donation.currentHint.amount,description:t.donation.currentHint.description,amountUsd:t.donation.currentHint.amountUsd}||null,hintOptions:(null===(r=t.donation.hintOptions)||void 0===r?void 0:r.map((e=>({amount:e.amount,description:e.description,amountUsd:e.amountUsd,default:e.default}))))||null,hintVariantName:t.donation.hintVariantName||null,aiEnabled:i.campaign.config.enableAI,goalMeter:t.goalMeter,annualCheckbox:e.donation.showAnnualCheckbox?{shown:e.donation.showAnnualCheckbox,checked:e.donation.annualCheckboxChecked}:void 0,defaultDesignation:ew({showDesignation:i.campaign.config.showDesignation,displayGoal:i.campaign.config.displayGoal,defaultGoals:e.designations.defaultGoals,frequency:e.donation.frequency}),donationItems:e.tracking.donationItems,designationTree:e.tracking.designationTree,matching:nw(e)}}(t,n,i,s);case Vn.UPSELL:return function(e){var t,n,i,s;return{amount:{value:e.upsell.fromAmount,valueInUsd:e.upsell.fromAmountInUSD},currency:{value:e.currency},smallAmount:{shown:null!==e.lowAmount,value:null!==(t=e.lowAmount)&&void 0!==t?t:0,valueInUsd:null!==(n=e.lowAmountInUSD)&&void 0!==n?n:0},bigAmount:{value:null!==(i=e.highAmount)&&void 0!==i?i:0,valueInUsd:null!==(s=e.highAmountInUSD)&&void 0!==s?s:0,frequency:e.targetFrequency}}}(t);case Vn.PAYMENT_OPTIONS:return function(e,t,n){var i;const s=e.availableOptions.filter((t=>e.buttonOptions[t].visible)),a=n.getAskPageConfig(),o={coverFees:{checked:e.isFeeCovered,fees:e.processingFee,total:e.total,currency:e.currency},frequency:e.frequency,paymentMethods:s,paymentOptions:{visible:e.displayedPaymentOptions,hidden:e.hiddenPaymentOptions},askPage:{shown:a.show},fundraisingPage:{shown:Boolean((null===(i=n.fundraisingPage)||void 0===i?void 0:i.key)&&t.askPageActiveTab===Ql.FUNDRAISER),isTabsShown:a.showTabs,fundraiserImageType:a.fundraiserImage?tw.FUNDRAISER:tw.CAMPAIGN},card:{number:{filled:e.cardFilledFields[Bv.CARD_NUMBER]},expiry:{filled:e.cardFilledFields[Bv.CARD_EXPIRY]},cvc:{filled:e.cardFilledFields[Bv.CARD_CVC]}}};return e.isFeeCoverageSelectionExperimentEnabled&&(o.coverFees.coverageLevel=e.coverageLevel,o.coverFees.fullFee=e.fullFee,o.coverFees.partialFee=e.partialFee,o.coverFees.coverageLevel===fN.PARTIAL&&(o.coverFees.fees=e.processingPartialFee)),o}(t,i,s);case Vn.GIFT_AID:return{shown:!0};case Vn.UK_BACS:return function(e){return{accountNumber:{filled:!!e.accountNumber},sortCode:{filled:!!e.sortCode}}}(t);case Vn.DOUBLE:return function(e){return{upsell:{currency:e.currency,currentAmount:e.total,matchingFromAmount:e.minimumMatchedAmount,matchingPromisedAmount:e.matchingPromisedAmount,matchingRatio:e.matchingRatio,proposedAmount:e.proposedAmount,proposedAmountBeforeFeeCovered:e.proposedAmountBeforeFeeCovered,show:e.showDTDUpsellExperiment&&e.showDTDUpsell},employer:{filled:!!e.employer.name,filledFromList:e.companies.some((t=>{let{company_name:n}=t;return n===e.employer.name}))}}}(t);case wl.COMMENT:return function(e){return{comment:{filled:!!e.comment}}}(t);case wl.PRIVACY:return function(e,t,n){var i;const s=n.getAskPageConfig(),a=e.availableFastTrackPaymentOptions.filter((t=>e.fastTrackButtonOptions[t].visible)),o={firstName:{filled:!!e.firstName},lastName:{filled:!!e.lastName},email:{filled:!!e.email,validated:!1,valid:null},phoneNumber:{shown:e.showPhone,required:e.phoneRequired,filled:!!e.phone},anonymous:{shown:e.showAnonymous,filled:e.anonymousChecked},onBehalfOf:{shown:e.onBehalfOf.isEnabled,filled:!!e.onBehalfOf.companyName},terms:{shown:e.termsAndConditions.isEnabled,checked:e.termsAndConditions.isAccepted},generalConsent:{shown:e.generalConsent.isEnabled,checked:e.generalConsent.isEnabled&&e.generalConsent.isAccepted},askPage:{shown:s.show},fundraisingPage:{shown:Boolean((null===(i=n.fundraisingPage)||void 0===i?void 0:i.key)&&t.askPageActiveTab===Ql.FUNDRAISER),isTabsShown:s.showTabs,fundraiserImageType:s.fundraiserImage?tw.FUNDRAISER:tw.CAMPAIGN}};return a.length>0&&(o.paymentMethods=a),o}(t,i,s);case wl.MAILING_ADDRESS:return function(e){return{mailingAddressRequired:e.isRequired,city:{filled:!!e.city},country:{filled:!!e.countryCode,value:e.countryCode},line1:{filled:!!e.line1},line2:{filled:!!e.line2},postal:{filled:!!e.postal},region:{filled:!!e.region,value:e.region},sublocality:{filled:!!e.sublocality},administrativeArea:{filled:!!e.administrativeArea},benefits:{shown:e.benefitDeliveryAddress.isEnabled,firstName:{filled:!!e.benefitDeliveryAddress.firstName},lastName:{filled:!!e.benefitDeliveryAddress.lastName},line1:{filled:!!e.benefitDeliveryAddress.line1},line2:{filled:!!e.benefitDeliveryAddress.line2},city:{filled:!!e.benefitDeliveryAddress.city},postal:{filled:!!e.benefitDeliveryAddress.postal},region:{filled:!!e.benefitDeliveryAddress.region,value:e.benefitDeliveryAddress.region},country:{filled:!!e.benefitDeliveryAddress.countryCode,value:e.benefitDeliveryAddress.countryCode},sublocality:{filled:!!e.benefitDeliveryAddress.sublocality},administrativeArea:{filled:!!e.benefitDeliveryAddress.administrativeArea}}}}(t);case wl.THANK_YOU:return function(e){return{amount:{value:e.total},currency:{value:e.currency},email:{shown:e.sharing.showEmail},facebook:{shown:e.sharing.showFacebook},linkedin:{shown:e.sharing.showLinkedin},twitter:{shown:e.sharing.showTwitter},makeAnotherDonation:{shown:e.tribute.makeAnotherDonation},completeDedication:{shown:e.tribute.completeDedication},pdu:{shown:e.postDonationUpsell.shown,amount:e.postDonationUpsell.amount,amountInUSD:e.postDonationUpsell.amountInUSD,currency:e.currency,minAmount:e.postDonationUpsell.recurringMinAmount,period:e.postDonationUpsell.period,total:e.total}}}(t);case wl.REMIND_ME:return function(e){return{email:{filled:!!e.email.value},terms:{shown:e.isTermsAndConditionsEnabled,checked:e.termsAndConditions.isAccepted}}}(t);case $u.CRYPTO_CURRENCY:return function(e,t,n){var i;return{isFiatEnabled:e.enabledFlows.money,isCryptoEnabled:!0,tribute:{filled:e.tribute.isFilled,type:e.tribute.show?e.tribute.labelType:null,shown:e.tribute.show},comment:{shown:e.comment.isEnabled,filled:!!e.comment.content},goal:{value:e.designation.goalKey,editable:e.designation.isEditable,shown:e.designation.show},askPage:{shown:n.getAskPageConfig().show},fundraisingPage:{shown:Boolean((null===(i=n.fundraisingPage)||void 0===i?void 0:i.key)&&t.askPageActiveTab===Ql.FUNDRAISER)},cryptocurrency:e.currencyCode,defaultDesignation:ew({showDesignation:n.campaign.config.showDesignation,displayGoal:n.campaign.config.displayGoal,defaultGoals:e.designations.defaultGoals,frequency:e.frequency}),donationItems:e.tracking.donationItems,designationTree:e.tracking.designationTree}}(t,i,s);case Vn.COMMUNICATION_CONSENT:return(e=>{const t=t=>{const n=e.channels.find((e=>e.type===t));return{shown:Boolean(n),checked:!!n&&n.isAccepted}};return{channels:{email:t(ks.EMAIL),sms:t(ks.SMS),phoneCalls:t(ks.PHONE_CALLS),postalMail:t(ks.POSTAL_MAIL),socialMedia:t(ks.SOCIAL_MEDIA)}}})(t);case Vn.FAST_TRACK_PAYMENT_OPTIONS:return function(e,t){const n=t.getAskPageConfig(),i=e.availableOptions.filter((t=>e.buttonOptions[t].visible));return{coverFees:{checked:e.isFeeCovered,fees:e.processingFee,total:e.total,currency:e.currency},paymentMethods:i,frequency:e.frequency,onBehalfOf:{shown:e.onBehalfOf.isEnabled,filled:!!e.onBehalfOf.companyName},askPage:{shown:n.show},anonymous:{shown:e.showAnonymous,filled:e.anonymousChecked},generalConsent:{shown:e.generalConsent.isEnabled,checked:e.generalConsent.isEnabled&&e.generalConsent.isAccepted},terms:{shown:e.termsAndConditions.isEnabled,checked:e.termsAndConditions.isAccepted}}}(t,s);default:throw new Bs.HP(e,`Unknown screen name "${e}"`)}}(e,t,n,i,s)}}Error,Error;class aw extends Error{constructor(){super("Intent secret is not provided")}}Error;class ow extends Error{constructor(e){super("Could not retrieve iDEAL payment intent"),this.resultError=e}}Error;class rw{constructor(e){this.stripeLoadingPromise=e,this.stripeInstance=null}getStripe(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.stripeInstance)return this.stripeInstance;const e=yield this.stripeLoadingPromise();if(!e)throw new Error("Stripe is not provided");return this.stripeInstance=e,e}))}}class lw{static handleError(e){return"validation_error"===e.type?wn.fail({}):wn.fail({message:e.message})}constructor(e,t,n,i,s,a,o){this.intl=t,this.sentry=n,this.paymentAPI=i,this.donorName=s,this.donorEmail=a,this.setPaymentMethod=o,this.name=Gn.ACSS,this.intentSecret=null,this.params=null,this.stripeInstanceManager=new rw(e)}initiateFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.params=e,!0}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.ACSS});if(wn.isFailure(e))return e;const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s;if(this.setPaymentMethod(Gn.ACSS),yield this.hold(),!this.intentSecret)return wn.fail({});let a;const o=yield this.stripeInstanceManager.getStripe();try{a=yield o.retrieveSetupIntent(this.intentSecret)}catch(m){return this.sentry.captureException(m,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.ACSS),e))),wn.fail({})}if((null===(e=a.setupIntent)||void 0===e?void 0:e.status)===k_.SUCCEEDED)return wn.success(void 0);const{firstName:c,lastName:u}=this.donorName.getDto(),{email:d}=this.donorEmail.getDto();let h;try{null===(n=null===(t=this.params)||void 0===t?void 0:t.onPopupOpen)||void 0===n||n.call(t),h=yield o.confirmAcssDebitSetup(this.intentSecret,{payment_method:{billing_details:{name:_N([c,u]),email:d}}},{skipMandate:!1})}catch(m){return this.sentry.captureException(m,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.ACSS),e))),wn.fail({message:this.commonErrorText})}finally{null===(s=null===(i=this.params)||void 0===i?void 0:i.onPopupClose)||void 0===s||s.call(i)}const m=h.error;return m?lw.handleError(m):wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}get commonErrorText(){return this.intl.translate("common.errorOccurredText")}}var cw;!function(e){e.PAYMENT_METHOD_MICRODEPOSIT_VERIFICATION_DESCRIPTOR_CODE_MISMATCH="payment_method_microdeposit_verification_descriptor_code_mismatch",e.PAYMENT_METHOD_MICRODEPOSIT_VERIFICATION_ATTEMPTS_EXCEEDED="payment_method_microdeposit_verification_attempts_exceeded",e.BANK_ACCOUNT_UNUSABLE="bank_account_unusable",e.ACCOUNT_NUMBER_INVALID="account_number_invalid",e.PAYMENT_INTENT_AUTHENTICATION_FAILURE="payment_intent_authentication_failure"}(cw||(cw={}));const uw=["INR","USD","EUR","GBP","SGD","CAD","CHF","SEK","AED","JPY","NOK","MYR","HKD"];class dw{static handleCardError(e,t,n){return{message:t?e.translate("creditCard.error.title"):n,additionalMessage:t?e.translate("creditCard.error.message"):void 0}}static handle3DsAuthResult(e){return e?e.code===cw.PAYMENT_INTENT_AUTHENTICATION_FAILURE?wn.fail({message:e.message}):wn.fail({}):wn.success({})}constructor(e,t){this.paymentAPI=t,this.stripeInstanceManager=new rw(e)}validateStripePaymentMethod(e,t,n){var i;if((null===(i=null==e?void 0:e.card)||void 0===i?void 0:i.country)!==sn.INDIA)return wn.success({});const s=this.validateIndianCard(t,n);return wn.isFailure(s)?s:wn.success({})}perform(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentAPI.pay({paymentMethod:e});if(wn.isSuccess(t))return t;const n=t.failureResult.errors,i=null==n?void 0:n.customCode,s=null==n?void 0:n.intentSecret;return n?i&&s&&"requires_action"===n.customCode?this.initiate3DS(n.intentSecret,e):wn.fail({}):wn.fail({hasBaseErrorMessage:!!t.failureResult.message})}))}validateIndianCard(e,t){return e.getFrequency()===qn.ONCE?wn.success({}):e.getFrequency()===qn.DAILY&&this.isIndianCardRestrictedRecurringCurrency(e.getCurrency())?wn.fail({shouldLeave:!1,title:t.translate("creditCard.error.indianCardError.title"),message:t.translate("creditCard.error.indianCardError.notValidFrequencyAndCurrency",{currency:e.getCurrency()})}):e.getFrequency()===qn.DAILY?wn.fail({shouldLeave:!1,title:t.translate("creditCard.error.indianCardError.title"),message:t.translate("creditCard.error.indianCardError.notValidFrequency")}):this.isIndianCardRestrictedRecurringCurrency(e.getCurrency())?wn.fail({shouldLeave:!1,title:t.translate("creditCard.error.indianCardError.title"),message:t.translate("creditCard.error.indianCardError.notValidCurrency",{currency:e.getCurrency()})}):wn.success({})}isIndianCardRestrictedRecurringCurrency(e){return!uw.includes(e)}initiate3DS(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){const n=yield this.stripeInstanceManager.getStripe(),i=yield n.handleCardAction(e),s=dw.handle3DsAuthResult(i.error);if(wn.isFailure(s))return s;const a=yield this.paymentAPI.pay({paymentMethod:t});return wn.isFailure(a)?wn.fail({}):a}))}}const hw="Payment cancelled";class mw{constructor(e){this.params=e}init(){return this.makePaymentRequest().then((e=>{let{canMakePaymentResult:t}=e;return!!(null==t?void 0:t.applePay)}))}create(e,t){return this.makePaymentRequest(t).then((t=>{let{paymentRequest:n}=t;const i=new Promise(((e,t)=>{n.once("token",(t=>{t.complete("success"),e({token:t.token,payerName:t.payerName,payerEmail:t.payerEmail,payerPhone:t.payerPhone,shippingAddress:t.shippingAddress})})).once("cancel",(()=>{t(hw)}))})),{total:s,displayItems:a}=this.params.request;return n.update({total:{label:s.label,amount:e.amount},displayItems:a,currency:e.currency}),n.show(),i.finally((()=>{n.off("token").off("cancel")}))})).then((e=>({stripeVerifier:e})))}makePaymentRequest(e){const t=this.params.stripe();if(!t)throw new Error("Stripe is not provided");return t.then((t=>{const n=Object.assign(Object.assign({},this.params.request),{requestPayerEmail:!0,requestPayerName:!0,wallets:["applePay"]});return(null==e?void 0:e.isFastTrackExperimentEnabled())&&(e.isMailingAddressRequired()&&(n.requestShipping=!0,n.shippingOptions=[{id:"shipping",label:"",detail:"",amount:0}]),e.isPhoneNumberRequired()&&(n.requestPayerPhone=!0)),t.paymentRequest(n)})).then((e=>new Promise(((t,n)=>{e.canMakePayment().then((n=>{t({canMakePaymentResult:n,paymentRequest:e})})).catch((e=>{n(e)}))}))))}}class pw{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S,E){this.config=e,this.applePayStripeLoadingPromise=t,this.sentry=n,this.intl=i,this.paymentAPI=s,this.donation=a,this.setPaymentMethod=o,this.setDonorFullNameIfEmpty=r,this.setDonorEmailIfEmpty=l,this.setCountryCodeIfEmptyAddress=c,this.setCityIfEmpty=u,this.setLine1IfEmpty=d,this.setLine2IfEmpty=h,this.setPostalIfEmpty=m,this.setRegionIfEmpty=p,this.isFastTrackExperimentEnabled=g,this.isMailingAddressRequired=y,this.isPhoneNumberRequired=f,this.setDonorPhoneIfEmpty=v,this.setPhoneCleanNumber=S,this.setPhoneCountryCodeIfEmptyPhone=E,this.name=Gn.APPLE_PAY,this.cardToken=null,this.params=null,this.stripeInstanceManager=new rw(t),this.applePayPaymentMethodService=new mw({request:e,stripe:t})}checkAvailability(){return(0,d.sH)(this,void 0,void 0,(function*(){try{return yield this.applePayPaymentMethodService.init()}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.APPLE_PAY),e))),!1}}))}initiateFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return!0}))}startFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(e&&(this.params=e),this.setPaymentMethod(Gn.APPLE_PAY),this.cardToken=yield this.createToken(),!this.cardToken)return wn.fail({});const t=yield this.hold();return wn.isFailure(t)?wn.fail({message:this.intl.translate("common.errorOccurredText")}):wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){try{const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.APPLE_PAY});if(wn.isFailure(e))return e}catch(e){return wn.fail({shouldLeave:!1})}return wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.cardToken||(this.cardToken=yield this.createToken()),!this.cardToken)return wn.fail({shouldLeave:!1});const e=yield this.createStripePaymentMethod(this.cardToken);if(wn.isFailure(e))return this.cardToken=null,wn.fail({shouldLeave:!1,message:e.failureResult.message});const t=yield this.initiatePayment(e.successResult);if(this.cardToken=null,wn.isSuccess(t))return t;const{message:n,additionalMessage:i}=dw.handleCardError(this.intl,t.failureResult.hasBaseErrorMessage,t.failureResult.message);return wn.fail({shouldLeave:!1,message:n,additionalMessage:i})}))}initiatePayment(e){return(0,d.sH)(this,void 0,void 0,(function*(){return new dw(this.applePayStripeLoadingPromise,this.paymentAPI).perform(e)}))}createStripePaymentMethod(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.stripeInstanceManager.getStripe();let n;try{n=yield t.createPaymentMethod({type:p_.CARD,card:{token:e}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.APPLE_PAY),e))),wn.fail({})}return n.error?wn.fail({message:n.error.message}):n.paymentMethod?wn.success(n.paymentMethod):wn.fail({})}))}createToken(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s,a,o,c;let u;try{null===(t=null===(e=this.params)||void 0===e?void 0:e.onPopupOpen)||void 0===t||t.call(e),u=yield this.applePayPaymentMethodService.create({amount:this.donation.getTotal(),currency:this.donation.getCurrency().toLowerCase()},{isFastTrackExperimentEnabled:this.isFastTrackExperimentEnabled,isMailingAddressRequired:this.isMailingAddressRequired,isPhoneNumberRequired:this.isPhoneNumberRequired}),u.stripeVerifier&&this.setDonorInfo(u.stripeVerifier)}catch(e){return null===(i=null===(n=this.params)||void 0===n?void 0:n.onPopupClose)||void 0===i||i.call(n),e!==hw&&this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.APPLE_PAY),e))),null}return null===(a=null===(s=this.params)||void 0===s?void 0:s.onPopupClose)||void 0===a||a.call(s),(null===(c=null===(o=u.stripeVerifier)||void 0===o?void 0:o.token)||void 0===c?void 0:c.id)||null}))}setDonorInfo(e){this.setPrivacy(e),this.setDonorMailingAddress(e)}setPrivacy(e){var t;const{payerEmail:n,payerName:i,payerPhone:s,shippingAddress:a}=e,o=(null==a?void 0:a.phone)||s;n&&this.setDonorEmailIfEmpty(n);const r=(null==a?void 0:a.recipient)||i||(null===(t=e.token.card)||void 0===t?void 0:t.name);r&&this.setDonorFullNameIfEmpty(r),(null==a?void 0:a.country)&&this.setPhoneCountryCodeIfEmptyPhone(a.country),o&&(this.setDonorPhoneIfEmpty(o),this.setPhoneCleanNumber(o))}setDonorMailingAddress(e){var t,n;const{shippingAddress:i}=e;if(!i)return;const s=i.country,a=null===(t=i.addressLine)||void 0===t?void 0:t[0],o=null===(n=i.addressLine)||void 0===n?void 0:n[1],r=i.postalCode,l=i.city,c=i.region;s&&this.setCountryCodeIfEmptyAddress(s),a&&this.setLine1IfEmpty(a),o&&this.setLine2IfEmpty(o),r&&this.setPostalIfEmpty(r),l&&this.setCityIfEmpty(l),c&&this.setRegionIfEmpty(c)}}Error,Error;class gw extends Error{constructor(){super("AU BECS intent secret not found")}}class yw extends Error{constructor(){super("AU BECS personal information required")}}class fw{constructor(e,t,n,i,s,a,o){this.stripeElementsLoadingPromise=t,this.donorName=n,this.donorEmail=i,this.sentry=s,this.paymentAPI=a,this.params=o,this.name=Gn.AU_BECS,this.intentSecret=null,this.completed=!1,this.elementReady=!1,this.hasElementError=!1,this.initiated=!1,this.onElementChange=e=>{this.completed=e.complete,this.hasElementError=!!e.error},this.stripeInstanceManager=new rw(e)}initiateFlow(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return this.initiated||(this.auBankAccountElement=yield this.createElement(),this.auBankAccountElement.once("ready",(()=>{this.elementReady=!0,(null==t?void 0:t.onAuBankAccountElementReady)&&t.onAuBankAccountElementReady()})),this.auBankAccountElement.on("change",this.onElementChange),this.auBankAccountElement.mount(e),this.initiated=!0),!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.elementReady?!this.completed&&!(yield this.validatePayment())||this.hasElementError?wn.fail({}):wn.success(void 0):wn.fail({})}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.AU_BECS});if(wn.isFailure(e))return e;const{intentSecret:t}=e.successResult;if(!t)throw new gw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.intentSecret)throw new gw;const{firstName:e,lastName:t}=this.donorName.getDto(),{email:n}=this.donorEmail.getDto();if(!n||!e||!t)throw new yw;const i=yield this.retrieveSetupIntent(this.intentSecret);if(!i)return wn.fail({shouldLeave:!1});if(i.status===k_.SUCCEEDED)return this.requestPay();const s=yield this.confirmDebitSetup(this.intentSecret);return wn.isFailure(s)?wn.fail({shouldLeave:!1,message:s.failureResult.message}):s.successResult.status===k_.SUCCEEDED?this.requestPay():wn.fail({shouldLeave:!1})}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;null===(e=this.auBankAccountElement)||void 0===e||e.destroy()}))}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}confirmDebitSetup(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.getElement(),{firstName:n,lastName:i}=this.donorName.getDto(),{email:s}=this.donorEmail.getDto();let a;const o=yield this.stripeInstanceManager.getStripe();try{a=yield o.confirmAuBecsDebitSetup(e,{payment_method:{au_becs_debit:t,billing_details:{name:_N([n,i]),email:s}}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.AU_BECS),e))),wn.fail({shouldLeave:!1})}return a.error?"validation_error"===a.error.type||a.error.code===cw.ACCOUNT_NUMBER_INVALID?wn.fail({shouldLeave:!1,message:a.error.message}):wn.fail({shouldLeave:!1}):wn.success(a.setupIntent)}))}retrieveSetupIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrieveSetupIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.AU_BECS),e))),null}return t.error?null:t.setupIntent}))}validatePayment(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.getElement();let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.createPaymentMethod({type:p_.AU_BECS,au_becs_debit:e,billing_details:{name:Xi,email:Qi}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.AU_BECS),e))),!1}return!!t.paymentMethod&&!t.error}))}getElement(){if(!this.auBankAccountElement)throw new Error("auBankAccountElement is not initialized");return this.auBankAccountElement}createElement(){return(0,d.sH)(this,void 0,void 0,(function*(){return(yield this.stripeElementsLoadingPromise).create("auBankAccount",{iconStyle:"default",disabled:!1,hideIcon:!1,style:this.params.stripe.elementStyles,classes:this.params.stripe.elementClasses})}))}}class vw extends Error{constructor(){super("Card element not found")}}class Sw{constructor(e,t,n,i,s,a,o,r,l,c){this.stripeElementsLoadingPromise=t,this.sentry=n,this.intl=i,this.failureHandler=s,this.paymentAPI=a,this.setPaymentMethodCountry=o,this.donation=r,this.params=l,this.tracker=c,this.name=Gn.CARD,this.elementsSource=null,this.elementsState=this.getElementsInitialState(),this.handleElementChange=(e,t)=>{e===Bv.CARD_NUMBER&&this.params.stripe.stripeLinkExperimentIsTestGroup&&t.complete&&this.handleStripeLinkCheck(),this.elementsState[e].completed=t.complete,this.elementsState[e].hasError=!!t.error},this.handleElementReady=(e,t)=>{this.elementsState[e].ready=!0,t&&t(e)},this.stripeInstanceManager=new rw(e),this.cardPaymentInitiator=new dw(e,this.paymentAPI)}initiateFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n,i;const{source:s,cardCvcContainer:a,cardExpiryContainer:o,cardNumberContainer:r,cardCvcOptions:l,cardNumberOptions:c,stripeElementStyleOverride:u,onCardElementReady:d}=e;if(this.elementsSource===s)return!0;this.elementsSource=s,this.elementsState=this.getElementsInitialState();const h=yield this.stripeElementsLoadingPromise;null===(t=h.getElement(Bv.CARD_NUMBER))||void 0===t||t.destroy(),null===(n=h.getElement(Bv.CARD_EXPIRY))||void 0===n||n.destroy(),null===(i=h.getElement(Bv.CARD_CVC))||void 0===i||i.destroy();const m=h.create(Bv.CARD_NUMBER,{iconStyle:"default",showIcon:void 0===(null==c?void 0:c.showIcon)||c.showIcon,style:void 0!==u?u:this.params.stripe.elementStyles,classes:this.params.stripe.elementClasses,placeholder:void 0!==(null==c?void 0:c.placeholder)?c.placeholder:this.intl.translate("creditCard.numberInput.label"),disableLink:this.shouldDisableStripeLink()}),p=h.create(Bv.CARD_EXPIRY,{style:void 0!==u?u:this.params.stripe.elementStyles,classes:this.params.stripe.elementClasses}),g=h.create(Bv.CARD_CVC,{style:void 0!==u?u:this.params.stripe.elementStyles,classes:this.params.stripe.elementClasses,placeholder:void 0!==(null==l?void 0:l.placeholder)?l.placeholder:void 0});return m.on("change",this.handleElementChange.bind(this,Bv.CARD_NUMBER)),p.on("change",this.handleElementChange.bind(this,Bv.CARD_EXPIRY)),g.on("change",this.handleElementChange.bind(this,Bv.CARD_CVC)),m.once("ready",this.handleElementReady.bind(this,Bv.CARD_NUMBER,d)),p.once("ready",this.handleElementReady.bind(this,Bv.CARD_EXPIRY,d)),g.once("ready",this.handleElementReady.bind(this,Bv.CARD_CVC,d)),m.mount(r),p.mount(o),g.mount(a),!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.elementsReady)return wn.fail({});const e=yield this.stripeInstanceManager.getStripe();return!this.elementsCompleted||this.hasElementsError?(yield e.createToken(yield this.getCardNumberElement()),wn.fail({})):wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.paymentAPI.hold({clientPaymentMethod:Gn.CARD})}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.stripeElementsLoadingPromise,t=e.getElement(Bv.CARD_NUMBER),n=e.getElement(Bv.CARD_EXPIRY),i=e.getElement(Bv.CARD_CVC);null==t||t.destroy(),null==n||n.destroy(),null==i||i.destroy()}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.createStripePaymentMethod();if(wn.isSuccess(e)){const t=this.cardPaymentInitiator.validateStripePaymentMethod(e.successResult,this.donation,this.intl);if(wn.isFailure(t))return t}if(wn.isFailure(e))return this.failureHandler(),wn.fail({shouldLeave:!0,message:e.failureResult.message,code:e.failureResult.code,type:e.failureResult.type,declineCode:e.failureResult.declineCode});const t=yield this.initiatePayment(e.successResult);return wn.isFailure(t)?(this.failureHandler(),wn.fail({shouldLeave:!0,message:t.failureResult.message})):t}))}get elementsReady(){return Object.values(this.elementsState).every((e=>{let{ready:t}=e;return t}))}get elementsCompleted(){return Object.values(this.elementsState).every((e=>{let{completed:t}=e;return t}))}get hasElementsError(){return Object.values(this.elementsState).some((e=>{let{hasError:t}=e;return t}))}getCardNumberElement(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=(yield this.stripeElementsLoadingPromise).getElement(Bv.CARD_NUMBER);if(!e)throw new vw;return e}))}initiatePayment(e){return this.cardPaymentInitiator.perform(e)}createStripePaymentMethod(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n;let i;const s=yield this.stripeInstanceManager.getStripe();try{const e=yield this.getCardNumberElement();i=yield s.createPaymentMethod({type:p_.CARD,card:e})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.CARD),e))),wn.fail({})}return i.error?wn.fail({message:i.error.message,code:i.error.code,type:i.error.type,declineCode:i.error.decline_code}):i.paymentMethod?((null===(e=i.paymentMethod.card)||void 0===e?void 0:e.country)&&this.setPaymentMethodCountry(i.paymentMethod.card.country),"link"===(null===(n=null===(t=i.paymentMethod.card)||void 0===t?void 0:t.wallet)||void 0===n?void 0:n.type)&&this.tracker&&this.params.stripe.stripeLinkExperimentIsTestGroup&&this.tracker.trackCheckoutCustomEvent({type:Ee.STRIPE_LINK_USED}),wn.success(i.paymentMethod)):wn.fail({})}))}handleStripeLinkCheck(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;const n=yield this.stripeInstanceManager.getStripe(),i=yield n.createToken(yield this.getCardNumberElement()),s=null===(e=null==i?void 0:i.token)||void 0===e?void 0:e.card;"link"===(null===(t=null==s?void 0:s.wallet)||void 0===t?void 0:t.type)&&this.tracker&&this.tracker.trackCheckoutCustomEvent({type:Ee.STRIPE_LINK_FILLED})}))}getElementsInitialState(){return{[Bv.CARD_NUMBER]:{ready:!1,completed:!1,hasError:!1},[Bv.CARD_EXPIRY]:{ready:!1,completed:!1,hasError:!1},[Bv.CARD_CVC]:{ready:!1,completed:!1,hasError:!1}}}shouldDisableStripeLink(){return!this.params.stripe.stripeLinkExperimentIsTestGroup}}class Ew extends Error{constructor(e){super(e.message||"Google Pay payment flow error"),this.meta=e,this.name="GooglePayPaymentFlowError"}}class Aw{constructor(e,t){this.googlePaySdkEnv=e,this.sentry=t}loadClient(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;yield(0,$i.k0)("https://pay.google.com/gp/p/js/pay.js",!1,window,{},!1,is);const t=window.google;return(null===(e=null==t?void 0:t.payments)||void 0===e?void 0:e.api)?new t.payments.api.PaymentsClient({environment:this.googlePaySdkEnv}):null}))}}var Cw;!function(e){e.CANCELED="CANCELED"}(Cw||(Cw={}));class bw{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S,E,A,C,b,P){this.config=e,this.livemode=t,this.env=n,this.currencyService=s,this.donation=a,this.sentry=o,this.intl=r,this.paymentAPI=l,this.googlePayAPI=c,this.setPaymentMethod=u,this.setDonorFullNameIfEmpty=d,this.setDonorEmailIfEmpty=h,this.isFastTrackExperimentEnabled=m,this.isMailingAddressRequired=p,this.isPhoneNumberRequired=g,this.setDonorPhoneIfEmpty=y,this.setPhoneCleanNumber=f,this.setPhoneCountryCodeIfEmptyPhone=v,this.setCountryCodeIfEmptyAddress=S,this.setCityIfEmpty=E,this.setLine1IfEmpty=A,this.setLine2IfEmpty=C,this.setPostalIfEmpty=b,this.setRegionIfEmpty=P,this.name=Gn.GOOGLE_PAY,this.cardToken=null,this.googlePayJwt=null,this.client=null,this.googlePaySdkEnv="TEST",this.stripeLivemode="test",this.params=null,this.livemode&&this.env===BD.h.PRODUCTION&&(this.googlePaySdkEnv="PRODUCTION",this.stripeLivemode="live"),this.stripeInstanceManager=new rw(i),this.cardPaymentInitiator=new dw(i,this.paymentAPI)}checkAvailability(){return(0,d.sH)(this,void 0,void 0,(function*(){try{if(!this.client)return!1;const e=this.makeReadyToPayRequest();return(yield this.client.isReadyToPay(e)).result}catch(e){return"DEVELOPER_ERROR"===(null==e?void 0:e.statusCode)&&this.sentry.captureException(new Error(e.statusMessage),(t=>(t.setTag(r.ERROR_TYPE,l.GOOGLE_PAY_SDK_INTERACTION),t.setTag(r.PAYMENT_METHOD,Gn.GOOGLE_PAY),t.setExtra("error",e),t))),!1}}))}initiateFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.client)return!0;try{this.googlePayJwt=yield this.getJwt()}catch(e){return!1}return this.client=yield this.loadClient(),!0}))}startFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(e&&(this.params=e),this.setPaymentMethod(Gn.GOOGLE_PAY),this.cardToken=yield this.createToken(),!this.cardToken)return wn.fail({});const t=yield this.hold();return wn.isFailure(t)?wn.fail({message:this.intl.translate("common.errorOccurredText")}):wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.cardToken||(this.cardToken=yield this.createToken()),!this.cardToken)return wn.fail({shouldLeave:!1});const e=yield this.createStripePaymentMethod(this.cardToken);if(wn.isSuccess(e)){const t=this.cardPaymentInitiator.validateStripePaymentMethod(e.successResult,{getFrequency:()=>this.donation.getFrequency(),getCurrency:()=>this.donation.getCurrency()},this.intl);if(wn.isFailure(t))return t}if(wn.isFailure(e))return this.cardToken=null,wn.fail({shouldLeave:!1,message:e.failureResult.message});const t=yield this.initiatePayment(e.successResult);if(this.cardToken=null,wn.isSuccess(t))return t;const{message:n,additionalMessage:i}=dw.handleCardError(this.intl,t.failureResult.hasBaseErrorMessage,t.failureResult.message);return wn.fail({shouldLeave:!1,message:n,additionalMessage:i})}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){try{const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.GOOGLE_PAY});if(wn.isFailure(e))return e}catch(e){return wn.fail({shouldLeave:!1})}return wn.success(void 0)}))}get merchantInfo(){if(!this.googlePayJwt)throw new Error("GPay token is required");return{merchantId:this.config.googlePayInfo.merchantId,merchantName:this.config.companyName,merchantOrigin:window.location.hostname,authJwt:this.googlePayJwt}}initiatePayment(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.cardPaymentInitiator.perform(e)}))}createStripePaymentMethod(e){return(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.createPaymentMethod({type:p_.CARD,card:{token:e}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.GOOGLE_PAY),e))),wn.fail({})}return t.error?wn.fail({message:t.error.message}):t.paymentMethod?wn.success(t.paymentMethod):wn.fail({})}))}create(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n,i,s,a,o,c,u,d,h,m,p,g,y,f,v,S,E,A,C,b,P;if(!this.client)throw new Error("GPay client not found");const N=this.makePaymentRequest(e);let D;try{null===(n=null===(t=this.params)||void 0===t?void 0:t.onPopupOpen)||void 0===n||n.call(t),D=yield this.client.loadPaymentData(N)}catch(e){throw null===(s=null===(i=this.params)||void 0===i?void 0:i.onPopupClose)||void 0===s||s.call(i),"DEVELOPER_ERROR"===(null==e?void 0:e.statusCode)&&this.sentry.captureException(new Error(e.statusMessage),(t=>(t.setTag(r.ERROR_TYPE,l.GOOGLE_PAY_SDK_INTERACTION),t.setTag(r.PAYMENT_METHOD,Gn.GOOGLE_PAY),t.setExtra("error",e),t))),e}if(D.errorCode)throw null===(o=null===(a=this.params)||void 0===a?void 0:a.onPopupClose)||void 0===o||o.call(a),new Error("GPay payment data is not loaded");return null===(u=null===(c=this.params)||void 0===c?void 0:c.onPopupClose)||void 0===u||u.call(c),{token:JSON.parse(D.paymentMethodData.tokenizationData.token),email:D.email,shippingName:null===(d=D.shippingAddress)||void 0===d?void 0:d.name,shippingPhone:null===(h=D.shippingAddress)||void 0===h?void 0:h.phoneNumber,billingName:null===(g=null===(p=null===(m=D.paymentMethodData)||void 0===m?void 0:m.info)||void 0===p?void 0:p.billingAddress)||void 0===g?void 0:g.name,billingPhone:null===(v=null===(f=null===(y=D.paymentMethodData)||void 0===y?void 0:y.info)||void 0===f?void 0:f.billingAddress)||void 0===v?void 0:v.phoneNumber,countryCode:null===(S=D.shippingAddress)||void 0===S?void 0:S.countryCode,line1:null===(E=D.shippingAddress)||void 0===E?void 0:E.address1,line2:null===(A=D.shippingAddress)||void 0===A?void 0:A.address2,city:null===(C=D.shippingAddress)||void 0===C?void 0:C.locality,region:null===(b=D.shippingAddress)||void 0===b?void 0:b.administrativeArea,postal:null===(P=D.shippingAddress)||void 0===P?void 0:P.postalCode}}))}makePaymentRequest(e){const{amount:t,currency:n}=e,i={apiVersion:2,apiVersionMinor:0,emailRequired:!0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:this.config.googlePayInfo.allowedAuthMethods,allowedCardNetworks:this.config.googlePayInfo.allowedCardNetworks},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"stripe",gatewayMerchantId:this.merchantInfo.merchantId,"stripe:version":this.config.googlePayInfo.stripeAPIVersion,"stripe:publishableKey":this.config.stripePublicKey[this.stripeLivemode]+"/"+this.config.stripeAccount}}}],transactionInfo:{countryCode:this.config.countryCode,currencyCode:n.toUpperCase(),totalPriceStatus:"FINAL",totalPrice:this.currencyService.toFloatUnformattedStr(t,n.toUpperCase())},merchantInfo:this.merchantInfo};return this.isFastTrackExperimentEnabled()&&(i.allowedPaymentMethods[0].parameters.billingAddressRequired=!0,i.allowedPaymentMethods[0].parameters.billingAddressParameters={format:"MIN",phoneNumberRequired:this.isPhoneNumberRequired()},(this.isMailingAddressRequired()||this.isPhoneNumberRequired())&&(i.shippingAddressRequired=!0,this.isPhoneNumberRequired()&&(i.shippingAddressParameters={phoneNumberRequired:!0,allowedCountryCodes:[]}))),i}makeReadyToPayRequest(){return{allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:this.config.googlePayInfo.allowedAuthMethods,allowedCardNetworks:this.config.googlePayInfo.allowedCardNetworks}}],apiVersion:2,apiVersionMinor:0}}getJwt(){return this.googlePayAPI.getToken(window.location.hostname)}loadClient(){return new Aw(this.googlePaySdkEnv,this.sentry).loadClient()}createToken(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;let t;try{t=yield this.create({currency:this.donation.getCurrency(),amount:this.donation.getTotal()}),t.token&&this.setDonorInfo(t)}catch(e){const t=e&&"object"==typeof e?e:{},n={toString:t.toString(),stringify:JSON.stringify(t),message:t.message,name:t.name,code:t.code};return t.statusCode!==Cw.CANCELED&&this.sentry.captureException(new Ew(n),{extra:n}),null}return(null===(e=t.token)||void 0===e?void 0:e.id)||null}))}setDonorInfo(e){this.setPrivacy(e),this.setMailingAddress(e)}setPrivacy(e){var t;const{email:n,countryCode:i,shippingPhone:s,shippingName:a,billingName:o,billingPhone:r,token:l}=e,c=a||o||(null===(t=l.card)||void 0===t?void 0:t.name),u=s||r;n&&this.setDonorEmailIfEmpty(n),c&&this.setDonorFullNameIfEmpty(c),i&&this.setPhoneCountryCodeIfEmptyPhone(i),u&&(this.setDonorPhoneIfEmpty(u),this.setPhoneCleanNumber(u))}setMailingAddress(e){const{line1:t,line2:n,city:i,region:s,postal:a,countryCode:o}=e;o&&this.setCountryCodeIfEmptyAddress(o),t&&this.setLine1IfEmpty(t),n&&this.setLine2IfEmpty(n),a&&this.setPostalIfEmpty(a),i&&this.setCityIfEmpty(i),s&&this.setRegionIfEmpty(s)}}class Pw{constructor(e,t,n,i,s,a,o,r,l){this.sessionAPI=e,this.donorName=n,this.donorEmail=i,this.intl=s,this.sentry=a,this.paymentAPI=o,this.clientId=r,this.checkoutConfiguration=l,this.name=Gn.IDEAL,this._isPaymentRestored=!1,this.intentSecret=null,this.paymentIntent=null,this.stripeInstanceManager=new rw(t)}initiateFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){let e;try{if(e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.IDEAL,token:{initOnly:!1}}),wn.isFailure(e))return e}catch(e){return wn.fail({message:this.commonErrorText})}const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.isRestoredByWidgetSession&&!this._isPaymentRestored)return this.confirmAfterPayment();if(this.intentSecret){const e=yield this.retrievePaymentIntent(this.intentSecret);if((null==e?void 0:e.status)===k_.SUCCEEDED)return this.requestPay()}if(!this.intentSecret)throw new aw;const e=yield this.confirmPaymentIntent(this.intentSecret);return wn.isFailure(e)?e:(this.paymentIntent=e.successResult,this.paymentIntent?this.requestPay():wn.fail({message:this.paymentErrorText}))}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){}))}isPaid(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.paymentIntent)return!1;if(this.paymentIntent.status===k_.SUCCEEDED)return!0;this.assert(this.paymentIntent.client_secret);const e=yield this.retrievePaymentIntent(this.paymentIntent.client_secret);return(null==e?void 0:e.status)===k_.SUCCEEDED}))}isPaymentStarted(){return null!==this.paymentIntent}isPaymentRestored(){return this._isPaymentRestored}get commonErrorText(){return this.intl.translate("common.errorOccurredText")}get paymentErrorText(){return this.intl.translate("common.paymentNotAuthorizedError")}confirmAfterPayment(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;if(this.intentSecret=null!==(t=null===(e=this.checkoutConfiguration.external.restore)||void 0===e?void 0:e.paymentIntentClientSecret)&&void 0!==t?t:null,!this.intentSecret)throw new aw;return this.handleAction(this.intentSecret)}))}confirmPaymentIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;const n=this.donorName.getDto(),i=this.donorEmail.getDto(),s={ideal:{},billing_details:{name:_N([n.firstName,n.lastName]),email:i.email}},a=yield this.stripeInstanceManager.getStripe();try{const n=yield a.confirmIdealPayment(e,{payment_method:s,return_url:this.getReturnUrl()});return n.error?(null===(t=n.error.payment_intent)||void 0===t?void 0:t.status)===k_.SUCCEEDED?wn.success(n.error.payment_intent):wn.fail({message:n.error.message}):wn.success(n.paymentIntent)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.IDEAL),e))),wn.fail({message:e.message})}}))}getReturnUrl(){const e=this.sessionAPI.sessionToken,t=new URL(window.location.href);return t.searchParams.set("restoreToken",e),t.searchParams.set("clientId",this.clientId),t.toString()}handleAction(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;switch(this.paymentIntent=yield this.retrievePaymentIntent(e),this._isPaymentRestored=!0,null===(t=this.paymentIntent)||void 0===t?void 0:t.status){case k_.SUCCEEDED:return this.requestPay();case k_.REQUIRES_PAYMENT_METHOD:case k_.REQUIRES_ACTION:return wn.fail({message:this.paymentErrorText});default:return this.notifyAboutError(new Error("Unexpected payment intent status"),{paymentIntent:this.paymentIntent}),wn.fail({message:this.paymentErrorText})}}))}retrievePaymentIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{return yield this.retrievePaymentIntentWithRetry(e)}catch(e){return e instanceof ow&&this.notifyAboutWarning(e,{stripeError:e.resultError}),null}}))}retrievePaymentIntentWithRetry(e){return(0,d.sH)(this,void 0,void 0,(function*(){return JD((()=>(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrievePaymentIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.IDEAL),e))),null}if(t.error)throw new ow(t.error);return t.paymentIntent?t.paymentIntent:null}))),{retries:3,delay:500})}))}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}assert(e){const t=new Error(this.commonErrorText);if(!e)throw t}notifyAboutError(e,t){this.sentry.captureException(e,{extra:Object.assign(Object.assign({},t),{widgetSession:this.sessionAPI.sessionToken})})}notifyAboutWarning(e,t){this.sentry.captureException(e,{level:"warning",extra:Object.assign(Object.assign({},t),{widgetSession:this.sessionAPI.sessionToken})})}}class Nw{static removeAuthorizePaymentHandler(e){e&&window.removeEventListener("message",e)}constructor(e,t,n,i,s,a,o,r){this.sessionAPI=e,this.env=n,this.donorName=i,this.donorEmail=s,this.intl=a,this.sentry=o,this.paymentAPI=r,this.name=Gn.IDEAL,this.intentSecret=null,this.paymentIntent=null,this.popup=null,this.popupParams={},this.counter=0,this.stripeInstanceManager=new rw(t)}initiateFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){let e;try{if(e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.IDEAL,token:{initOnly:!1}}),wn.isFailure(e))return e}catch(e){return wn.fail({message:this.commonErrorText})}const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;if(this.intentSecret){const e=yield this.retrievePaymentIntent(this.intentSecret);if((null==e?void 0:e.status)===k_.SUCCEEDED)return this.closePopup(),this.requestPay()}if(!this.intentSecret)throw this.closePopup(),new aw;const t=yield this.confirmPaymentIntent(this.intentSecret);if(wn.isFailure(t))return t;if(this.paymentIntent=t.successResult,!this.paymentIntent)return this.closePopup(),wn.fail({message:this.paymentErrorText});if(this.paymentIntent.status===k_.SUCCEEDED)return this.closePopup(),this.requestPay();const n=this.paymentIntent.next_action;return"redirect_to_url"===(null==n?void 0:n.type)&&(null===(e=n.redirect_to_url)||void 0===e?void 0:e.url)?this.handleAction(this.intentSecret,n.redirect_to_url.url):(this.closePopup(),this.requestPay())}))}openConfirmationWindow(e){var t;if(this.popup)return this.popup;(null===(t=this.paymentIntent)||void 0===t?void 0:t.status)!==k_.SUCCEEDED?(this.popupParams=e,this.popup=window.open(this.popupPreLoadingPage,"_blank"),this.assertPopup(this.popup)):e.onClose&&e.onClose()}focusConfirmationWindow(){this.popup&&(this.popup.blur(),this.popup.focus())}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){}))}isPaid(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.paymentIntent)return!1;if(this.paymentIntent.status===k_.SUCCEEDED)return!0;this.assert(this.paymentIntent.client_secret);const e=yield this.retrievePaymentIntent(this.paymentIntent.client_secret);return(null==e?void 0:e.status)===k_.SUCCEEDED}))}isPaymentStarted(){return null!==this.paymentIntent}get commonErrorText(){return this.intl.translate("common.errorOccurredText")}get paymentErrorText(){return this.intl.translate("common.paymentNotAuthorizedError")}get popupPreLoadingPage(){switch(this.env){case BD.h.PRODUCTION:return"https://checkout.fundraiseup.com/ideal";case BD.h.STAGING:return"https://checkout.funstaging.com/ideal";case BD.h.TESTING:return"http://checkout.fun.internal/ideal";default:return"https://checkout.localtest.me/ideal"}}confirmPaymentIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;const n=this.donorName.getDto(),i=this.donorEmail.getDto(),s={ideal:{},billing_details:{name:_N([n.firstName,n.lastName]),email:i.email}},a=yield this.stripeInstanceManager.getStripe();try{const n=yield a.confirmIdealPayment(e,{payment_method:s,return_url:this.popupPreLoadingPage},{handleActions:!1});return n.error?(null===(t=n.error.payment_intent)||void 0===t?void 0:t.status)===k_.SUCCEEDED?wn.success(n.error.payment_intent):wn.fail({message:n.error.message}):wn.success(n.paymentIntent)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.IDEAL),e))),wn.fail({message:e.message})}}))}handleAction(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){var n;switch(yield this.authorizePayment(t),this.paymentIntent=yield this.retrievePaymentIntent(e),null===(n=this.paymentIntent)||void 0===n?void 0:n.status){case k_.SUCCEEDED:return this.requestPay();case k_.REQUIRES_PAYMENT_METHOD:{const t=yield this.confirmPaymentIntent(e);return wn.isSuccess(t)&&(this.paymentIntent=t.successResult),wn.fail({message:this.paymentErrorText})}case k_.REQUIRES_ACTION:return wn.fail({message:this.paymentErrorText});default:return this.notifyAboutError(new Error("Unexpected payment intent status"),{paymentIntent:this.paymentIntent}),this.closePopup(),wn.fail({message:this.paymentErrorText})}}))}retrievePaymentIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{return yield this.retrievePaymentIntentWithRetry(e)}catch(e){return e instanceof ow&&this.notifyAboutWarning(e,{stripeError:e.resultError}),null}}))}retrievePaymentIntentWithRetry(e){return(0,d.sH)(this,void 0,void 0,(function*(){return JD((()=>(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrievePaymentIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.IDEAL),e))),null}if(t.error)throw new ow(t.error);return t.paymentIntent?t.paymentIntent:null}))),{retries:2,delay:500})}))}authorizePayment(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.popup;let n,i,s;return this.assertPopup(t),this.focusConfirmationWindow(),t.location=e,new Promise((e=>{s=this.authorizePaymentHandlerFn(e),n=setInterval((()=>{if(t.closed)return this.closePopup(),e()}),20),window.addEventListener("message",s),setTimeout((()=>{this.resetCounter(),i=setInterval((()=>this.waitWhileIntentWillUpdated(e,1e3,i)),1e3)}),5e3)})).then((()=>{clearInterval(n),clearInterval(i),Nw.removeAuthorizePaymentHandler(s)}))}))}authorizePaymentHandlerFn(e){const t=new URL(this.popupPreLoadingPage).origin;return n=>{if(n.origin===t)return this.closePopup(),e()}}waitWhileIntentWillUpdated(e,t,n){return(0,d.sH)(this,void 0,void 0,(function*(){var i;this.assert(this.intentSecret);const s=Math.round(9e5/t);if(this.counter>=s&&n)return clearInterval(n),this.closePopup(),e();this.counter++;const a=yield this.retrievePaymentIntent(this.intentSecret);return a&&a.status!==(null===(i=this.paymentIntent)||void 0===i?void 0:i.status)?(this.closePopup(),e()):void 0}))}resetCounter(){this.counter=0}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}closePopup(){this.popup&&(this.popup.close(),this.popupParams.onClose&&this.popupParams.onClose(),this.resetPopup())}resetPopup(){this.popup=null,this.popupParams={}}assertPopup(e){var t;const n=new Error(this.commonErrorText);if(!e)throw this.notifyAboutError(new Error("Can not create iDEAL popup"),{intent:null===(t=this.paymentIntent)||void 0===t?void 0:t.id}),n}assert(e){const t=new Error(this.commonErrorText);if(!e)throw t}notifyAboutError(e,t){this.sentry.captureException(e,{extra:Object.assign(Object.assign({},t),{widgetSession:this.sessionAPI.sessionToken})})}notifyAboutWarning(e,t){this.sentry.captureException(e,{level:"warning",extra:Object.assign(Object.assign({},t),{widgetSession:this.sessionAPI.sessionToken})})}}class Dw extends Error{constructor(){super("Paypal hold payload is invalid")}}const Tw=["Component closed","Detected container element removed from DOM"],kw=["Window closed before response","Window closed for postrobot_method before ack"];class Iw{constructor(e,t,n,i){this.config=e,this.sentry=t,this.locale=n,this.iframeWindow=i,this.scriptParams=null,this.buttonParams=null,this.actions=null,this.rendered=!1,this.paypalButtons=null,this.scriptLoadingPromise=null}setCurrency(e,t){var n;const{paypalMerchantId:i,paypalClientId:s,subscriptionsEnabled:a}=this.config;if(!i){const e=new Error("Paypal merchant ID is not provided");throw this.sentry.captureException(e),e}const o={"client-id":s,"merchant-id":i,currency:this.getPaypalCurrency(e,t).toUpperCase(),"disable-funding":"venmo",locale:"automatic",intent:"capture",vault:"false"},r=Wi(this.locale);return r&&(o.locale=r),a&&(o.intent="tokenize",o.vault="true"),o.currency!==(null===(n=this.scriptParams)||void 0===n?void 0:n.currency)&&(this.scriptLoadingPromise=null,this.destroy()),this.scriptParams=o,this}setButtonParams(e){let{onCreate:t,onApprove:n,onButtonClick:i,buttonColor:s,onCancel:a,onFail:o,onInit:r,validate:l}=e;return this.buttonParams={fundingSource:Gn.PAYPAL,style:{color:s,tagline:!1,shape:"rect",height:48,size:"responsive"},[this.paypalIdentifierMethod]:()=>t(this.clientPaymentMethod),onApprove:e=>(0,d.sH)(this,void 0,void 0,(function*(){const t=e[this.paypalIdentifierKey];if(!t)return this.handleEmptyTokenError(e);yield n(this.clientPaymentMethod,t)})),onInit:(e,t)=>{this.actions=t,null==r||r()},onClick:(e,t)=>(0,d.sH)(this,void 0,void 0,(function*(){var e;if(null==i||i(this.clientPaymentMethod),null!==(e=null==l?void 0:l())&&void 0!==e&&!e)return null==a||a(),t.reject()})),onError:e=>{const t=e.message;if(!t||!(t.includes("popup close")||t.includes("cross-domain")||t.includes("Window is closed")))throw e;o({message:"Window is closed"})},onCancel:()=>{null==a||a()}},this}disable(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;try{yield null===(e=this.actions)||void 0===e?void 0:e.disable()}catch(e){if(kw.includes(e.message))return;throw e}}))}enable(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;try{yield null===(e=this.actions)||void 0===e?void 0:e.enable()}catch(e){if(kw.includes(e.message))return;throw e}}))}loadPayPalScriptIfNeeded(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.scriptParams)throw new Error("Call `setCurrency` before you mount");return this.scriptLoadingPromise||(this.scriptLoadingPromise=(0,$i.k0)(`https://www.paypal.com/sdk/js?${fs(this.scriptParams)}`,!1,this.iframeWindow,{},!0,is)),this.scriptLoadingPromise}))}mount(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;if(!this.buttonParams)throw new Error("Call `setHandlers` before you mount");if(e&&(e.innerHTML&&(e.innerHTML=""),null===(t=this.iframeWindow.paypal)||void 0===t?void 0:t.Buttons)){this.paypalButtons=this.iframeWindow.paypal.Buttons(this.buttonParams);try{yield this.paypalButtons.render(e),this.rendered=!0}catch(e){if(Tw.includes(null==e?void 0:e.message))return;throw e}}}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){this.rendered&&this.paypalButtons&&(yield this.paypalButtons.close(),this.rendered=!1,this.actions=null,this.paypalButtons=null)}))}get clientPaymentMethod(){return Gn.PAYPAL}get paypalIdentifierMethod(){return this.config.subscriptionsEnabled?"createBillingAgreement":"createOrder"}get paypalIdentifierKey(){return this.config.subscriptionsEnabled?"billingToken":"orderID"}getPaypalCurrency(e,t){const n=this.config.paypalCurrencies;return n.includes(e)?e:n.includes(t)?t:"USD"}handleEmptyTokenError(e){this.sentry.captureException(new Error(`Got an undefined token by paypalIdentifierKey: ${this.paypalIdentifierKey}`),(t=>(t.setTag(r.ERROR_TYPE,l.PAYPAL_SDK_INTERACTION),t.setTag(r.PAYMENT_METHOD,Gn.PAYPAL),t.setExtra("paypalIdentifierKey",this.paypalIdentifierKey),t.setExtra("paypalData",e),t)))}}class _w{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S,E,A,C){this.config=e,this.sentry=t,this.locale=n,this.iframeWindow=i,this.paypalAPI=s,this.paymentAPI=a,this.donation=o,this.updateSession=r,this.setPaymentMethod=l,this.setDonorFirstNameIfEmpty=c,this.setDonorLastNameIfEmpty=u,this.setDonorEmailIfEmpty=d,this.setPhoneCountryCodeIfEmptyPhone=h,this.setPhoneNumberIfEmpty=m,this.setCountryCodeIfEmptyAddress=p,this.setCityIfEmpty=g,this.setLine1IfEmpty=y,this.setLine2IfEmpty=f,this.setPostalIfEmpty=v,this.setRegionIfEmpty=S,this.paymentFailureHandler=E,this.isFastTrackExperimentEnabled=A,this.setCleanPhoneNumber=C,this.name=Gn.PAYPAL,this.isCompleted=!1,this.paypalButtonBuilder=new Iw(this.config,this.sentry,this.locale,this.iframeWindow)}initiateFlow(e){return(0,d.sH)(this,arguments,void 0,(function(e){var t=this;let{element:n,holdDone:i,onFail:s,buttonColor:a,onButtonClick:o,onCancel:r,onInit:l,validate:c}=e;return function*(){return yield t.loadPayPalScriptIfNeeded(),yield t.paypalButtonBuilder.setButtonParams({buttonColor:a,onCreate:e=>(0,d.sH)(t,void 0,void 0,(function*(){yield this.updateSession();const t=yield this.paypalAPI.createOrder(e,this.isFastTrackExperimentEnabled());if(!wn.isFailure(t))return t.successResult;s(t.failureResult)})),onApprove:(e,n)=>(0,d.sH)(t,void 0,void 0,(function*(){this.isCompleted=!0,this.setPaymentMethod(e),this.clientPaymentMethod=e,this.token=n;const t=yield this.hold();if(wn.isFailure(t))return this.isCompleted=!1,void s(t.failureResult);i()})),onButtonClick:o,onCancel:()=>{t.isCompleted||null==r||r()},onFail:e=>{t.isCompleted||s(e)},onInit:l,validate:c}).mount(n),!0}()}))}loadPayPalScriptIfNeeded(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.paypalButtonBuilder.setCurrency(this.donation.getCurrency(),this.donation.getDefaultCurrency()).loadPayPalScriptIfNeeded()}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.token||!this.clientPaymentMethod)throw new Dw;const e={token:this.token,clientPaymentMethod:this.clientPaymentMethod};try{const t=yield this.paymentAPI.hold(e);return wn.isFailure(t)?t:(this.setDonorInfo(t.successResult),wn.success(void 0))}catch(e){return wn.fail({})}}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n;const i=yield this.paymentAPI.pay();return wn.isSuccess(i)?i:(null===(e=i.failureResult.errors)||void 0===e?void 0:e.code)===R_.ORDER_EXPIRED?(this.paymentFailureHandler(),wn.fail({shouldLeave:!0,message:null===(t=i.failureResult.errors)||void 0===t?void 0:t.message})):wn.fail({shouldLeave:!1,message:null===(n=i.failureResult.errors)||void 0===n?void 0:n.message})}))}closePaypal(){this.paypalButtonBuilder.destroy()}togglePaypalActions(e){e?this.paypalButtonBuilder.enable():this.paypalButtonBuilder.disable()}setDonorInfo(e){this.setPrivacy(e),this.setMailingAddress(e)}setPrivacy(e){const{email:t,phone:n,firstName:i,lastName:s,address:a}=e;t&&this.setDonorEmailIfEmpty(t),i&&this.setDonorFirstNameIfEmpty(i),s&&this.setDonorLastNameIfEmpty(s),(null==a?void 0:a.countryCode)&&this.setPhoneCountryCodeIfEmptyPhone(a.countryCode),n&&(this.setPhoneNumberIfEmpty(n),this.setCleanPhoneNumber(n))}setMailingAddress(e){const{line1:t,line2:n,city:i,region:s,postal:a,countryCode:o}=e.address||{};o&&this.setCountryCodeIfEmptyAddress(o),t&&this.setLine1IfEmpty(t),n&&this.setLine2IfEmpty(n),a&&this.setPostalIfEmpty(a.toString()),i&&this.setCityIfEmpty(i),s&&this.setRegionIfEmpty(s)}}class Ow{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h){this.stripeElementsLoadingPromise=t,this.donorName=n,this.donorEmail=i,this.paymentOptions=s,this.mailingAddress=a,this.sentry=o,this.paymentMethodManager=r,this.checkoutConfiguration=l,this.setPaymentMethodCountry=c,this.mailingAddressFailureHandler=u,this.paymentAPI=d,this.params=h,this.name=Gn.SEPA,this.intentSecret=null,this.completed=!1,this.elementReady=!1,this.ibanElement=null,this.hasElementError=!1,this.initiated=!1,this.onElementChange=e=>{this.setPaymentMethodCountry(e.country),this.completed=e.complete,this.hasElementError=!!e.error},this.stripeInstanceManager=new rw(e)}initiateFlow(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return this.initiated||(this.ibanElement=yield this.createElement(t),this.ibanElement.once("ready",(()=>{this.elementReady=!0,(null==t?void 0:t.onIbanElementReady)&&t.onIbanElementReady()})),this.ibanElement.on("change",this.onElementChange),this.ibanElement.mount(e),this.initiated=!0),!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.elementReady?!this.completed&&!(yield this.validatePayment())||this.hasElementError?wn.fail({}):wn.success(void 0):wn.fail({})}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.SEPA});if(wn.isFailure(e))return wn.fail(e.failureResult);const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.intentSecret)throw new aw;const{isValid:e}=this.mailingAddress.validate();if(this.paymentMethodManager.isRequired("address",{ibanCountry:this.country})&&!e)throw new Error(`Wrong address format for ${this.country} IBAN`);const t=yield this.retrieveSetupIntent(this.intentSecret);if(!t)return wn.fail({shouldLeave:!1});if(t.status===k_.SUCCEEDED)return this.requestPay();const n=yield this.confirmSepaDebitSetup(this.intentSecret);if(wn.isFailure(n))return n;const i=n.successResult;return i&&i.status===k_.SUCCEEDED?this.requestPay():wn.fail({shouldLeave:!1})}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;try{null===(e=this.ibanElement)||void 0===e||e.destroy()}catch(e){}}))}get country(){const e=this.paymentOptions.getDto();if(!e.paymentMethodCountry)throw new Error("Country is not set");return e.paymentMethodCountry}retrieveSetupIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrieveSetupIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.SEPA),e))),null}return t.setupIntent?t.setupIntent:null}))}confirmSepaDebitSetup(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;const n=this.getElement();if(!this.country)throw new Error("country was not set");const i=this.donorName.getDto(),s=this.donorEmail.getDto(),a=this.mailingAddress.getDto();let o;const c=yield this.stripeInstanceManager.getStripe();try{o=yield c.confirmSepaDebitSetup(e,{payment_method:{sepa_debit:n,billing_details:{name:_N([i.firstName,i.lastName]),email:s.email,address:{line1:a.line1,city:a.city,country:a.countryCode,postal_code:a.postal}}}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.SEPA),e))),wn.fail({})}return o.error?"validation_error"===o.error.type?wn.fail({shouldLeave:!1,message:o.error.message}):["invalid_owner_address","country-code-invalid"].includes(null!==(t=o.error.message)&&void 0!==t?t:"")?(this.mailingAddressFailureHandler(),wn.fail({shouldLeave:!0,message:o.error.message})):wn.fail({shouldLeave:!1}):wn.success(o.setupIntent)}))}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}getElement(){if(!this.ibanElement)throw new Error("ibanElement is not initialized");return this.ibanElement}createElement(e){return(0,d.sH)(this,void 0,void 0,(function*(){const{stripeElementStyleOverride:t,showIcon:n}=null!=e?e:{};return(yield this.stripeElementsLoadingPromise).create("iban",{iconStyle:"default",disabled:!1,hideIcon:void 0!==n&&!n,placeholderCountry:this.checkoutConfiguration.company.country,style:void 0!==t?t:Object.assign(Object.assign({},this.params.stripe.elementStyles),{base:Object.assign(Object.assign({},this.params.stripe.elementStyles.base),{fontSize:"14px"})}),classes:this.params.stripe.elementClasses,supportedCountries:["SEPA"]})}))}validatePayment(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.getElement();let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.createPaymentMethod({type:p_.SEPA,sepa_debit:e,billing_details:{name:Xi,email:Qi}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.SEPA),e))),!1}return!!t.paymentMethod&&!t.error}))}}class xw{constructor(e,t,n,i,s,a,o,r,l){this.donorEmail=t,this.mailingAddress=n,this.ukBacs=i,this.sentry=s,this.intl=a,this.mailingAddressFailureHandler=o,this.ukBacsFailureHandler=r,this.paymentAPI=l,this.name=Gn.UK_BACS,this.intentSecret=null,this.stripeInstanceManager=new rw(e)}initiateFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.UK_BACS});if(wn.isFailure(e))return e;const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.intentSecret)throw new aw;const e=yield this.retrieveSetupIntent(this.intentSecret);if(!e)return wn.fail({shouldLeave:!1});if(e.status===k_.SUCCEEDED)return this.requestPay();const t=yield this.confirmBacsDebitSetup(this.intentSecret);if(wn.isFailure(t))return t;const n=t.successResult;return n&&n.status===k_.SUCCEEDED?this.requestPay():wn.fail({shouldLeave:!0})}))}retrieveSetupIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrieveSetupIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.UK_BACS),e))),null}return t.setupIntent?t.setupIntent:null}))}confirmBacsDebitSetup(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n,i;let s;const a=this.donorEmail.getDto(),o=this.mailingAddress.getDto(),c=this.ukBacs.getDto(),u=yield this.stripeInstanceManager.getStripe();try{s=yield u.confirmBacsDebitSetup(e,{payment_method:{bacs_debit:{sort_code:c.sortCode,account_number:c.accountNumber},billing_details:{name:c.accountHolderName,email:a.email,address:{line1:o.line1,city:o.city,country:o.countryCode,postal_code:o.postal}}}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.UK_BACS),e))),wn.fail({})}return s.error?["invalid_owner_address","country-code-invalid"].includes(null!==(n=s.error.code)&&void 0!==n?n:"")?(this.mailingAddressFailureHandler(),wn.fail({shouldLeave:!0,additionalMessage:s.error.message,message:this.intl.translate("mailingAddressScreen.validationError.title")})):(this.ukBacsFailureHandler(),["invalid_bank_account_account_number","invalid_bank_account"].includes(null!==(i=s.error.code)&&void 0!==i?i:"")?wn.fail({shouldLeave:!0,message:s.error.message}):s.error.message?wn.fail({shouldLeave:!1,message:s.error.message}):wn.fail({shouldLeave:!0})):wn.success(null!==(t=s.setupIntent)&&void 0!==t?t:null)}))}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}}class ww{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m){this.usBankAccount=t,this.sentry=n,this.paymentAPI=i,this.intl=s,this.params=a,this.donation=o,this.donorName=r,this.paymentFailureHandler=l,this.setFinancialInstitution=c,this.setVerificationType=u,this.setAccountNumber=d,this.setRoutingNumber=h,this.setAccountType=m,this.name=Gn.US_BANK_ACCOUNT,this.intentSecret=null,this.initiateParams=null,this.stripeInstanceManager=new rw(e)}initiateFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.initiateParams=e,!0}))}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.usBankAccount.getUsBankAccountVerificationSetup();if(e.isMicroDepositOnly||e.isAbavOnly)return wn.success(void 0);const t=yield this.hold();if(wn.isFailure(t))return wn.fail({message:t.failureResult.message||this.commonErrorText});if(!this.intentSecret)return wn.fail({message:this.commonErrorText});const n=yield this.collectBankAccountForSetup(this.intentSecret);if(wn.isFailure(n))return n;const i=n.successResult;if(i.status===k_.REQUIRES_PAYMENT_METHOD)return wn.fail({});const s=i.payment_method;return this.assertUSBankAccountPaymentMethod(s),this.paymentMethod=s,this.setFinancialInstitution(s.us_bank_account.bank_name),this.setAccountNumber(s.us_bank_account.last4),this.setRoutingNumber(s.us_bank_account.routing_number),this.setAccountType(s.us_bank_account.account_holder_type),wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.shouldCreatePaymentMethod){const e=yield this.createPaymentMethod();if(wn.isFailure(e))return e}const e=yield this.paymentAPI.hold({clientPaymentMethod:Gn.US_BANK_ACCOUNT,token:{verificationType:this.verificationType}});if(wn.isFailure(e))return wn.fail(e.failureResult);const{intentSecret:t}=e.successResult;if(!t)throw new aw;return this.intentSecret=t,wn.success(void 0)}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.intentSecret)throw new aw;const e=yield this.retrieveSetupIntent(this.intentSecret);if(wn.isFailure(e))return e;if(e.successResult.status===k_.SUCCEEDED)return this.requestPay();const t=yield this.confirmUsBankAccountSetup(this.intentSecret);if(wn.isFailure(t))return t;const n=t.successResult;return!n||n.status!==k_.SUCCEEDED&&n.status!==k_.REQUIRES_ACTION?wn.fail({shouldLeave:!0}):(n.next_action&&(this.assertUSBankAccountNextAction(n.next_action),this.setVerificationType(n.next_action.verify_with_microdeposits.microdeposit_type)),this.requestPay())}))}get verificationType(){var e;if(null===(e=this.initiateParams)||void 0===e?void 0:e.verificationType)return this.initiateParams.verificationType;const t=this.usBankAccount.getUsBankAccountVerificationSetup();return t.isAbavOnly?"instant_or_skip":t.isInstantOnly?"instant":t.isInstantAndMicroDeposit?XI(function(e,t,n){if("USD"!==n)return t;const i=function(e){switch(e){case aS.ONE_FOR_ISRAEL:return 150;case aS.FCA:return 200;default:return null}}(e);return null===i?t:t<9500&&t>=i?9500:t}(this.params.companyKey,this.donation.getTotal(),this.donation.getCurrency()))?"automatic":"instant":t.isInstantAndAbav?"instant_or_skip":"microdeposits"}get shouldCreatePaymentMethod(){return"microdeposits"===this.verificationType||"instant_or_skip"===this.verificationType}get commonErrorText(){return this.intl.translate("common.errorOccurredText")}createPaymentMethod(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.usBankAccount.getDto();let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.createPaymentMethod({type:p_.US_BANK_ACCOUNT,billing_details:{name:e.accountHolderName},us_bank_account:{account_number:e.accountNumber,routing_number:e.routingNumber,account_holder_type:e.accountType}})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.US_BANK_ACCOUNT),e.setExtra("widgetSession",this.params.getSessionToken()),e))),wn.fail({shouldLeave:!1})}if(t.error)return wn.fail({shouldLeave:!1,message:t.error.message||this.commonErrorText});const i=t.paymentMethod;return this.assertUSBankAccountPaymentMethod(i),this.paymentMethod=i,this.setFinancialInstitution(i.us_bank_account.bank_name),wn.success(i)}))}retrieveSetupIntent(e){return(0,d.sH)(this,void 0,void 0,(function*(){let t;const n=yield this.stripeInstanceManager.getStripe();try{t=yield n.retrieveSetupIntent(e)}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.US_BANK_ACCOUNT),e.setExtra("widgetSession",this.params.getSessionToken()),e))),wn.fail({shouldLeave:!1})}return t.setupIntent?wn.success(t.setupIntent):wn.fail({shouldLeave:!1})}))}confirmUsBankAccountSetup(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;let n;const i=yield this.stripeInstanceManager.getStripe();this.assertUSBankAccountPaymentMethod(this.paymentMethod);try{n=yield i.confirmUsBankAccountSetup(e,{payment_method:this.paymentMethod.id,expand:["payment_method"]})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.US_BANK_ACCOUNT),e.setExtra("widgetSession",this.params.getSessionToken()),e))),wn.fail({shouldLeave:!1})}return n.setupIntent?wn.success(n.setupIntent):(this.paymentFailureHandler(),["invalid_bank_account_account_number","invalid_bank_account"].includes(null!==(t=n.error.code)&&void 0!==t?t:"")||n.error.message?wn.fail({shouldLeave:!0,message:n.error.message}):wn.fail({shouldLeave:!0}))}))}collectBankAccountForSetup(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n,i,s;let a;const o=yield this.stripeInstanceManager.getStripe(),{firstName:c,lastName:u}=this.donorName.getDto();try{null===(n=null===(t=this.initiateParams)||void 0===t?void 0:t.onPopupOpen)||void 0===n||n.call(t),a=yield o.collectBankAccountForSetup({clientSecret:e,params:{payment_method_type:p_.US_BANK_ACCOUNT,payment_method_data:{billing_details:{name:_N([c,u])}}},expand:["payment_method"]})}catch(e){return this.sentry.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.STRIPE_SDK_INTERACTION),e.setTag(r.PAYMENT_METHOD,Gn.US_BANK_ACCOUNT),e.setExtra("widgetSession",this.params.getSessionToken()),e))),wn.fail({shouldLeave:!1})}finally{null===(s=null===(i=this.initiateParams)||void 0===i?void 0:i.onPopupClose)||void 0===s||s.call(i)}return a.setupIntent?wn.success(a.setupIntent):a.error?wn.fail({shouldLeave:!1,message:a.error.message||this.commonErrorText}):wn.fail({shouldLeave:!1})}))}requestPay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1,message:e.failureResult.message})}))}assertUSBankAccountPaymentMethod(e){if("us_bank_account"!==e.type)throw this.sentry.captureException(new Error(`Expected us_bank_account payment method, but ${e.type} has been retrieved`),(e=>(e.setExtra("widgetSession",this.params.getSessionToken()),e))),new Error(this.commonErrorText)}assertUSBankAccountNextAction(e){if("verify_with_microdeposits"!==e.type)throw this.sentry.captureException(new Error(`Expected verify_with_microdeposits next action, but ${e.type} has been retrieved`),(e=>(e.setExtra("widgetSession",this.params.getSessionToken()),e))),new Error(this.commonErrorText)}}const Rw="venmo",Mw=["Window closed before response","Window closed for postrobot_method before ack"];class Lw{constructor(e,t,n,i){this.config=e,this.sentry=t,this.locale=n,this.iframeWindow=i,this.available=!0,this.scriptParams=null,this.buttonParams=null,this.actions=null,this.rendered=!1,this.scriptLoadingPromise=null}init(){const{paypalMerchantId:e,paypalClientId:t}=this.config;if(!e){const e=new Error("Paypal merchant ID is not provided");throw this.sentry.captureException(e),e}const n={"client-id":t,"merchant-id":e,currency:"USD","enable-funding":Rw,"disable-funding":"card"},i=Wi(this.locale);return i&&(n.locale=i),this.scriptParams=n,this}setHandlers(e){let{onCreate:t,onApprove:n,onButtonClick:i,onCancel:s,onInit:a}=e;return this.buttonParams={fundingSource:Rw,style:{tagline:!1,shape:"rect",height:48,size:"responsive"},createOrder:()=>t(Gn.VENMO),onApprove:e=>(0,d.sH)(this,void 0,void 0,(function*(){if(!this.venmoButtons)throw new Error("Venmo Buttons not initialized");const t=e.orderID;if(!t)return this.handleEmptyTokenError(e);yield n(this.clientPaymentMethod,t)})),onInit:(e,t)=>{this.actions=t,null==a||a()},onClick:()=>(0,d.sH)(this,void 0,void 0,(function*(){null==i||i(this.clientPaymentMethod)})),onError:e=>{const t=e.message;if(!t||!t.includes("popup close")&&!t.includes("cross-domain"))throw e},onCancel:()=>{null==s||s()}},this}disable(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;try{yield null===(e=this.actions)||void 0===e?void 0:e.disable()}catch(e){if(Mw.includes(e.message))return;throw e}}))}enable(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;try{yield null===(e=this.actions)||void 0===e?void 0:e.enable()}catch(e){if(Mw.includes(e.message))return;throw e}}))}loadPayPalScriptIfNeeded(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.scriptParams)throw new Error("Call `setCurrency` before init");return this.scriptLoadingPromise||(this.scriptLoadingPromise=(0,$i.k0)(`https://www.paypal.com/sdk/js?${fs(this.scriptParams)}`,!1,this.iframeWindow,{"data-namespace":"venmo"},!1,is)),this.scriptLoadingPromise}))}mount(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;if(!this.buttonParams)throw new Error("Call `setHandlers` before you mount");if(yield this.loadPayPalScriptIfNeeded(),e)if(null===(t=this.iframeWindow.venmo)||void 0===t?void 0:t.Buttons)if(this.venmoButtons=this.iframeWindow.venmo.Buttons(this.buttonParams),this.venmoButtons.isEligible())try{yield this.venmoButtons.render(e),this.rendered=!0}catch(e){if(["Component closed","Detected container element removed from DOM"].includes(null==e?void 0:e.message))return;throw e}else this.available=!1;else this.available=!1}))}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){this.rendered&&this.venmoButtons&&(yield this.venmoButtons.close(),this.rendered=!1)}))}get clientPaymentMethod(){return Gn.VENMO}handleEmptyTokenError(e){this.sentry.captureException(new Error("Got an undefined token"),(t=>(t.setTag(r.ERROR_TYPE,l.PAYPAL_SDK_INTERACTION),t.setTag(r.PAYMENT_METHOD,Gn.VENMO),t.setExtra("data",e),t)))}}class Fw{constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S,E){this.livemode=e,this.showcase=t,this.config=n,this.sentry=i,this.locale=s,this.iframeWindow=a,this.updateSession=o,this.setPaymentMethod=r,this.setDonorFirstNameIfEmpty=l,this.setDonorLastNameIfEmpty=c,this.setDonorEmailIfEmpty=u,this.setPhoneCountryCodeIfEmptyPhone=d,this.setPhoneNumberIfEmpty=h,this.setCountryCodeIfEmptyAddress=m,this.setCityIfEmpty=p,this.setLine1IfEmpty=g,this.setLine2IfEmpty=y,this.setPostalIfEmpty=f,this.setRegionIfEmpty=v,this.paypalAPI=S,this.paymentAPI=E,this.name=Gn.VENMO,this.isCompleted=!1,this.venmoButtonBuilder=new Lw(this.config,this.sentry,this.locale,this.iframeWindow)}checkAvailability(){return this.venmoButtonBuilder.available}initiateFlow(e){return(0,d.sH)(this,arguments,void 0,(function(e){var t=this;let{element:n,holdDone:i,onFail:s,onButtonClick:a,onCancel:o,onInit:r}=e;return function*(){return yield t.loadPayPalScriptIfNeeded(),yield t.venmoButtonBuilder.setHandlers({onCreate:e=>(0,d.sH)(t,void 0,void 0,(function*(){yield this.updateSession();const t=yield this.paypalAPI.createOrder(e,!1);if(!wn.isFailure(t))return t.successResult;s(t.failureResult)})),onApprove:(e,n)=>(0,d.sH)(t,void 0,void 0,(function*(){this.isCompleted=!0,this.setPaymentMethod(e),this.clientPaymentMethod=e,this.token=n;const t=yield this.hold();if(wn.isFailure(t))return this.isCompleted=!1,void s(t.failureResult);i()})),onButtonClick:a,onCancel:()=>{t.isCompleted||null==o||o()},onInit:r}).mount(n),t.venmoButtonBuilder.available}()}))}loadPayPalScriptIfNeeded(){return this.venmoButtonBuilder.init().loadPayPalScriptIfNeeded()}startFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){return wn.success(void 0)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.token||!this.clientPaymentMethod)throw new Dw;const e={token:this.token,clientPaymentMethod:this.clientPaymentMethod},t=yield this.paymentAPI.hold(e);return wn.isFailure(t)?wn.fail(t.failureResult):(this.setDonorInfo(t.successResult),wn.success(void 0))}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentAPI.pay();return wn.isSuccess(e)?e:wn.fail({shouldLeave:!1})}))}closeButton(){this.venmoButtonBuilder.destroy()}toggleVenmoActions(e){e?this.venmoButtonBuilder.enable():this.venmoButtonBuilder.disable()}setDonorInfo(e){var t,n,i,s,a,o,r,l;this.setDonorFirstNameIfEmpty(e.firstName||""),this.setDonorLastNameIfEmpty(e.lastName||""),this.setDonorEmailIfEmpty(e.email||""),(null===(t=e.address)||void 0===t?void 0:t.countryCode)&&this.setPhoneCountryCodeIfEmptyPhone(e.address.countryCode),this.setPhoneNumberIfEmpty(e.phone||""),(null===(n=e.address)||void 0===n?void 0:n.countryCode)&&this.setCountryCodeIfEmptyAddress(e.address.countryCode),this.setCityIfEmpty((null===(i=e.address)||void 0===i?void 0:i.city)||""),this.setLine1IfEmpty((null===(s=e.address)||void 0===s?void 0:s.line1)||""),this.setLine2IfEmpty((null===(a=e.address)||void 0===a?void 0:a.line2)||""),this.setRegionIfEmpty((null===(o=e.address)||void 0===o?void 0:o.region)||""),this.setPostalIfEmpty((null===(l=null===(r=e.address)||void 0===r?void 0:r.postal)||void 0===l?void 0:l.toString())||"")}}class Uw{constructor(e){this.sessionAPI=e}getToken(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{return yield this.sessionAPI.get("googlePay/token",{merchantOrigin:e},{retries:5,delay:200,rejectsOnInvalid:!0})}catch(e){throw Error("Error while receiving google pay token")}}))}}class jw{constructor(e){this.sessionAPI=e}createOrder(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return this.sessionAPI.post("paypal/order",{clientPaymentMethod:e,fastTrack:t})}))}}class Bw{constructor(e,t,n,i,s){this.sentry=e,this.intl=t,this.paymentMethodAvailabilityManagerRepository=n,this.params=i,this.tracker=s,this.paymentFlows={}}destroy(){return(0,d.sH)(this,void 0,void 0,(function*(){for(const e of Object.values(this.paymentFlows))e.destroy&&(yield e.destroy())}))}resolveCard(e){let{sessionAPI:t,stripeLoadingPromise:n,stripeElementsLoadingPromise:i,failureHandler:s,setPaymentMethodCountry:a,donation:o}=e;return this.getOrCreatePaymentFlow(Gn.CARD,(()=>new Sw(n,i,this.sentry,this.intl,s,new SO(t),a,o,{stripe:{elementClasses:this.params.stripe.elementClasses,elementStyles:this.params.stripe.elementStyles,stripeLinkExperimentIsTestGroup:this.params.stripe.stripeLinkExperimentIsTestGroup}},this.tracker)))}resolvePaypal(e){let{sessionAPI:t,locale:n,iframeWindow:i,paypalClientId:s,paypalMerchantId:a,paypalCurrencies:o,subscriptionsEnabled:r,donation:l,updateSession:c,setPaymentMethod:u,setDonorFirstNameIfEmpty:d,setDonorLastNameIfEmpty:h,setDonorEmailIfEmpty:m,setPhoneCountryCodeIfEmptyPhone:p,setPhoneNumberIfEmpty:g,setCountryCodeIfEmptyAddress:y,setCityIfEmpty:f,setLine1IfEmpty:v,setLine2IfEmpty:S,setPostalIfEmpty:E,setRegionIfEmpty:A,paymentFailureHandler:C,isFastTrackExperimentEnabled:b,setCleanPhoneNumber:P}=e;return this.getOrCreatePaymentFlow(Gn.PAYPAL,(()=>new _w({paypalClientId:s,paypalMerchantId:a,paypalCurrencies:o,subscriptionsEnabled:r},this.sentry,n,i,new jw(t),new SO(t),l,c,u,d,h,m,p,g,y,f,v,S,E,A,C,b,P)))}resolveGooglePay(e){let{sessionAPI:t,livemode:n,env:i,googlePayInfo:s,stripeAccount:a,companyName:o,stripePublicKey:r,countryCode:l,stripeLoadingPromise:c,currencyService:u,donation:d,setPaymentMethod:h,setDonorFullNameIfEmpty:m,setDonorEmailIfEmpty:p,isFastTrackExperimentEnabled:g,isMailingAddressRequired:y,isPhoneNumberRequired:f,setDonorPhoneIfEmpty:v,setPhoneCleanNumber:S,setPhoneCountryCodeIfEmptyPhone:E,setCountryCodeIfEmptyAddress:A,setCityIfEmpty:C,setLine1IfEmpty:b,setLine2IfEmpty:P,setPostalIfEmpty:N,setRegionIfEmpty:D}=e;return this.getOrCreatePaymentFlow(Gn.GOOGLE_PAY,(()=>{if(!a)throw new Error("Stripe account is required for GPay");return new bw({googlePayInfo:s,stripeAccount:a,stripePublicKey:r,companyName:o,countryCode:l},n,i,c,u,d,this.sentry,this.intl,new SO(t),new Uw(t),h,m,p,g,y,f,v,S,E,A,C,b,P,N,D)}))}resolveUkBacs(e){let{sessionAPI:t,stripeLoadingPromise:n,donorEmail:i,mailingAddress:s,ukBacs:a,mailingAddressFailureHandler:o,ukBacsFailureHandler:r}=e;return this.getOrCreatePaymentFlow(Gn.UK_BACS,(()=>new xw(n,i,s,a,this.sentry,this.intl,o,r,new SO(t))))}resolveApplePay(e){let{sessionAPI:t,companyName:n,applePayStripeLoadingPromise:i,donation:s,setPaymentMethod:a,setDonorFullNameIfEmpty:o,setDonorEmailIfEmpty:r,setCountryCodeIfEmptyAddress:l,setCityIfEmpty:c,setLine1IfEmpty:u,setLine2IfEmpty:d,setPostalIfEmpty:h,setRegionIfEmpty:m,isFastTrackExperimentEnabled:p,isMailingAddressRequired:g,isPhoneNumberRequired:y,setDonorPhoneIfEmpty:f,setPhoneCleanNumber:v,setPhoneCountryCodeIfEmptyPhone:S}=e;return this.getOrCreatePaymentFlow(Gn.APPLE_PAY,(()=>{const e={country:sn.UNITED_STATES,currency:s.getCurrency().toLowerCase(),total:{label:n,amount:s.getTotal()||0}};return new pw(e,i,this.sentry,this.intl,new SO(t),s,a,o,r,l,c,u,d,h,m,p,g,y,f,v,S)}))}resolveAuBECS(e){let{sessionAPI:t,stripeLoadingPromise:n,stripeElementsLoadingPromise:i,donorName:s,donorEmail:a}=e;return this.getOrCreatePaymentFlow(Gn.AU_BECS,(()=>new fw(n,i,s,a,this.sentry,new SO(t),{stripe:{elementClasses:this.params.stripe.elementClasses,elementStyles:this.params.stripe.elementStyles}})))}resolveSepa(e){let{sessionAPI:t,stripeLoadingPromise:n,stripeElementsLoadingPromise:i,mailingAddress:s,donorName:a,donorEmail:o,paymentOptions:r,checkoutConfiguration:l,setPaymentMethodCountry:c,mailingAddressFailureHandler:u}=e;return this.getOrCreatePaymentFlow(Gn.SEPA,(()=>{const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.SEPA,nn.WIDGET);return new Ow(n,i,a,o,r,s,this.sentry,e,l,c,u,new SO(t),{stripe:{elementClasses:this.params.stripe.elementClasses,elementStyles:this.params.stripe.elementStyles}})}))}resolveIDEAL(e){let{sessionAPI:t,stripeLoadingPromise:n,stripeElementsLoadingPromise:i,donorName:s,donorEmail:a,env:o,clientId:r,checkoutConfiguration:l}=e;return this.getOrCreatePaymentFlow(Gn.IDEAL,(()=>l.paymentOptionsSettings.isNewIdealPaymentFlowEnabled?new Pw(t,n,s,a,this.intl,this.sentry,new SO(t),r,l):new Nw(t,n,o,s,a,this.intl,this.sentry,new SO(t))))}resolveUSBankAccount(e){let{stripeLoadingPromise:t,usBankAccount:n,sessionAPI:i,checkoutConfiguration:s,donation:a,donorName:o,paymentFailureHandler:r,setFinancialInstitution:l,setVerificationType:c,setAccountNumber:u,setRoutingNumber:d,setAccountType:h}=e;return this.getOrCreatePaymentFlow(Gn.US_BANK_ACCOUNT,(()=>new ww(t,n,this.sentry,new SO(i),this.intl,{companyKey:s.company.key,getSessionToken:()=>i.sessionToken},a,o,r,l,c,u,d,h)))}resolveACSS(e){let{sessionAPI:t,stripeLoadingPromise:n,donorName:i,donorEmail:s,setPaymentMethod:a}=e;return this.getOrCreatePaymentFlow(Gn.ACSS,(()=>new lw(n,this.intl,this.sentry,new SO(t),i,s,a)))}resolveVenmo(e){let{sessionAPI:t,livemode:n,showcase:i,locale:s,iframeWindow:a,paypalClientId:o,paypalMerchantId:r,updateSession:l,setPaymentMethod:c,setDonorFirstNameIfEmpty:u,setDonorLastNameIfEmpty:d,setDonorEmailIfEmpty:h,setPhoneCountryCodeIfEmptyPhone:m,setPhoneNumberIfEmpty:p,setCountryCodeIfEmptyAddress:g,setCityIfEmpty:y,setLine1IfEmpty:f,setLine2IfEmpty:v,setPostalIfEmpty:S,setRegionIfEmpty:E}=e;return this.getOrCreatePaymentFlow(Gn.VENMO,(()=>new Fw(n,i,{paypalClientId:o,paypalMerchantId:r},this.sentry,s,a,l,c,u,d,h,m,p,g,y,f,v,S,E,new jw(t),new SO(t))))}getPaymentFlow(e){return this.paymentFlows[e]}getOrCreatePaymentFlow(e,t){return this.paymentFlows[e]||(this.paymentFlows[e]=t()),this.paymentFlows[e]}}var Gw;!function(e){e.V3="v3",e.V4="v4",e.V5_1="v5.1",e.V5_2="v5.2",e.V5_3="v5.3",e.V5_4="v5.4"}(Gw||(Gw={}));class qw{}qw.isAmountPresetsV5Version=e=>!!e&&(e===Gw.V5_1||e===Gw.V5_2||e===Gw.V5_3||e===Gw.V5_4),qw.getAmountPresetsV5ApiVersion=e=>{switch(e){case te.TEST_1:return Gw.V5_1;case te.TEST_2:return Gw.V5_2;case te.TEST_3:return Gw.V5_3;case te.TEST_4:return Gw.V5_4;default:return null}};const Vw=(e,t,n,i,s,a,o)=>{const{isFallback:r}=i,l=(0,d.Tt)(i,["isFallback"]),c=e.allAmountSuggestions,u=e.allDefaultAmounts,h=e=>c[e]?c[e]:[],m=e=>u[e]?u[e]:0,p=e=>!r&&"presets"in l?l.presets[e].amountOptions:[],g=e=>!r&&"presets"in l?l.presets[e].defaultAmount:0,y={donation:{amounts:{[qn.ONCE]:{amountOptions:h(qn.ONCE),defaultAmount:m(qn.ONCE),minAmount:e.getFrequencyMinimalAmount(qn.ONCE),currency:a},[qn.MONTHLY]:{amountOptions:h(qn.MONTHLY),defaultAmount:m(qn.MONTHLY),minAmount:e.getFrequencyMinimalAmount(qn.MONTHLY),currency:a}}}},f={donation:{amounts:{[qn.ONCE]:{amountOptions:p(qn.ONCE),defaultAmount:g(qn.ONCE),minAmount:e.getFrequencyMinimalAmount(qn.ONCE),currency:a},[qn.MONTHLY]:{amountOptions:p(qn.MONTHLY),defaultAmount:g(qn.MONTHLY),minAmount:e.getFrequencyMinimalAmount(qn.MONTHLY),currency:a}}}},v={isSuggestionUsed:s&&!r,isFallback:r,requestDurationMs:t,suggestion:f,defaults:y,fetchCallsCount:n};return qw.isAmountPresetsV5Version(o)&&(v.mlVersion=null!=o?o:void 0),v},Hw=(e,t)=>!(!e||!t||e.defaultAmount<t||!e.amountOptions.length||e.amountOptions.some((e=>e<t)));class Kw{constructor(e,t,n,i,s,a,o){this.checkoutService=e,this.checkoutState=t,this.tracker=n,this.checkoutConfiguration=i,this.currencyService=s,this.suggestionsService=a,this.amountPresetsFetcher=o,this._allowedFrequencies=[qn.ONCE,qn.MONTHLY],this._amountPresetsTrackData=[]}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutService.tryStartMlAmountPresetsV5Experiment(this.getCanApplyParams()),this.checkoutService.exposeMlAmountPresetsV5Experiment(),!this.shouldUseAdaptiveLogic())return;const e=this.getCanApplyParams(),t=this.getAmountPresetsVersion();yield Promise.all(e.currencies.map((e=>this.amountPresetsFetcher.fetchSuggestion(e,t)))),e.currencies.forEach((e=>this.saveMlAmountPresetsTrackData(e)))}))}tryApplySuggestion(){if(!this.shouldUseAdaptiveLogic())return;if(!this.canApply())return;const e=[this.donationDataPoint.currency];this.donationDataPoint.isCurrencyEditableForFrequency(qn.MONTHLY)||this.donationDataPoint.currency===this.checkoutConfiguration.defaultCurrency||e.unshift(this.checkoutConfiguration.defaultCurrency);for(const t of e){const e=this.amountPresetsFetcher.getSuggestion(t);null!==e&&(e.isFallback||this.checkoutConfiguration.enabledFrequencies.forEach((n=>{const i=this.donationDataPoint.frequency===n;if(!this.donationDataPoint.isCurrencyEditableForFrequency(n)&&this.checkoutConfiguration.defaultCurrency!==t||!this.allowedFrequencies.includes(n))return;if(this.checkoutService.isMlAmountPresetsV5ExperimentEnabled()&&0===e.presets[n].amountOptions.length)return;const s=i&&this.checkoutConfiguration.hasExternalAmount,a=!this.checkoutConfiguration.defaultAmounts[n],o=this.checkoutService.isMlAmountPresetsV5ExperimentEnabled();if(!s&&(o||!a)){const i=t!==this.donationDataPoint.currency?this.currencyService.convert(e.presets[n].defaultAmount,t,this.donationDataPoint.currency):e.presets[n].defaultAmount;this.changeDefaultAmountForFrequency(i,n)}const r=e.presets[n].amountOptions,l=t!==this.checkoutConfiguration.defaultCurrency?r.map((e=>this.currencyService.convert(e,t,this.checkoutConfiguration.defaultCurrency))):r;this.setSuggestionsAndDisableAi(r,l,n)})))}}tryTrackSuggestion(){this._amountPresetsTrackData.forEach((e=>{this.tracker.trackCheckoutCustomEvent({type:e.type,data:e.data})})),this._amountPresetsTrackData=[]}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get allowedFrequencies(){var e;return null!==(e=this.checkoutService.getMlAmountPresetsV5ExperimentAllowedFrequencies())&&void 0!==e?e:this._allowedFrequencies}shouldUseAdaptiveLogic(){return!(this.checkoutConfiguration.isRestoredByWidgetSession||this.checkoutConfiguration.infrastructureParams.showcase||this.checkoutConfiguration.infrastructureParams.isLighthouse||this.checkoutConfiguration.checkoutType!==Kn.PAGE&&!this.checkoutService.isMlAmountPresetsV5ExperimentEnabled())}getAmountPresetsCurrencies(){let e=[this.donationDataPoint.currency];return this.donationDataPoint.isCurrencyEditableForFrequency(qn.MONTHLY)||this.donationDataPoint.currency===this.checkoutConfiguration.defaultCurrency||(this.allowedFrequencies.includes(qn.ONCE)?e.push(this.checkoutConfiguration.defaultCurrency):e=[this.checkoutConfiguration.defaultCurrency]),e}changeDefaultAmountForFrequency(e,t){if(null!==e){const n=this.suggestionsService.beautify(e,this.donationDataPoint.currency);this.checkoutState.donation.setFrequencyDefaultAmount(t,n)}}setSuggestionsAndDisableAi(e,t,n){const i=this.suggestionsService.beautify(e,this.donationDataPoint.currency),s=this.suggestionsService.beautify(t,this.checkoutConfiguration.defaultCurrency);this.checkoutState.donation.setFrequencyAmountSuggestions(n,s,i,!0)}getCanApplyParams(){var e,t;const n=this.checkoutConfiguration.enabledFrequencies,i=this.checkoutConfiguration.element,s=n.some((e=>this.checkoutConfiguration.campaign.config.frequencies[e].hintsEnabled)),a=this.getAmountPresetsCurrencies(),o=a[0]||this.donationDataPoint.currency;let r=this.donationDataPoint.getFrequencyMinimalAmount(qn.ONCE),l=this.donationDataPoint.getFrequencyMinimalAmount(qn.MONTHLY);return o!==this.donationDataPoint.currency&&(r=this.currencyService.convert(r,this.donationDataPoint.currency,o),l=this.currencyService.convert(l,this.donationDataPoint.currency,o)),{fromDonationForm:i.type===Hn.DONATION_FORM,isEnabledCampaignAi:this.checkoutConfiguration.campaign.config.enableAI,isEnabledCampaignHints:s,p2pUsed:!!(null===(e=this.checkoutConfiguration.fundraisingPage)||void 0===e?void 0:e.key),enabledFrequencies:n,minAmounts:{[qn.ONCE]:r,[qn.MONTHLY]:l},mlSuggestion:null!==(t=this.amountPresetsFetcher.getSuggestion(o))&&void 0!==t?t:null,currencies:a}}saveMlAmountPresetsTrackData(e){if(!this.amountPresetsFetcher.isSuggestionRequested(e))return;const t=this.amountPresetsFetcher.getSuggestion(e);if(!t)return;const n=this.getAmountPresetsVersion(),i=this.canApply();if(qw.isAmountPresetsV5Version(n))return this.trackResponse(t,i,e,Ee.EXPERIMENT_ML_AMOUNT_PRESETS_V5_RESPONSE,n),void(t.v3&&this.trackResponse(t.v3,!1,e,Ee.EXPERIMENT_ML_AMOUNT_PRESETS_RESPONSE,Gw.V3));this.trackResponse(t,i,e,Ee.EXPERIMENT_ML_AMOUNT_PRESETS_RESPONSE,n)}trackResponse(e,t,n,i,s){this._amountPresetsTrackData.push({type:i,data:Vw(this.donationDataPoint,this.amountPresetsFetcher.getSuggestionRequestDurationMs(n),this.amountPresetsFetcher.getSuggestionFetchCallsCount(n),e,t,n,s)})}getAmountPresetsVersion(){return this.checkoutService.isMlAmountPresetsV5ExperimentEnabled()?qw.getAmountPresetsV5ApiVersion(this.checkoutService.getMlAmountPresetsV5ExperimentTestGroup()):Gw.V3}canApply(){const e=this.getCanApplyParams();return!!e.isEnabledCampaignAi&&!e.isEnabledCampaignHints&&(!e.p2pUsed||!this.checkoutService.isMlAmountPresetsPagesV5ControlGroupEnabled())&&!!e.mlSuggestion&&!e.mlSuggestion.isFallback&&(qw.isAmountPresetsV5Version(this.getAmountPresetsVersion())?(e=>{const{mlSuggestion:t,minAmounts:n,allowedFrequencies:i}=e;let s=!1;for(const e of i){const i=t.presets[e],a=n[e];if(i.amountOptions.length&&i.defaultAmount){if(!Hw(i,a))return!1;s=!0}}return s})({mlSuggestion:e.mlSuggestion,minAmounts:e.minAmounts,allowedFrequencies:this.allowedFrequencies}):(e=>{let{mlSuggestion:t,minAmounts:n,allowedFrequencies:i}=e;for(const e of i){const i=t.presets[e],s=n[e];if(!Hw(i,s))return!1}return!0})({mlSuggestion:e.mlSuggestion,minAmounts:e.minAmounts,allowedFrequencies:this.allowedFrequencies}))}}var Yw;!function(e){e.V1="v1",e.V2="v2",e.V3="v3"}(Yw||(Yw={}));class zw{constructor(e,t,n,i,s,a){this.checkoutConfiguration=e,this.currencyService=t,this.checkoutState=n,this.tracker=i,this.defaultFrequencyFetcher=s,this.options=a}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s;if(!this.canApply())return wn.success(void 0);if(this.isSuggestionRequestedAtLeastOnce)return wn.success(void 0);const a=yield this.defaultFrequencyFetcher.fetchSuggestion({amount:this.donationDataPoint.amountInUSD||0,currency:this.donationDataPoint.currency||"USD",companyKey:this.params.companyKey,campaignKey:this.params.campaignKey,elementKey:this.params.elementKey,clientLocale:this.params.clientLocale,utmSource:this.params.utmSource,checkoutType:this.params.checkoutType,currencyRate:this.currencyService.getRate(this.donationDataPoint.currency),clientId:this.tracker.clientId,version:Yw.V3,clientDevicePixelRatio:this.options.clientDevicePixelRatio,clientBatteryLevel:null!==(e=this.options.clientBatteryLevel)&&void 0!==e?e:0,clientDeviceMemory:null!==(t=this.options.clientDeviceMemory)&&void 0!==t?t:0,clientHardwareConcurrency:null!==(n=this.options.clientHardwareConcurrency)&&void 0!==n?n:0,clientConnectionDownlink:null!==(i=this.options.clientConnectionDownlink)&&void 0!==i?i:0,clientConnectionType:null!==(s=this.options.clientConnectionType)&&void 0!==s?s:"",clientDoNotTrack:Boolean(this.options.clientDoNotTrack)});return wn.isFailure(a)?wn.fail(void 0):wn.success(void 0)}))}tryApplySuggestion(){if(!this.canApply())return;const e=this.defaultFrequencyFetcher.getSuggestion();e.isFallback||(this.checkoutState.donation.setDonationsFrequency(e.defaultFrequency),this.tryReapplyExternalAmount())}tryTrackSuggestion(){if(!this.canApply())return;const e=this.defaultFrequencyFetcher.getSuggestion(),t=this.defaultFrequencyFetcher.getMeta();this.tracker.trackCheckoutCustomEvent({type:Ee.ML_DEFAULT_FREQUENCY_V3_RESPONSE,data:{isSuggestionUsed:!e.isFallback,isFallback:e.isFallback,requestDurationMs:t.requestDurationMs,suggestion:{defaultFrequency:e.defaultFrequency},defaults:{frequency:this.checkoutConfiguration.defaultFrequency}}})}get params(){var e;return{companyKey:this.checkoutConfiguration.company.key,campaignKey:this.checkoutConfiguration.campaign.key,elementKey:this.checkoutConfiguration.element.key,clientLocale:this.tracker.clientLocale,utmSource:(null===(e=this.checkoutConfiguration.external.utm)||void 0===e?void 0:e.source)||"",isFrequenciesAIEnabled:this.checkoutConfiguration.aiConfig.frequencies.enabled,enabledFrequencies:this.checkoutConfiguration.enabledFrequencies,hasExternalFrequency:this.checkoutConfiguration.hasExternalFrequency,externalFrequency:this.checkoutConfiguration.externalFrequency,userCountry:this.checkoutConfiguration.user.address.countryCode,checkoutType:this.checkoutConfiguration.checkoutType}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get allowedFrequencies(){return[qn.ONCE,qn.MONTHLY]}get isSuggestionRequestedAtLeastOnce(){return this.defaultFrequencyFetcher.getMeta().fetchCallsCount>0}shouldUseAdaptiveLogic(){return!this.checkoutConfiguration.infrastructureParams.showcase&&!this.checkoutConfiguration.infrastructureParams.isLighthouse}tryReapplyExternalAmount(){var e,t,n,i,s;const a=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.amount,o=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.currency;if(void 0===a)return;const r=this.checkoutConfiguration.campaign.config.defaultCurrency,l=this.donationDataPoint.currency;this.checkoutState.donation.setCurrency(r),this.checkoutConfiguration.enabledFrequencies.forEach((e=>{var t;this.checkoutState.donation.setFrequencyDefaultAmount(e,null!==(t=this.checkoutConfiguration.campaign.config.frequencies[e].defaultAmount)&&void 0!==t?t:0)})),this.checkoutState.donation.setDefaultAmountsApplied(),this.checkoutState.donation.setCurrency(null!=o?o:r),this.checkoutState.donation.setFrequencyDefaultAmount(this.donationDataPoint.frequency,a),this.checkoutState.donation.setCurrency(l);const c=null===(s=this.donationDataPoint.getFrequencyAmountHints(this.donationDataPoint.frequency))||void 0===s?void 0:s.find((e=>e.amount===a));c&&this.checkoutState.donation.setDonationsAmountHint(c)}isChosenBenefitAvailableOnlyInOneFrequency(){var e,t;return null!==(t=null===(e=this.checkoutState.benefits.dataPoint.chosenBenefit)||void 0===e?void 0:e.isAvailableOnlyInOneFrequency)&&void 0!==t&&t}canApply(){return!!this.checkoutConfiguration.donationSettings.isAdaptiveDefaultFrequencySuggestionEnabled&&(!this.checkoutConfiguration.isRestoredByWidgetSession&&(!!this.params.isFrequenciesAIEnabled&&(!!this.shouldUseAdaptiveLogic()&&(!(this.params.hasExternalFrequency&&this.params.externalFrequency&&this.allowedFrequencies.includes(this.params.externalFrequency))&&!(this.allowedFrequencies.length!==this.params.enabledFrequencies.length||!this.params.enabledFrequencies.every((e=>this.allowedFrequencies.includes(e)))||this.isChosenBenefitAvailableOnlyInOneFrequency())))))}}class Ww{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JSON.stringify,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>e;this.defaultValue=e,this.makeRequest=t,this.shouldCacheResponse=n,this.getCacheKey=i,this.getResult=s,this._cachedValues=new Map,this.pendingObject=null}getCachedOrFetchValue(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t;const n=this.getCacheKey(e);if(null===(t=this.pendingObject)||void 0===t?void 0:t.promise){if(this.pendingObject.cacheKey===n){const e=yield this.pendingObject.promise;return this.getResult(e,!1)}this.pendingObject.reject("Aborted"),this.pendingObject=null}const i=this._cachedValues.get(n);return i?Promise.resolve(this.getResult(i,!0)):this.makeRequestAndCacheValue(e)}))}makeRequestAndCacheValue(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.getCacheKey(e);this.pendingObject=this.initPendingObject(e,t);try{const n=yield this.pendingObject.promise;return this.shouldCacheResponse(e,n)&&this._cachedValues.set(t,n),this.getResult(n,!1)}catch(e){return this._cachedValues.delete(t),this.getResult(this.defaultValue,!1)}finally{this.pendingObject=null}}))}initPendingObject(e,t){let n=e=>{};return{promise:new Promise(((t,i)=>{n=i,this.makeRequest(e).then((e=>{wn.isSuccess(e)?t(e.successResult):t(this.defaultValue)})).catch(i)})),cacheKey:t,reject:n}}}const $w={isFallback:!0};class Xw{constructor(e){this.sessionApi=e,this._suggestion=this.getResult($w,!1),this._fetchSuggestion=e=>Promise.race([this.requestCacheService.getCachedOrFetchValue(e),new Promise((e=>setTimeout((()=>{e(this.getResult($w,!1))}),1500)))]),this.requestCacheService=new Ww($w,e.getFeeCovering.bind(e),this.shouldCacheResponse,this.getCacheKey,this.getResult)}fetchSuggestion(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this._suggestion=yield this._fetchSuggestion(e),this._suggestion}))}getSuggestion(){return this._suggestion}getCacheKey(e){return JSON.stringify(e)}shouldCacheResponse(e,t){return!t.isFallback}getResult(e,t){return{response:e,fromCache:t}}}function Qw(){const e=new Date;return{eventTime:e.toISOString().split(".")[0]+"Z",clientWeekday:e.getDay(),clientHour:e.getHours(),clientTimeZone:Bi()}}var Zw,Jw;!function(e){e.YES="yes",e.NO="no",e.UNKNOWN="unknown"}(Zw||(Zw={})),function(e){e.V3="v3",e.V4="v4"}(Jw||(Jw={}));class eR{constructor(e,t,n,i,s,a){this.checkoutConfiguration=e,this.checkoutState=t,this.tracker=n,this.feeCoveringSuggestionsFetcher=i,this.currencyService=s,this._options=a,this.isAdaptiveSuggestionFetched=!1}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.canApply())return!1;const e=yield this.createGetSmartCoveringFeePayload();return null!==e&&(yield this.feeCoveringSuggestionsFetcher.fetchSuggestion(e),this.isAdaptiveSuggestionFetched=!0,!0)}))}tryApplySuggestion(){if(!this.canApply())return;const e=this.feeCoveringSuggestionsFetcher.getSuggestion();e.response.isFallback||this.checkoutState.donation.setFeeCovered(e.response.feeCoveringSuggestion===sC.DEFAULT_YES)}tryTrackSuggestion(){if(!this.isAdaptiveSuggestionFetched)return;if(!this.canApply())return;const e=this.feeCoveringSuggestionsFetcher.getSuggestion();e.fromCache||(this._options.version===Jw.V4?(e.response.v3&&this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_SMART_COVERING_FEE_V2_RESPONSE,data:this.prepareTrackDataForV3(e,!1)}),this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_SMART_COVERING_FEE_V4_RESPONSE,data:this.prepareTrackDataForV4(e,!0)})):this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_SMART_COVERING_FEE_V2_RESPONSE,data:this.prepareTrackDataForV3(e,!0)}))}get donationDataPoint(){return this.checkoutState.donation.dataPoint}canApply(){return!!this._options.isAdaptiveLogicEnabled&&this.checkoutConfiguration.campaign.config.includeFees===sC.SMART_COVERING&&!this.donationDataPoint.isCustomFeeCoveredValue&&!!this.shouldUseAdaptiveLogic()}createGetSmartCoveringFeePayload(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s,a;if(null===this.donationDataPoint.amountInUSD||null===this.donationDataPoint.getFrequencyDefaultAmount(this.donationDataPoint.frequency))return null;const o=this.currencyService.convert(this.checkoutConfiguration.defaultAmounts[this.donationDataPoint.frequency]||0,this.checkoutConfiguration.defaultCurrency,"USD"),r=this.currencyService.getRate(this.donationDataPoint.currency),l=this.checkoutState.preDonationUpsell.dataPoint.isShowed,c=this.checkoutState.preDonationUpsell.dataPoint.isAccepted,{eventTime:u}=Qw();return{amountInUSD:this.donationDataPoint.amountInUSD,defaultAmountInUSD:o,currency:this.donationDataPoint.currency,companyKey:this.checkoutConfiguration.company.key,campaignKey:this.checkoutConfiguration.campaign.key,clientLocale:this.checkoutConfiguration.environmentConfig.locale,history:window.history.length,trackerClientId:this.tracker.clientId,elementLocale:this.checkoutConfiguration.element.locale,clientTimeZone:Bi(),battery:null!==(e=this._options.clientBatteryLevel)&&void 0!==e?e:0,version:null!==(t=this._options.version)&&void 0!==t?t:Jw.V3,eventTime:u,checkoutType:this.checkoutConfiguration.checkoutType,clientDeviceMemory:null!==(n=this._options.clientDeviceMemory)&&void 0!==n?n:0,clientDevicePixelRatio:null!==(i=this._options.clientDevicePixelRatio)&&void 0!==i?i:0,clientHardwareConcurrency:null!==(s=this._options.clientHardwareConcurrency)&&void 0!==s?s:0,clientConnectionDownlink:null!==(a=this._options.clientConnectionDownlink)&&void 0!==a?a:0,isInApp:this.checkoutConfiguration.infrastructureParams.isInAppBrowser,currencyRate:r,clientDoNotTrack:Boolean(this._options.clientDoNotTrack),upsellShown:l,upsellUsed:c,elementType:this.checkoutConfiguration.element.type}}))}shouldUseAdaptiveLogic(){return!this.checkoutConfiguration.infrastructureParams.showcase&&!this.checkoutConfiguration.infrastructureParams.isLighthouse}prepareTrackDataForV3(e,t){return e.response.v3?e.response.v3.isFallback?{isFallback:!0,isSuggestionUsed:!1}:{isFallback:e.response.v3.isFallback,feeCoveringSuggestion:e.response.v3.feeCoveringSuggestion,isSuggestionUsed:t}:this.prepareTrackDataForV4(e,t)}prepareTrackDataForV4(e,t){return e.response.isFallback?{isFallback:!0,isSuggestionUsed:!1}:{isFallback:e.response.isFallback,feeCoveringSuggestion:e.response.feeCoveringSuggestion,isSuggestionUsed:t}}}class tR{constructor(e,t,n,i){this.adaptiveDefaultFrequencyService=e,this.adaptiveAmountPresetsService=t,this.adaptivePreDonationUpsellSuggestionsService=n,this.adaptiveFeeCoveringService=i}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){yield Promise.all([this.adaptiveDefaultFrequencyService.tryFetchSuggestion(),this.adaptiveAmountPresetsService.tryFetchSuggestion()])}))}tryApplySuggestion(){this.adaptiveDefaultFrequencyService.tryApplySuggestion(),this.adaptiveAmountPresetsService.tryApplySuggestion()}tryTrackSuggestion(){var e,t;this.adaptiveDefaultFrequencyService.tryTrackSuggestion(),this.adaptiveAmountPresetsService.tryTrackSuggestion(),null===(e=this.adaptivePreDonationUpsellSuggestionsService)||void 0===e||e.tryTrackSuggestion(),null===(t=this.adaptiveFeeCoveringService)||void 0===t||t.tryTrackSuggestion()}}const nR={amount:0,currency:"",isFallback:!0};class iR{constructor(e){this.sessionApi=e,this.suggestion=nR,this.requestDurationMs=0,this.fetchCallsCount=0}getMeta(){return{requestDurationMs:this.requestDurationMs,fetchCallsCount:this.fetchCallsCount}}getSuggestion(){return this.suggestion}fetchSuggestion(e){return(0,d.sH)(this,void 0,void 0,(function*(){try{const t=performance.now(),n=yield Promise.race([this.timeoutPromise,this.fetchSuggestionFromApi(e)]);return wn.isSuccess(n)?this.suggestion=n.successResult:this.suggestion=nR,this.requestDurationMs=Math.round(performance.now()-t),wn.success(void 0)}catch(e){return this.suggestion=nR,this.requestDurationMs=0,wn.fail(void 0)}finally{this.fetchCallsCount++}}))}get timeoutPromise(){return new Promise((e=>{setTimeout((()=>{e(wn.success(nR))}),3e3)}))}fetchSuggestionFromApi(e){return this.sessionApi.post("getPduAmount",e)}}var sR,aR;!function(e){e.PAGES="pages",e.MODAL="modal"}(sR||(sR={})),function(e){e.V1="v1",e.V3="v3"}(aR||(aR={}));class oR{constructor(e,t,n,i,s,a,o){this.checkoutState=e,this.checkoutConfiguration=t,this.tracker=n,this.pduAmountsFetcher=i,this.currencyService=s,this.suggestions=a,this._options=o}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.getRequestParams(),t=yield this.pduAmountsFetcher.fetchSuggestion(e);return!wn.isFailure(t)}))}tryApplySuggestion(){const e=this.pduAmountsFetcher.getSuggestion();if(!e||e.isFallback)return;const t=this.adjustSuggestion(e,this.postDonationUpsellDataPoint.upsellMinAmount);this.checkoutState.postDonationUpsell.setUpsellCustomAmount(t.amount)}tryTrackSuggestion(){const e=this.pduAmountsFetcher.getSuggestion(),t=this.pduAmountsFetcher.getMeta();this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_POST_DONATION_UPSELL_AMOUNT_SUGGESTION,data:{suggestion:e,requestDurationMs:t.requestDurationMs,suggestionFetchCallsCount:t.fetchCallsCount}})}get postDonationUpsellDataPoint(){return this.checkoutState.postDonationUpsell.dataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}getMaxSumInCorrectCurrency(){return this.currencyService.fromFloat(this.currencyService.convert(1e3,"USD",this.donationDataPoint.currency),this.donationDataPoint.currency)}getRequestParams(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;const n=new Date;return{clientId:this.tracker.clientId,utmSource:(null===(e=this.checkoutConfiguration.external.utm)||void 0===e?void 0:e.source)||"",source:this.checkoutConfiguration.checkoutType,version:aR.V3,companyKey:this.checkoutConfiguration.company.key,checkoutWidgetKey:this.checkoutConfiguration.campaign.key,checkoutCurrency:this.donationDataPoint.currency,checkoutInUsdAmount:null!==(t=this.donationDataPoint.amountInUSD)&&void 0!==t?t:0,checkoutCurrencyRate:this.currencyService.getRate(this.donationDataPoint.currency),clientWeekday:n.getDay(),clientHour:n.getHours(),clientTimeZone:Bi(),clientLocale:this.checkoutConfiguration.environmentConfig.locale,clientDevicePixelRatio:this._options.clientDevicePixelRatio,clientBatteryLevel:this._options.clientBatteryLevel,clientDeviceMemory:this._options.clientDeviceMemory,clientHardwareConcurrency:this._options.clientHardwareConcurrency,clientConnectionDownlink:this._options.clientConnectionDownlink,clientConnectionType:this._options.clientConnectionType,clientDoNotTrack:Boolean(this._options.clientDoNotTrack)}}))}adjustSuggestion(e,t){const{amount:n,currency:i}=e,s=this.currencyService.convert(n,i,this.donationDataPoint.currency);let a=s;s<=t&&(a=t);const o=this.getMaxSumInCorrectCurrency();return s>o&&(a=o),Object.assign(Object.assign({},e),{amount:this.suggestions.beautify(a,this.donationDataPoint.currency)})}}class rR{constructor(e){this.isAdaptiveSuggestionFetched=!1,this.adaptivePreDonationUpsellSuggestionsFetcher=e.adaptivePreDonationUpsellSuggestionsFetcher,this.checkoutConfiguration=e.checkoutConfiguration,this.checkoutState=e.checkoutState,this.currencyService=e.currencyService,this.suggestionsService=e.suggestionsService,this.tracker=e.tracker,this.useShowUpsell=e.useShowUpsell,this.checkForUseAmounts=e.checkForUseAmounts}tryFetchSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i,s,a,o,r,l;if(!this.shouldFetchSuggestion)return!1;if(null===this.donationDataPoint.amount||null===this.donationDataPoint.amountInUSD)return!1;const c=null===(e=this.tracker.page)||void 0===e?void 0:e.toObject();return yield this.adaptivePreDonationUpsellSuggestionsFetcher.fetchSuggestion(Object.assign(Object.assign({},Qw()),{clientLocale:this.checkoutConfiguration.environmentConfig.locale,clientId:this.tracker.clientId,amountUsd:this.donationDataPoint.amountInUSD,currency:this.donationDataPoint.currency,currencyRate:this.currencyService.getRate(this.donationDataPoint.currency),companyKey:this.checkoutConfiguration.company.key,campaignKey:this.checkoutConfiguration.campaign.key,utmSource:null!==(n=null===(t=this.checkoutConfiguration.external.utm)||void 0===t?void 0:t.source)&&void 0!==n?n:"",clientDeviceMemory:null!==(i=null==c?void 0:c.clientDeviceMemory)&&void 0!==i?i:1,clientDevicePixelRatio:null!==(s=null==c?void 0:c.clientDevicePixelRatio)&&void 0!==s?s:1,clientHardwareConcurrency:null!==(a=null==c?void 0:c.clientHardwareConcurrency)&&void 0!==a?a:1,clientBatteryLevel:null!==(o=null==c?void 0:c.clientBatteryLevel)&&void 0!==o?o:1,clientDoNotTrack:null!==(r=null==c?void 0:c.clientDoNotTrack)&&void 0!==r?r:1,clientConnectionDownlink:null!==(l=null==c?void 0:c.clientConnectionDownlink)&&void 0!==l?l:1,isCheckoutPage:this.checkoutConfiguration.checkoutType===Kn.PAGE})),this.isAdaptiveSuggestionFetched=!0,!0}))}tryApplySuggestion(){this.tryApplyShowUpsell(),this.tryApplyAmounts()}tryTrackSuggestion(){if(!this.isAdaptiveSuggestionFetched)return;const e=this.adaptivePreDonationUpsellSuggestionsFetcher.getSuggestion();this.tracker.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_ML_PRE_DONATION_UPSELL_V2_RESPONSE,data:{showUpsell:e.showUpsell,primaryAmount:e.primaryAmount,secondaryAmount:e.secondaryAmount}})}resetSuggestionApplication(){this.checkoutState.preDonationUpsell.resetSuggestedAvailability(),this.checkoutState.preDonationUpsell.resetSuggestedAmounts()}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get shouldFetchSuggestion(){return!(!this.checkoutConfiguration.preDonationUpsellSettings.isAdaptiveSuggestionEnabled||!this.preDonationUpsellDataPoint.isEnabled||this.preDonationUpsellDataPoint.upsellFrequency!==qn.MONTHLY&&this.preDonationUpsellDataPoint.upsellFrequency!==qn.EVERY_4_WEEKS)}get preDonationUpsellDataPoint(){return this.checkoutState.preDonationUpsell.dataPoint}tryApplyShowUpsell(){if(!this.useShowUpsell)return;const e=this.adaptivePreDonationUpsellSuggestionsFetcher.getSuggestion();e.showUpsell!==Zw.UNKNOWN&&this.checkoutState.preDonationUpsell.setSuggestedAvailability(e.showUpsell===Zw.YES)}tryApplyAmounts(){if(!this.checkForUseAmounts(this.checkoutState))return;const e=this.getAdjustedAmounts();e&&this.checkoutState.preDonationUpsell.setSuggestedAmounts(...e)}getAdjustedAmounts(){const e=this.adaptivePreDonationUpsellSuggestionsFetcher.getSuggestion(),t=e.primaryAmount,n=e.secondaryAmount;if(0===t&&0===n)return;if("number"!=typeof t||isNaN(t)||"number"!=typeof n||isNaN(n))return;const i=this.preDonationUpsellDataPoint.upsellCurrency,s=this.donationDataPoint.getFrequencyMinimalAmount(this.preDonationUpsellDataPoint.upsellFrequency);let a=null,o=null;return[a,o]=[t,n].map((e=>this.suggestionsService.beautify(this.currencyService.convert(e,"USD",i),i))),a<s||o<s?void 0:(a===o&&(o=null),[a,o])}}function lR(e,t=300){let n;const i=()=>{clearTimeout(n),n=setTimeout((()=>{e()}),t)};return i.cancel=()=>{clearTimeout(n)},i}function cR(e,t){let n=null;const i=(...i)=>new Promise(((s,a)=>{null!==n&&(clearTimeout(n),n=null),n=setTimeout((()=>{e(...i).then(s).catch(a)}),t)}));return i.cancel=()=>{null!==n&&(clearTimeout(n),n=null)},i}const uR={showUpsell:Zw.YES,primaryAmount:null,secondaryAmount:null};class dR{constructor(e){this.suggestion=uR,this.requestCacheService=new Ww(uR,(t=>e.getNextScreen(t)),((e,t)=>this.shouldCacheResponse(e,t)),(e=>this.getCacheKey(e))),this.fetchSuggestionWithDebounce=cR((e=>this.getCachedOrFetchValue(e)),500)}fetchSuggestion(e){return this.fetchSuggestionWithDebounce(e)}getSuggestion(){return this.suggestion}shouldCacheResponse(e,t){return t.showUpsell!==Zw.UNKNOWN&&null!==t.primaryAmount&&null!==t.secondaryAmount}getCacheKey(e){return JSON.stringify({eventTime:new Date(e.eventTime).toLocaleTimeString(e.clientLocale,{hour:"2-digit",weekday:"long"}),clientLocale:e.clientLocale,amountUsd:e.amountUsd,currency:e.currency,currencyRate:e.currencyRate,companyKey:e.companyKey,campaignKey:e.campaignKey})}getCachedOrFetchValue(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.suggestion=yield this.requestCacheService.getCachedOrFetchValue(e),this.suggestion}))}}class hR{constructor(e){this.adaptiveSuggestionsService=e}tryApply(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.adaptiveSuggestionsService.tryFetchSuggestion(),this.adaptiveSuggestionsService.tryApplySuggestion()}))}}class mR{constructor(e,t){this.checkoutConfiguration=e,this.checkoutState=t}tryApply(){var e,t;(null===(e=this.checkoutConfiguration.external.flow)||void 0===e?void 0:e.type)&&(null===(t=this.checkoutConfiguration.external.flow)||void 0===t?void 0:t.type)!==$n.MONEY||(this.tryApplyEnabledAmountHints(),this.tryApplyFrequency(),this.tryApplyCurrencyAndAmount(),this.tryApplyAmountHint(),this.tryApplyEndDate(),this.tryApplyFeeCovered(),this.tryApplyBenefitParams())}get currentFrequency(){return this.checkoutState.donation.dataPoint.frequency}get currentCurrency(){return this.checkoutState.donation.dataPoint.currency}tryApplyEnabledAmountHints(){var e,t,n,i;const s=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.enabledAmountHintsIds,a=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.amountHintId;(s||a)&&Object.values(qn).forEach((e=>{const t=[];if(a&&t.push(a),(null==s?void 0:s[e])&&t.push(...s[e]),t.length){const n=[...new Set(t)];this.checkoutState.donation.setFrequencyAmountHints(e,n,this.currentCurrency),this.checkoutState.donation.setDefaultAmountsApplied()}}))}tryApplyFrequency(){var e,t;const n=this.chosenBenefitFrequency();if(n)return void this.checkoutState.donation.setDonationsFrequency(n);const i=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.frequency;i&&this.checkoutState.donation.setDonationsFrequency(i)}tryApplyCurrencyAndAmount(){var e,t,n,i;const s=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.currency,a=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.amount,o=this.currentCurrency;s&&(this.checkoutState.donation.setCurrency(s),void 0!==a&&this.checkoutState.donation.setFrequencyDefaultAmount(this.currentFrequency,a),this.checkoutState.donation.dataPoint.isCurrencyEditableForFrequency(this.currentFrequency)||this.checkoutState.donation.setCurrency(o)),s||void 0===a||(this.checkoutState.donation.setCurrency(this.checkoutConfiguration.defaultCurrency),this.checkoutState.donation.setFrequencyDefaultAmount(this.currentFrequency,a),this.checkoutState.donation.setCurrency(o))}tryApplyAmountHint(){var e,t,n,i,s,a;const o=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.amountHintId,r=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.amount;if(o){const e=null===(s=this.checkoutState.donation.dataPoint.getFrequencyAmountHints(this.currentFrequency))||void 0===s?void 0:s.find((e=>e.id===o));e&&this.checkoutState.donation.setDonationsAmountHint(e)}if(void 0!==r){const e=null===(a=this.checkoutState.donation.dataPoint.getFrequencyAmountHints(this.currentFrequency))||void 0===a?void 0:a.find((e=>e.amount===r));e&&this.checkoutState.donation.setDonationsAmountHint(e)}}tryApplyEndDate(){var e,t,n,i;const s=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.isEndDateSelected,a=null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.isEndDateEnabled;this.checkoutState.donation.setDonationsEndDateActive(!s||!!a)}tryApplyFeeCovered(){var e,t;const n=null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.donation)||void 0===t?void 0:t.isFeeCovered;void 0!==n&&this.checkoutState.donation.setFeeCovered(n,{isCustomFeeCoveredValue:!0})}tryApplyBenefitParams(){var e,t,n,i;(null===(t=null===(e=this.checkoutConfiguration.external.state)||void 0===e?void 0:e.benefit)||void 0===t?void 0:t.id)&&(this.checkoutState.benefits.setChosenBenefit(this.checkoutConfiguration.external.state.benefit.id),(null===(i=null===(n=this.checkoutConfiguration.external.state)||void 0===n?void 0:n.benefit)||void 0===i?void 0:i.optionValueId)&&this.checkoutState.benefits.setOptionVariant(this.checkoutConfiguration.external.state.benefit.id,this.checkoutConfiguration.external.state.benefit.optionValueId))}chosenBenefitFrequency(){var e;const t=this.checkoutState.benefits.dataPoint.chosenBenefit;if(!(null==t?void 0:t.isAvailableOnlyInOneFrequency))return null;const n=null!==(e=null==t?void 0:t.eligibilityCriterias)&&void 0!==e?e:{};return Object.keys(n).filter((e=>Object.values(qn).includes(e)))[0]||null}}class pR{constructor(e,t,n,i,s){this.checkoutConfiguration=e,this.checkoutState=t,this.sessionService=n,this.sessionTokenService=i,this.initialScreenDecider=s}apply(e,t){this.checkoutConfiguration.setRestoredByWidgetSession(),this.sessionTokenService.setToken(e),this.initialScreenDecider.setScreensHistoryForRestore(t.screenHistory),this.sessionService.setRestoreSessionData(t),this.applyComment(t),this.applyTribute(t),this.applyDonation(t),this.applyCustomer(t),this.applyMailingAddress(t),this.applyPayment(t),this.applyElement(t),this.applyBenefit(t)}applyComment(e){e.comment&&(this.checkoutState.comment.saveComment(e.comment),this.checkoutState.comment.setIsActive(!0))}applyTribute(e){var t;(null===(t=e.tribute)||void 0===t?void 0:t.inHonorOf)&&(this.checkoutState.tribute.setTributeeName(e.tribute.inHonorOf),this.checkoutState.tribute.setActive(!0))}prepareGoals(e){var t;const n=[];for(const i of e.donation.donationItems)if(i.goal){const e=ZD();n.push({id:i.goal.key,key:e,name:i.goal.name,code:null!==(t=i.goal.code)&&void 0!==t?t:null,parentId:null,parentKey:null,repeat:tT(i.frequency),default:null,frequency:null,isGroup:!1})}return n}applyDonation(e){var t;const n=e.donation.items[0].frequency;if(this.applyPreDonationUpsell(e),this.applyEmployerUpsell(e),this.checkoutState.donation.setCurrency(e.donation.currency),this.applyDonationItems(e),this.applyGoals(e,tT(n)),e.donation.suggestedAmountHint){const i=null===(t=this.checkoutState.donation.dataPoint.getFrequencyAmountHints(n))||void 0===t?void 0:t.find((t=>t.id===e.donation.suggestedAmountHint));i&&this.checkoutState.donation.setDonationsAmountHint(i)}this.checkoutState.donation.setFeeCovered(Boolean(e.donation.publicFee),{isCustomFeeCoveredValue:!0}),e.donation.giftAid&&(e.donation.giftAid.shown&&this.checkoutState.giftAid.setShowed(),e.donation.giftAid.claimed&&this.checkoutState.giftAid.accept())}applyPreDonationUpsell(e){if(e.donation.upsell){this.checkoutState.donation.setDonationsAmount(e.donation.upsell.fromAmount),this.checkoutState.donation.setCurrency(e.donation.upsell.currency),this.checkoutState.donation.setDonationsFrequency(qn.ONCE),e.donation.upsell.showed&&this.checkoutState.preDonationUpsell.setShowed(),e.donation.upsell.used&&this.checkoutState.preDonationUpsell.confirm(!0);const t=e.donation.items[0];this.checkoutState.donation.setDonationsAmount(t.amount),this.checkoutState.donation.setDonationsFrequency(t.frequency),this.checkoutState.donation.setCurrency(e.donation.currency)}}applyEmployerUpsell(e){if(e.donation.employerUpsell){this.checkoutState.donation.setDonationsAmount(e.donation.employerUpsell.initialAmount),this.checkoutState.donation.setCurrency(e.donation.employerUpsell.currency),this.checkoutState.doubleTheDonation.setUpsellShowed(e.donation.employerUpsell.showed),e.donation.employerUpsell.used&&this.checkoutState.doubleTheDonation.setUpsellAccepted(),this.applyEmployer(e);const t=e.donation.items[0];this.checkoutState.donation.setDonationsAmount(t.amount),this.checkoutState.donation.setCurrency(e.donation.currency)}}applyDonationItems(e){var t;const n=e.donation.items[0];if((null===(t=e.donation.donationItems)||void 0===t?void 0:t.length)>1){e.donation.donationItems.forEach((e=>{this.checkoutState.donation.addDonation()})),this.checkoutState.donation.removeDonation(this.checkoutState.donation.dataPoint.availableDonationItemsDto[0].id);const t=this.checkoutState.donation.dataPoint.availableDonationItemsDto;for(let n=0;n<t.length;n++){const i=t[n],s=e.donation.donationItems[n].amount;this.checkoutState.donation.setDonationAmount(i.id,s)}}else this.checkoutState.donation.setDonationsAmount(n.amount);this.checkoutState.donation.setDonationsFrequency(n.frequency)}applyGoals(e,t){const n=this.prepareGoals(e);0===this.checkoutState.designations.dataPoint.allGoals.size&&this.checkoutState.designations.setAllGoals(n),this.checkoutState.designations.setSelectedGoals(n,t);const i=e.donation.items[0];i.goalKey&&this.checkoutState.designation.setGoal(i.goalKey)}applyCustomer(e){var t,n;if(this.checkoutState.privacy.setDonorTitle(e.customer.title),this.checkoutState.privacy.setDonorFirstName(e.customer.firstName),this.checkoutState.privacy.setDonorLastName(e.customer.lastName),e.customer.email&&this.checkoutState.privacy.setDonorEmail(e.customer.email),this.checkoutState.privacy.setPhoneNumber(e.customer.phone),this.checkoutState.privacy.setPhoneCleanNumber(e.customer.phone),e.customer.onBehalfOf&&(this.checkoutState.privacy.setOnBehalfOfCompanyName(e.customer.onBehalfOf),this.checkoutState.privacy.setOnBehalfOfActive(!0)),e.customer.anonymousChecked&&this.checkoutState.privacy.setDonateAnonymousChecked(e.customer.anonymousChecked),e.customer.termsChecked&&this.checkoutState.privacy.setTermsAndConditionsAccepted(e.customer.termsChecked),(null===(t=e.customer.consent)||void 0===t?void 0:t.type)===Ns.GENERAL){const t=e.customer.consent.general===Ts.OPTED_IN;e.customer.consent.general!==Ts.NOT_SUBMITTED&&this.checkoutState.communicationConsent.setGeneralConsentShown(),this.checkoutState.communicationConsent.setGeneralConsentState(t)}if((null===(n=e.customer.consent)||void 0===n?void 0:n.type)===Ns.CUSTOMIZED){const t=Object.keys(e.customer.consent.customized),n=t.some((t=>{var n;return(null===(n=e.customer.consent)||void 0===n?void 0:n.customized[t])!==Ts.NOT_SUBMITTED}));n&&this.checkoutState.communicationConsent.setCustomizedConsentShown(),t.forEach((t=>{var n;const i=(null===(n=e.customer.consent)||void 0===n?void 0:n.customized[t])===Ts.OPTED_IN;this.checkoutState.communicationConsent.setCustomizedChannelState(t,i)}))}}applyEmployer(e){var t,n;e.employer&&this.checkoutState.doubleTheDonation.setEmployerName(e.employer.name),e.employerDTD&&this.checkoutState.doubleTheDonation.setEmployerData({id:e.employerDTD.id,company_name:e.employerDTD.companyName,minimumMatchedAmount:null!==(t=e.employerDTD.minimumMatchedAmount)&&void 0!==t?t:0,ratio:(n=e.employerDTD.ratio,n?0===n.length?[1,1]:n:[1,1])})}applyMailingAddress(e){e.address&&(this.checkoutState.mailingAddress.setLine1(e.address.line1),e.address.line2&&this.checkoutState.mailingAddress.setLine2(e.address.line2),e.address.city&&this.checkoutState.mailingAddress.setCity(e.address.city),e.address.region&&this.checkoutState.mailingAddress.setRegion(e.address.region),this.checkoutState.mailingAddress.setPostal(e.address.postal),this.checkoutState.mailingAddress.setCountryCode(e.address.countryCode))}applyPayment(e){e.payment.clientPaymentMethod&&(this.checkoutState.paymentOptions.setPaymentMethod(e.payment.clientPaymentMethod),this.checkoutState.paymentOptions.setPaymentOption(e.payment.clientPaymentMethod),this.checkoutState.paymentOptions.setPreSelectedPaymentOption(e.payment.clientPaymentMethod))}applyBenefit(e){var t,n;const i=e.benefit;if(!(null==i?void 0:i.data))return;const s=i.data.key;s&&this.checkoutState.benefits.setChosenBenefit(s);const a=null===(n=null===(t=i.data.option)||void 0===t?void 0:t.variant)||void 0===n?void 0:n.publicId;s&&a&&this.checkoutState.benefits.setOptionVariant(s,a);const o=i.data.delivery;if(!o)return;this.checkoutState.benefits.setDeliveryShown(Boolean(o.showed)),this.checkoutState.benefits.setDeliveryUsed(Boolean(o.used));const r=o.data;if(!r)return;r.firstName&&this.checkoutState.benefits.setFirstName(r.firstName),r.lastName&&this.checkoutState.benefits.setLastName(r.lastName);const l=r.address;l&&(l.line1&&this.checkoutState.benefits.setLine1(l.line1),l.line2&&this.checkoutState.benefits.setLine2(l.line2),l.city&&this.checkoutState.benefits.setCity(l.city),l.region&&this.checkoutState.benefits.setRegion(l.region),l.postal&&this.checkoutState.benefits.setPostal(l.postal),l.countryCode&&this.checkoutState.benefits.setCountryCode(l.countryCode),l.sublocality&&this.checkoutState.benefits.setSublocality(l.sublocality),l.administrativeArea&&this.checkoutState.benefits.setAdministrativeArea(l.administrativeArea))}applyElement(e){var t,n,i,s;(e.element||e.reminder)&&this.checkoutConfiguration.restoreElement({key:null===(t=null==e?void 0:e.element)||void 0===t?void 0:t.key,type:null===(n=null==e?void 0:e.element)||void 0===n?void 0:n.type,reminderKey:null===(i=null==e?void 0:e.reminder)||void 0===i?void 0:i.key,locale:null===(s=null==e?void 0:e.element)||void 0===s?void 0:s.defaultLocale})}}class gR{constructor(e){this.sessionAPI=e,this.data=null}fetchData(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){const n=yield this.sessionAPI.post("restore",{clientId:t},{sessionToken:e});return wn.isSuccess(n)&&n.successResult&&(this.data=n.successResult),this.data}))}}class yR{constructor(e,t,n){this.checkoutConfiguration=e,this.checkoutRestoreDataFetcher=t,this.checkoutRestoreDataApplier=n}tryApply(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;const n=null===(e=this.checkoutConfiguration.external.restore)||void 0===e?void 0:e.token,i=null===(t=this.checkoutConfiguration.external.restore)||void 0===t?void 0:t.clientId;if(!n||!i)return!1;const s=yield this.checkoutRestoreDataFetcher.fetchData(n,i);return!!s&&(this.checkoutRestoreDataApplier.apply(n,s),!0)}))}}class fR extends yT{constructor(e,t,n,i,s,a,o,r,l,c,u){super(),this.designationStateService=e,this.designationsStateService=t,this.preDonationUpsellStateService=n,this.doubleTheDonationStateService=i,this.giftAidStateService=s,this.mailingAddressStateService=a,this.postDonationUpsellStateService=o,this.paymentOptionsStateService=r,this.communicationConsentStateService=l,this.remindMeLaterStateService=c,this.benefitsStateService=u}synchronize(){this.syncDesignation(),this.syncDesignations(),this.syncPreDonationUpsell(),this.syncDoubleTheDonation(),this.syncGiftAid(),this.syncMailingAddress(),this.syncPostDonationUpsell(),this.syncPaymentOptions(),this.syncCommunicationConsent(),this.syncRemindMeLater(),this.syncBenefits()}onDonationChange(){this.syncDesignation(),this.syncDesignations(),this.syncPreDonationUpsell(),this.syncDoubleTheDonation(),this.syncMailingAddress(),this.syncPostDonationUpsell(),this.syncPaymentOptions(),this.syncBenefits()}onDesignationChange(){this.syncPreDonationUpsell(),this.syncPostDonationUpsell()}onDesignationsChange(){this.syncPreDonationUpsell(),this.syncPostDonationUpsell()}onTributeChange(){this.syncPreDonationUpsell(),this.syncPostDonationUpsell()}onPrivacyChange(){this.syncDoubleTheDonation(),this.syncGiftAid(),this.syncCommunicationConsent(),this.syncRemindMeLater()}onGiftAidChange(){this.syncMailingAddress()}onPaymentOptionsChange(){this.syncMailingAddress(),this.syncPostDonationUpsell()}onMailingAddressChange(){this.syncCommunicationConsent()}onBenefitsChange(){this.syncPreDonationUpsell(),this.syncPostDonationUpsell(),this.syncGiftAid()}syncDesignation(){this.designationStateService.synchronize(),this.onDesignationChange()}syncDesignations(){this.designationsStateService.synchronize(),this.onDesignationsChange()}syncPreDonationUpsell(){this.preDonationUpsellStateService.synchronize()}syncDoubleTheDonation(){this.doubleTheDonationStateService.synchronize()}syncGiftAid(){this.giftAidStateService.synchronize(),this.onGiftAidChange()}syncMailingAddress(){this.mailingAddressStateService.synchronize(),this.onMailingAddressChange()}syncPostDonationUpsell(){this.postDonationUpsellStateService.synchronize()}syncPaymentOptions(){this.paymentOptionsStateService.synchronize(),this.onPaymentOptionsChange()}syncCommunicationConsent(){this.communicationConsentStateService.synchronize()}syncRemindMeLater(){this.remindMeLaterStateService.synchronize()}syncBenefits(){this.benefitsStateService.synchronize(),this.onBenefitsChange()}}class vR{constructor(e,t,n){this.checkoutConfiguration=e,this.dataPointRegistry=t,this.currencyService=n}isChosenBenefitEligible(){var e,t,n,i;const s=this.dataPointRegistry.getDataPoint(tk.BENEFITS).chosenBenefit,a=this.dataPointRegistry.getDataPoint(tk.DONATION),o=null!==(e=a.amount)&&void 0!==e?e:0,r=a.frequency;return o>=(null!==(i=null===(n=null===(t=null==s?void 0:s.eligibilityCriterias)||void 0===t?void 0:t[r])||void 0===n?void 0:n.minAmount)&&void 0!==i?i:0)}getAvailableForCurrentFrequencyBenefits(){const e=this.dataPointRegistry.getDataPoint(tk.BENEFITS).benefits,t=this.dataPointRegistry.getDataPoint(tk.DONATION);let n=t.frequency;n===qn.ANNUAL&&(n=qn.ONCE);const i=t.currency;return e.filter((e=>{var t;return void 0!==(null===(t=e.eligibilityCriterias)||void 0===t?void 0:t[n])})).map((e=>this.convertBenefitAmountsToDonationCurrency(e,n,i)))}convertBenefitAmountsToDonationCurrency(e,t,n){var i,s,a,o;const r=null===(i=e.eligibilityCriterias)||void 0===i?void 0:i[t];return r?Object.assign(Object.assign({},e),{fmv:this.convertAndCeilAmount(null!==(s=e.fmv)&&void 0!==s?s:0,n),option:e.option?Object.assign(Object.assign({},e.option),{variants:this.convertBenefitOptionVariantsToDonationCurrency(null!==(o=null===(a=e.option)||void 0===a?void 0:a.variants)&&void 0!==o?o:[],n)}):void 0,eligibilityCriterias:e.eligibilityCriterias?Object.assign(Object.assign({},e.eligibilityCriterias),{[t]:Object.assign({},this.convertBenefitEligibilityCriteriaToDonationCurrency(r,n))}):void 0}):e}convertBenefitOptionVariantsToDonationCurrency(e,t){return e.map((e=>{var n;return Object.assign(Object.assign({},e),{fmv:this.convertAndCeilAmount(null!==(n=e.fmv)&&void 0!==n?n:0,t)})}))}convertBenefitEligibilityCriteriaToDonationCurrency(e,t){return Object.assign(Object.assign({},e),{minAmount:this.convertAndCeilAmount(e.minAmount,t)})}convertAndCeilAmount(e,t){if(this.checkoutConfiguration.campaign.config.defaultCurrency===t)return e;const n=this.currencyService.convert(e,this.checkoutConfiguration.campaign.config.defaultCurrency,t);return this.currencyService.ceil(n,t)}}class SR extends vT{constructor(e,t,n){super(e),this.dataPointRegistry=e,this.benefitsParamsService=t,this.tracker=n}synchronize(){const e=this.benefitsParamsService.getAvailableForCurrentFrequencyBenefits(),t=this.benefitsDataPointReadOnly.chosenBenefit;this.benefitsDataPointComputed.computed.setAvailableBenefits(e),this.benefitsParamsService.isChosenBenefitEligible()||this.benefitsDataPointComputed.computed.setChosenBenefitRemoved(!0);const n=this.benefitsDataPointReadOnly.chosenBenefit;t&&!n&&this.tracker.trackCheckoutCustomEvent({type:Ee.BENEFIT_RESET})}get benefitsDataPointReadOnly(){return this.dataPointRegistry.getDataPoint(tk.BENEFITS)}get benefitsDataPointComputed(){return this.dataPointRegistry.getDataPoint(tk.BENEFITS)}}const ER=[Ci.AUSTRIA,Ci.BELGIUM,Ci.BULGARIA,Ci.HUNGARY,Ci.GERMANY,Ci.GREECE,Ci.DENMARK,Ci.IRELAND,Ci.SPAIN,Ci.ITALY,Ci.CYPRUS,Ci.LATVIA,Ci.LITHUANIA,Ci.LUXEMBOURG,Ci.MALTA,Ci.NETHERLANDS,Ci.POLAND,Ci.PORTUGAL,Ci.ROMANIA,Ci.SLOVAKIA,Ci.SLOVENIA,Ci.FINLAND,Ci.FRANCE,Ci.CROATIA,Ci.CZECH_REPUBLIC,Ci.SWEDEN,Ci.ESTONIA,Ci.NORWAY,Ci.LIECHTENSTEIN,Ci.SWITZERLAND,Ci.UNITED_KINGDOM,Ci.BRAZIL,Ci.AUSTRALIA,Ci.INDIA,Ci.CANADA,Ci.ICELAND,Ci.SOUTH_KOREA],AR=[...ER,Ci.JAPAN,Ci.THAILAND,Ci.INDONESIA,Ci.HONG_KONG,Ci.TURKEY],CR=[{country:Ci.UNITED_STATES_OF_AMERICA,region:yr.US_COLORADO,regionCode:fr.US_COLORADO},{country:Ci.UNITED_STATES_OF_AMERICA,region:yr.US_OREGON,regionCode:fr.US_OREGON}];class bR{static isBasedOnGeoCountry(e){return AR.includes(e)}static isBasedOnGeoAndAddressRegion(e){let{geoCountry:t,geoRegion:n,addressCountry:i,addressRegionCode:s}=e;return CR.some((e=>{let{country:a,region:o,regionCode:r}=e;return a===t&&o===n||a===i&&r===s}))}}const PR=[...ER,Ci.JAPAN,Ci.THAILAND,Ci.INDONESIA,Ci.HONG_KONG,Ci.TURKEY],NR=[{country:Ci.UNITED_STATES_OF_AMERICA,region:yr.US_COLORADO,regionCode:fr.US_COLORADO},{country:Ci.UNITED_STATES_OF_AMERICA,region:yr.US_OREGON,regionCode:fr.US_OREGON}];class DR{static isBasedOnGeoCountry(e){return PR.includes(e)}static isBasedOnGeoAndAddressRegion(e){let{geoCountry:t,geoRegion:n}=e;return NR.some((e=>{let{country:i,region:s,regionCode:a}=e;return i===t&&s===n}))}}class TR extends vT{constructor(e,t){super(t),this.checkoutConfiguration=e,this.dataPointRegistry=t}synchronize(){this.checkoutConfiguration.infrastructureParams.showcase||(this.synchronizePhoneNumberConsent(),this.synchronizeMailingAddressConsent())}get communicationConsentDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.COMMUNICATION_CONSENT)}synchronizePhoneNumberConsent(){const e=this.dataPointRegistry.getDataPoint(Wl.PHONE_NUMBER).isFullPhoneNumberFilled;this.communicationConsentDataPoint.computed.setPhoneNumberConsentEnabled(e)}synchronizeMailingAddressConsent(){const e=this.dataPointRegistry.getDataPoint(Wl.MAILING_ADDRESS),t=e.isServerValidationRequired()&&!e.isSkipped;this.communicationConsentDataPoint.computed.setMailingAddressConsentEnabled(t),this.communicationConsentDataPoint.computed.setGDPRPolicy(this.getGDPRPolicy(e.countryCode,e.region))}getGDPRPolicy(e,t){return{customizedConsent:{basedOnGeoCountry:bR.isBasedOnGeoCountry(this.checkoutConfiguration.user.address.countryCode),basedOnGeoAndAddressRegion:bR.isBasedOnGeoAndAddressRegion({geoCountry:this.checkoutConfiguration.user.address.countryCode,geoRegion:this.checkoutConfiguration.user.address.region,addressCountry:e,addressRegionCode:t})},generalConsent:{basedOnGeoCountry:DR.isBasedOnGeoCountry(this.checkoutConfiguration.user.address.countryCode),basedOnGeoAndAddressRegion:DR.isBasedOnGeoAndAddressRegion({geoCountry:this.checkoutConfiguration.user.address.countryCode,geoRegion:this.checkoutConfiguration.user.address.region})}}}}class kR extends vT{constructor(e){super(e),this.dataPointRegistry=e}synchronize(){const e=tT(this.dataPointRegistry.getDataPoint(tk.DONATION).frequency);this.designationDataPoint.hasSelectedGoalWithRepeat(e)||this.designationDataPoint.setComputedGoalKeyByGoalRepeat(e)}get designationDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATION)}}class IR extends ET{get donationDataPoint(){return this.dataPointRegistry.getDataPoint(tk.DONATION)}}class _R extends CT{constructor(e,t){super(e,t),this.dataPointRegistry=e}}class OR{constructor(e,t){this.checkoutConfiguration=e,this.dataPointRegistry=t}isAvailable(){return this.checkConfiguration()&&this.checkOnBehalfOf()&&this.checkMultipleDonations()}checkConfiguration(){return this.checkoutConfiguration.campaign.config.showDouble}checkOnBehalfOf(){return!this.dataPointRegistry.getDataPoint(Wl.ON_BEHALF_OF).isOnBehalfOf}checkMultipleDonations(){return!this.dataPointRegistry.getDataPoint(tk.DONATION).isMultipleDonations}}class xR{constructor(e){this.dataPointRegistry=e}getDtdFrequency(){return this.dataPointRegistry.getDataPoint(tk.DONATION).frequency}getDtdCurrency(){return this.dataPointRegistry.getDataPoint(tk.DONATION).currency}getDtdInitialAmount(){return this.dataPointRegistry.getDataPoint(tk.DONATION).amount}}class wR extends vT{constructor(e,t,n){super(e),this.dataPointRegistry=e,this.doubleTheDonationAvailabilityService=t,this.doubleTheDonationParamsService=n}synchronize(){this.dtdDataPoint.computed.setAvailability(this.doubleTheDonationAvailabilityService.isAvailable()),this.dtdDataPoint.computed.setParams({dtdFrequency:this.doubleTheDonationParamsService.getDtdFrequency(),dtdCurrency:this.doubleTheDonationParamsService.getDtdCurrency(),dtdInitialAmount:this.doubleTheDonationParamsService.getDtdInitialAmount()})}get dtdDataPoint(){return this.dataPointRegistry.getDataPoint(tk.DTD)}}class RR{constructor(e,t,n){this.checkoutConfiguration=e,this.currencyService=t,this.dataPointRegistry=n}isAvailable(){return this.checkConfigurationCampaign()&&this.checkConfigurationFeatureConfig()&&this.checkOnBehalfOf()&&this.checkCurrency()&&this.checkBenefit()}checkConfigurationCampaign(){return this.checkoutConfiguration.campaign.config.giftAid.show}checkConfigurationFeatureConfig(){return this.checkoutConfiguration.featureConfig.giftAid}checkOnBehalfOf(){return!this.dataPointRegistry.getDataPoint(Wl.ON_BEHALF_OF).isOnBehalfOf}checkCurrency(){return"GBP"===this.dataPointRegistry.getDataPoint(tk.DONATION).currency}checkBenefit(){var e;const t=this.dataPointRegistry.getDataPoint(tk.BENEFITS).chosenBenefit;if(!t)return!0;const n=this.dataPointRegistry.getDataPoint(tk.DONATION);if(!n.amount)return!1;const i=n.amount;return!(this.currencyService.convert(null!==(e=t.fmv)&&void 0!==e?e:0,n.currency,"GBP")>this.calculateMaxAllowedFmv(i))}calculateMaxAllowedFmv(e){if(e<=1e4)return.25*e;const t=2500+.05*(e-1e4);return Math.min(t,25e4)}}class MR extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.giftAidAvailabilityService=t}synchronize(){this.giftAidDataPoint.computed.setAvailability(this.giftAidAvailabilityService.isAvailable())}get giftAidDataPoint(){return this.dataPointRegistry.getDataPoint(tk.GIFT_AID)}}class LR{constructor(e,t,n,i,s){this.checkoutConfiguration=e,this.currencyService=t,this.mailingAddressModule=n,this.paymentMethodAvailabilityManagerRepository=i,this.dataPointRegistry=s}isEnabled(){return this.mailingAddressModuleCheckoutScreenLogic.isEnabled(this.mailingAddressModuleCheckoutScreenAmount,this.mailingAddressModuleCheckoutScreenParams)}isRequired(){return this.mailingAddressModuleCheckoutScreenLogic.isRequired(this.mailingAddressModuleCheckoutScreenAmount,this.mailingAddressModuleCheckoutScreenParams)}get mailingAddressModuleCheckoutScreenLogic(){return this.mailingAddressModule.getCheckoutScreenLogic()}get mailingAddressModuleCheckoutScreenAmount(){const e=this.dataPointRegistry.getDataPoint(tk.DONATION),t=this.mailingAddressModule.getCurrencyLogic({widget:this.checkoutConfiguration.campaign.config});return this.currencyService.convert(this.donationAmount,e.currency,t.currency)}get mailingAddressModuleCheckoutScreenParams(){const e=this.dataPointRegistry.getDataPoint(tk.PAYMENT_OPTIONS),t=this.dataPointRegistry.getDataPoint(tk.GIFT_AID);return{showMailing:this.checkoutConfiguration.campaign.config.showMailing,showMailingFromAmount:this.checkoutConfiguration.campaign.config.showMailingFromAmount,mailingRequired:this.checkoutConfiguration.campaign.config.mailingRequired,mailingRequiredFromAmount:this.checkoutConfiguration.campaign.config.mailingRequiredFromAmount,paymentMethodAvailabilityManagerRepository:this.paymentMethodAvailabilityManagerRepository,paymentMethod:e.clientPaymentMethod,paymentMethodCountry:e.paymentMethodCountry,isGiftAidAccepted:t.isAccepted}}get donationAmount(){let e=0;return this.dataPointRegistry.getDataPoint(tk.DONATION).availableDonationItemsDto.forEach((t=>{t.amount&&t.amount>e&&(e=t.amount)})),e}}class FR extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.mailingAddressAvailabilityService=t}synchronize(){this.mailingAddressDataPoint.computed.setAvailability({isEnabled:this.mailingAddressAvailabilityService.isEnabled(),isRequired:this.mailingAddressAvailabilityService.isRequired()})}get mailingAddressDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.MAILING_ADDRESS)}}class UR{constructor(e,t,n){this.checkoutConfiguration=e,this.paymentMethodAvailabilityManagerRepository=t,this.dataPointRegistry=n}getAvailablePaymentOptions(){return{[Gn.PAYPAL]:this.checkPaypal(),[Gn.VENMO]:this.checkVenmo(),[Gn.CARD]:this.checkCard(),[Gn.APPLE_PAY]:this.checkApplePay(),[Gn.GOOGLE_PAY]:this.checkGooglePay(),[Gn.AU_BECS]:this.checkAuBecs(),[Gn.US_BANK_ACCOUNT]:this.checkUSBankAccount(),[Gn.UK_BACS]:this.checkUkBacs(),[Gn.SEPA]:this.checkSepa(),[Gn.ACSS]:this.checkAcss(),[Gn.IDEAL]:this.checkIDEAL(),[Gn.CRYPTO]:{available:!0,visible:!0}}}get donationDataPoint(){return this.dataPointRegistry.getDataPoint(tk.DONATION)}checkPaypal(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.PAYPAL,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.PAYPAL)&&this.checkoutConfiguration.company.paymentOptions.paypal&&e.allowed("currency",this.donationDataPoint.currency)&&this.checkoutConfiguration.company.paypalCurrencies.includes(this.donationDataPoint.currency);return{available:t,visible:t&&e.allowed("repeat",this.donationDataPoint.frequency)&&(this.donationDataPoint.frequency===qn.ONCE||this.checkoutConfiguration.company.paypal.subscriptionsEnabled)}}checkVenmo(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.VENMO,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.VENMO)&&this.checkoutConfiguration.infrastructureParams.livemode&&!this.checkoutConfiguration.infrastructureParams.showcase&&(this.checkoutConfiguration.user.address.countryCode===sn.UNITED_STATES||Bn())&&!!this.checkoutConfiguration.company.paypal.merchantId&&this.checkoutConfiguration.company.paymentOptions.venmo;return{available:t,visible:t&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)}}checkCard(){const e=this.isPaymentMethodAvailableByConfiguration(Gn.CARD)&&this.checkoutConfiguration.company.paymentOptions.creditCard;return{available:e,visible:e}}checkApplePay(){const e=this.isPaymentMethodAvailableByConfiguration(Gn.APPLE_PAY)&&this.checkoutConfiguration.company.paymentOptions.applePay;return{available:e,visible:e}}checkGooglePay(){const e=this.isPaymentMethodAvailableByConfiguration(Gn.GOOGLE_PAY)&&this.checkoutConfiguration.company.paymentOptions.googlePay&&!this.checkoutConfiguration.infrastructureParams.isInAppBrowser&&window.isSecureContext;return{available:e,visible:e}}checkAuBecs(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.AU_BECS,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.AU_BECS)&&this.checkoutConfiguration.company.paymentOptions.auBecsDebit&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)&&e.allowed("amount",this.donationDataPoint.total);return{available:t,visible:t}}checkUSBankAccount(){const e=function(e,t,n){if("USD"!==n)return t;const i=function(e){switch(e){case aS.ONE_FOR_ISRAEL:return 150;case aS.FCA:return 200;default:return null}}(e);return null===i?t:t<9500&&t>=i?9500:t}(this.checkoutConfiguration.company.key,this.donationDataPoint.total,this.donationDataPoint.currency),t=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.US_BANK_ACCOUNT,nn.WIDGET),n=t.allowed("amount",e)&&zI(this.checkoutConfiguration.company.stripe.usBankAccount.verification)?XI(e):t.allowed("amount",e),i=this.isPaymentMethodAvailableByConfiguration(Gn.US_BANK_ACCOUNT)&&this.checkoutConfiguration.company.paymentOptions.usBankAccount&&t.allowed("repeat",this.donationDataPoint.frequency)&&t.allowed("currency",this.donationDataPoint.currency)&&n&&"USD"===this.checkoutConfiguration.company.stripeCurrencies.default;return{available:i,visible:i}}checkUkBacs(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.UK_BACS,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.UK_BACS)&&this.checkoutConfiguration.company.paymentOptions.ukBacs&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)&&e.allowed("amount",this.donationDataPoint.total);return{available:t,visible:t}}checkSepa(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.SEPA,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.SEPA)&&this.checkoutConfiguration.company.paymentOptions.sepa&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)&&e.allowed("amount",this.donationDataPoint.total);return{available:t,visible:t}}checkAcss(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.ACSS,nn.WIDGET),t=this.isPaymentMethodAvailableByConfiguration(Gn.ACSS)&&this.checkoutConfiguration.company.paymentOptions.acss&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)&&e.allowed("amount",this.donationDataPoint.total);return{available:t,visible:t}}checkIDEAL(){const e=this.paymentMethodAvailabilityManagerRepository.getManager(Gn.IDEAL,nn.WIDGET),t=this.checkoutConfiguration.company.country===sn.NETHERLANDS||e.allowed("customerCountry",this.checkoutConfiguration.user.address.countryCode),n=this.isPaymentMethodAvailableByConfiguration(Gn.IDEAL)&&this.checkoutConfiguration.company.paymentOptions.ideal&&(this.donationDataPoint.frequency===qn.ONCE||this.checkoutConfiguration.company.paymentOptions.sepa)&&(t||Bn())&&e.allowed("repeat",this.donationDataPoint.frequency)&&e.allowed("currency",this.donationDataPoint.currency)&&e.allowed("amount",this.donationDataPoint.total);return{available:n,visible:n}}isPaymentMethodAvailableByConfiguration(e){return!this.checkoutConfiguration.paymentOptionsSettings.disabledPaymentMethods.includes(e)}}class jR extends vT{constructor(e,t){super(e),this.dataPointRegistry=e,this.paymentOptionsParamsService=t}synchronize(){const e=this.paymentOptionsParamsService.getAvailablePaymentOptions();this.paymentOptionsDataPoint.computed.setAllowedPaymentMethods(e)}get paymentOptionsDataPoint(){return this.dataPointRegistry.getDataPoint(tk.PAYMENT_OPTIONS)}}const BR=[sn.INDIA];class GR{constructor(e,t){this.checkoutConfiguration=e,this.dataPointRegistry=t}isAvailable(){return this.checkoutConfiguration.infrastructureParams.showcase?this.checkConfiguration():this.checkConfiguration()&&this.checkDonation()&&this.checkDesignations()&&this.checkTribute()&&this.checkPaymentOptions()}checkConfiguration(){return this.checkoutConfiguration.campaign.config.showPostDonationUpsell}checkDonation(){return this.dataPointRegistry.getDataPoint(tk.DONATION).frequency===qn.ONCE}checkDesignations(){const e=this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS);return 0===e.selectedGoals.length||1===e.selectedGoals.length&&e.selectedGoals[0].repeat!==js.ONE_TIME}checkTribute(){return!this.dataPointRegistry.getDataPoint(Wl.TRIBUTE).tributeeName}checkPaymentOptions(){switch(this.dataPointRegistry.getDataPoint(tk.PAYMENT_OPTIONS).clientPaymentMethod){case Gn.PAYPAL:return this.checkoutConfiguration.company.paypal.subscriptionsEnabled;case Gn.VENMO:case Gn.IDEAL:return!1;case Gn.CARD:return this.checkPaymentMethodCountry();default:return!0}}checkPaymentMethodCountry(){const e=this.dataPointRegistry.getDataPoint(tk.PAYMENT_OPTIONS);return null===e.paymentMethodCountry||!BR.includes(e.paymentMethodCountry)}}class qR{constructor(e,t,n){this.checkoutConfiguration=e,this.suggestionsService=t,this.dataPointRegistry=n,this.timestamp=Date.now()}getUpsellStartDate(){return function(e,t){const n=new Date(e),i=n.getDate();return n.setMonth(n.getMonth()+1),n.getDate()!==i&&n.setDate(0),n.toISOString()}(this.timestamp)}getUpsellFrequency(){return qn.MONTHLY}getUpsellCurrency(){return this.dataPointRegistry.getDataPoint(tk.DONATION).currency}getUpsellMinAmount(){return this.dataPointRegistry.getDataPoint(tk.DONATION).getFrequencyMinimalAmount(this.checkoutConfiguration.highestFrequency)}getUpsellAmount(){var e,t;const n=this.dataPointRegistry.getDataPoint(tk.DONATION),i=null!==(e=n.amount)&&void 0!==e?e:0,s=null!==(t=n.amountInUSD)&&void 0!==t?t:0;return Math.max(this.suggestionsService.beautify(i*this.getUpsellSuggestedAmountPercent(s),this.getUpsellCurrency()),this.getUpsellMinAmount())}getUpsellSuggestedAmountPercent(e){switch(!0){case e>1e5:return.1;case e>=5e4:return.15;default:return.2}}}class VR extends vT{constructor(e,t,n){super(e),this.dataPointRegistry=e,this.postDonationUpsellAvailabilityService=t,this.postDonationUpsellParamsService=n}synchronize(){this.postDonationUpsellDataPoint.computed.setAvailability(this.postDonationUpsellAvailabilityService.isAvailable()),this.postDonationUpsellDataPoint.computed.setParams({upsellStartDate:this.postDonationUpsellParamsService.getUpsellStartDate(),upsellFrequency:this.postDonationUpsellParamsService.getUpsellFrequency(),upsellCurrency:this.postDonationUpsellParamsService.getUpsellCurrency(),upsellMinAmount:this.postDonationUpsellParamsService.getUpsellMinAmount(),upsellAmount:this.postDonationUpsellParamsService.getUpsellAmount()})}get postDonationUpsellDataPoint(){return this.dataPointRegistry.getDataPoint(tk.POST_DONATION_UPSELL)}}const HR={[sn.UNITED_STATES]:4e3,[sn.CANADA]:3500,[sn.UNITED_KINGDOM]:2500,[sn.AUSTRALIA]:2500},KR=[sn.UNITED_STATES,sn.UNITED_KINGDOM,sn.AUSTRIA,sn.BELGIUM,sn.BULGARIA,sn.CROATIA,sn.CYPRUS,sn.CZECH_REPUBLIC,sn.DENMARK,sn.ESTONIA,sn.FINLAND,sn.FRANCE,sn.GERMANY,sn.GREECE,sn.HUNGARY,sn.IRELAND,sn.ITALY,sn.LATVIA,sn.LITHUANIA,sn.LUXEMBOURG,sn.MALTA,sn.NETHERLANDS,sn.POLAND,sn.PORTUGAL,sn.ROMANIA,sn.SLOVAKIA,sn.SLOVENIA,sn.SPAIN,sn.SWEDEN];class YR{constructor(e,t,n){this.checkoutConfiguration=e,this.currencyService=t,this.dataPointRegistry=n}isAvailable(e,t){switch(e){case qn.ANNUAL:return this.isAnnualUpsellAvailable(t);case qn.EVERY_4_WEEKS:return this.isEvery4WeeksUpsellAvailable(t);case qn.MONTHLY:return this.isMonthlyUpsellAvailable(t);case qn.QUARTERLY:return this.isQuarterlyUpsellAvailable();default:throw new Error(`Unsupported target frequency: ${e}`)}}isAnnualUpsellAvailable(e){return this.checkConfigurationCampaignEnabledFrequencies()&&this.checkConfigurationCampaignRecurringFrequency()&&this.checkConfigurationCompanyRecurringPlan(qn.ANNUAL)&&this.checkDesignations()&&this.checkTribute()&&this.checkDonationFrequency()&&this.checkBenefitEligibilityCriterias(qn.ANNUAL,e)}isEvery4WeeksUpsellAvailable(e){return this.checkConfigurationCampaignUpsell()&&this.checkConfigurationCampaignEnabledFrequencies()&&this.checkConfigurationCampaignRecurringFrequency()&&this.checkConfigurationCompanyRecurringPlan(qn.EVERY_4_WEEKS)&&this.checkConfigurationUserCountryCode(KR)&&this.checkDesignations()&&!this.checkTribute()&&this.checkDonationFrequency()&&this.checkDonationCurrency()&&this.checkDonationAmount(qn.EVERY_4_WEEKS)&&this.checkBenefitEligibilityCriterias(qn.EVERY_4_WEEKS,e)}isMonthlyUpsellAvailable(e){return!!this.checkoutConfiguration.infrastructureParams.showcase||this.checkConfigurationCampaignUpsell()&&this.checkConfigurationCampaignEnabledFrequencies()&&this.checkConfigurationCampaignRecurringFrequency()&&this.checkDesignations()&&!this.checkTribute()&&this.checkDonationFrequency()&&this.checkDonationCurrency()&&this.checkDonationAmount(qn.MONTHLY)&&this.checkBenefitEligibilityCriterias(qn.MONTHLY,e)}isQuarterlyUpsellAvailable(){return this.checkConfigurationCampaignUpsell()&&this.checkConfigurationCampaignEnabledFrequencies()&&this.checkConfigurationCampaignRecurringFrequency()&&this.checkConfigurationCompanyRecurringPlan(qn.QUARTERLY)&&this.checkAssignedDesignationsForQuarterlyUpsell()&&!this.checkTribute()&&this.checkDonationFrequencyForQuarterlyUpsell()&&this.checkDonationCurrency()&&this.checkDonationAmount(qn.QUARTERLY)}checkConfigurationCampaignUpsell(){return this.checkoutConfiguration.campaign.config.showUpsell}checkConfigurationCampaignEnabledFrequencies(){return this.checkoutConfiguration.enabledFrequencies.every((e=>this.checkoutConfiguration.preDonationUpsellSettings.enabledForDonationFrequencies.includes(e)))}checkConfigurationCampaignRecurringFrequency(){return this.checkoutConfiguration.enabledFrequencies.some((e=>e!==qn.ONCE))}checkConfigurationCompanyRecurringPlan(e){return this.checkoutConfiguration.company.recurringPlans[e]}checkConfigurationUserCountryCode(e){return e.includes(this.checkoutConfiguration.user.address.countryCode)}checkDesignations(){const e=this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS);return 0===e.selectedGoals.length||1===e.selectedGoals.length&&e.selectedGoals[0].repeat!==js.ONE_TIME}checkAssignedDesignationsForQuarterlyUpsell(){const e=this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS);return 0===e.selectedGoals.length||!e.selectedGoals.find((e=>e.frequency===qn.MONTHLY))}checkTribute(){return this.dataPointRegistry.getDataPoint(Wl.TRIBUTE).isFilled}checkDonationFrequency(){return this.dataPointRegistry.getDataPoint(tk.DONATION).frequency===qn.ONCE}checkDonationCurrency(){const e=this.dataPointRegistry.getDataPoint(tk.DONATION);return this.checkoutConfiguration.campaign.config.currencyEnabledRecurrings||e.currency===this.checkoutConfiguration.campaign.config.defaultCurrency}checkDonationAmount(e){var t;const n=this.dataPointRegistry.getDataPoint(tk.DONATION),i=null!==(t=n.amount)&&void 0!==t?t:0,s=n.currency;let a,o;switch(e){case qn.EVERY_4_WEEKS:a=Math.max(n.getFrequencyMinimalAmount(e),this.currencyService.convert(7e3,"USD",s)),o=this.currencyService.convert(2e4,"USD",s);break;case qn.MONTHLY:a=n.getFrequencyMinimalAmount(e),o=this.currencyService.convert(2e4,"USD",s);break;case qn.QUARTERLY:{a=n.getFrequencyMinimalAmount(e);const t=this.checkoutConfiguration.user.address.countryCode,i=HR[t]||2500;o=this.currencyService.convert(i,"USD",s);break}default:throw new Error(`Unsupported target frequency: ${e}`)}return i>=a&&i<=o}checkDonationFrequencyForQuarterlyUpsell(){return this.dataPointRegistry.getDataPoint(tk.DONATION).frequency===qn.MONTHLY}checkBenefitEligibilityCriterias(e,t){var n;const i=this.dataPointRegistry.getDataPoint(tk.BENEFITS);if(!i.chosenBenefit)return!0;const s=i.chosenBenefit.eligibilityCriterias;if(void 0!==(null==s?void 0:s[qn.ONCE])&&1===Object.keys(s).length)return!1;const a=null==s?void 0:s[e];return!(null==a?void 0:a.minAmount)||(null!==(n=null==t?void 0:t.low)&&void 0!==n?n:0)>=a.minAmount}}class zR{constructor(e,t,n,i){this.checkoutConfiguration=e,this.currencyService=t,this.suggestionsService=n,this.dataPointRegistry=i}getUpsellCurrency(){return this.dataPointRegistry.getDataPoint(tk.DONATION).currency}getUpsellAmounts(e){switch(e){case qn.ANNUAL:return this.getAnnualAmounts();case qn.EVERY_4_WEEKS:case qn.MONTHLY:return this.getEvery4WeeksAndMonthlyAmounts(e);case qn.QUARTERLY:return this.getQuarterlyAmounts();default:throw new Error(`Unsupported target frequency: ${e}`)}}getAnnualAmounts(){const e=this.dataPointRegistry.getDataPoint(tk.DONATION).amount;return{high:e,low:null,initial:e}}getEvery4WeeksAndMonthlyAmounts(e){const t=this.dataPointRegistry.getDataPoint(tk.DONATION).amount,[n,i]=this.calculateEvery4WeeksAndMonthlyAmountsInUsd(),[s,a]=this.adjustEvery4WeeksAndMonthlyAmounts(e,n,i);return{high:a,low:s,initial:t}}getQuarterlyAmounts(){const e=this.dataPointRegistry.getDataPoint(tk.DONATION).amount,[t,n]=this.calculateQuarterlyAmounts(e);return{high:n,low:t,initial:e}}calculateQuarterlyAmounts(e){if(!e)return[null,null];const t=this.getUpsellCurrency(),n=this.currencyService.ceil(3*e,t);return[this.currencyService.ceil(3*e*.95,t),n]}calculateEvery4WeeksAndMonthlyAmountsInUsd(){var e;const t=null!==(e=this.dataPointRegistry.getDataPoint(tk.DONATION).amountInUSD)&&void 0!==e?e:0,n=this.checkoutConfiguration.preDonationUpsellSettings.amountsMap;switch(!0){case t<=1e3:return[null,t];case t<=2500:return n[ya.UP_TO_25];case t<=3500:return n[ya.UP_TO_35];case t<=5500:return n[ya.UP_TO_55];case t<=1e4:return n[ya.UP_TO_100];case t<=15e3:return n[ya.UP_TO_150];case t<=2e4:return n[ya.UP_TO_200];default:return[null,t]}}adjustEvery4WeeksAndMonthlyAmounts(e,t,n){const i=this.dataPointRegistry.getDataPoint(tk.DONATION),s=this.getUpsellCurrency(),a=i.getFrequencyMinimalAmount(e);let o=null,r=null;return null!==n&&(o=this.suggestionsService.beautify(this.currencyService.convert(n,"USD",s),s),o<a&&(o=a)),null!==t&&(r=this.suggestionsService.beautify(this.currencyService.convert(t,"USD",s),s),(r<a||r===o)&&(r=null)),[r,o]}}class WR extends vT{constructor(e,t,n,i){super(t),this.checkoutConfiguration=e,this.dataPointRegistry=t,this.preDonationUpsellAvailabilityService=n,this.preDonationUpsellParamsService=i}synchronize(){const e=this.checkoutConfiguration.preDonationUpsellSettings.enabledTargetFrequencies.find((e=>this.preDonationUpsellAvailabilityService.isAvailable(e,this.preDonationUpsellParamsService.getUpsellAmounts(e))));if(this.preDonationUpsellDataPoint.computed.setAvailability(!!e),e){const t=this.preDonationUpsellParamsService.getUpsellAmounts(e);this.preDonationUpsellDataPoint.computed.setParams({upsellFrequency:e,upsellCurrency:this.preDonationUpsellParamsService.getUpsellCurrency(),upsellHighAmount:t.high,upsellLowAmount:t.low,upsellInitialAmount:t.initial})}}get preDonationUpsellDataPoint(){return this.dataPointRegistry.getDataPoint(tk.PRE_DONATION_UPSELL)}}class $R extends DT{isAvailable(){return!this.isMultipleDonations&&super.isAvailable()}get isMultipleDonations(){return this.dataPointRegistry.getDataPoint(tk.DONATION).isMultipleDonations}}class XR extends kT{}class QR extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.BENEFITS)}setChosenBenefit(e){this.perform((()=>{this.dataPoint.setChosenBenefit(e)}))}removeChosenBenefit(){this.perform((()=>{this.dataPoint.removeChosenBenefit()}))}setOptionVariant(e,t){this.perform((()=>{this.dataPoint.setOptionVariant(e,t)}))}setDeliveryShown(e){this.perform((()=>{this.dataPoint.setDeliveryShown(e)}))}setDeliveryUsed(e){this.perform((()=>{this.dataPoint.setDeliveryUsed(e)}))}setFirstName(e){this.perform((()=>{this.dataPoint.setFirstName(e)}))}setFirstNameIfEmpty(e){this.perform((()=>{this.dataPoint.setFirstNameIfEmpty(e)}))}setLastName(e){this.perform((()=>{this.dataPoint.setLastName(e)}))}setLastNameIfEmpty(e){this.perform((()=>{this.dataPoint.setLastNameIfEmpty(e)}))}setFullName(e){this.perform((()=>{this.dataPoint.setFullName(e)}))}setFullNameIfEmpty(e){this.perform((()=>{this.dataPoint.setFullNameIfEmpty(e)}))}setLine1(e){this.perform((()=>{this.dataPoint.setLine1(e)}))}setLine1IfEmpty(e){this.perform((()=>{this.dataPoint.setLine1IfEmpty(e)}))}setLine2(e){this.perform((()=>{this.dataPoint.setLine2(e)}))}setLine2IfEmpty(e){this.perform((()=>{this.dataPoint.setLine2IfEmpty(e)}))}setCity(e){this.perform((()=>{this.dataPoint.setCity(e)}))}setCityIfEmpty(e){this.perform((()=>{this.dataPoint.setCityIfEmpty(e)}))}setRegion(e){this.perform((()=>{this.dataPoint.setRegion(e)}))}setRegionIfEmpty(e){this.perform((()=>{this.dataPoint.setRegionIfEmpty(e)}))}setPostal(e){this.perform((()=>{this.dataPoint.setPostal(e)}))}setPostalIfEmpty(e){this.perform((()=>{this.dataPoint.setPostalIfEmpty(e)}))}setCountryCode(e){this.perform((()=>{this.dataPoint.setCountryCode(e)}))}setCountryCodeIfEmptyAddress(e){this.perform((()=>{this.dataPoint.setCountryCodeIfEmptyAddress(e)}))}setSublocality(e){this.perform((()=>{this.dataPoint.setSublocality(e)}))}setSublocalityIfEmpty(e){this.perform((()=>{this.dataPoint.setSublocalityIfEmpty(e)}))}setAdministrativeArea(e){this.perform((()=>{this.dataPoint.setAdministrativeArea(e)}))}setAdministrativeAreaIfEmpty(e){this.perform((()=>{this.dataPoint.setAdministrativeAreaIfEmpty(e)}))}resetDeliveryAddress(){this.perform((()=>{this.dataPoint.removeDeliveryAddress()}))}triggerSynchronization(){this.checkoutStateSynchronizer.onBenefitsChange()}}class ZR extends xT{triggerSynchronization(){}}class JR extends RT{triggerSynchronization(){}}class eM extends FT{get donationDataPoint(){return this.dataPointRegistry.getDataPoint(tk.DONATION)}triggerSynchronization(){this.checkoutStateSynchronizer.onDesignationChange()}}class tM extends jT{triggerSynchronization(){this.checkoutStateSynchronizer.onDesignationsChange()}}class nM extends GT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.DONATION)}setDonationsFrequency(e){this.perform((()=>{this.dataPoint.setDonationsFrequency(e)})),this.perform((()=>{this.dataPoint.setDonationItemsAvailability(this.donationItemsAvailability)}))}setCurrency(e){this.perform((()=>{this.dataPoint.setCurrency(e)}))}setDonationsAmount(e){this.perform((()=>{this.dataPoint.setDonationsAmount(e)}))}setDonationsAmountHint(e){this.perform((()=>{this.dataPoint.setDonationsAmountHint(e)}))}setFeeCovered(e,t){this.perform((()=>{this.dataPoint.setFeeCovered(e,t)}))}setFeeCoverageLevel(e,t){this.perform((()=>{this.dataPoint.setFeeCoverageLevel(e,t)}))}setDonationsEndDateActive(e){this.perform((()=>{this.dataPoint.setDonationsEndDateActive(e)}))}setDefaultAmountsApplied(){this.perform((()=>{this.dataPoint.setDefaultAmountsApplied()}))}setFrequencyDefaultAmount(e,t){this.perform((()=>{this.dataPoint.setFrequencyDefaultAmount(e,t)}))}setFrequencyAmountSuggestions(e,t,n,i){this.perform((()=>{this.dataPoint.setFrequencyAmountSuggestions(e,t,n,i)}))}setFrequencyAmountHint(e,t){this.perform((()=>{this.dataPoint.setFrequencyAmountHint(e,t)}))}setFrequencyAmountHints(e,t,n){this.perform((()=>{this.dataPoint.setFrequencyAmountHints(e,t,n)}))}setDonationAmount(e,t){this.perform((()=>{this.dataPoint.setDonationAmount(e,t)}))}addDonation(){this.perform((()=>{this.dataPoint.addDonation()}))}removeDonation(e){this.perform((()=>{this.dataPoint.removeDonation(e)})),this.perform((()=>{this.dataPoint.setDonationItemsAvailability(this.donationItemsAvailability)}))}setCurrentDistributionWeights(){this.perform((()=>{this.dataPoint.setCurrentDistributionWeights()}))}triggerSynchronization(){this.checkoutStateSynchronizer.onDonationChange()}get designationsDataPoint(){return this.dataPointRegistry.getDataPoint(Wl.DESIGNATIONS)}get donationItemsAvailability(){return new Map(this.designationsDataPoint.selectedGoalsAvailability.map(((e,t)=>[this.dataPoint.donationItemsDto[t].id,e.isAvailable])))}}class iM extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.DTD)}setEmployerName(e){this.perform((()=>{this.dataPoint.setEmployerName(e)}))}setEmployerData(e){this.perform((()=>{this.dataPoint.setEmployerData(e)}))}resetEmployerData(){this.perform((()=>{this.dataPoint.removeEmployerData()}))}setUpsellShowed(e){this.perform((()=>{this.dataPoint.setUpsellShowed(e)}))}setUpsellAccepted(){this.perform((()=>{this.dataPoint.setUpsellAccepted()}))}setSkipped(){this.perform((()=>{this.dataPoint.setSkipped()}))}resetState(){this.perform((()=>{this.dataPoint.removeState()}))}triggerSynchronization(){}}class sM extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.GIFT_AID)}setShowed(){this.perform((()=>{this.dataPoint.setShowed()}))}accept(){this.perform((()=>{this.dataPoint.setAccepted(!0)}))}reject(){this.perform((()=>{this.dataPoint.setAccepted(!1)}))}triggerSynchronization(){this.checkoutStateSynchronizer.onGiftAidChange()}}class aM extends VT{triggerSynchronization(){this.checkoutStateSynchronizer.onMailingAddressChange()}}class oM extends OT{get paymentOptionsDataPoint(){return this.dataPointRegistry.getDataPoint(tk.PAYMENT_OPTIONS)}get ukBacsDataPoint(){return this.dataPointRegistry.getDataPoint(tk.UK_BACS)}get usBankAccountDataPoint(){return this.dataPointRegistry.getDataPoint(tk.US_BANK_ACCOUNT)}setPaymentMethod(e){this.perform((()=>{this.paymentOptionsDataPoint.setPaymentMethod(e)}))}setPaymentOption(e){this.perform((()=>{this.paymentOptionsDataPoint.setPaymentOption(e)}))}setPreSelectedPaymentOption(e){this.perform((()=>{this.paymentOptionsDataPoint.setPreSelectedPaymentOption(e)}))}setPreSelectedFastTrackPaymentOption(e){this.perform((()=>{this.paymentOptionsDataPoint.setPreSelectedFastTrackPaymentOption(e)}))}setPaymentMethodCountry(e){this.perform((()=>{this.paymentOptionsDataPoint.setPaymentMethodCountry(e)}))}setPaymentMethodChecked(e){this.perform((()=>{this.paymentOptionsDataPoint.setPaymentMethodChecked(e)}))}setUkBacsSortCode(e){this.perform((()=>{this.ukBacsDataPoint.setSortCode(e)}))}setUkBacsAccountNumber(e){this.perform((()=>{this.ukBacsDataPoint.setAccountNumber(e)}))}setUkBacsAccountHolderName(e){this.perform((()=>{this.ukBacsDataPoint.setAccountHolderName(e)}))}setUkBacsTermsAccepted(e){this.perform((()=>{this.ukBacsDataPoint.setTermsAccepted(e)}))}setUsBankAccountRoutingNumber(e){this.perform((()=>{this.usBankAccountDataPoint.setRoutingNumber(e)}))}setUsBankAccountNumber(e){this.perform((()=>{this.usBankAccountDataPoint.setAccountNumber(e)}))}setUsBankAccountHolderName(e){this.perform((()=>{this.usBankAccountDataPoint.setAccountHolderName(e)}))}setUsBankAccountVerificationType(e){this.perform((()=>{this.usBankAccountDataPoint.setVerificationType(e)}))}setUsBankAccountFinancialInstitution(e){this.perform((()=>{this.usBankAccountDataPoint.setFinancialInstitution(e)}))}setUsBankAccountType(e){this.perform((()=>{this.usBankAccountDataPoint.setAccountType(e)}))}setFastTrackFlow(e){this.perform((()=>{this.paymentOptionsDataPoint.setFastTrackFlow(e)}))}triggerSynchronization(){this.checkoutStateSynchronizer.onPaymentOptionsChange()}}class rM extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.POST_DONATION_UPSELL)}setUpsellCustomAmount(e){this.perform((()=>{this.dataPoint.setUpsellCustomAmount(e)}))}setShowed(){this.perform((()=>{this.dataPoint.setShowed()}))}setAccepted(){this.perform((()=>{this.dataPoint.setAccepted()}))}triggerSynchronization(){}}class lM extends OT{get dataPoint(){return this.dataPointRegistry.getDataPoint(tk.PRE_DONATION_UPSELL)}setShowed(){this.perform((()=>{this.dataPoint.setShowed()}))}confirm(e){this.perform((()=>{e?this.dataPoint.setAccepted():this.dataPoint.setRejected()}))}setSuggestedAvailability(e){this.perform((()=>{this.dataPoint.setSuggestedAvailability(e)}))}resetSuggestedAvailability(){this.perform((()=>{this.dataPoint.removeSuggestedAvailability()}))}setSuggestedAmounts(e,t){this.perform((()=>{this.dataPoint.setSuggestedAmounts(e,t)}))}resetSuggestedAmounts(){this.perform((()=>{this.dataPoint.removeSuggestedAmounts()}))}triggerSynchronization(){}}class cM extends KT{triggerSynchronization(){this.checkoutStateSynchronizer.onPrivacyChange()}}class uM extends zT{triggerSynchronization(){}}class dM extends $T{triggerSynchronization(){}}class hM extends QT{triggerSynchronization(){}}class mM extends JT{triggerSynchronization(){this.checkoutStateSynchronizer.onTributeChange()}}function pM(e){if(!e.isSkipped&&e.employerName)return{name:e.employerName}}function gM(e){if(!e.isSkipped&&e.employerId)return{id:e.employerId,company_name:e.employerName,minimumMatchedAmount:e.employerRawMinAmount,ratio:e.employerRatio}}function yM(e){var t;return{currency:e.snapshot.dtdCurrency,fromAmount:e.snapshot.dtdInitialTotal,initialAmount:null!==(t=e.snapshot.dtdInitialAmount)&&void 0!==t?t:0,matchingFromAmount:e.snapshot.employerMinAmount,matchingPromisedAmount:e.snapshot.employerUpsellTotalDoubled,matchingRatio:e.snapshot.employerRatio,minimumMatchedAmount:e.snapshot.employerMinAmount,proposedAmount:e.snapshot.employerUpsellTotal,proposedAmountBeforeFeeCovered:e.snapshot.employerRawMinAmount,visible:!!e.employerMinAmount,showed:e.isUpsellShowed,used:e.isUpsellAccepted}}const fM=(e,t,n)=>e&&t?n?Ts.OPTED_IN:Ts.OPTED_OUT:Ts.NOT_SUBMITTED,vM=e=>{const{type:t,customizedConsent:n,generalConsent:i,isCustomizedConsentShown:s,isGeneralConsentShown:a}=e;return t===bs.GENERAL?{type:Ns.GENERAL,general:fM(a,!0,i.isAccepted),customized:{email:Ts.NOT_SUBMITTED,phoneCalls:Ts.NOT_SUBMITTED,postalMail:Ts.NOT_SUBMITTED,sms:Ts.NOT_SUBMITTED,socialMedia:Ts.NOT_SUBMITTED}}:t===bs.CUSTOMIZED?{type:Ns.CUSTOMIZED,general:Ts.NOT_SUBMITTED,customized:{email:fM(s,n.email.isEnabled,n.email.isAccepted),phoneCalls:fM(s,n.phoneCalls.isEnabled,n.phoneCalls.isAccepted),postalMail:fM(s,n.postalMail.isEnabled,n.postalMail.isAccepted),sms:fM(s,n.sms.isEnabled,n.sms.isAccepted),socialMedia:fM(s,n.socialMedia.isEnabled,n.socialMedia.isAccepted)}}:{type:Ns.GENERAL,general:Ts.NOT_SUBMITTED,customized:{email:Ts.NOT_SUBMITTED,phoneCalls:Ts.NOT_SUBMITTED,postalMail:Ts.NOT_SUBMITTED,sms:Ts.NOT_SUBMITTED,socialMedia:Ts.NOT_SUBMITTED}}};function SM(e){const t=e.chosenBenefit,n=t?e.benefits.find((e=>e.key===t.key)):null;return{showed:e.isEnabled,data:n?Object.assign(Object.assign({},Vs()(n,["chosen","active","delivery","chosenOptionVariant","isAvailableOnlyInOneFrequency","previewImage"])),{code:n.code||null,description:n.description||null,image:EM(n),option:n.option?{name:n.option.name,variant:AM(n)}:null,localization:(i=n,{defaultLocale:i.localization.defaultLocale,fields:CM(i)})}):null};var i}function EM(e){var t;const n=e.chosenOptionVariant,i=null!==(t=null==n?void 0:n.image)&&void 0!==t?t:e.image;return i?Vs()(i,["previewUrl","previewUrlRetina","alt"]):null}function AM(e){const t=e.chosenOptionVariant;return t?{publicId:t.publicId,value:t.value,fmv:t.fmv,code:t.code||null}:null}function CM(e){const t=e.chosenOptionVariant;return e.localization.fields.map((e=>{var n,i;return Object.assign(Object.assign({},e),{description:e.description||null,delivery:e.delivery||null,option:e.option&&t?{name:e.option.name,variant:{value:null!==(i=null===(n=t.localization.fields.find((t=>t.lang===e.lang)))||void 0===n?void 0:n.value)&&void 0!==i?i:""}}:null})}))}function bM(e){const t=e.frequency;return{defaultAmount:e.getFrequencyDefaultAmount(t)||0,frequencyAmountOptions:e.getFrequencyAmountSuggestions(t),amountOptions:e.allAmountSuggestions,frequency:t,currency:e.currency,defaultAmounts:e.allDefaultAmounts}}class PM extends nO{updateSession(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n,i,s,a,o,r,l;if(this.checkoutConfiguration.infrastructureParams.showcase)return wn.success({});const c=this.donationDataPoint.frequency,u=function(e,t){if((null==t?void 0:t.canUseAmountDefaults)&&!e.amount){const t=e.frequency,n=e.getFrequencyDefaultAmount(t),i=e.getFrequencyDefaultTotal(t),s=e.getFrequencyMinimalAmount(t),a=e.getFrequencyMinimalTotal(t);return n?{amount:n,total:i}:{amount:s,total:a}}return{amount:e.amount||0,total:e.total}}(this.donationDataPoint,e),d=this.commentDataPoint.getDTO(),h=this.tributeDataPoint.getDTO(),m=this.postDonationUpsellDataPoint.getDTO(),p=this.questionsDataPoint.getDTO(),g=this.donorNameDataPoint.getDTO(),y=this.donorEmailDataPoint.getValidOrEmptyEmail(),f=this.preDonationUpsellDataPoint,v=this.donateAnonymousDataPoint.getDTO(),S=this.phoneNumberDataPoint.getDTO(),E=this.termsAndConditionsDataPoint.getDTO(),A=this.onBehalfOfDataPoint.getDTO(),C=this.customerTitleDataPoint.getDTO(),b=this.communicationConsentDataPoint.getDTO(),P=this.benefitsDataPoint.getDTO();return this.sessionAPI.update({donationType:$n.MONEY,comment:d.isActive?d.comment:"",tribute:h.inHonorOf&&h.isActive?{labelType:h.labelType,type:h.type,inHonorOf:h.inHonorOf}:null,questions:p.questions,customer:{firstName:g.firstName,lastName:g.lastName,title:C.title,email:y,phone:S.phone,onBehalfOf:A.companyName,anonymousChecked:v.isAnonymousChecked,termsChecked:E.isAccepted,consent:vM(b)},donation:{amount:u.amount,total:u.total,publicFee:this.donationDataPoint.processingFee,currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency,goalKey:null!==(n=null===(t=this.availableSelectedGoals[0])||void 0===t?void 0:t.id)&&void 0!==n?n:null,goalName:null!==(s=null===(i=this.availableSelectedGoals[0])||void 0===i?void 0:i.name)&&void 0!==s?s:null,giftAid:{shown:this.giftAidDataPoint.isShowed,claimed:this.giftAidDataPoint.isAccepted},upsell:{currency:f.upsellShowedFromCurrency,fromAmount:null!==(a=f.upsellShowedFromAmount)&&void 0!==a?a:0,showed:f.isShowed,used:f.isAccepted},employerUpsell:yM(this.dtdDataPoint),feeCoveringSuggestion:this.donationDataPoint.feeCoveringSuggestion,hintsVariantName:this.donationDataPoint.amountHint?G_.RANDOM:G_.NONE,hintDescription:(null===(o=this.donationDataPoint.amountHint)||void 0===o?void 0:o.description)||"",_suggestedAmountHint:(null===(r=this.donationDataPoint.amountHint)||void 0===r?void 0:r.id)||null,limit:this.getLimitField(c),currencyRatesId:null!==(l=this.checkoutConfiguration.currencySettings.ratesId)&&void 0!==l?l:null,donationItems:this.getDonationItems()},employer:pM(this.dtdDataPoint),employerDTD:gM(this.dtdDataPoint),postDonationUpsell:{period:m.upsellFrequency,firstChargeAt:m.upsellStartDate,fromAmount:u.amount,showed:m.isShowed,currency:m.upsellCurrency,recurringAmount:m.upsellAmount,recurringTip:m.upsellTip,recurringTotal:m.upsellTotal,used:m.isAccepted},checkoutDefaults:bM(this.donationDataPoint),screenHistory:this.getScreenHistory(null==e?void 0:e.shouldSaveScreenHistory),marketingCookieConsent:this.sessionConsent,benefit:SM(P)})}))}updateSessionWidgetDefaults(){this.sessionAPI.updateSessionWidgetDefaults(this.donationDataPoint.amount||0,bM(this.donationDataPoint))}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}get phoneNumberDataPoint(){return this.checkoutState.privacy.phoneNumberDataPoint}get customerTitleDataPoint(){return this.checkoutState.privacy.customerTitleDataPoint}get termsAndConditionsDataPoint(){return this.checkoutState.privacy.termsAndConditionsDataPoint}get onBehalfOfDataPoint(){return this.checkoutState.privacy.onBehalfOfDataPoint}get donateAnonymousDataPoint(){return this.checkoutState.privacy.donateAnonymousDataPoint}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get giftAidDataPoint(){return this.checkoutState.giftAid.dataPoint}get dtdDataPoint(){return this.checkoutState.doubleTheDonation.dataPoint}get postDonationUpsellDataPoint(){return this.checkoutState.postDonationUpsell.dataPoint}get questionsDataPoint(){return this.checkoutState.questions.dataPoint}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}get communicationConsentDataPoint(){return this.checkoutState.communicationConsent.dataPoint}get preDonationUpsellDataPoint(){return this.checkoutState.preDonationUpsell.dataPoint}get benefitsDataPoint(){return this.checkoutState.benefits.dataPoint}get availableSelectedGoals(){return this.designationsDataPoint.selectedGoals.filter(((e,t)=>this.designationsDataPoint.selectedGoalsAvailability[t].isAvailable))}getDonationItems(){var e,t,n,i,s,a,o;const r=[],l=this.donationDataPoint.processingFees;for(let c=0;c<this.donationDataPoint.availableDonationItemsDto.length;c++){const u=this.donationDataPoint.availableDonationItemsDto[c];r.push({amount:null!==(e=u.amount)&&void 0!==e?e:0,fee:null!==(t=l[u.id])&&void 0!==t?t:0,frequency:u.frequency,goalKey:null===(n=this.availableSelectedGoals[c])||void 0===n?void 0:n.id,hintsVariantName:u.amountHint?G_.RANDOM:G_.NONE,hintDescription:null!==(s=null===(i=u.amountHint)||void 0===i?void 0:i.description)&&void 0!==s?s:"",_suggestedAmountHint:null!==(o=null===(a=u.amountHint)||void 0===a?void 0:a.id)&&void 0!==o?o:null,limit:this.getLimitField(u.frequency)})}return r}getScreenHistory(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.sessionRestoreData?this.sessionRestoreData.screenHistory:e?this.screenHistory:[]}getLimitField(e){const t=this.donationDataPoint.getFrequencyDonationEndDate(e),n=this.donationDataPoint.isDonationEndDateActive&&t.shouldShow&&t.endDate?t.endDate.toISOString():null;return{maxDate:n,configMaxDate:n?this.checkoutConfiguration.campaign.config.frequencies[e].endDate:null}}}class NM extends rr{constructor(e,t,n,i,s,a,o){super(s,a,o),this.currencyService=e,this.checkoutState=t,this.checkoutUIState=n,this.screenDataFormatter=i,this.checkoutConfiguration=s,this.sessionTokenService=a,this.params=o}createCheckoutViewEvent(){var e,t,n;const i={isAmountFromElement:Boolean((null===(e=this.checkoutConfiguration.external.element)||void 0===e?void 0:e.key)&&(null===(n=null===(t=this.checkoutConfiguration.external.state)||void 0===t?void 0:t.donation)||void 0===n?void 0:n.amount))};return new hO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.getOpeningTime(),i)}createCheckoutScreenViewEvent(e){const t={paymentMethods:Object.keys(this.paymentOptionsDataPoint.allowedPaymentMethods).filter((e=>![Gn.CRYPTO].includes(e)&&this.paymentOptionsDataPoint.allowedPaymentMethods[e].available&&this.paymentOptionsDataPoint.allowedPaymentMethods[e].visible)),renderDuration:null};return e.transitionStartedAt&&e.transitionFinishedAt&&(t.transitionDuration=e.transitionFinishedAt.getTime()-e.transitionStartedAt.getTime()),e.renderedAt&&e.transitionFinishedAt&&(t.renderDuration=e.renderedAt.getTime()-e.transitionFinishedAt.getTime()),this.checkoutConfiguration.isRestoredByWidgetSession&&(t.isRestoredByWidgetSession=!0),void 0!==e.progress&&(t.progress=e.progress),new dO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,t,e.askPagePosition)}createCheckoutChargeEvent(e){var t,n;const i={};this.donationDataPoint.amountHint&&(i.hintAmount=this.donationDataPoint.amountHint.amount,i.hintDescription=this.donationDataPoint.amountHint.description,i.default=this.donationDataPoint.amountHint.default,i.amountUsd=this.donationDataPoint.amountHint.amountUsd,i.hintVariantName=this.donationDataPoint.amountHint?G_.RANDOM:G_.NONE);const s=this.designationsDataPoint.selectedGoals.filter(((e,t)=>{var n;return null===(n=this.designationsDataPoint.selectedGoalsAvailability[t])||void 0===n?void 0:n.isAvailable})),a=null!==(t=e.donationIds[0])&&void 0!==t?t:e.donationId,o=null===(n=s[0])||void 0===n?void 0:n.id;return new oO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,{chargeKey:a,chargeInUSDAmount:this.donationDataPoint.totalInUSD||0,chargeInDefaultCurrencyAmount:this.donationDataPoint.totalInDefaultCurrency,chargeAmount:this.donationDataPoint.total,chargeCurrency:this.donationDataPoint.currency,chargeFeeCovered:this.donationDataPoint.isFeeCovered,chargePaymentMethod:e.clientPaymentMethod,chargeIsRecurring:this.donationDataPoint.frequency!==qn.ONCE,chargeHasComment:this.commentDataPoint.isActive&&!!this.commentDataPoint.comment,chargeHasTribute:this.tributeDataPoint.isFilled,chargeGoal:o||void 0,chargeCampaignKey:this.checkoutConfiguration.campaign.key},e.duration,i)}createCheckoutDonationCompleteEvent(e){var t,n;const i={};this.donationDataPoint.amountHint&&(i.hintAmount=this.donationDataPoint.amountHint.amount,i.hintDescription=this.donationDataPoint.amountHint.description,i.default=this.donationDataPoint.amountHint.default,i.amountUsd=this.donationDataPoint.amountHint.amountUsd,i.hintVariantName=this.donationDataPoint.amountHint?G_.RANDOM:G_.NONE);const s=[],a=this.donationDataPoint.availableDonationItemsDto,o=this.designationsDataPoint.selectedGoals.filter(((e,t)=>{var n;return null===(n=this.designationsDataPoint.selectedGoalsAvailability[t])||void 0===n?void 0:n.isAvailable}));for(let i=0;i<e.donationIds.length;i++){const r=a[i],l=e.donationIds[i],c=o[i],u=null!==(t=this.donationDataPoint.processingFees[r.id])&&void 0!==t?t:0,d=(null!==(n=r.amount)&&void 0!==n?n:0)+u;s.push({chargeId:l,goalId:null==c?void 0:c.id,amount:d,amountInUSD:this.currencyService.convert(d,this.donationDataPoint.currency,"USD")})}return new mO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,{paymentIntentId:e.paymentIntentId,donationItems:s,chargeInUSDAmount:this.donationDataPoint.totalInUSD||0,chargeInDefaultCurrencyAmount:this.donationDataPoint.totalInDefaultCurrency,chargeAmount:this.donationDataPoint.total,chargeCurrency:this.donationDataPoint.currency,chargeFeeCovered:this.donationDataPoint.isFeeCovered,chargePaymentMethod:e.clientPaymentMethod,chargeIsRecurring:this.donationDataPoint.frequency!==qn.ONCE,chargeHasComment:this.commentDataPoint.isActive&&!!this.commentDataPoint.comment,chargeHasTribute:this.tributeDataPoint.isFilled,chargeCampaignKey:this.checkoutConfiguration.campaign.key},e.duration,i)}createCheckoutErrorEvent(e){return new uO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,e.errorMessage,this.paymentOptionsDataPoint.clientPaymentMethod||Gn.CARD,e.durationTime,e.errorCode,e.errorType,e.errorDeclineCode)}createCheckoutCloseEvent(){return new lO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName)}createCheckoutClickEvent(e){return new rO(this.checkoutEventPayParams,this.checkoutEventElementParams,this.checkoutScreenName,e.elementName||"other",new fO(e.target))}createCheckoutCustomEvent(e){return new cO(this.checkoutEventPayParams,this.checkoutEventElementParams,{customEventType:e.type,customEventData:"data"in e?e.data:void 0})}getCommonEventPayload(){var e,t;const n=this.getCurrentScreenData();return Object.assign(Object.assign({},super.getCommonEventPayload()),{donationType:this.processDataPoint.flowType,checkoutFrequency:this.donationDataPoint.frequency,checkoutDefaultAmount:null!==(e=this.donationDataPoint.getFrequencyDefaultAmount(this.donationDataPoint.frequency))&&void 0!==e?e:0,checkoutInUSDAmount:null!==(t=this.donationDataPoint.amountInUSD)&&void 0!==t?t:0,checkoutCurrencyRate:this.currencyService.getRate(this.donationDataPoint.currency),checkoutScreen:null==n?void 0:n.screenName,checkoutScreenData:n&&this.checkoutUIState?JSON.stringify(this.screenDataFormatter.format(n.screenName,n.screenData,this.screenFormatterData,this.checkoutUIState,this.checkoutConfiguration)):void 0})}get screenFormatterData(){const e=this.checkoutConfiguration.goalMeterData.raisedAmount,t=this.checkoutConfiguration.goalMeterData.totalAmount,n=this.checkoutConfiguration.goalMeterData.currency,i=this.donationDataPoint.frequency;return{donation:{amount:this.donationDataPoint.amount,currency:this.donationDataPoint.currency,frequency:i,defaultAmount:this.donationDataPoint.getFrequencyDefaultAmount(i),amountOptions:this.donationDataPoint.getFrequencyAmountSuggestions(i),currentHint:this.donationDataPoint.amountHint,hintOptions:this.donationDataPoint.getFrequencyAmountHints(i),hintVariantName:this.donationDataPoint.amountHint?G_.RANDOM:null},tribute:{isActive:this.tributeDataPoint.isActive},goalMeter:{shown:this.checkoutConfiguration.goalMeterData.shown,isFundraisingPageGoalMeter:this.checkoutConfiguration.goalMeterData.isFundraisingPageGoalMeter,raisedInUSD:e&&n?this.currencyService.convert(e,n,"USD"):null,goalAmountInUSD:t&&n?this.currencyService.convert(t,n,"USD"):null}}}get checkoutEventPayParams(){const e={};return Object.entries(this.donationDataPoint.allAmountHints).forEach((t=>{let[n,i]=t;var s;e[n]=null!==(s=null==i?void 0:i.map((e=>e.amount)))&&void 0!==s?s:[]})),{frequency:this.donationDataPoint.frequency,currency:this.donationDataPoint.currency,amount:this.donationDataPoint.amount||0,amountOptions:e[this.donationDataPoint.frequency].length?e:this.donationDataPoint.allAmountSuggestions}}get checkoutEventElementParams(){return{elementKey:this.checkoutConfiguration.element.key,elementType:this.checkoutConfiguration.element.type,elementReminderKey:this.checkoutConfiguration.element.reminderKey}}get checkoutScreenName(){var e;return(null===(e=this.getCurrentScreenData())||void 0===e?void 0:e.screenName)||""}get processDataPoint(){return this.checkoutState.process.dataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get designationDataPoint(){return this.checkoutState.designation.dataPoint}get paymentOptionsDataPoint(){return this.checkoutState.paymentOptions.paymentOptionsDataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}}class DM{constructor(e,t){this.donorRating=e,this.currencyService=t}calculate(e,t){var n,i;const{frequency:s,currency:a}=e;let{amount:o}=e;const r=this.getDonorRatingGroupKey(t);if(!r)return DM.NONE_POSITION;const l=null===(i=null===(n=this.donorRating)||void 0===n?void 0:n[r])||void 0===i?void 0:i[s];return l?("USD"!==a&&(o=this.currencyService.convert(o,a,"USD")),{position:this.findPosition(o,l)}):DM.NONE_POSITION}getDonorRatingGroupKey(e){return e===H.TEST_1||e===K.TEST_1?Qn.TEST_1:e===H.TEST_2||e===K.TEST_2?Qn.TEST_2:null}findPosition(e,t){if(e>=t[Xn.TOP_0_1][1])return Xn.TOP_0_1;for(const[n,[i,s]]of Object.entries(t))if(e>=i&&e<s)return n;return Xn.NONE}}function TM(e,t){return(e-t)/e*100}DM.NONE_POSITION={position:Xn.NONE};class kM{constructor(e){this.donorRating=e.donorRating,this.currencyService=e.currencyService}calculate(e){var t;const{frequency:n,amount:i,currency:s,position:a}=e,o=this.donorRating[n];if(!o)return kM.DEFAULT_RESULT;const r=this.convertToBoundaryTable(o),l=this.convertToDefaultCurrency(i,s),c=this.findNextBoundary(a,r);if(!c)return kM.DEFAULT_RESULT;if(TM(c.lowerBound,l)>this.getThresholdPercentage(l))return kM.DEFAULT_RESULT;const u=this.calculateAdditionalAmount(c.lowerBound,l,s),d=this.convertToDefaultCurrency(u,s),h=this.findResultBoundary(r,l+d);return{amount:u,position:null!==(t=null==h?void 0:h.percentage)&&void 0!==t?t:Xn.NONE}}calculateAdditionalAmount(e,t,n){let i=e-t;return n!==kM.DEFAULT_CURRENCY&&(i=this.currencyService.convert(i,kM.DEFAULT_CURRENCY,n)),i=this.currencyService.ceil(i,n),i}getThresholdPercentage(e){for(const t of kM.DONATION_THRESHOLDS)if(e>=t.lowerBound&&e<t.upperBound)return t.percentage;return kM.BELOW_TOP_40_THRESHOLD}sortBoundaries(e,t){const n=parseFloat(e[0].replace("_","."));return parseFloat(t[0].replace("_","."))-n}convertToBoundaryTable(e){return Object.entries(e).sort(this.sortBoundaries).map((e=>{let[t,[n,i]]=e;return{percentage:t,lowerBound:n,upperBound:i}}))}findNextBoundary(e,t){if(e===Xn.NONE&&t.length>0)return t[0];const n=t.findIndex((t=>t.percentage===e));return-1!==n&&n<t.length-1?t[n+1]:null}findResultBoundary(e,t){let n=null;for(const i of e)if(t>=i.lowerBound&&t<i.upperBound){n=i;break}return n}convertToDefaultCurrency(e,t){return t===kM.DEFAULT_CURRENCY?e:this.currencyService.convert(e,t,kM.DEFAULT_CURRENCY)}}kM.DEFAULT_RESULT={amount:0,position:Xn.NONE},kM.DEFAULT_CURRENCY="USD",kM.BELOW_TOP_40_THRESHOLD=30,kM.DONATION_THRESHOLDS=[{lowerBound:0,upperBound:16e3,percentage:30},{lowerBound:16e3,upperBound:1e5,percentage:25},{lowerBound:1e5,upperBound:1/0,percentage:15}];class IM extends Error{constructor(e){super(`${e} payment flow is not initialized`)}}class _M{constructor(e,t,n,i,s,a,o,r,l,c,u,d){this.checkoutConfiguration=e,this.checkoutState=t,this.paymentFlowManager=n,this.sessionAPI=i,this.sessionService=s,this.currencyService=a,this.intl=o,this.paymentMethods=r,this.iframeWindow=l,this.stripeLoadingPromise=c,this.applePayStripeLoadingPromise=u,this.params=d,this._stripeElementsPromise=null,this.googlePayChecked=!1,this.applePayChecked=!1,this.initializePaymentMethodsPromise=null}initiateCreditCard(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.resolvePaymentFlow(Gn.CARD);return yield t.initiateFlow(e),{stripeElements:yield this.stripeElementsPromise}}))}startCreditCardFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.resolvePaymentFlow(Gn.CARD),t=yield e.startFlow();return wn.isSuccess(t)}))}initiatePaypal(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.resolvePaymentFlow(Gn.PAYPAL);return yield this.sessionService.updateSession(),t.initiateFlow(e)}))}preloadVenmoScript(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.isLighthouse)return;const e=yield this.resolvePaymentFlow(Gn.VENMO);yield e.loadPayPalScriptIfNeeded()}))}preloadPayPalScript(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutConfiguration.isLighthouse)return;const e=yield this.resolvePaymentFlow(Gn.PAYPAL);yield e.loadPayPalScriptIfNeeded()}))}closePaypalButton(){if(this.isShowcase)return;const e=this.paymentFlowManager.getPaymentFlow(Gn.PAYPAL);if(!e)throw new IM(Gn.PAYPAL);e.closePaypal()}togglePaypalActions(e){const t=this.paymentFlowManager.getPaymentFlow(Gn.PAYPAL);t&&t.togglePaypalActions(e)}initiateGooglePay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.resolvePaymentFlow(Gn.GOOGLE_PAY);yield e.initiateFlow(),yield this.checkGooglePay()}))}startGooglePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){return(yield this.resolvePaymentFlow(Gn.GOOGLE_PAY)).startFlow(e)}))}initiateApplePay(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.checkApplePay()}))}startApplePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){return(yield this.resolvePaymentFlow(Gn.APPLE_PAY)).startFlow(e)}))}initiateUSBankAccount(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.resolvePaymentFlow(Gn.US_BANK_ACCOUNT);yield t.initiateFlow(e)}))}startUSBankAccount(){return(0,d.sH)(this,void 0,void 0,(function*(){return yield this.sessionService.updateSession(),(yield this.resolvePaymentFlow(Gn.US_BANK_ACCOUNT)).startFlow()}))}initiateACSS(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.resolvePaymentFlow(Gn.ACSS);yield t.initiateFlow(e)}))}startACSS(){return(0,d.sH)(this,void 0,void 0,(function*(){return yield this.sessionService.updateSession(),(yield this.resolvePaymentFlow(Gn.ACSS)).startFlow()}))}initiateSepa(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){const n=yield this.resolvePaymentFlow(Gn.SEPA);return yield n.initiateFlow(e,t),{stripeElements:yield this.stripeElementsPromise}}))}startSepaFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.resolvePaymentFlow(Gn.SEPA),t=yield e.startFlow();return wn.isSuccess(t)}))}initiateVenmo(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.resolvePaymentFlow(Gn.VENMO);yield t.initiateFlow(e),yield this.checkVenmo()}))}closeVenmoButton(){const e=this.paymentFlowManager.getPaymentFlow(Gn.VENMO);if(!e)throw new IM(Gn.VENMO);e.closeButton()}toggleVenmoActions(e){const t=this.paymentFlowManager.getPaymentFlow(Gn.VENMO);t&&t.toggleVenmoActions(e)}initiateIDEAL(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.resolvePaymentFlow(Gn.IDEAL);yield e.initiateFlow()}))}openIDEALConfirmationWindow(e){const t=this.paymentFlowManager.getPaymentFlow(Gn.IDEAL);if(!t)throw new IM(Gn.IDEAL);if(!(t instanceof Pw))return t.openConfirmationWindow(e)}isIDEALPaid(){const e=this.paymentFlowManager.getPaymentFlow(Gn.IDEAL);if(!e)throw new IM(Gn.IDEAL);return e.isPaid()}isIDEALPaymentRestored(){const e=this.paymentFlowManager.getPaymentFlow(Gn.IDEAL);return!!e&&!(e instanceof Nw)&&e.isPaymentRestored()}isIDEALPaymentStarted(){const e=this.paymentFlowManager.getPaymentFlow(Gn.IDEAL);return!!e&&e.isPaymentStarted()}focusIDEALConfirmationWindow(){const e=this.paymentFlowManager.getPaymentFlow(Gn.IDEAL);if(!e)throw new IM(Gn.IDEAL);e instanceof Pw||e.focusConfirmationWindow()}initiateAuBECS(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){const n=yield this.resolvePaymentFlow(Gn.AU_BECS);return yield n.initiateFlow(e,t),{stripeElements:yield this.stripeElementsPromise}}))}startAuBECSFlow(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.resolvePaymentFlow(Gn.AU_BECS),t=yield e.startFlow();return wn.isSuccess(t)}))}ensurePaymentMethodsInitialized(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.isShowcase){if(this.initializePaymentMethodsPromise)return this.initializePaymentMethodsPromise;this.initializePaymentMethodsPromise=this.initiatePaymentMethods(),yield this.initializePaymentMethodsPromise,this.initializePaymentMethodsPromise=null}}))}resolvePaymentFlow(e){return(0,d.sH)(this,void 0,void 0,(function*(){var t,n;if(!e)throw new Error("Client payment method is not specified");const i=this.checkoutConfiguration.company,s=this.checkoutConfiguration.user;switch(e){case Gn.CARD:return this.paymentFlowManager.resolveCard({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,stripeElementsLoadingPromise:this.stripeElementsPromise,failureHandler:()=>this.setProcessError(aI.PAYMENT),setPaymentMethodCountry:e=>this.setPaymentMethodCountry(e),donation:{getFrequency:()=>this.getDonationFrequency(),getCurrency:()=>this.getDonationCurrency()}});case Gn.PAYPAL:return this.paymentFlowManager.resolvePaypal({sessionAPI:this.sessionAPI,locale:null===(t=this.intl)||void 0===t?void 0:t.locale,iframeWindow:this.iframeWindow,paypalClientId:this.paymentMethods.paypalClientId,paypalMerchantId:i.paypal.merchantId,paypalCurrencies:[...i.paypalCurrencies],subscriptionsEnabled:i.paypal.subscriptionsEnabled,donation:{getCurrency:()=>this.getDonationCurrency(),getDefaultCurrency:()=>this.getDonationDefaultCurrency()},updateSession:()=>this.sessionService.updateSession(),setPaymentMethod:e=>this.setPaymentMethod(e),setDonorFirstNameIfEmpty:e=>this.setDonorFirstNameIfEmpty(e),setDonorLastNameIfEmpty:e=>this.setDonorLastNameIfEmpty(e),setDonorEmailIfEmpty:e=>this.setDonorEmailIfEmpty(e),setPhoneCountryCodeIfEmptyPhone:e=>this.setPhoneCountryCodeIfEmptyPhone(e),setPhoneNumberIfEmpty:e=>this.setPhoneNumberIfEmpty(e),setCountryCodeIfEmptyAddress:e=>this.setCountryCodeIfEmptyAddress(e),setCityIfEmpty:e=>this.setCityIfEmpty(e),setLine1IfEmpty:e=>this.setLine1IfEmpty(e),setLine2IfEmpty:e=>this.setLine2IfEmpty(e),setPostalIfEmpty:e=>this.setPostalIfEmpty(e),setRegionIfEmpty:e=>this.setRegionIfEmpty(e),paymentFailureHandler:()=>this.setProcessError(aI.PAYMENT),isFastTrackExperimentEnabled:()=>this.checkoutState.paymentOptions.paymentOptionsDataPoint.isFastTrackFlow&&this.checkoutState.mailingAddress.dataPoint.isRequired,setCleanPhoneNumber:e=>this.setPhoneCleanNumber(e)});case Gn.GOOGLE_PAY:return this.paymentFlowManager.resolveGooglePay({sessionAPI:this.sessionAPI,livemode:this.livemode,stripePublicKey:this.paymentMethods.stripePublicKey,countryCode:s.address.countryCode,googlePayInfo:this.paymentMethods.googlePayInfo,stripeAccount:i.stripeAccount,companyName:i.name,env:this.checkoutConfiguration.infrastructureParams.env,stripeLoadingPromise:this.stripeLoadingPromise,currencyService:this.currencyService,donation:{getFrequency:()=>this.getDonationFrequency(),getCurrency:()=>this.getDonationCurrency(),getTotal:()=>this.getDonationTotal()},setPaymentMethod:e=>this.setPaymentMethod(e),setDonorFullNameIfEmpty:e=>this.setDonorFullNameIfEmpty(e),setDonorEmailIfEmpty:e=>this.setDonorEmailIfEmpty(e),isFastTrackExperimentEnabled:()=>this.checkoutState.paymentOptions.paymentOptionsDataPoint.isFastTrackFlow,isMailingAddressRequired:()=>this.checkoutState.mailingAddress.dataPoint.isRequired,isPhoneNumberRequired:()=>this.checkoutState.privacy.phoneNumberDataPoint.isRequired,setDonorPhoneIfEmpty:e=>this.setPhoneNumberIfEmpty(e),setPhoneCleanNumber:e=>this.setPhoneCleanNumber(e),setPhoneCountryCodeIfEmptyPhone:e=>this.setPhoneCountryCodeIfEmptyPhone(e),setCountryCodeIfEmptyAddress:e=>this.setCountryCodeIfEmptyAddress(e),setCityIfEmpty:e=>this.setCityIfEmpty(e),setLine1IfEmpty:e=>this.setLine1IfEmpty(e),setLine2IfEmpty:e=>this.setLine2IfEmpty(e),setPostalIfEmpty:e=>this.setPostalIfEmpty(e),setRegionIfEmpty:e=>this.setRegionIfEmpty(e)});case Gn.APPLE_PAY:return this.paymentFlowManager.resolveApplePay({sessionAPI:this.sessionAPI,companyName:i.name,applePayStripeLoadingPromise:this.applePayStripeLoadingPromise,donation:{getTotal:()=>this.getDonationTotal(),getCurrency:()=>this.getDonationCurrency()},setPaymentMethod:e=>this.setPaymentMethod(e),setDonorFullNameIfEmpty:e=>this.setDonorFullNameIfEmpty(e),setDonorEmailIfEmpty:e=>this.setDonorEmailIfEmpty(e),setCountryCodeIfEmptyAddress:e=>this.setCountryCodeIfEmptyAddress(e),setCityIfEmpty:e=>this.setCityIfEmpty(e),setLine1IfEmpty:e=>this.setLine1IfEmpty(e),setLine2IfEmpty:e=>this.setLine2IfEmpty(e),setPostalIfEmpty:e=>this.setPostalIfEmpty(e),setRegionIfEmpty:e=>this.setRegionIfEmpty(e),isFastTrackExperimentEnabled:()=>this.checkoutState.paymentOptions.paymentOptionsDataPoint.isFastTrackFlow,isMailingAddressRequired:()=>this.checkoutState.mailingAddress.dataPoint.isRequired,isPhoneNumberRequired:()=>this.checkoutState.privacy.phoneNumberDataPoint.isRequired,setDonorPhoneIfEmpty:e=>this.setPhoneNumberIfEmpty(e),setPhoneCleanNumber:e=>this.setPhoneCleanNumber(e),setPhoneCountryCodeIfEmptyPhone:e=>this.setPhoneCountryCodeIfEmptyPhone(e)});case Gn.UK_BACS:return this.paymentFlowManager.resolveUkBacs({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,donorEmail:{getDto:()=>this.getDonorEmailDto()},mailingAddress:{getDto:()=>this.getMailingAddressDto()},ukBacs:{getDto:()=>this.getUkBacsDto()},mailingAddressFailureHandler:()=>this.setProcessError(aI.MAILING_ADDRESS),ukBacsFailureHandler:()=>this.setProcessError(aI.PAYMENT)});case Gn.ACSS:return this.paymentFlowManager.resolveACSS({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,donorName:{getDto:()=>this.getDonorNameDto()},donorEmail:{getDto:()=>this.getDonorEmailDto()},setPaymentMethod:e=>this.setPaymentMethod(e)});case Gn.AU_BECS:return this.paymentFlowManager.resolveAuBECS({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,stripeElementsLoadingPromise:this.stripeElementsPromise,donorName:{getDto:()=>this.getDonorNameDto()},donorEmail:{getDto:()=>this.getDonorEmailDto()}});case Gn.SEPA:return this.paymentFlowManager.resolveSepa({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,stripeElementsLoadingPromise:this.stripeElementsPromise,donorName:{getDto:()=>this.getDonorNameDto()},donorEmail:{getDto:()=>this.getDonorEmailDto()},paymentOptions:{getDto:()=>this.getPaymentOptionsDto()},mailingAddress:{getDto:()=>this.getMailingAddressDto(),validate:()=>this.getMailingAddressValidationResult()},checkoutConfiguration:this.checkoutConfiguration,setPaymentMethodCountry:e=>this.setPaymentMethodCountry(e),mailingAddressFailureHandler:()=>this.setProcessError(aI.MAILING_ADDRESS)});case Gn.IDEAL:return this.paymentFlowManager.resolveIDEAL({sessionAPI:this.sessionAPI,stripeLoadingPromise:this.stripeLoadingPromise,env:this.checkoutConfiguration.infrastructureParams.env,stripeElementsLoadingPromise:this.stripeElementsPromise,donorName:{getDto:()=>this.getDonorNameDto()},donorEmail:{getDto:()=>this.getDonorEmailDto()},clientId:this.params.clientId,checkoutConfiguration:this.checkoutConfiguration});case Gn.VENMO:return this.paymentFlowManager.resolveVenmo({sessionAPI:this.sessionAPI,livemode:this.livemode,showcase:this.isShowcase,locale:null===(n=this.intl)||void 0===n?void 0:n.locale,iframeWindow:this.iframeWindow,paypalClientId:this.paymentMethods.paypalClientId,paypalMerchantId:i.paypal.merchantId,updateSession:()=>this.sessionService.updateSession(),setPaymentMethod:e=>this.setPaymentMethod(e),setDonorFirstNameIfEmpty:e=>this.setDonorFirstNameIfEmpty(e),setDonorLastNameIfEmpty:e=>this.setDonorLastNameIfEmpty(e),setDonorEmailIfEmpty:e=>this.setDonorEmailIfEmpty(e),setPhoneCountryCodeIfEmptyPhone:e=>this.setPhoneCountryCodeIfEmptyPhone(e),setPhoneNumberIfEmpty:e=>this.setPhoneNumberIfEmpty(e),setCountryCodeIfEmptyAddress:e=>this.setCountryCodeIfEmptyAddress(e),setCityIfEmpty:e=>this.setCityIfEmpty(e),setLine1IfEmpty:e=>this.setLine1IfEmpty(e),setLine2IfEmpty:e=>this.setLine2IfEmpty(e),setPostalIfEmpty:e=>this.setPostalIfEmpty(e),setRegionIfEmpty:e=>this.setRegionIfEmpty(e)});case Gn.US_BANK_ACCOUNT:return this.paymentFlowManager.resolveUSBankAccount({stripeLoadingPromise:this.stripeLoadingPromise,usBankAccount:{getDto:()=>this.getUsBankAccountDto(),getUsBankAccountVerificationSetup:()=>this.getUsBankAccountVerificationSetup()},sessionAPI:this.sessionAPI,checkoutConfiguration:this.checkoutConfiguration,donation:{getTotal:()=>this.getDonationTotal(),getCurrency:()=>this.getDonationCurrency()},donorName:{getDto:()=>this.getDonorNameDto()},paymentFailureHandler:()=>this.setProcessError(aI.PAYMENT),setFinancialInstitution:e=>this.setUsBankAccountFinancialInstitution(e),setVerificationType:e=>this.setUsBankAccountVerificationType(e),setAccountNumber:e=>this.setUsBankAccountNumber(e),setRoutingNumber:e=>this.setUsBankAccountRoutingNumber(e),setAccountType:e=>this.setUsBankAccountType(e)});default:throw new Error(`Payment flow for ${e} is not implemented`)}}))}get livemode(){return this.checkoutConfiguration.infrastructureParams.livemode}get isShowcase(){return this.checkoutConfiguration.infrastructureParams.showcase}get stripeElementsPromise(){return this._stripeElementsPromise||(this._stripeElementsPromise=this.getStripeElements()),this._stripeElementsPromise}initiatePaymentMethods(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.checkoutState.paymentOptions.paymentOptionsDataPoint,t=[];e.allowedPaymentMethods.googlePay.available&&t.push(this.initiateGooglePay()),e.allowedPaymentMethods.applePay.available&&t.push(this.initiateApplePay()),e.allowedPaymentMethods.paypal.available&&t.push(this.preloadPayPalScript()),e.allowedPaymentMethods.venmo.available&&t.push(this.preloadVenmoScript()),yield Promise.all(t)}))}getStripeElements(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.stripeLoadingPromise();if(!e)throw new Error("Stripe is not provided");return e.elements(this.params.stripe.elementsOptions)}))}checkGooglePay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.googlePayChecked)return;const e=yield this.resolvePaymentFlow(Gn.GOOGLE_PAY);(yield e.checkAvailability())&&this.setPaymentMethodChecked(Gn.GOOGLE_PAY),this.googlePayChecked=!0}))}checkApplePay(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.applePayChecked)return;const e=yield this.resolvePaymentFlow(Gn.APPLE_PAY);(yield e.checkAvailability())&&this.setPaymentMethodChecked(Gn.APPLE_PAY),this.applePayChecked=!0}))}checkVenmo(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=(yield this.resolvePaymentFlow(Gn.VENMO)).checkAvailability();return e&&this.setPaymentMethodChecked(Gn.VENMO),e}))}setPaymentMethod(e){this.checkoutState.paymentOptions.setPaymentMethod(e)}setPaymentMethodCountry(e){this.checkoutState.paymentOptions.setPaymentMethodCountry(e)}setPaymentMethodChecked(e){this.checkoutState.paymentOptions.setPaymentMethodChecked(e)}setUsBankAccountFinancialInstitution(e){this.checkoutState.paymentOptions.setUsBankAccountFinancialInstitution(e)}setUsBankAccountVerificationType(e){this.checkoutState.paymentOptions.setUsBankAccountVerificationType(e)}setUsBankAccountNumber(e){this.checkoutState.paymentOptions.setUsBankAccountNumber(e)}setUsBankAccountRoutingNumber(e){this.checkoutState.paymentOptions.setUsBankAccountRoutingNumber(e)}setUsBankAccountType(e){this.checkoutState.paymentOptions.setUsBankAccountType(e)}setProcessError(e){this.checkoutState.process.setError({errorType:e})}setDonorFirstNameIfEmpty(e){this.checkoutState.privacy.setDonorFirstNameIfEmpty(e)}setDonorLastNameIfEmpty(e){this.checkoutState.privacy.setDonorLastNameIfEmpty(e)}setDonorFullNameIfEmpty(e){this.checkoutState.privacy.setDonorFullNameIfEmpty(e)}setDonorEmailIfEmpty(e){this.checkoutState.privacy.setDonorEmailIfEmpty(e)}setPhoneCountryCodeIfEmptyPhone(e){this.checkoutState.privacy.setPhoneCountryCodeIfEmptyPhone(e)}setPhoneNumberIfEmpty(e){this.checkoutState.privacy.setPhoneNumberIfEmpty(e)}setPhoneCleanNumber(e){this.checkoutState.privacy.setPhoneCleanNumber(e)}setCountryCodeIfEmptyAddress(e){this.checkoutState.mailingAddress.setCountryCodeIfEmptyAddress(e)}setCityIfEmpty(e){this.checkoutState.mailingAddress.setCityIfEmpty(e)}setLine1IfEmpty(e){this.checkoutState.mailingAddress.setLine1IfEmpty(e)}setLine2IfEmpty(e){this.checkoutState.mailingAddress.setLine2IfEmpty(e)}setRegionIfEmpty(e){this.checkoutState.mailingAddress.setRegionIfEmpty(e)}setPostalIfEmpty(e){this.checkoutState.mailingAddress.setPostalIfEmpty(e)}getDonationFrequency(){return this.checkoutState.donation.dataPoint.frequency}getDonationCurrency(){return this.checkoutState.donation.dataPoint.currency}getDonationDefaultCurrency(){return this.checkoutConfiguration.defaultCurrency}getDonationTotal(){return this.checkoutState.donation.dataPoint.total}getDonorEmailDto(){return this.checkoutState.privacy.donorEmailDataPoint.getDTO()}getDonorNameDto(){return this.checkoutState.privacy.donorNameDataPoint.getDTO()}getPaymentOptionsDto(){return this.checkoutState.paymentOptions.paymentOptionsDataPoint.getDTO()}getMailingAddressDto(){return this.checkoutState.mailingAddress.dataPoint.getDTO()}getMailingAddressValidationResult(){return this.checkoutState.mailingAddress.dataPoint.getValidationResult()}getUkBacsDto(){return this.checkoutState.paymentOptions.ukBacsDataPoint.getDTO()}getUsBankAccountDto(){return this.checkoutState.paymentOptions.usBankAccountDataPoint.getDTO()}getUsBankAccountVerificationSetup(){return this.checkoutState.paymentOptions.usBankAccountDataPoint.usBankAccountVerificationSetup}}class OM{constructor(e){this.sessionAPI=e}update(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.sessionAPI.post("postDonationUpsell",{postDonationUpsell:e},{rejectsOnInvalid:!0});return!!wn.isSuccess(t)}))}}class xM{constructor(e){this.sessionApi=e,this._fetchDecision=e=>Promise.race([this.requestCacheService.getCachedOrFetchValue(e),new Promise((e=>setTimeout((()=>{e(this.getResult($w,!1))}),1500)))]),this.requestCacheService=new Ww($w,e.getFeeCovering.bind(e),this.shouldCacheResponse,this.getCacheKey,this.getResult),this._debouncedGetDecision=cR(this._fetchDecision,300)}fetchDecision(e){return this._fetchDecision(e)}debouncedFetchDecision(e){return this._debouncedGetDecision(e)}getCacheKey(e){return JSON.stringify(e)}shouldCacheResponse(e,t){return!t.isFallback}getResult(e,t){return{response:e,fromCache:t}}}class wM extends _O{}const RM=Vn.DONATE,MM=[...RO,Vn.DONATE,Vn.DONATE_BY_VOICE],LM=[Vn.PAYMENT_OPTIONS,Vn.AU_BECS,Vn.SEPA],FM=[...MO,Vn.DONATE,wl.REMIND_ME],UM=[...FO,Vn.DONATE],jM=[...BO,Vn.DONATE],BM=[Vn.DONATE,wl.THANK_YOU,wl.BLOCKED],GM=[Vn.UPSELL,Vn.PAYMENT_OPTIONS,wl.COMMENT],qM=[...xO,wl.REMIND_ME,Vn.DONATE,Vn.IDEAL_CONFIRMATION,Vn.DONATE_BY_VOICE],VM=[...wO,Vn.DONATE],HM=[wl.THANK_YOU,wl.REMIND_ME,Vn.DONATE_BY_VOICE],KM=[...LO],YM=[...UO,wl.REMIND_ME],zM=[...jO,wl.REMIND_ME],WM={[qn.ANNUAL]:"upsellScreen.button.donateAnnual",[qn.MONTHLY]:"upsellScreen.button.donateMonthly",[qn.EVERY_4_WEEKS]:"upsellScreen.button.donate4Weeks",[qn.QUARTERLY]:"upsellScreen.button.donateQuarterly"},$M={[qn.ANNUAL]:"upsellScreen.button.donateAnnual",[qn.MONTHLY]:"upsellScreen.button.donateMonthly",[qn.EVERY_4_WEEKS]:"upsellScreen.button.donate4Weeks",[qn.QUARTERLY]:"upsellScreen.button.donateQuarterly"},XM={[qn.ANNUAL]:"upsellScreen.titleAnnual",[qn.MONTHLY]:"upsellScreen.title",[qn.EVERY_4_WEEKS]:"upsellScreen.titleEvery4Weeks",[qn.QUARTERLY]:"upsellScreen.titleQuarterly"},QM={[qn.ANNUAL]:"upsellScreen.questionAnnual",[qn.MONTHLY]:"upsellScreen.question",[qn.EVERY_4_WEEKS]:"upsellScreen.questionEvery4Weeks",[qn.QUARTERLY]:"upsellScreen.questionQuarterly"},ZM={[qn.ANNUAL]:"upsellScreen.questionAnnual",[qn.MONTHLY]:"upsellScreen.questionShort",[qn.EVERY_4_WEEKS]:"upsellScreen.questionShortEvery4Weeks",[qn.QUARTERLY]:"upsellScreen.questionQuarterly"},JM={[qn.ANNUAL]:"upsellScreen.descriptionAnnual",[qn.MONTHLY]:"upsellScreen.description",[qn.EVERY_4_WEEKS]:"upsellScreen.descriptionEvery4Weeks",[qn.QUARTERLY]:""};class eL{constructor(e,t){this.checkoutState=e,this.intl=t}getBeforeEnterViewState(){var e,t;const n=this.preDonationUpsellDataPoint.upsellFrequency===qn.ANNUAL,i=this.getViewTexts();return{currency:this.preDonationUpsellDataPoint.upsellCurrency,targetFrequency:this.preDonationUpsellDataPoint.upsellFrequency,lowAmount:this.preDonationUpsellDataPoint.upsellLowAmount,lowAmountInUSD:this.preDonationUpsellDataPoint.upsellLowAmountInUsd,highAmount:this.preDonationUpsellDataPoint.upsellHighAmount,highAmountInUSD:this.preDonationUpsellDataPoint.upsellHighAmountInUsd,isAnnualTribute:n,highButtonText:i.highButtonText,lowButtonText:i.lowButtonText,screenTitle:i.screenTitle,questionText:i.questionText,questionShortText:i.questionShortText,descriptionText:i.descriptionText,upsell:{fromAmount:null!==(e=this.preDonationUpsellDataPoint.upsellInitialAmount)&&void 0!==e?e:0,fromAmountInUSD:null!==(t=this.preDonationUpsellDataPoint.upsellInitialAmountInUsd)&&void 0!==t?t:0},processingState:{lowMonthly:Xl.IDLE,highMonthly:Xl.IDLE}}}confirmUpsell(e){e?this.acceptUpsell(e):this.rejectUpsell()}get preDonationUpsellDataPoint(){return this.checkoutState.preDonationUpsell.dataPoint}acceptUpsell(e){this.checkoutState.preDonationUpsell.confirm(!0),this.setDonationParams({frequency:this.preDonationUpsellDataPoint.upsellFrequency,amount:e===YN.HIGH?this.preDonationUpsellDataPoint.upsellHighAmount:this.preDonationUpsellDataPoint.upsellLowAmount})}rejectUpsell(){this.checkoutState.preDonationUpsell.confirm(!1),this.setDonationParams({frequency:qn.ONCE,amount:this.preDonationUpsellDataPoint.upsellInitialAmount})}setDonationParams(e){this.checkoutState.donation.dataPoint.frequency===e.frequency&&this.checkoutState.donation.dataPoint.amount===e.amount||(this.checkoutState.donation.setDonationsFrequency(e.frequency),this.checkoutState.donation.setDonationsAmount(e.amount))}getViewTexts(){var e,t,n;const i=this.preDonationUpsellDataPoint.upsellFrequency,s=this.preDonationUpsellDataPoint.upsellCurrency,a=null!==(e=this.preDonationUpsellDataPoint.upsellHighAmount)&&void 0!==e?e:0,o=null!==(t=this.preDonationUpsellDataPoint.upsellLowAmount)&&void 0!==t?t:0,r=null!==(n=this.preDonationUpsellDataPoint.upsellInitialAmount)&&void 0!==n?n:0;return{highButtonText:this.intl.translate(WM[i],{amount:this.getFormattedAmount(a,s)}),lowButtonText:this.intl.translate($M[i],{amount:this.getFormattedAmount(o,s)}),screenTitle:this.intl.translate(XM[i]),questionText:this.intl.translate(QM[i],{amount:this.getFormattedAmount(r,s)}),questionShortText:this.intl.translate(ZM[i],{amount:this.getFormattedAmount(r,s)}),descriptionText:this.intl.translate(JM[i])}}getFormattedAmount(e,t){return this.intl.formatAmount({amount:e,currency:t,numberFormat:Kt.FLOAT,currencyFormat:Yt.SHORT,forceExplicit:!0})}}class tL extends dx{constructor(e){super(e),this.logs=[],this.logsUrl=null,this.isLogsSent=!1,this.applePayPromiseResolver=null,this.paymentService=e.paymentService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.isMicrophoneAvailable();this.produceViewState((t=>{t.step=e?If.CONVERSATION_STARTING:If.PERMISSIONS}))}))}askForMicrophonePermission(){return(0,d.sH)(this,void 0,void 0,(function*(){try{yield navigator.mediaDevices.getUserMedia({audio:!0}),this.produceViewState((e=>{e.step=If.CONVERSATION_STARTING}))}catch(e){}}))}getConversationSession(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=this.checkoutService.checkoutConfiguration.getAskPageConfig(!1),n=Gs.getDefaultFrequency(this.checkoutService.checkoutConfiguration.campaign.config.frequencies),i=Gs.getSecondaryFrequency(this.checkoutService.checkoutConfiguration.campaign.config.frequencies);if(!n||!i)throw new Error("Failed to find frequencies");const s=this.currencyService.toFloat(Math.min(this.checkoutState.donation.dataPoint.getFrequencyMinimalAmount(n),this.checkoutState.donation.dataPoint.getFrequencyMinimalAmount(i)),tL.CURRENCY),a=[],o=this.checkoutState.paymentOptions.paymentOptionsDataPoint.allowedPaymentMethods;o[Gn.APPLE_PAY].available&&o[Gn.APPLE_PAY].visible&&a.push(Gn.APPLE_PAY),o[Gn.CARD].available&&o[Gn.CARD].visible&&a.push(Gn.CARD);const r={campaignKey:this.checkoutService.checkoutConfiguration.campaign.key,companyKey:this.checkoutService.checkoutConfiguration.company.key,companyName:this.checkoutService.checkoutConfiguration.company.name,companyWebsite:window.location.hostname||"organization website",description:`${t.title}\n${t.text}`,minAmount:s,frequencyOne:n,frequencyTwo:i,enabledPaymentOptions:a},l=yield this.checkoutService.sessionAPI.post("voice/session",r,{rejectsOnInvalid:!0});if(wn.isFailure(l))throw this.log("voice session start failed (can not receive client token)"),new Error("Failed to receive client token");this.log("voice session start success (client token received)");const c=l.successResult.token,u=yield fetch("https://api.openai.com/v1/realtime/calls?model=gpt-4o-realtime-preview-2025-06-03",{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/sdp"},body:e.sdp});if(!u.ok)throw this.log("voice session failed (can not receive remote SDP)"),new Error("Failed to receive remote SDP");this.log("voice session success (remote SDP received)");const d=yield u.text();return this.logsUrl=l.successResult.url,{type:"answer",sdp:d}}))}log(e){var t;null===(t=this.debug)||void 0===t||t.log("DonationByVoice: voice conversation log",e),this.logs.push({timestamp:Date.now(),message:e})}handleConversationStarted(){return(0,d.sH)(this,void 0,void 0,(function*(){yield Ri(1e3),this.produceViewState((e=>{e.step=If.CONVERSATION_START}))}))}handleStoreDonorInfoCommand(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.checkoutService.isPaid)return!0;switch(e){case"amount":{const e=100*Number.parseFloat(t.trim());if(this.produceViewState((e=>{e.step=If.DONATION_AMOUNT})),Number.isNaN(e)||!(e>0))return!1;this.checkoutState.donation.setCurrency(tL.CURRENCY),this.checkoutState.donation.setDonationsAmount(e),this.checkoutState.donation.setFeeCovered(!1,{isCustomFeeCoveredValue:!0}),this.produceViewState((e=>{var t;e.donationAmount=this.intl.formatCurrency(null!==(t=this.checkoutState.donation.dataPoint.amount)&&void 0!==t?t:0,{currency:tL.CURRENCY,display:"fulltrimzeroes"})}));break}case"frequency":{const e=t.trim();if(this.produceViewState((e=>{e.step=If.DONATION_AMOUNT})),!Object.values(qn).includes(e))return!1;this.checkoutState.donation.setDonationsFrequency(e),this.produceViewState((e=>{e.donationFrequency=this.checkoutState.donation.dataPoint.frequency}));break}case"name":{const e=t.trim();if(this.produceViewState((e=>{e.step=If.CUSTOMER_NAME})),!e)return!1;e&&(this.checkoutState.privacy.setDonorFullName(e),this.produceViewState((e=>{e.firstName=this.checkoutState.privacy.donorNameDataPoint.firstName,e.lastName=this.checkoutState.privacy.donorNameDataPoint.lastName})));break}case"email":{const e=t.trim();if(this.produceViewState((t=>{t.step=If.CUSTOMER_EMAIL,t.email=e})),!Ia(e))return!1;this.checkoutState.privacy.setDonorEmail(e);const n=yield this.checkoutService.updateSession();if(wn.isFailure(n)&&n.failureResult.customerEmailError)return!1;this.produceViewState((e=>{e.email=this.checkoutState.privacy.donorEmailDataPoint.email}));break}case"card_number":{const e=t.trim();this.produceViewState((t=>{t.step=If.PAYMENT_CARD,t.cardNumber=e}));break}case"card_expiry":{const e=t.trim();this.produceViewState((t=>{t.step=If.PAYMENT_CARD,t.cardExpirationDate=e}));break}case"card_cvc":{const e=t.trim();this.produceViewState((t=>{t.step=If.PAYMENT_CARD,t.cardCvc=e}));break}}return this.checkoutService.updateSession(),!0}))}handleProcessCardPaymentCommand(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i;return this.checkoutService.isPaid?{isSuccess:!0,donationAmount:null!==(e=this.viewState.donationAmount)&&void 0!==e?e:"",cardNumberLast4:(null!==(t=this.viewState.cardNumber)&&void 0!==t?t:"").slice(-4)}:(this.pending=!0,this.log("card payment processing started"),yield Ri(5e3),this.checkoutState.process.setCompleted({donationId:"",customerId:""}),yield this.checkoutService.tryCloseSession(),this.log('card "payment" success'),setTimeout((()=>this.sendLogs()),ns.MS.MINUTE),this.pending=!1,this.produceViewState((e=>{e.step=If.THANK_YOU})),{isSuccess:!0,donationAmount:null!==(n=this.viewState.donationAmount)&&void 0!==n?n:"",cardNumberLast4:(null!==(i=this.viewState.cardNumber)&&void 0!==i?i:"").slice(-4)})}))}handleProcessApplePayPaymentCommand(){return(0,d.sH)(this,void 0,void 0,(function*(){var e;return this.checkoutService.isPaid?{isSuccess:!0,donationAmount:null!==(e=this.viewState.donationAmount)&&void 0!==e?e:""}:(this.produceViewState((e=>{e.step=If.PAYMENT_APPLE_PAY})),new Promise((e=>{this.applePayPromiseResolver=e})))}))}handleHangUpCommand(){this.log("voice conversation ended (hang up)"),this.sendLogs(),this.checkoutService.isPaid||this.goBack()}handleConversationError(){this.log("voice conversation ended (error)"),this.goBack()}handleApplePayButtonClick(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t,n,i;this.log("user clicked apple pay button"),this.pending=!0,this.checkoutState.paymentOptions.setPaymentMethod(Gn.APPLE_PAY),this.checkoutState.paymentOptions.setPaymentOption(ch.APPLE_PAY);const s=yield this.paymentService.startApplePay();if(wn.isFailure(s))return this.log("apple pay payment failed on stage start"),null===(e=this.applePayPromiseResolver)||void 0===e||e.call(this,{isSuccess:!1}),void(this.pending=!1);const a=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});if(wn.isFailure(a))return null===(t=this.applePayPromiseResolver)||void 0===t||t.call(this,{isSuccess:!1}),this.log("apple pay payment failed on stage pay"),void(this.pending=!1);yield this.checkoutService.tryCloseSession(),null===(n=this.applePayPromiseResolver)||void 0===n||n.call(this,{isSuccess:!0,donationAmount:null!==(i=this.viewState.donationAmount)&&void 0!==i?i:""}),this.log("apple pay payment success"),setTimeout((()=>this.sendLogs()),ns.MS.MINUTE),this.pending=!1,this.produceViewState((e=>{e.step=If.THANK_YOU}))}))}handleConversationEndCallButtonClick(){this.log("voice conversation ended (end call button clicked)"),this.goBack()}handlePermissionsEndCallButtonClick(){this.goBack()}handleCheckoutClosed(){this.log("voice conversation ended (checkout closed)"),this.sendLogs()}getInitialViewState(){return{step:If.PERMISSIONS,donationAmount:null,donationFrequency:null,firstName:null,lastName:null,email:null,cardNumber:null,cardExpirationDate:null,cardCvc:null,locked:!1}}isMicrophoneAvailable(){return(0,d.sH)(this,void 0,void 0,(function*(){try{return"granted"===(yield navigator.permissions.query({name:"microphone"})).state}catch(e){return!1}}))}goBack(){return(0,d.sH)(this,void 0,void 0,(function*(){this.sendLogs(),this.flow.prev()}))}sendLogs(){var e;if(!this.logs.length)return;if(!this.logsUrl)return;if(this.isLogsSent)return;this.isLogsSent=!0,null===(e=this.debug)||void 0===e||e.log("DonationByVoice: send logs",this.logs);const t={widgetSessionKey:this.checkoutService.sessionAPI.sessionToken,companyKey:this.checkoutService.checkoutConfiguration.company.key,campaignKey:this.checkoutService.checkoutConfiguration.campaign.key},n=this.logs.map((e=>Object.assign(Object.assign({},t),{timestamp:e.timestamp,message:e.message})));fetch(this.logsUrl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),this.logs=[]}}tL.CURRENCY="USD";class nL extends dx{constructor(e){super(e),this.paymentService=e.paymentService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{var t;e.isPaymentScreen=this.isPaymentScreen,e.formattedAmount=this.intl.formatCurrency(null!==(t=this.donationDataPoint.total)&&void 0!==t?t:0,{currency:this.donationDataPoint.currency,display:"floatcents"}),e.frequency=this.donationDataPoint.frequency}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;if(this.pending=!0,this.setProcessingState(Xl.PENDING),this.produceViewState((e=>{e.payErrorMessage=""})),!(yield this.paymentService.startAuBECSFlow()))return this.produceViewState((e=>{e.shakeKey+=1,e.processingState=Xl.IDLE})),this.pending=!1,!1;const e=yield this.checkoutService.hold();return wn.isFailure(e)?(this.pending=!1,yield this.showError(),!1):this.isPaymentScreen?this.pay():(this.pending=!1,!0)}))}initiateAuBECS(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return this.paymentService.initiateAuBECS(e,t)}))}getInitialViewState(){return{locked:!1,accountNumber:null,bsbNumber:null,shakeKey:0,accountHolderName:"",termsChecked:!0,errors:{},processingState:Xl.IDLE,isPaymentScreen:!1,formattedAmount:"",frequency:qn.ONCE}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isFailure(e)?e.failureResult.shouldLeave?(this.pending=!1,!0):(this.pending=!1,yield this.showError(),!1):(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),this.pending=!1,!0)}))}showError(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}))}))}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}}const iL=[ks.EMAIL,ks.SMS,ks.PHONE_CALLS,ks.POSTAL_MAIL,ks.SOCIAL_MEDIA];class sL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.channels=this.prepareChannels()}))}))}changeChannel(e,t){this.checkoutState.communicationConsent.setCustomizedChannelState(e,t),this.produceViewState((e=>{e.channels=this.prepareChannels()}))}resetChannels(){this.checkoutState.communicationConsent.resetCustomizedConsent()}setCustomizedConsentShown(){this.checkoutState.communicationConsent.setCustomizedConsentShown()}beforeLeave(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.updateSession(),!0}))}getInitialViewState(){return{locked:!1,channels:[]}}prepareChannels(){return iL.filter((e=>this.checkoutState.communicationConsent.dataPoint.customizedConsent[e].isEnabled)).map((e=>({type:e,isAccepted:this.checkoutState.communicationConsent.dataPoint.customizedConsent[e].isAccepted})))}}class aL extends dx{constructor(e){super(e),this._fastTrackPaymentOptionsViewService=null,this.paymentService=e.paymentService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.handleErrors(),this.syncPaymentButtons(),this.initializePaymentOptions(),this.resetPaymentOptions(),this.checkoutService.updateSession(),this.produceViewState((e=>{e.isInited=!0,e.currency=this.donationDataPoint.currency,e.currencySymbol=this.currencyService.getSymbol(this.donationDataPoint.currency),e.defaultCurrency=this.checkoutService.checkoutConfiguration.defaultCurrency,e.amount=this.donationDataPoint.amount||(this.isShowcase?1e4:0),e.frequency=this.donationDataPoint.frequency,e.total=!this.donationDataPoint.amount&&this.isShowcase?10600:this.donationDataPoint.total,e.processingFee=!this.donationDataPoint.amount&&this.isShowcase?600:this.donationDataPoint.fee,e.isFeeCovered=this.donationDataPoint.isFeeCovered,e.includeFees=this.donationDataPoint.includeFees,e.showIncludeFee=this.isIncludeFeesSectionVisible(this.donationDataPoint.includeFees),e.prefixCurrencySymbol=this.intl.formatSymbol(this.currencyService.getSymbol(this.donationDataPoint.currency),Ht.PREFIX),e.postfixCurrencySymbol=this.intl.formatSymbol(this.currencyService.getSymbol(this.donationDataPoint.currency),Ht.POSTFIX),e.isRecurring=this.donationDataPoint.frequency!==qn.ONCE,e.recurringLabel=this.recurringLabel,e.isBackFlowDisabled=this.checkoutService.checkoutConfiguration.isRestoredByWidgetSession,e.showAnonymous=this.donateAnonymousDataPoint.isEnabled,e.anonymousChecked=this.donateAnonymousDataPoint.isAnonymousChecked,e.generalConsent={isAccepted:this.communicationConsentDataPoint.generalConsent.isAccepted,isEnabled:this.communicationConsentDataPoint.isGeneralConsentEnabled},e.onBehalfOf.companyName=this.onBehalfOfDataPoint.companyName,e.onBehalfOf.isEnabled=this.onBehalfOfDataPoint.isEnabled,e.onBehalfOf.isActive=this.onBehalfOfDataPoint.isActive,e.termsAndConditions.text=this.termsAndConditionsDataPoint.text,e.termsAndConditions.isEnabled=this.termsAndConditionsDataPoint.isEnabled,e.termsAndConditions.isAccepted=this.termsAndConditionsDataPoint.isAccepted}))}))}beforeLeave(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.updateSession(),this.pay()}))}choosePaymentOption(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.pending&&(this.resetError(),this.lock(),this.validateAndProduceViewStateErrors()))switch(this.checkoutState.paymentOptions.setPaymentMethod(null),this.checkoutState.paymentOptions.setPaymentOption(e),e){case ch.GOOGLE_PAY:return this.isShowcase?void this.unlock():(this.checkoutState.paymentOptions.setPaymentMethod(Gn.GOOGLE_PAY),this.resetDonorData(),void(yield this.startGooglePay({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide})));case ch.APPLE_PAY:return this.isShowcase?void this.unlock():(this.checkoutState.paymentOptions.setPaymentMethod(Gn.APPLE_PAY),this.resetDonorData(),void(yield this.startApplePay({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide})));case ch.PAYPAL:throw new Error("Paypal method can not be chosen");default:throw new Bs.HP(e)}}))}goToPrivacyScreen(){this.flow.goTo(wl.PRIVACY)}closePaypalButton(){return this.paymentService.closePaypalButton()}initiatePaypal(e){let{element:t,buttonColor:n,onClick:i,onHide:s}=e;return this.isShowcase?Promise.resolve(!1):this.paymentService.initiatePaypal({element:t,buttonColor:n,holdDone:()=>{null==s||s(),this.leave()},onFail:e=>{null==s||s(),this.resetPaymentOptions(),this.unlock(),"Window is closed"!==e.message&&this.showError({title:this.intl.translate("fastTrackPaymentOptionsScreen.error.title"),message:this.intl.translate("fastTrackPaymentOptionsScreen.error.message",{link:"#"})})},onCancel:()=>{this.resetPaymentOptions(),this.unlock(),null==s||s()},onButtonClick:()=>{this.resetError(),this.lock(),this.checkoutState.paymentOptions.setPaymentOption(null),this.resetDonorData(),null==i||i()},validate:()=>this.validateAndProduceViewStateErrors()})}togglePaypalActions(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.paymentService.togglePaypalActions(e)}))}startGooglePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentService.startGooglePay(e);this.unlock(),wn.isSuccess(t)?yield this.leave():(this.resetPaymentOptions(),t.failureResult.message&&this.showError({title:this.intl.translate("fastTrackPaymentOptionsScreen.error.title"),message:this.intl.translate("fastTrackPaymentOptionsScreen.error.message",{link:"#"})}))}))}startApplePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentService.startApplePay(e);this.unlock(),wn.isSuccess(t)?yield this.leave():(this.resetPaymentOptions(),t.failureResult.message&&this.showError({title:this.intl.translate("fastTrackPaymentOptionsScreen.error.title"),message:this.intl.translate("fastTrackPaymentOptionsScreen.error.message",{link:"#"})}))}))}toggleFeeCovered(){this.checkoutState.donation.setFeeCovered(!this.donationDataPoint.isFeeCovered,{isCustomFeeCoveredValue:!0}),this.produceViewState((e=>{e.isFeeCovered=this.donationDataPoint.isFeeCovered,e.total=this.donationDataPoint.total})),this.syncButtonsAvailability(),this.checkoutService.syncUpdateCheckoutState()}syncPaymentButtons(){this.syncButtonsAvailability()}getFrequency(){return this.donationDataPoint.frequency}getCurrency(){return this.donationDataPoint.currency}toggleOnBehalfOf(){this.checkoutState.privacy.setOnBehalfOfActive(!this.onBehalfOfDataPoint.isActive),this.produceViewState((e=>{e.onBehalfOf.isActive=this.onBehalfOfDataPoint.isActive}))}toggleTermsAndConditionsAccepted(){this.checkoutState.privacy.setTermsAndConditionsAccepted(!this.termsAndConditionsDataPoint.isAccepted),this.produceViewState((e=>{var t;(null===(t=e.validation.isAccepted)||void 0===t?void 0:t.isValid)||(e.validation.isAccepted=qI.defaultValidationResult),e.termsAndConditions.isAccepted=this.termsAndConditionsDataPoint.isAccepted}))}toggleAnonymousChecked(){this.checkoutState.privacy.setDonateAnonymousChecked(!this.donateAnonymousDataPoint.isAnonymousChecked),this.produceViewState((e=>{e.anonymousChecked=this.donateAnonymousDataPoint.isAnonymousChecked}))}toggleGeneralConsentChecked(e){this.checkoutState.communicationConsent.setGeneralConsentState(e),this.produceViewState((e=>{e.generalConsent.isAccepted=this.communicationConsentDataPoint.generalConsent.isAccepted}))}setGeneralConsentShown(){this.checkoutState.communicationConsent.setGeneralConsentShown()}changeCompanyName(e){this.checkoutState.privacy.setOnBehalfOfCompanyName(e),this.produceViewState((e=>{e.validation.onBehalfOf.isValid||(e.validation.onBehalfOf=RI.defaultValidationResult),e.onBehalfOf.companyName=this.onBehalfOfDataPoint.companyName}))}validateAndProduceViewStateErrors(){let e=!1;return this.produceViewState((t=>{t.validation.isAccepted=this.termsAndConditionsDataPoint.getValidationResult(),t.validation.onBehalfOf=this.onBehalfOfDataPoint.getValidationResult(),e=this.checkHasError(t),e&&(t.shakeKey+=1)})),!e||(this.unlock(),!1)}resetError(){this.produceViewState((e=>{e.paymentError.title=void 0,e.paymentError.message=void 0}))}getInitialViewState(){return{isInited:!1,showIncludeFee:!0,livemode:this.isLivemode,showTestModeTooltipInfo:this.showTestModeTooltipInfo,amount:0,currency:"USD",currencySymbol:"$",prefixCurrencySymbol:"",postfixCurrencySymbol:"",allowCentsForCharges:this.checkoutService.company.allowCentsForCharges,frequency:qn.ONCE,includeFees:sC.DEFAULT_YES,processingFee:0,total:0,defaultCurrency:"USD",isFeeCovered:!1,availableOptions:[],buttonOptions:Object.fromEntries(Object.values([ch.APPLE_PAY,ch.GOOGLE_PAY,ch.PAYPAL]).map((e=>[e,{visible:!1}]))),paymentError:{},locked:!1,shakeKey:0,isRecurring:!0,recurringLabel:"",isBackFlowDisabled:!1,termsAndConditions:{isAccepted:!1,isEnabled:!1,text:""},onBehalfOf:{isEnabled:!1,isActive:!1,companyName:""},generalConsent:{isAccepted:!1,isEnabled:!1},anonymousChecked:!1,showAnonymous:!1,mailingListSubscription:{show:!1,checked:!1,text:""},validation:{onBehalfOf:RI.defaultValidationResult,isAccepted:qI.defaultValidationResult},serverErrors:{}}}get isShowcase(){return this.checkoutService.checkoutConfiguration.infrastructureParams.showcase}get isLivemode(){return this.checkoutService.checkoutConfiguration.infrastructureParams.livemode}get showTestModeTooltipInfo(){return!this.isShowcase&&!this.isLivemode}get recurringLabel(){return nh(this.intl,this.donationDataPoint.frequency)}get fastTrackPaymentOptionsViewService(){return this._fastTrackPaymentOptionsViewService||(this._fastTrackPaymentOptionsViewService=new Cx(this.checkoutService.checkoutConfiguration)),this._fastTrackPaymentOptionsViewService}get paymentOptionsDataPoint(){return this.checkoutState.paymentOptions.paymentOptionsDataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get donateAnonymousDataPoint(){return this.checkoutState.privacy.donateAnonymousDataPoint}get communicationConsentDataPoint(){return this.checkoutState.communicationConsent.dataPoint}get onBehalfOfDataPoint(){return this.checkoutState.privacy.onBehalfOfDataPoint}get termsAndConditionsDataPoint(){return this.checkoutState.privacy.termsAndConditionsDataPoint}checkHasError(e){return Object.keys(e.validation).some((t=>{const n=e.validation[t];return!!n&&!n.isValid}))}syncButtonsAvailability(){const e=this.fastTrackPaymentOptionsViewService.getPaymentButtons(this.paymentOptionsDataPoint.allowedPaymentMethods);this.produceViewState((t=>{const n=e.available;Jo()(t.availableOptions,n)||(t.availableOptions=n);const i=this.paymentOptionsDataPoint.preSelectedFastTrackPaymentOption&&e.available.includes(this.paymentOptionsDataPoint.preSelectedFastTrackPaymentOption);for(const[n,s]of Object.entries(t.buttonOptions))s.visible=i?n===this.paymentOptionsDataPoint.preSelectedFastTrackPaymentOption:e.visible.some((e=>e===n))}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){this.setPaymentLoader();const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen(),isFastTrackFlow:!0});return wn.isFailure(e)?(this.removePaymentLoader(),this.unlock(),!!e.failureResult.shouldLeave||((()=>{switch(!0){case!!this.paymentOptionsDataPoint.selectedPaymentOption:return this.paymentOptionsDataPoint.selectedPaymentOption;case this.paymentOptionsDataPoint.clientPaymentMethod===Gn.PAYPAL:return ch.PAYPAL;default:return null}})()&&this.showError({title:this.intl.translate("fastTrackPaymentOptionsScreen.error.title"),message:this.intl.translate("fastTrackPaymentOptionsScreen.error.message",{link:"#"})}),!1)):(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave?yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave):this.removePaymentLoader(),this.unlock(),!0)}))}setPaymentLoader(){this.checkoutService.checkoutUIState.showPaymentLoader=!0,this.checkoutService.syncUpdateCheckoutState()}removePaymentLoader(){this.checkoutService.checkoutUIState.showPaymentLoader=!1,this.checkoutService.syncUpdateCheckoutState()}lock(){this.togglePaypalActions(!1),this.pending=!0}unlock(){this.togglePaypalActions(!0),this.pending=!1}resetPaymentOptions(){this.checkoutState.paymentOptions.setPaymentMethod(null),this.checkoutState.paymentOptions.setPaymentOption(null)}resetDonorData(){this.checkoutState.privacy.setDonorFirstName(""),this.checkoutState.privacy.setDonorLastName(""),this.checkoutState.privacy.setDonorEmail(""),this.checkoutState.privacy.setPhoneNumber(null),this.checkoutState.privacy.setPhoneCleanNumber(null),this.checkoutState.mailingAddress.setLine1(""),this.checkoutState.mailingAddress.setLine2(""),this.checkoutState.mailingAddress.setCity(""),this.checkoutState.mailingAddress.setRegion(""),this.checkoutState.mailingAddress.setPostal("")}showError(e){let{title:t,message:n}=e;this.produceViewState((e=>{e.paymentError.title=t,e.paymentError.message=n}))}handleErrors(){this.processDataPoint.hasPaymentError&&(this.paymentOptionsDataPoint.clientPaymentMethod===Gn.PAYPAL&&this.showError({title:this.intl.translate("fastTrackPaymentOptionsScreen.error.title"),message:this.intl.translate("fastTrackPaymentOptionsScreen.error.message",{link:"#"})}),this.checkoutState.process.setInProgress())}isIncludeFeesSectionVisible(e){return[sC.DEFAULT_YES,sC.DEFAULT_NO,sC.SMART_COVERING].includes(e)}initializePaymentOptions(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.paymentService.ensurePaymentMethodsInitialized(),this.syncPaymentButtons()}))}}class oL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState.giftAid.reject(),this.produceViewState((e=>{var t;e.formattedAmount=this.intl.formatCurrency(null!==(t=this.donationDataPoint.total)&&void 0!==t?t:0,{currency:this.donationDataPoint.currency,display:"floatcents"}),e.frequency=this.donationDataPoint.frequency,e.legalText=this.giftAidDataPoint.legalText}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;if(this.pending=!0,this.checkoutService.updateSession(),!this.isPaymentScreen)return this.pending=!1,!0;this.produceViewState((e=>{e.processingState=Xl.PENDING}));const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(e)||e.failureResult.shouldLeave?(this.pending=!1,!0):(this.produceViewState((e=>{e.payErrorMessage=this.checkoutService.payErrorMessage,e.processingState=Xl.ERROR})),this.pending=!1,!1)}))}changeGiftAid(e){e?this.checkoutState.giftAid.accept():this.checkoutState.giftAid.reject()}setShown(){this.checkoutState.giftAid.setShowed()}getInitialViewState(){return{locked:!1,showcase:this.checkoutService.checkoutConfiguration.infrastructureParams.showcase,formattedAmount:"",frequency:qn.MONTHLY,legalText:"",processingState:Xl.IDLE}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}get giftAidDataPoint(){return this.checkoutState.giftAid.dataPoint}}class rL extends dx{constructor(e){super(e),this.paymentService=e.paymentService}get showNextStepOverview(){return!(this.pending&&this.shouldPaymentRestore||this.viewState.processingState===Xl.SUCCESS)}back(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.flow.canGoBack)return(yield this.withPending((()=>this.paymentService.isIDEALPaid())))?this.leave():this.flow.prev()}))}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{var t;e.email=this.donorEmailDataPoint.email,e.name=this.donorNameDataPoint.fullName,e.formattedAmount=this.intl.formatCurrency(null!==(t=this.donationDataPoint.total)&&void 0!==t?t:0,{currency:this.donationDataPoint.currency,display:"floatcents"}),e.frequency=this.donationDataPoint.frequency,e.isSubscription=this.donationDataPoint.frequency!==qn.ONCE,e.shouldPaymentRestore=this.shouldPaymentRestore}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.checkoutConfiguration.paymentOptionsSettings.isNewIdealPaymentFlowEnabled?this.beforeLeaveNew():this.beforeLeaveOld()}))}beforeLeaveOld(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING),this.produceViewState((e=>{e.showReturnBankInfo=!0})),this.paymentService.openIDEALConfirmationWindow({onClose:()=>{this.produceViewState((e=>{e.showReturnBankInfo=!1}))}});const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(e)?(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),this.pending=!1,!0):e.failureResult.shouldLeave?(this.pending=!1,!0):(this.setProcessingState(Xl.ERROR),this.pending=!1,!1)}))}beforeLeaveNew(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING);const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen(),shouldSaveScreenHistory:!this.shouldPaymentRestore});return wn.isSuccess(e)?(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),this.pending=!1,!0):e.failureResult.shouldLeave?(this.pending=!1,!0):(this.setProcessingState(Xl.ERROR),this.pending=!1,!1)}))}returnToBankWindow(){this.paymentService.focusIDEALConfirmationWindow()}getInitialViewState(){return{locked:!1,email:"",name:"",processingState:Xl.IDLE,formattedAmount:"",frequency:qn.ONCE,isSubscription:!1,errorMessage:"",showReturnBankInfo:!1,forceShowBackButton:!1,shouldPaymentRestore:!1}}get shouldPaymentRestore(){return this.checkoutService.checkoutConfiguration.isRestoredByWidgetSession&&!this.paymentService.isIDEALPaymentRestored()}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}setProcessingState(e){return e===Xl.ERROR&&this.produceViewState((e=>{e.errorMessage=this.checkoutService.payErrorMessage})),this.produceViewState((t=>{t.processingState=e,t.forceShowBackButton=e===Xl.ERROR})),this}}class lL{constructor(e){this.checkoutConfiguration=e,this._paymentMethodSorter=null}get paymentMethodSorter(){return this._paymentMethodSorter||(this._paymentMethodSorter=new Ax({specificCompanyCountry:this.checkoutConfiguration.company.country})),this._paymentMethodSorter}getPaymentButtons(e){const t={available:[],visible:[]};return this.paymentMethodSorter.sort(e).forEach((e=>{let{paymentMethod:n,available:i,visible:s}=e;if(n===Gn.APPLE_PAY&&i&&(t.available.push(ch.APPLE_PAY),s&&t.visible.push(ch.APPLE_PAY)),n===Gn.CARD&&i&&(t.available.push(ch.CARD),s&&t.visible.push(ch.CARD)),n===Gn.PAYPAL&&i&&(t.available.push(ch.PAYPAL),s&&t.visible.push(ch.PAYPAL)),n===Gn.GOOGLE_PAY&&i&&(t.available.push(ch.GOOGLE_PAY),s&&t.visible.push(ch.GOOGLE_PAY)),n===Gn.VENMO&&i&&(t.available.push(ch.VENMO),s&&t.visible.push(ch.VENMO)),n===Gn.US_BANK_ACCOUNT&&i){const e=this.checkoutConfiguration.company.stripe.usBankAccount.verification,n=WI(e)||KI(e),i=$I(e);n?(t.available.push(ch.US_BANK_ACCOUNT_INSTANT),s&&t.visible.push(ch.US_BANK_ACCOUNT_INSTANT)):i?(t.available.push(ch.US_BANK_ACCOUNT),s&&t.visible.push(ch.US_BANK_ACCOUNT)):(t.available.push(ch.US_BANK_ACCOUNT_VERIFICATION),s&&t.visible.push(ch.US_BANK_ACCOUNT_VERIFICATION))}n===Gn.UK_BACS&&i&&(t.available.push(ch.UK_BACS),s&&t.visible.push(ch.UK_BACS)),n===Gn.AU_BECS&&i&&(t.available.push(ch.AU_BECS),s&&t.visible.push(ch.AU_BECS)),n===Gn.ACSS&&i&&(t.available.push(ch.ACSS),s&&t.visible.push(ch.ACSS)),n===Gn.SEPA&&i&&(t.available.push(ch.SEPA),s&&t.visible.push(ch.SEPA)),n===Gn.IDEAL&&i&&(t.available.push(ch.IDEAL),s&&t.visible.push(ch.IDEAL))})),t}}const cL=(e,t)=>{if(0===t||!t)return 0;const n=((e,t)=>0===e?0:t/e*100)(t,e);return i=n,Math.round(10*i)/10;var i};class uL extends dx{constructor(e){super(e),this.frequency=qn.ONCE,this._paymentOptionsViewService=null,this.paymentService=e.paymentService,this._paymentOptionListService=e.paymentOptionListService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.handleErrors(),this.syncPaymentButtons(),this.initializePaymentOptions(),this.exposeFeeCoverageSelectionExperiments(),this.resetCoverageLevelIfExperimentBecomeDisabled(),this.checkoutService.exposeSmartCoveringFeeExperimentV2(),this.checkoutService.exposureSmartCoveringFeeV4Experiment(),this.checkoutService.stripeLinkExperimentExpose(),this.checkoutService.updateSession(),this.resetPaymentOptions(),this.produceViewState((e=>{e.isInited=!0,e.currency=this.donationDataPoint.currency,e.currencySymbol=this.currencyService.getSymbol(this.donationDataPoint.currency),e.defaultCurrency=this.checkoutService.checkoutConfiguration.defaultCurrency,e.amount=this.donationDataPoint.amount||(this.isShowcase?1e4:0),e.frequency=this.donationDataPoint.frequency,e.total=!this.donationDataPoint.amount&&this.isShowcase?10600:this.donationDataPoint.total,e.processingFee=!this.donationDataPoint.amount&&this.isShowcase?600:this.donationDataPoint.fee,e.isFeeCovered=this.donationDataPoint.isFeeCovered,e.includeFees=this.donationDataPoint.includeFees,e.showIncludeFee=this.isIncludeFeesSectionVisible(this.donationDataPoint.includeFees),e.prefixCurrencySymbol=this.intl.formatSymbol(this.currencyService.getSymbol(this.donationDataPoint.currency),Ht.PREFIX),e.postfixCurrencySymbol=this.intl.formatSymbol(this.currencyService.getSymbol(this.donationDataPoint.currency),Ht.POSTFIX),e.isRecurring=this.donationDataPoint.frequency!==qn.ONCE,e.recurringLabel=this.recurringLabel,e.isPaymentScreen=this.isPaymentScreen,e.isBackFlowDisabled=this.checkoutService.checkoutConfiguration.isRestoredByWidgetSession,e.coverageLevel=this.donationDataPoint.coverageLevel,e.partialFee=this.partialFeePercent,e.fullFee=this.fullFeePercent,e.isFeeCoverageSelectionExperimentEnabled=this.isFeeCoverageSelectionExperimentEnabled(),e.processingPartialFee=this.donationDataPoint.partialFee,this.syncDisplayedPaymentOptions(e)}))}))}beforeLeave(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.updateSession(),this.isPaymentScreen?this.pay():(this.unlock(),!0)}))}choosePaymentOption(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.pending)switch(this.lock(),this.checkoutState.paymentOptions.setPaymentMethod(null),this.checkoutState.paymentOptions.setPaymentOption(e),e){case ch.CARD:if(this.checkoutState.paymentOptions.setPaymentMethod(Gn.CARD),this.produceViewState((e=>{e.processingCardState=Xl.PENDING})),yield this.startCreditCard(),this.viewState.processingCardState===Xl.ERROR)return;return void this.produceViewState((e=>{e.processingCardState=Xl.IDLE}));case ch.GOOGLE_PAY:return this.isShowcase?void this.unlock():(this.checkoutState.paymentOptions.setPaymentMethod(Gn.GOOGLE_PAY),void(yield this.startGooglePay({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide})));case ch.APPLE_PAY:return this.isShowcase?void this.unlock():(this.checkoutState.paymentOptions.setPaymentMethod(Gn.APPLE_PAY),void(yield this.startApplePay({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide})));case ch.UK_BACS:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.UK_BACS),this.leave();case ch.AU_BECS:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.AU_BECS),this.leave();case ch.ACSS:return this.isShowcase?void this.unlock():(this.checkoutState.paymentOptions.setPaymentMethod(Gn.ACSS),this.produceViewState((e=>{e.processingACSSState=Xl.PENDING})),yield this.paymentService.initiateACSS({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide}),yield this.startACSS(),void this.produceViewState((e=>{e.processingACSSState=Xl.IDLE})));case ch.US_BANK_ACCOUNT:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.US_BANK_ACCOUNT),this.checkoutState.paymentOptions.setPaymentOption(ch.US_BANK_ACCOUNT),this.produceViewState((e=>{e.processingUSBankAccountState=Xl.PENDING})),yield this.paymentService.initiateUSBankAccount({}),this.produceViewState((e=>{e.processingUSBankAccountState=Xl.IDLE})),this.leave();case ch.US_BANK_ACCOUNT_VERIFICATION:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.US_BANK_ACCOUNT),this.checkoutState.paymentOptions.setPaymentOption(ch.US_BANK_ACCOUNT_VERIFICATION),this.produceViewState((e=>{e.processingUSBankAccountState=Xl.PENDING})),yield this.paymentService.initiateUSBankAccount({}),this.produceViewState((e=>{e.processingUSBankAccountState=Xl.IDLE})),this.leave();case ch.US_BANK_ACCOUNT_INSTANT:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.US_BANK_ACCOUNT),this.checkoutState.paymentOptions.setPaymentOption(ch.US_BANK_ACCOUNT_INSTANT),this.produceViewState((e=>{e.processingUSBankAccountState=Xl.PENDING})),yield this.paymentService.initiateUSBankAccount({onPopupOpen:null==t?void 0:t.onModalShow,onPopupClose:null==t?void 0:t.onModalHide}),this.startUSBankAccount(ch.US_BANK_ACCOUNT_INSTANT);case ch.PAYPAL:throw new Error("Paypal method can not be chosen");case ch.VENMO:throw new Error("Venmo method can not be chosen");case ch.SEPA:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.SEPA),this.leave();case ch.IDEAL:return this.checkoutState.paymentOptions.setPaymentMethod(Gn.IDEAL),this.produceViewState((e=>{e.processingIdealState=Xl.PENDING})),this.startIDEAL();default:throw new Bs.HP(e)}}))}changeCardFilledFields(e,t){this.produceViewState((n=>{n.cardFilledFields[e]=t}),!0)}initiateCreditCard(e){return this.paymentService.initiateCreditCard(e)}startIDEAL(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.paymentService.initiateIDEAL();const e=yield this.checkoutService.hold();if(wn.isFailure(e))return this.unlock(),this.showError({option:ch.IDEAL,message:this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}),void this.produceViewState((e=>{e.processingIdealState=Xl.IDLE}));yield this.leave()}))}startCreditCard(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!(yield this.paymentService.startCreditCardFlow()))return this.resetPaymentOptions(),this.unlock(),void this.produceViewState((e=>{e.shakeKey+=1}));const e=yield this.checkoutService.hold();if(wn.isFailure(e))return this.resetPaymentOptions(),this.unlock(),void this.showError({title:this.intl.safeTranslate("creditCard.error.title"),message:this.checkoutService.payErrorMessage||this.intl.safeTranslate("common.errorOccurredText"),option:ch.CARD});yield this.leave()}))}initiateVenmo(e){return(0,d.sH)(this,arguments,void 0,(function(e){var t=this;let{element:n,onClick:i,onHide:s}=e;return function*(){yield t.paymentService.initiateVenmo({element:n,holdDone:()=>{null==s||s(),t.leave()},onFail:e=>{null==s||s(),t.resetPaymentOptions(),t.unlock(),t.showError({message:e.message||t.intl.translate("common.errorOccurredText"),option:ch.VENMO})},onCancel:()=>{t.resetPaymentOptions(),t.unlock(),null==s||s()},onButtonClick:()=>{t.lock(),t.checkoutState.paymentOptions.setPaymentOption(null),null==i||i()}}),t.syncButtonsAvailability(),t.syncMultiplePaymentOptions(),t.syncPreSelectedPaymentOption()}()}))}closePaypalButton(){return this.paymentService.closePaypalButton()}closeVenmoButton(){return this.paymentService.closeVenmoButton()}initiatePaypal(e){let{element:t,buttonColor:n,onClick:i,onHide:s}=e;return this.isShowcase?Promise.resolve(!1):this.paymentService.initiatePaypal({element:t,buttonColor:n,holdDone:()=>{null==s||s(),this.leave()},onFail:e=>{null==s||s(),this.resetPaymentOptions(),this.unlock(),this.showError({message:e.message||this.intl.translate("common.errorOccurredText"),option:ch.PAYPAL})},onCancel:()=>{this.resetPaymentOptions(),this.unlock(),null==s||s()},onButtonClick:()=>{this.lock(),this.checkoutState.paymentOptions.setPaymentOption(null),null==i||i()}})}togglePaypalActions(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.paymentService.togglePaypalActions(e)}))}startGooglePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentService.startGooglePay(e);if(wn.isFailure(t)){this.resetPaymentOptions(),this.unlock();const e=t.failureResult.message;e&&this.showError({message:e,option:ch.GOOGLE_PAY})}else yield this.leave()}))}startApplePay(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentService.startApplePay(e);if(wn.isFailure(t)){this.resetPaymentOptions(),this.unlock();const e=t.failureResult.message;e&&this.showError({message:e,option:ch.APPLE_PAY})}else yield this.leave()}))}startACSS(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.paymentService.startACSS();if(wn.isFailure(e)){this.resetPaymentOptions(),this.unlock();const t=e.failureResult.message;t&&this.showError({message:t,option:ch.ACSS})}else yield this.leave()}))}startUSBankAccount(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.paymentService.startUSBankAccount();if(wn.isFailure(t)){this.resetPaymentOptions(),this.unlock();const n=t.failureResult.message;n?this.showError({message:n,option:e}):this.produceViewState((e=>{e.processingUSBankAccountState=Xl.IDLE}))}else yield this.leave()}))}toggleFeeCovered(){this.checkoutState.donation.setFeeCovered(!this.donationDataPoint.isFeeCovered,{isCustomFeeCoveredValue:!0}),this.produceViewState((e=>{e.isFeeCovered=this.donationDataPoint.isFeeCovered,e.total=this.donationDataPoint.total})),this.syncButtonsAvailability(),this.syncMultiplePaymentOptions(),this.syncPreSelectedPaymentOption(),this.checkoutService.syncUpdateCheckoutState()}selectFeeCoverageLevel(e){this.checkoutState.donation.setFeeCoverageLevel(e,{isCustomFeeCoveredValue:!0}),this.produceViewState((e=>{e.isFeeCovered=this.donationDataPoint.isFeeCovered,e.total=this.donationDataPoint.total,e.coverageLevel=this.donationDataPoint.coverageLevel})),this.syncButtonsAvailability(),this.syncMultiplePaymentOptions(),this.syncPreSelectedPaymentOption(),this.checkoutService.syncUpdateCheckoutState()}setPreSelectedPaymentOption(e){this.checkoutState.paymentOptions.setPreSelectedPaymentOption(e),this.produceViewState((t=>{t.preSelectedPaymentOption=e,this.syncDisplayedPaymentOptions(t)}))}selectPaymentOption(e){this.setPreSelectedPaymentOption(e)}setShowAllPaymentOptions(e){this.produceViewState((t=>{t.showAllPaymentOptions=e,this.syncDisplayedPaymentOptions(t)}))}toggleShowAllPaymentOptions(){this.setShowAllPaymentOptions(!this.viewState.showAllPaymentOptions)}syncPaymentButtons(){this.syncButtonsAvailability(),this.syncMultiplePaymentOptions(),this.syncPreSelectedPaymentOption()}getFrequency(){return this.donationDataPoint.frequency}getCurrency(){return this.donationDataPoint.currency}isFeeCoverageSelectionExperimentEnabled(){return this.checkoutService.checkoutConfiguration.checkoutType===Kn.PAGE?this.feeCoverageSelectionPagesExperiment.isEnabled({frequency:this.donationDataPoint.frequency,amountInUsd:this.donationDataPoint.amountInUSD||0,donationItems:this.donationDataPoint.donationItemsDto}):this.feeCoverageSelectionModalExperiment.isEnabled({frequency:this.donationDataPoint.frequency,amountInUsd:this.donationDataPoint.amountInUSD||0,donationItems:this.donationDataPoint.donationItemsDto})}getInitialViewState(){return{isInited:!1,showIncludeFee:!0,livemode:this.isLivemode,showTestModeTooltipInfo:this.showTestModeTooltipInfo,isStripeAccountConnected:this.isStripeAccountConnected,stripeElementsAvailable:this.isStripeElementsAvailable,amount:0,currency:"USD",currencySymbol:"$",prefixCurrencySymbol:"",postfixCurrencySymbol:"",allowCentsForCharges:this.checkoutService.company.allowCentsForCharges,frequency:qn.ONCE,includeFees:sC.DEFAULT_YES,processingFee:0,total:0,defaultCurrency:"USD",isFeeCovered:!1,availableOptions:[],visiblePaymentOptions:[],hiddenPaymentOptions:[],buttonOptions:Object.fromEntries(Object.values(ch).map((e=>[e,{visible:!1}]))),isMultiplePaymentOptions:!1,locked:!1,processingACSSState:Xl.IDLE,processingUSBankAccountState:Xl.IDLE,processingCardState:Xl.IDLE,processingIdealState:Xl.IDLE,shakeKey:0,cardFilledFields:{[Bv.CARD_NUMBER]:!1,[Bv.CARD_EXPIRY]:!1,[Bv.CARD_CVC]:!1},isRecurring:!0,recurringLabel:"",isPaymentScreen:!1,preSelectedPaymentOption:null,isBackFlowDisabled:!1,showAllPaymentOptions:!1,displayedPaymentOptions:[],shouldShowMoreButton:!1,coverageLevel:fN.NONE,partialFee:0,fullFee:0,isFeeCoverageSelectionExperimentEnabled:!1,processingPartialFee:0}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}get paymentOptionsDataPoint(){return this.checkoutState.paymentOptions.paymentOptionsDataPoint}get recurringLabel(){return nh(this.intl,this.donationDataPoint.frequency)}get isShowcase(){return this.checkoutService.checkoutConfiguration.infrastructureParams.showcase}get isLivemode(){return this.checkoutService.checkoutConfiguration.infrastructureParams.livemode}get showTestModeTooltipInfo(){return!this.isShowcase&&!this.isLivemode}get isStripeAccountConnected(){return!!this.checkoutService.checkoutConfiguration.company.stripeAccount}get isStripeElementsAvailable(){return this.checkoutService.checkoutConfiguration.infrastructureParams.env!==BD.h.PRODUCTION||this.checkoutService.checkoutConfiguration.infrastructureParams.isSSLEnabled}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}get availableVisiblePaymentOptions(){return this.viewState.availableOptions.filter((e=>this.viewState.buttonOptions[e].visible))}get paymentOptionsViewService(){return this._paymentOptionsViewService||(this._paymentOptionsViewService=new lL(this.checkoutService.checkoutConfiguration)),this._paymentOptionsViewService}get feeCoverageSelectionPagesExperiment(){return this.experiments.get(u.FEE_COVERAGE_SELECTION_PAGES_EXPERIMENT)}get feeCoverageSelectionModalExperiment(){return this.experiments.get(u.FEE_COVERAGE_SELECTION_MODAL_EXPERIMENT)}get fullFeePercent(){return cL(this.donationDataPoint.getFullFee,this.donationDataPoint.amount)}get partialFeePercent(){return cL(this.donationDataPoint.partialFee,this.donationDataPoint.amount)}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){this.setPaymentLoader();const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});if(wn.isFailure(e)){if(this.removePaymentLoader(),this.unlock(),e.failureResult.shouldLeave)return!0;const t=(()=>{switch(!0){case!!this.paymentOptionsDataPoint.selectedPaymentOption:return this.paymentOptionsDataPoint.selectedPaymentOption;case this.paymentOptionsDataPoint.clientPaymentMethod===Gn.PAYPAL:return ch.PAYPAL;case this.paymentOptionsDataPoint.clientPaymentMethod===Gn.VENMO:return ch.VENMO;default:return null}})();return t&&this.showError({title:this.checkoutService.payErrorTitle,message:this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText"),option:t}),!1}return this.produceViewState((e=>{e.processingCardState=Xl.SUCCESS})),this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave?yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave):this.removePaymentLoader(),this.unlock(),!0}))}exposeFeeCoverageSelectionExperiments(){const e={amountInUsd:this.donationDataPoint.amountInUSD||0,frequency:this.donationDataPoint.frequency,donationItems:this.donationDataPoint.donationItemsDto};this.checkoutService.checkoutConfiguration.checkoutType!==Kn.PAGE?this.feeCoverageSelectionModalExperiment.canBeStarted(e)&&this.feeCoverageSelectionModalExperiment.exposure():this.feeCoverageSelectionPagesExperiment.canBeStarted(e)&&this.feeCoverageSelectionPagesExperiment.exposure()}resetCoverageLevelIfExperimentBecomeDisabled(){this.donationDataPoint.coverageLevel!==fN.PARTIAL||this.isFeeCoverageSelectionExperimentEnabled()||this.checkoutState.donation.setFeeCoverageLevel(fN.FULL,{isCustomFeeCoveredValue:!0})}resetPaymentOptions(){this.checkoutState.paymentOptions.setPaymentMethod(null),this.checkoutState.paymentOptions.setPaymentOption(null)}syncButtonsAvailability(){const e=this.paymentOptionsViewService.getPaymentButtons(this.paymentOptionsDataPoint.allowedPaymentMethods);this.produceViewState((t=>{const n=e.available;Jo()(t.availableOptions,n)||(t.availableOptions=n);for(const[n,i]of Object.entries(t.buttonOptions))i.visible=e.visible.some((e=>e===n));this.syncDisplayedPaymentOptions(t)}))}syncMultiplePaymentOptions(){this.produceViewState((e=>{const t=Object.values(e.buttonOptions).filter((e=>e.visible));e.isMultiplePaymentOptions=t.length>1}))}syncPreSelectedPaymentOption(){var e;const t=this.availableVisiblePaymentOptions;null!==this.paymentOptionsDataPoint.preSelectedPaymentOption&&t.includes(this.paymentOptionsDataPoint.preSelectedPaymentOption)?this.setPreSelectedPaymentOption(this.paymentOptionsDataPoint.preSelectedPaymentOption):this.setPreSelectedPaymentOption(null!==(e=t[0])&&void 0!==e?e:null)}syncDisplayedPaymentOptions(e){const t=e.availableOptions.filter((t=>e.buttonOptions[t].visible)),n=this._paymentOptionListService.getDisplayedOptions({visibleOptions:t,selectedOption:e.preSelectedPaymentOption,showAll:e.showAllPaymentOptions});e.displayedPaymentOptions=n,e.shouldShowMoreButton=n.length<t.length,e.hiddenPaymentOptions=t.filter((e=>!n.includes(e)))}showError(e){let{title:t,message:n,option:i}=e;this.produceViewState((e=>{i!==ch.US_BANK_ACCOUNT_INSTANT&&i!==ch.US_BANK_ACCOUNT_VERIFICATION&&i!==ch.US_BANK_ACCOUNT||(e.processingUSBankAccountState=Xl.ERROR),i===ch.CARD&&(e.processingCardState=Xl.ERROR),i===ch.IDEAL&&(e.processingIdealState=Xl.ERROR),e.buttonOptions[i].errorTitle=t,e.buttonOptions[i].error=n})),window.setTimeout((()=>{this.produceViewState((e=>{i!==ch.US_BANK_ACCOUNT_INSTANT&&i!==ch.US_BANK_ACCOUNT_VERIFICATION&&i!==ch.US_BANK_ACCOUNT||(e.processingUSBankAccountState=Xl.IDLE),i===ch.CARD&&(e.processingCardState=Xl.IDLE),i===ch.IDEAL&&(e.processingIdealState=Xl.IDLE),e.buttonOptions[i].errorTitle=void 0,e.buttonOptions[i].error=void 0}))}),$s)}isIncludeFeesSectionVisible(e){return[sC.DEFAULT_YES,sC.DEFAULT_NO,sC.SMART_COVERING].includes(e)}lock(){this.togglePaypalActions(!1),this.pending=!0}unlock(){this.togglePaypalActions(!0),this.pending=!1}setPaymentLoader(){this.paymentOptionsDataPoint.selectedPaymentOption!==ch.CARD&&(this.checkoutService.checkoutUIState.showPaymentLoader=!0),this.checkoutService.syncUpdateCheckoutState()}removePaymentLoader(){this.checkoutService.checkoutUIState.showPaymentLoader=!1,this.checkoutService.syncUpdateCheckoutState()}handleErrors(){this.processDataPoint.hasPaymentError&&(this.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT&&this.paymentOptionsDataPoint.selectedPaymentOption&&this.showError({message:this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText"),option:this.paymentOptionsDataPoint.selectedPaymentOption}),this.paymentOptionsDataPoint.clientPaymentMethod===Gn.PAYPAL&&this.showError({message:this.intl.translate("common.errorOccurredText"),option:ch.PAYPAL}),this.paymentOptionsDataPoint.clientPaymentMethod===Gn.CARD&&this.showError({title:this.intl.safeTranslate("creditCard.error.title"),message:this.checkoutService.payErrorMessage||this.intl.translate("creditCard.error.message"),option:ch.CARD}),this.checkoutState.process.setInProgress())}initializePaymentOptions(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.paymentService.ensurePaymentMethodsInitialized(),this.syncPaymentButtons()}))}}class dL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{var t,n,i;e.ukBacs.accountHolderName=this.ukBacsDataPoint.accountHolderName,e.ukBacs.accountNumber=null!==(t=this.ukBacsDataPoint.accountNumber)&&void 0!==t?t:"",e.ukBacs.sortCode=null!==(n=this.ukBacsDataPoint.sortCode)&&void 0!==n?n:"",e.email=this.donorEmailDataPoint.email,e.company.stripe.ukBacsDisplayName=this.checkoutService.checkoutConfiguration.company.stripe.ukBacsDisplayName,e.formattedAmount=this.intl.formatCurrency(null!==(i=this.donationDataPoint.total)&&void 0!==i?i:0,{currency:this.donationDataPoint.currency,display:"floatcents"}),e.frequency=this.donationDataPoint.frequency}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING);const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(e)?(this.pending=!1,this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),!0):e.failureResult.shouldLeave?(this.pending=!1,!0):(this.pending=!1,yield this.showError(),!1)}))}getInitialViewState(){return{locked:!1,ukBacs:{sortCode:"",accountHolderName:"",accountNumber:""},email:"",company:{stripe:{ukBacsDisplayName:"Stripe"}},processingState:Xl.IDLE,formattedAmount:"",frequency:qn.MONTHLY}}get ukBacsDataPoint(){return this.checkoutState.paymentOptions.ukBacsDataPoint}get donorEmailDataPoint(){return this.checkoutState.privacy.donorEmailDataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}showError(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")})),this.produceViewState((e=>{e.payErrorMessage=""}),!0)}))}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}}class hL extends dx{constructor(e,t,n){super(n),this.upsellAggregate=e,this.adaptiveFeeCoveringService=t}get isLocked(){return!!this.getScreenData().locked||this.viewState.processingState.lowMonthly===Xl.PENDING||this.viewState.processingState.highMonthly===Xl.PENDING}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.upsellAggregate.getBeforeEnterViewState();this.experiments.get(u.UPSELL_SCREEN_CAMPAIGN_PAGE_V_3_EXPERIMENT).tryExposure({isAnnualTribute:e.isAnnualTribute}),this.produceViewState((t=>{t.currency=e.currency,t.targetFrequency=e.targetFrequency,t.upsell.fromAmount=e.upsell.fromAmount,t.upsell.fromAmountInUSD=e.upsell.fromAmountInUSD,t.lowAmount=e.lowAmount,t.lowAmountInUSD=e.lowAmountInUSD,t.highAmount=e.highAmount,t.highAmountInUSD=e.highAmountInUSD,t.isAnnualTribute=e.isAnnualTribute,t.highButtonText=e.highButtonText,t.lowButtonText=e.lowButtonText,t.screenTitle=e.screenTitle,t.descriptionText=e.descriptionText,t.questionText=e.questionText,t.questionShortText=e.questionShortText}))}))}setShowed(){this.checkoutState.preDonationUpsell.setShowed()}confirm(e){return this.upsellAggregate.confirmUpsell(e),this.checkoutService.campaignConfig.includeFees===sC.SMART_COVERING&&this.checkoutState.preDonationUpsell.dataPoint.isAccepted&&this.checkoutState.donation.setFeeCovered(!0,{isCustomFeeCoveredValue:!0}),this.checkoutService.updateSession(),this.checkoutService.syncUpdateCheckoutState(),this.performFeeCoveringSuggestion(),this.checkoutService.fetchFeeCoveringSuggestion(),this.leave({omitBeforeLeave:!0})}getInitialViewState(){return{locked:!1,upsell:{fromAmount:0,fromAmountInUSD:0},currency:"USD",highButtonText:"",lowButtonText:"",highAmount:0,highAmountInUSD:0,lowAmount:0,lowAmountInUSD:0,screenTitle:"",questionText:"",questionShortText:"",descriptionText:"",targetFrequency:qn.MONTHLY,isAnnualTribute:!1,processingState:{lowMonthly:Xl.IDLE,highMonthly:Xl.IDLE}}}performFeeCoveringSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){(yield this.adaptiveFeeCoveringService.tryFetchSuggestion())&&(this.adaptiveFeeCoveringService.tryApplySuggestion(),this.adaptiveFeeCoveringService.tryTrackSuggestion())}))}}class mL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.routingNumber=this.usBankAccountDataPoint.routingNumber,e.accountNumber=this.usBankAccountDataPoint.accountNumber,e.accountHolderName=this.usBankAccountDataPoint.accountHolderName})),this.processDataPoint.hasPaymentError&&(this.showError(),this.checkoutState.process.setInProgress())}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING);const e=this.usBankAccountDataPoint.getValidationResult();if(!e.isValid)return this.produceViewState((t=>{t.errors.routingNumber=!e.fields.routingNumber.isValid,t.errors.accountNumber=!e.fields.accountNumber.isValid,t.errors.accountHolderName=!e.fields.accountHolderName.isValid,t.shakeKey+=1,t.processingState=Xl.IDLE})),this.pending=!1,!1;const t=yield this.checkoutService.hold();return wn.isSuccess(t)?(this.pending=!1,!0):(this.showError(),this.pending=!1,!1)}))}changeAccountNumber(e){e.length>17||(this.checkoutState.paymentOptions.setUsBankAccountNumber(e),this.produceViewState((e=>{e.errors.accountNumber=!1,e.accountNumber=this.usBankAccountDataPoint.accountNumber})))}changeRoutingNumber(e){e.length>9||(this.checkoutState.paymentOptions.setUsBankAccountRoutingNumber(e),this.produceViewState((e=>{e.errors.routingNumber=!1,e.routingNumber=this.usBankAccountDataPoint.routingNumber})))}changeAccountHolderName(e){this.checkoutState.paymentOptions.setUsBankAccountHolderName(e),this.produceViewState((e=>{e.errors.accountHolderName=!1,e.accountHolderName=this.usBankAccountDataPoint.accountHolderName}))}changeAccountType(e){this.checkoutState.paymentOptions.setUsBankAccountType(e),this.produceViewState((e=>{e.accountType=this.usBankAccountDataPoint.accountType}))}fillDemoData(e){const t=mL.demoData.routingNumber.split(""),n=mL.demoData.accountNumber.split(""),i=mL.demoData.accountHolderName.split(""),s=window.setInterval((()=>{var a,o,r;if(t.length)null===(a=e.routingNumber)||void 0===a||a.focus(),this.changeRoutingNumber(this.viewState.routingNumber+t.shift());else if(n.length)null===(o=e.accountNumber)||void 0===o||o.focus(),this.changeAccountNumber(this.viewState.accountNumber+n.shift());else{if(!i.length)return clearInterval(s);null===(r=e.accountHolderName)||void 0===r||r.focus(),this.changeAccountHolderName(this.viewState.accountHolderName+i.shift())}}),mL.demoDataInterval);return()=>clearInterval(s)}getInitialViewState(){return{locked:!1,routingNumber:"",accountNumber:"",accountHolderName:"",accountType:lD.INDIVIDUAL,shakeKey:0,processingState:Xl.IDLE,errors:{},livemode:this.checkoutService.checkoutConfiguration.infrastructureParams.livemode}}get usBankAccountDataPoint(){return this.checkoutState.paymentOptions.usBankAccountDataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}showError(){this.produceViewState((e=>{e.shakeKey+=1,e.processingState=Xl.ERROR,e.errorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}))}}mL.demoData={routingNumber:"110000000",accountNumber:"000123456789",accountHolderName:"Michael Smith"},mL.demoDataInterval=50;class pL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.usBankAccount.accountHolderName=this.usBankAccountDataPoint.accountHolderName||this.donorNameDataPoint.fullName,e.usBankAccount.accountNumberLast4=this.usBankAccountDataPoint.accountNumberLast4,e.usBankAccount.routingNumber=this.usBankAccountDataPoint.routingNumber,e.usBankAccount.financialInstitution=this.usBankAccountDataPoint.financialInstitution,e.isRecurring=this.donationDataPoint.frequency!==qn.ONCE}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;this.pending=!0,this.setProcessingState(Xl.PENDING),this.produceViewState((e=>{e.payErrorMessage=""}));const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isSuccess(e)?(this.pending=!1,this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),!0):(this.pending=!1,!!e.failureResult.shouldLeave||(yield this.showError(),!1))}))}getInitialViewState(){return{locked:!1,usBankAccount:{accountHolderName:"",accountNumberLast4:"",routingNumber:"",financialInstitution:"",agreementDate:this.intl.formatDate(new Date,{type:Qr.LONG_WITH_YEAR})},companyName:this.checkoutService.company.name,processingState:Xl.IDLE,isRecurring:!1}}get usBankAccountDataPoint(){return this.checkoutState.paymentOptions.usBankAccountDataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get donorNameDataPoint(){return this.checkoutState.privacy.donorNameDataPoint}showError(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}))}))}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}}class gL extends dx{constructor(e,t){super(t),this.paymentService=e}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.processDataPoint.hasPaymentError&&(this.showError(),this.checkoutState.process.setInProgress())}))}authorizeToBank(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return;this.pending=!0,this.setProcessingState(Xl.PENDING),this.checkoutState.paymentOptions.setPaymentMethod(Gn.US_BANK_ACCOUNT),this.checkoutState.paymentOptions.setPaymentOption(ch.US_BANK_ACCOUNT_INSTANT),yield this.paymentService.initiateUSBankAccount({onPopupOpen:null==e?void 0:e.onModalShow,onPopupClose:null==e?void 0:e.onModalHide,verificationType:"instant"});const t=yield this.paymentService.startUSBankAccount();if(wn.isSuccess(t))return this.setProcessingState(Xl.IDLE),this.pending=!1,this.leave();const n=t.failureResult.message;n?this.showError(n):this.setProcessingState(Xl.IDLE),this.pending=!1}))}fillDetailsManually(){return(0,d.sH)(this,void 0,void 0,(function*(){if(!this.pending)return this.pending=!0,this.setProcessingState(Xl.PENDING),this.checkoutState.paymentOptions.setPaymentMethod(Gn.US_BANK_ACCOUNT),this.checkoutState.paymentOptions.setPaymentOption(ch.US_BANK_ACCOUNT_VERIFICATION),yield this.paymentService.initiateUSBankAccount({}),this.pending=!1,this.setProcessingState(Xl.IDLE),this.leave({omitBeforeLeave:!0})}))}getInitialViewState(){return{test:1,processingState:Xl.IDLE,loginToBankError:"",locked:!1}}get processDataPoint(){return this.checkoutState.process.dataPoint}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}showError(e){this.produceViewState((t=>{t.processingState=Xl.ERROR,t.loginToBankError=e||this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}))}}class yL extends dx{constructor(e){super(e)}get amountExample(){return`+${this.intl.formatCurrency(0,{currency:"USD"}).replace("00","xx")}`}get descriptorCodeExample(){return{prefix:"SM",amount:`+${this.intl.formatCurrency(1,{currency:"USD"})}`}}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.statementDescriptor=this.statementDescriptor,e.verificationType=this.verificationType}))}))}getInitialViewState(){return{locked:!1,statementDescriptor:"",verificationType:"amounts"}}get usBankAccountDataPoint(){return this.checkoutState.paymentOptions.usBankAccountDataPoint}get verificationType(){const e=this.usBankAccountDataPoint.verificationType;if(!e)throw new Error("Verification type is not defined");return e}get statementDescriptor(){switch(this.usBankAccountDataPoint.verificationType){case"descriptor_code":return this.checkoutService.company.name;case"amounts":return"ACCTVERIFY";default:return""}}}class fL extends ii{tryStart(e){this.canBeStarted(e)&&(this.isActive||super.start())}isVariantTestGroup(e){return this.isActive&&this.isVariant(e)}canBeStarted(e){var t;if(null===(t=e.checkoutConfiguration.fundraisingPage)||void 0===t?void 0:t.key)return!1;if(!e.checkoutConfiguration.canModifyAmount)return!1;const n=e.checkoutConfiguration.enabledFrequencies,i=!e.checkoutConfiguration.infrastructureParams.isMobile,s=e.checkoutConfiguration.enabledFrequencies.includes(qn.DAILY),a=e.fiatDonationDataPoint.getFrequencyDonationEndDate(qn.DAILY),o=a.hasEndDate&&a.shouldShow;return!(i&&s&&o)&&!n.some((t=>null!==e.fiatDonationDataPoint.allAmountHints[t]))}}class vL extends ii{tryStart(e){this.isActive||this.canBeStarted(e)&&super.start()}isEnabled(e){return this.canBeStarted(e)&&this.isTestGroup}get isTestGroup(){return this.isActive&&this.isVariant(A.TEST)}canBeStarted(e){return!!e.canShowUpsellScreen&&!!vL.ALLOWED_TARGET_FREQUENCIES.includes(e.targetFrequency)}}vL.ALLOWED_TARGET_FREQUENCIES=[qn.MONTHLY,qn.EVERY_4_WEEKS];class SL extends qx{constructor(e,t,n,i,s){super(e,t,n,i,s),this.lastTrackedValidationErrorState=null}trackDonationItemAdd(e){var t,n;const{goalId:i}=e,s=null!==(t=this.donationDataPoint.donationItemsDto[this.donationDataPoint.donationItemsDto.length-1])&&void 0!==t?t:null;if(!s)return;const a={donationItemId:s.id,amount:{value:null!==(n=s.amount)&&void 0!==n?n:0,valueInUSD:this.convertToUSD(s.amount),isFilled:Boolean(s.amount),isEditable:this.checkoutConfiguration.canModifyAmount},goal:{id:i,isEditable:!0,parentGroupId:this.getGoalParentId(i)}};this.tracker.trackCheckoutCustomEvent({type:Ee.ADD_DONATION_ITEM,data:{donationItem:a}})}trackDonationItemRemove(e){var t,n,i,s;const{goalId:a,donationItemId:o}=e,r=null!==(t=this.donationDataPoint.donationItemsDto.find((e=>e.id===o)))&&void 0!==t?t:null;if(!r)return;const l=this.donationDataPoint.donationItemsDto.findIndex((e=>e.id===r.id)),c=null===(i=null===(n=this.designationsDataPoint.selectedGoalsAvailability[l])||void 0===n?void 0:n.isAvailable)||void 0===i||i,u={donationItemId:r.id,amount:{value:null!==(s=r.amount)&&void 0!==s?s:0,valueInUSD:this.convertToUSD(r.amount),isFilled:Boolean(r.amount),isEditable:this.checkoutConfiguration.canModifyAmount&&c},goal:{id:c?a:null,isEditable:c,parentGroupId:this.getGoalParentId(a)}};this.tracker.trackCheckoutCustomEvent({type:Ee.REMOVE_DONATION_ITEM,data:{donationItem:u}})}trackDonationItemsValidationError(e,t){var n,i,s,a,o,r,l;const c=this.serializeDonationItemsValidationState(e,t);if(c===this.lastTrackedValidationErrorState)return;this.lastTrackedValidationErrorState=c;const u=[],d=[],h=[],m=[];for(let c=0;c<e.length;++c){const p=e[c],g=null===(i=null===(n=t[c])||void 0===n?void 0:n.isAvailable)||void 0===i||i,y=null!==(a=null===(s=this.designationsDataPoint.selectedGoals[c])||void 0===s?void 0:s.id)&&void 0!==a?a:"";if(null===(o=null==p?void 0:p.amount)||void 0===o?void 0:o.min){const e=this.prepareDonationItemEventError(p,y);e&&u.push(e)}if(null===(r=null==p?void 0:p.amount)||void 0===r?void 0:r.max){const e=this.prepareDonationItemEventError(p,y);e&&d.push(e)}(null===(l=null==p?void 0:p.amount)||void 0===l?void 0:l.required)&&h.push({donationItemId:p.id,goal:{id:y}}),g||m.push({donationItemId:p.id,goal:{id:y}})}(u.length>0||d.length>0||h.length>0||m.length>0)&&this.tracker.trackCheckoutCustomEvent({type:Ee.DONATION_ITEMS_VALIDATION_ERROR,data:{donationError:{minAmount:{donationItems:u},maxAmount:{donationItems:d},emptyAmount:{donationItems:h},unsupportedGoalFrequency:{donationItems:m}}}})}getDonationItemsTrackingData(e,t,n){return this.donationDataPoint.donationItemsDto.filter((e=>e.id!==n)).map(((n,i)=>{var s,a,o,r,l;const c=null===(a=null===(s=this.designationsDataPoint.selectedGoalsAvailability[i])||void 0===s?void 0:s.isAvailable)||void 0===a||a,u=null!==(r=null===(o=this.designationsDataPoint.selectedGoals[i])||void 0===o?void 0:o.id)&&void 0!==r?r:null;return{donationItemId:n.id,amount:{value:null!==(l=n.amount)&&void 0!==l?l:0,valueInUSD:this.convertToUSD(n.amount),isFilled:Boolean(n.amount),isEditable:this.checkoutConfiguration.canModifyAmount&&c},goal:{id:c?u:null,isEditable:c&&!e&&!t,parentGroupId:this.getGoalParentId(u)}}}))}prepareDonationItemEventError(e,t){var n;const i=this.donationDataPoint.donationItemsDto.find((t=>t.id===e.id));return i?{donationItemId:e.id,amount:{value:null!==(n=i.amount)&&void 0!==n?n:0,valueInUSD:this.convertToUSD(i.amount)},goal:{id:t}}:null}serializeDonationItemsValidationState(e,t){var n,i,s,a,o;const r=[],l=this.donationDataPoint.donationItemsDto;for(let c=0;c<e.length;++c){const u=null!==(i=null===(n=l[c])||void 0===n?void 0:n.amount)&&void 0!==i?i:null,{id:d,amount:h,designation:m}=e[c],{min:p,max:g,required:y}=h,f=null===(a=null===(s=t[c])||void 0===s?void 0:s.isAvailable)||void 0===a||a,v=`${d}-${u}-${p}-${g}-${y}-${null!==(o=null==m?void 0:m.required)&&void 0!==o&&o}-${f}`;r.push(v)}return r.sort().join("\n")}}var EL;!function(e){e.VARIANT_1="variant-1",e.VARIANT_2="variant-2",e.VARIANT_3="variant-3",e.VARIANT_4="variant-4",e.VARIANT_5="variant-5",e.VARIANT_6="variant-6",e.VARIANT_7="variant-7",e.VARIANT_8="variant-8",e.VARIANT_9="variant-9"}(EL||(EL={}));class AL{constructor(){this.lastGeneratedIcon=null,this.availableIconsNames=Object.values(EL)}generate(){var e;const t=Math.floor(Math.random()*this.availableIconsNames.length);let n=this.availableIconsNames[t];return n===this.lastGeneratedIcon&&(n=null!==(e=this.availableIconsNames[t+1])&&void 0!==e?e:this.availableIconsNames[0]),this.lastGeneratedIcon=n,n}}const CL={[EL.VARIANT_1]:"medal",[EL.VARIANT_2]:"heart",[EL.VARIANT_3]:"star",[EL.VARIANT_4]:"light",[EL.VARIANT_5]:"trophy",[EL.VARIANT_6]:"prize",[EL.VARIANT_7]:"diamond",[EL.VARIANT_8]:"double-hearts",[EL.VARIANT_9]:"double-stars"};class bL{static getInstance(){return bL.instance||(bL.instance=new bL),bL.instance}constructor(){this.baseGenerator=new AL}generate(){const e=this.baseGenerator.generate();return CL[e]}}class PL extends dx{constructor(e,t,n,i,s,a,o,r,l){super(e),this.upsellAggregate=t,this.adaptiveFeeCoveringService=n,this.donorRatingCalculator=i,this.donorRatingRecommendationCalculator=s,this.designationsFetcher=a,this.tracker=o,this.paymentService=r,this.rateMatchingService=l,this.debouncedAmount=null,this.debouncedChangeAmount=lR((()=>{this.baseChangeAmount(this.debouncedAmount),this.debouncedAmount=null}),670),this.baseTryToCalculateDonorRating=()=>{if(null===this.donorRatingExperiment)return;const{isValid:e}=this.donationDataPoint.getValidationResult();if(!e)return void this.hideDonorRatingElements();this.donorRatingExperiment.tryToExpose();const{position:t}=this.tryToCalculateDonorRatingTop(),n=this.tryToShowDonorRatingUpsell(t);this.tryToShowDonorRatingBanner(t,n.position!==Xn.NONE)},this.debouncedTryToCalculateDonorRating=lR(this.baseTryToCalculateDonorRating,670),this.adaptivePreDonationUpsellSuggestionsService=e.adaptivePreDonationUpsellSuggestionsService,this.experiments.register(u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT,vL),this.experiments.register(u.AVERAGE_DONATION_HINT_EXPERIMENT,fL),this.donationItemsTrackingService=new SL(this.donationDataPoint,this.designationsDataPoint,this.currencyService,this.tracker,this.checkoutService.checkoutConfiguration),this.designationTreeTrackingService=new Hx(this.tracker),this.sendSentryLogInvalidDesignation()}get isLocked(){return this.getScreenData().locked}get donateButtonLabel(){return function(e,t){switch(t){case qn.DAILY:return e.translate("donateForm.donateButton.daily");case qn.WEEKLY:return e.translate("donateForm.donateButton.weekly");case qn.BIWEEKLY:return e.translate("donateForm.donateButton.biweekly");case qn.EVERY_4_WEEKS:return e.translate("donateForm.donateButton.every4weeks");case qn.MONTHLY:return e.translate("donateForm.donateButton.monthly");case qn.BIMONTHLY:return e.translate("donateForm.donateButton.bimonthly");case qn.QUARTERLY:return e.translate("donateForm.donateButton.quarterly");case qn.SEMIANNUAL:return e.translate("donateForm.donateButton.semiannual");case qn.ANNUAL:return e.translate("donateForm.donateButton.annual");default:return e.translate("donateForm.donateButton.once")}}(this.intl,this.donationDataPoint.frequency)}get shouldShowAverageDonationHint(){return(this.checkoutService.checkoutConfiguration.infrastructureParams.showcase||this.viewState.donation.frequency===qn.ONCE)&&!1}get shouldShowAverageDonationHintTooltip(){const e=this.viewState.tribute.sharingEnabled&&this.viewState.tribute.isActive&&this.viewState.isTributeInputFocused;return this.shouldShowAverageDonationHint&&!this.viewState.errors.amount.min&&!e&&!this.viewState.forceHideAverageDonationHintTooltip}get amountAverageDonationHint(){return this.currencyService.convert(1e4,"USD",this.viewState.donation.currency)}beforeEnter(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutService.ensureFrequencyEnabled(this.donationDataPoint.frequency);const e=this.donationDataPoint.frequency,t=this.donationDataPoint.getFrequencyDonationEndDate(e);this.produceViewState((n=>{n.tribute.show=this.tributeDataPoint.isEnabled,n.tribute.isActive=this.tributeDataPoint.isActive,n.tribute.labelType=this.tributeDataPoint.labelType,n.tribute.sharingEnabled=this.tributeDataPoint.isSharingEnabled,n.tribute.isOptional=this.tributeDataPoint.isOptional,n.tribute.name=this.tributeDataPoint.tributeeName,n.tribute.isFilled=this.tributeDataPoint.isFilled,n.tribute.isTributeOriented=this.tributeDataPoint.isTributeOriented,n.comment.isEnabled=this.commentDataPoint.isEnabled,n.comment.content=this.commentDataPoint.comment,n.comment.prevContent=this.commentDataPoint.prevComment,n.donation.amount=this.donationDataPoint.amount,n.donation.minAmount=this.donationDataPoint.getFrequencyMinimalAmount(e),n.donation.maxAmount=this.donationDataPoint.maxAmount,n.donation.amountOptions=[...this.donationDataPoint.getFrequencyAmountSuggestions(e)],n.donation.frequency=e,n.donation.canModifyAmount=this.checkoutService.checkoutConfiguration.canModifyAmount,n.donation.canSelectCurrency=this.donationDataPoint.isCurrencyEditableForFrequency(e),n.donation.currency=this.donationDataPoint.currency,n.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(e),n.donation.canModifyFrequency=this.checkoutService.checkoutConfiguration.canModifyFrequency,n.donation.showAmountSuggestions=this.checkoutService.checkoutConfiguration.showAmountSuggestions,n.donation.showDonationEndDate=t.shouldShow,n.donation.donationEndDate=t.endDate,n.donation.isDonationEndDateActive=this.donationDataPoint.isDonationEndDateActive,n.donation.donationItems=this.donationDataPoint.donationItemsDto,n.designations.availableGoals=this.designationsDataPoint.availableGoals,n.designations.goals=this.designationsDataPoint.goals,n.designations.selectedGoals=this.designationsDataPoint.selectedGoals,n.designations.selectedGoalsAvailability=this.designationsDataPoint.selectedGoalsAvailability,n.designations.defaultGoals=this.designationsDataPoint.defaultGoals,n.designations.isOptionsLoading=!1,n.allCurrenciesList=this.checkoutService.checkoutConfiguration.enabledCurrencies,n.guessedCurrenciesList=this.checkoutService.checkoutConfiguration.guessedCurrencies,n.donateButtonLabel=this.donateButtonLabel,n.leftButtonLabel=this.leftButtonLabel,n.leftButtonFrequency=this.checkoutService.checkoutConfiguration.lowestFrequency,n.rightButtonLabel=this.rightButtonLabel,n.rightButtonFrequency=this.checkoutService.checkoutConfiguration.highestFrequency,n.rateMatching=this.getRateMatching(this.donationDataPoint.amount,n.donation.currency),n.showFrequencyCustomAmountInput=!this.donationDataPoint.amountHint,n.donation.showAnnualCheckbox=this.checkoutService.isMultipleRecurringPlanTestGroup2(),n.donation.showAnnualTab=this.checkoutService.isMultipleRecurringPlanTestGroup1(),n.donation.annualCheckboxChecked=this.donationDataPoint.frequency===qn.ANNUAL&&this.checkoutService.isMultipleRecurringPlanTestGroup2(),n.tracking.donationItems=this.getDonationItemsTrackingData(),n.shouldOpenCommentBottomSheet=this.shouldOpenCommentBottomSheet()})),this.syncDonationItemsErrors(),this.validateAmount(!this.checkoutService.checkoutConfiguration.canModifyAmount),this.validateDesignations(!0),this.initializeAverageDonationHintExperiment(),this.calculateAverageDonationAmount(),!this.checkoutService.checkoutConfiguration.canModifyAmount&&this.viewState.showError&&(this.checkoutService.checkoutConfiguration.allowModifyAmount(),this.produceViewState((e=>{e.donation.canModifyAmount=this.checkoutService.checkoutConfiguration.canModifyAmount,e.tracking.donationItems=this.getDonationItemsTrackingData()}))),this.tryFetchDesignationGoals(),this.checkoutService.exposeMultipleRecurringPlanCheckoutExperiment(),this.tryInitializeDonateByVoiceExperiment()}))}tryToCalculateDonorRating(e){(null==e?void 0:e.debounce)?this.debouncedTryToCalculateDonorRating():this.baseTryToCalculateDonorRating()}applyDonorRatingUpsell(){if(null===this.donationDataPoint.amount)return;if(this.changeAmount(this.donationDataPoint.amount+this.viewState.donorRating.upsell.amount),null===this.donorRatingExperiment)return;this.donorRatingExperiment.isUpsellApplied=!0;const e=this.currencyService.convert(this.viewState.donorRating.upsell.amount,this.donationDataPoint.currency,"USD");let t=0;null!==this.donationDataPoint.amountInUSD&&(t=this.donationDataPoint.amountInUSD-e),this.donorRatingExperiment.trackUpsellClick({position:this.viewState.donorRating.upsell.position,frequency:this.donationDataPoint.frequency,amount:t,upsellAmount:e});const{position:n}=this.tryToCalculateDonorRatingTop();this.tryToShowDonorRatingBanner(n,!1),this.showDonorRatingUpsell(kM.DEFAULT_RESULT)}setIsTributeInputFocused(e){return(0,d.sH)(this,void 0,void 0,(function*(){yield Ri(200),this.produceViewState((t=>{t.isTributeInputFocused=e}))}))}toggleAnnualCheckbox(e){this.changeFrequency(e?qn.ANNUAL:qn.ONCE),this.produceViewState((t=>{t.donation.annualCheckboxChecked=e}))}changeFrequency(e){e!==this.viewState.donation.frequency&&this.hideDonorRatingElements(),this.checkoutState.donation.setDonationsFrequency(e),this.checkoutService.syncUpdateCheckoutState();const t=this.donationDataPoint.getFrequencyDonationEndDate(e);this.produceViewState((n=>{n.donation.frequency=this.donationDataPoint.frequency,n.donation.amount=this.donationDataPoint.amount,n.donation.currency=this.donationDataPoint.currency,n.donation.amountOptions=[...this.donationDataPoint.getFrequencyAmountSuggestions(e)],n.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(e),n.donation.canSelectCurrency=this.donationDataPoint.isCurrencyEditableForFrequency(e),n.donation.showDonationEndDate=t.shouldShow,n.donation.donationEndDate=t.endDate,n.donation.isDonationEndDateActive=this.donationDataPoint.isDonationEndDateActive,n.donation.donationItems=this.donationDataPoint.donationItemsDto,n.designations.availableGoals=this.designationsDataPoint.availableGoals,n.designations.goals=this.designationsDataPoint.goals,n.designations.selectedGoals=this.designationsDataPoint.selectedGoals,n.designations.selectedGoalsAvailability=this.designationsDataPoint.selectedGoalsAvailability,n.donation.minAmount=this.donationDataPoint.getFrequencyMinimalAmount(e),n.donateButtonLabel=this.donateButtonLabel,n.showFrequencyCustomAmountInput=!this.donationDataPoint.amountHint,n.tracking.donationItems=this.getDonationItemsTrackingData(),n.hasAmountHintBeenReset=!1,n.rateMatching=this.getRateMatching(this.donationDataPoint.amount,n.donation.currency)})),this.checkoutState.donation.setCurrentDistributionWeights(),this.validateAmount(),this.validateDesignations(!0),this.resetDesignationValidation(),this.resetDonationItemsAmountValidation(),this.syncDonationItemsErrors(),this.trackDonationItemsValidationError(),this.fetchUpsellScreenDecision(),this.calculateAverageDonationAmount()}validateAmount(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.donationDataPoint.getValidationResult(),n=null===this.donationDataPoint.amount,i=e&&t.fields.amount.errors.required;this.produceViewState((s=>{s.donation.isAmountValid=t.fields.amount.isValid,s.errors.amount.required=i,s.errors.amount.min=!n&&t.fields.amount.errors.min,s.errors.amount.max=!n&&t.fields.amount.errors.max,s.donation.isDonationItemsValid=t.fields.donationItems.isValid;const a=t.fields.donationItems.items;let o=0;s.errors.donationItems=s.errors.donationItems.map(((t,n)=>{var i,r,l,c,u,d,h,m,p,g,y,f,v,S;const E=null===(r=null===(i=s.designations.selectedGoalsAvailability[n])||void 0===i?void 0:i.isAvailable)||void 0===r||r,A=E?{min:null!==(d=null===(u=null===(c=null===(l=a[o])||void 0===l?void 0:l.amount)||void 0===c?void 0:c.errors)||void 0===u?void 0:u.min)&&void 0!==d&&d,max:null!==(g=null===(p=null===(m=null===(h=a[o])||void 0===h?void 0:h.amount)||void 0===m?void 0:m.errors)||void 0===p?void 0:p.max)&&void 0!==g&&g,required:!!e&&null!==(S=null===(v=null===(f=null===(y=a[o])||void 0===y?void 0:y.amount)||void 0===f?void 0:f.errors)||void 0===v?void 0:v.required)&&void 0!==S&&S}:{min:!1,max:!1,required:!1};return E&&(o+=1),Object.assign(Object.assign({},t),{amount:A})})),s.showError=t.fields.amount.errors.min||t.fields.amount.errors.max||i}))}changeAmount(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(this.debouncedAmount=e,this.debouncedChangeAmount()):this.baseChangeAmount(e)}addRateMatchingUpsellAmount(){const e=this.rateMatchingService.getUpsellAmountForDonation(this.donationDataPoint.amount,this.donationDataPoint.currency,this.checkoutService.campaignConfig.defaultCurrency);null!==e&&null!==this.donationDataPoint.amount&&this.changeAmount(this.donationDataPoint.amount+e)}changeCurrentHint(e){this.resetAmountValidationError(),this.checkoutState.donation.setDonationsAmountHint(e),this.checkoutService.syncUpdateCheckoutState();const t=this.donationDataPoint.frequency;this.produceViewState((e=>{e.donation.amount=this.donationDataPoint.amount,e.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(t),e.showFrequencyCustomAmountInput=!this.donationDataPoint.amountHint,e.donation.donationItems=this.donationDataPoint.donationItemsDto,e.donateButtonLabel=this.donateButtonLabel,e.tracking.donationItems=this.getDonationItemsTrackingData(),e.hasAmountHintBeenReset=!1,e.rateMatching=this.getRateMatching(this.donationDataPoint.amount,e.donation.currency)})),this.validateAmount(),this.fetchUpsellScreenDecision()}setDesignationsSelectedGoal(e){const t=this.getGoalRepeat(this.donationDataPoint.frequency);this.checkoutState.designations.setSelectedGoals([e],t),this.produceViewState((e=>{e.designations.availableGoals=this.designationsDataPoint.availableGoals,e.designations.goals=this.designationsDataPoint.goals,e.designations.selectedGoals=this.designationsDataPoint.selectedGoals,e.designations.selectedGoalsAvailability=this.designationsDataPoint.selectedGoalsAvailability,e.tracking.donationItems=this.getDonationItemsTrackingData()})),this.validateDesignations()}changeCurrency(e){this.checkoutState.donation.setCurrency(e),this.checkoutService.syncUpdateCheckoutState();const t=this.donationDataPoint.frequency;this.produceViewState((e=>{e.donation.currency=this.donationDataPoint.currency,e.donation.amountOptions=[...this.donationDataPoint.getFrequencyAmountSuggestions(t)],e.donation.amount=this.donationDataPoint.amount,e.donation.donationItems=this.donationDataPoint.donationItemsDto,e.donation.minAmount=this.donationDataPoint.getFrequencyMinimalAmount(t),e.donation.maxAmount=this.donationDataPoint.maxAmount,e.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(t),e.tracking.donationItems=this.getDonationItemsTrackingData(),e.donateButtonLabel=this.donateButtonLabel,e.rateMatching=this.getRateMatching(this.donationDataPoint.amount,e.donation.currency)})),this.fetchUpsellScreenDecision(),this.performFeeCoveringSuggestion(),this.checkoutService.fetchFeeCoveringSuggestion(),this.tryToCalculateDonorRating(),this.calculateAverageDonationAmount()}setTributeActive(e){this.checkoutState.tribute.setActive(e),this.checkoutService.syncUpdateCheckoutState(),this.produceViewState((e=>{e.tribute.isActive=this.tributeDataPoint.isActive,e.tribute.isFilled=this.tributeDataPoint.isFilled}))}toggleTribute(){this.setTributeActive(!this.tributeDataPoint.isActive)}changeTributeName(e){this.checkoutState.tribute.setTributeeName(e),this.checkoutService.syncUpdateCheckoutState(),this.produceViewState((e=>{e.tribute.name=this.tributeDataPoint.tributeeName,e.tribute.isFilled=this.tributeDataPoint.isFilled}))}useVoiceFlow(){return this.checkoutState.process.setVoiceFlow(!0),this.leave({omitBeforeLeave:!0})}addComment(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutState.comment.setIsRequired(!0),this.leave({omitBeforeLeave:!0})}))}savePrevComment(){this.checkoutService.checkoutConfiguration.infrastructureParams.showcase||this.checkoutState.comment.savePrevComment()}changeComment(e){const t=e.slice(0,500);this.checkoutState.comment.saveComment(t),this.produceViewState((e=>{e.comment.content=this.commentDataPoint.comment}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.produceViewState((e=>{e.forceHideAverageDonationHintTooltip=!0})),null!==this.debouncedAmount&&this.baseChangeAmount(this.debouncedAmount),this.syncDonationItemsErrors(),this.validateAmount(!0),this.validateDesignations(),this.trackDonationItemsValidationError(),this.viewState.donation.isAmountValid?this.viewState.designations.isValid?!!this.viewState.donation.isDonationItemsValid&&(this.checkoutService.updateSessionWidgetDefaults(),this.performFeeCoveringSuggestion(),this.checkoutService.fetchFeeCoveringSuggestion(),this.exposureCheckoutStepsExperiments(),this.tryExposePreDonationAmounts100200USDExperiments(),yield this.performMlRequests(),this.checkoutService.updateSession(),!0):(this.produceViewState((e=>{e.designationShakeKey+=1})),!1):(this.produceViewState((e=>{e.amountShakeKey+=1,e.showError=!0})),!1)}))}toggleDonationEndDateActive(e){this.checkoutState.donation.setDonationsEndDateActive(e),this.produceViewState((t=>{t.donation.isDonationEndDateActive=e}))}isAverageDonationAmountVariantTestGroup(e){return this.experiments.get(u.AVERAGE_DONATION_HINT_EXPERIMENT).isVariant(e)}isDesignationReadOnly(){return this.designationsDataPoint.isDesignationReadOnly}isDesignationEditable(){return this.designationsDataPoint.isDesignationEditable}resetDesignationValidation(){this.produceViewState((e=>{e.designations.isValid=!0,e.errors.designation.required=!1}))}trackDesignationScrollUsed(){this.designationTreeTrackingService.trackDesignationScrollUsed()}trackDesignationSearchFinished(e,t){this.designationTreeTrackingService.trackDesignationSearchFinished(e,t),this.designationTreeTrackingService.setItems(t),this.setDesignationTreeTrackingData()}setTrackingDesignationListOpen(e,t){this.designationTreeTrackingService.setListOpen(e),e&&this.designationTreeTrackingService.setItems(t),this.setDesignationTreeTrackingData()}setTrackingDesignationSearchInputVisible(e){this.designationTreeTrackingService.setSearchInputVisible(e),this.setDesignationTreeTrackingData()}setTrackingDesignationListScrollVisible(e){this.designationTreeTrackingService.setScrollVisible(e),this.setDesignationTreeTrackingData()}setTrackingDesignationClickedGoal(e){this.designationTreeTrackingService.setClickedGoal(e),this.setDesignationTreeTrackingData()}setTrackingDesignationClickedGroup(e,t){e&&(this.designationTreeTrackingService.setClickedGroup(e,t),this.setDesignationTreeTrackingData())}setTrackingDesignationItems(e){this.designationTreeTrackingService.setItems(e),this.setDesignationTreeTrackingData()}setShouldOpenCommentBottomSheet(e){this.produceViewState((t=>{t.shouldOpenCommentBottomSheet=e}))}getInitialViewState(){return{locked:!1,isShowcase:!1,amountShakeKey:0,designationShakeKey:0,allCurrenciesList:[],guessedCurrenciesList:[],allowCentsForCharges:this.checkoutService.company.allowCentsForCharges,donation:{frequency:qn.ONCE,amountOptions:[0,0,0,0,0,0],amount:null,minAmount:0,maxAmount:0,canModifyAmount:!0,showAmountSuggestions:!0,canSelectCurrency:!0,currency:"USD",isAmountValid:!0,canModifyFrequency:!0,hintOptions:null,showDonationEndDate:!1,donationEndDate:null,isDonationEndDateActive:!0,averageDonationAmount:null,donationItems:[],isDonationItemsValid:!0},errors:{amount:{min:!1,max:!1,required:!1},designation:{required:!1},donationItems:[]},showError:!1,comment:{isEnabled:!1,content:"",prevContent:""},tribute:{name:"",isActive:!1,show:!1,isOptional:!1,labelType:cf.IN_HONOR_MEMORY,sharingEnabled:!1,isFilled:!1,inHonorOfMaxLength:VI.getInHonorOfMaxLength(),isTributeOriented:!1},designations:{availableGoals:[],goals:[],selectedGoals:[],selectedGoalsAvailability:[],isOptionsLoading:!1,isValueLoading:!1,isValid:!0,defaultGoals:{[js.RECURRING]:null,[js.ONE_TIME]:null}},enabledFlows:{crypto:this.checkoutService.checkoutConfiguration.enabledFlows.crypto},companyName:this.checkoutService.company.name,donateButtonLabel:"",leftButtonLabel:"",leftButtonFrequency:qn.ONCE,rightButtonLabel:"",rightButtonFrequency:qn.MONTHLY,flowType:this.checkoutService.type,isTributeInputFocused:!1,forceHideAverageDonationHintTooltip:!1,rateMatching:{enabled:!1,rate:2,sponsor:null,sponsorLogo:null,minAmount:0,endDate:null,sponsorEnabled:!1,totalAmountLimitEnabled:!1,matchingImpact:null,isMatchingLimited:!1,isDonationMatched:!1,minRateMatchingAmount:0,upsellAmountToAdd:null,amountAfterUpsell:null,isCountdownEnabled:!1,isDaysCountdownEnabled:!1,isHourCountdownEnabled:!1,totalAmountLimitInDonationCurrency:null,isDonationOverMaxLimit:!1,isSponsorLogoShown:!1,isDonationLessThanMin:!1,isDonationEqualMin:!1},showFrequencyCustomAmountInput:!1,preDonationUpsell:{upsell:{fromAmount:0},currency:"USD",highButtonText:"",lowButtonText:"",highAmount:0,lowAmount:0,screenTitle:"",questionText:"",questionShortText:"",descriptionText:"",targetFrequency:qn.MONTHLY,isAnnualTribute:!1},processingState:Xl.IDLE,donorRating:{shouldShowDonorRatingBanner:!1,immediateExit:!1,thresholdName:Xn.NONE,upsell:kM.DEFAULT_RESULT},tracking:{donationItems:[],designationTree:{isOpened:!1,searchInput:{isVisible:!1},scroll:{isVisible:!1},items:{goals:{count:0},groups:{level1:{count:0},level2:{count:0}}},clickedGoal:{id:null,level:0},clickedGroup:{id:null,level:0,hasChildrenGroups:!1,isOpened:!1}}},hasAmountHintBeenReset:!1,isDonateByVoiceExperimentEnabled:!1,shouldOpenCommentBottomSheet:!1}}get tributeDataPoint(){return this.checkoutState.tribute.dataPoint}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get commentDataPoint(){return this.checkoutState.comment.dataPoint}get preDonationUpsellDataPoint(){return this.checkoutState.preDonationUpsell.dataPoint}get designationsDataPoint(){return this.checkoutState.designations.dataPoint}get leftButtonLabel(){return ih(this.intl,this.checkoutService.checkoutConfiguration.lowestFrequency)}get rightButtonLabel(){return ih(this.intl,this.checkoutService.checkoutConfiguration.highestFrequency)}get checkoutWithoutPreDonationUpsellExperiment(){return this.experiments.get(u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT)}get donorRatingCheckoutExperiment(){return this.experiments.get(u.DONOR_RATING_CHECKOUT_EXPERIMENT)}get donorRatingExperiment(){return this.isDonorRatingCheckoutExperimentEnabled?this.donorRatingCheckoutExperiment:null}get isDonorRatingCheckoutExperimentEnabled(){return this.donorRatingCheckoutExperiment.isEnabled({enabledFrequencies:this.checkoutService.checkoutConfiguration.enabledFrequencies,donorRating:this.checkoutService.checkoutConfiguration.company.donorRating})}get availableSelectedGoalsCount(){return this.designationsDataPoint.selectedGoalsAvailability.filter((e=>e.isAvailable)).length}setDesignationTreeTrackingData(){const e=this.designationTreeTrackingService.getCheckoutScreenData();this.produceViewState((t=>{t.tracking.designationTree=e}),!1)}validateDesignations(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.WITHOUT)return;if(this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.ASSIGN&&0===this.checkoutService.checkoutConfiguration.campaign.config.defaultGoals.length)return;const t=this.designationsDataPoint.getValidationResult();this.produceViewState((n=>{n.designations.isValid=t.isValid,n.errors.donationItems=n.errors.donationItems.map(((n,i)=>{var s,a;const o=t.fields.goals[i],r=!e&&null!==(a=null===(s=null==o?void 0:o.errors)||void 0===s?void 0:s.required)&&void 0!==a&&a;return Object.assign(Object.assign({},n),{designation:{required:r}})}))}))}tryFetchDesignationGoals(){return(0,d.sH)(this,void 0,void 0,(function*(){var e,t;const n=null===(t=null===(e=this.checkoutService.checkoutConfiguration.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.id;this.designationsDataPoint.selectedGoals.length>0||void 0===n||this.produceViewState((e=>{e.designations.isValueLoading=!0})),this.produceViewState((e=>{e.designations.isOptionsLoading=!0})),yield this.tryFetchGoals(n),this.produceViewState((e=>{e.designations.availableGoals=this.designationsDataPoint.availableGoals,e.designations.goals=this.designationsDataPoint.goals,e.designations.selectedGoals=this.designationsDataPoint.selectedGoals,e.designations.selectedGoalsAvailability=this.designationsDataPoint.selectedGoalsAvailability,e.designations.isOptionsLoading=!1,e.designations.isValueLoading=!1}))}))}tryFetchGoals(e){return(0,d.sH)(this,void 0,void 0,(function*(){void 0!==e?yield this.withPending((()=>this.designationsFetcher.tryFetchGoals())):yield this.designationsFetcher.tryFetchGoals()}))}setDonorRatingData(e){const{shouldShowDonorRatingBanner:t,immediateExit:n=!1,thresholdName:i,iconName:s}=e;this.produceViewState((e=>{void 0!==t&&(e.donorRating.shouldShowDonorRatingBanner=t),e.donorRating.immediateExit=n,void 0!==i&&(e.donorRating.thresholdName=i),void 0!==s&&(e.donorRating.iconName=s)}))}calculateAverageDonationAmount(){var e;const t=null===(e=[...this.donationDataPoint.getFrequencyAmountSuggestions(this.donationDataPoint.frequency)].sort(((e,t)=>e-t)))||void 0===e?void 0:e[2];this.produceViewState((e=>{e.donation.averageDonationAmount=t||null}))}showCheckoutDonorRatingBanner(e,t){this.donorRatingCheckoutExperiment.hideTimeoutId&&clearTimeout(this.donorRatingCheckoutExperiment.hideTimeoutId),this.viewState.donorRating.shouldShowDonorRatingBanner?(this.setDonorRatingData({shouldShowDonorRatingBanner:!1,immediateExit:!0}),setTimeout((()=>{this.setDonorRatingData({shouldShowDonorRatingBanner:!0,immediateExit:!1,thresholdName:e,iconName:t})}),50)):this.setDonorRatingData({shouldShowDonorRatingBanner:!0,thresholdName:e,iconName:t}),this.donorRatingCheckoutExperiment.hideTimeoutId=window.setTimeout((()=>{this.setDonorRatingData({shouldShowDonorRatingBanner:!1})}),li.BANNER_VISIBILITY_TIMEOUT)}hideDonorRatingElements(){this.donorRatingCheckoutExperiment.hideTimeoutId&&clearTimeout(this.donorRatingCheckoutExperiment.hideTimeoutId),this.setDonorRatingData({shouldShowDonorRatingBanner:!1,immediateExit:!0}),this.showDonorRatingUpsell(kM.DEFAULT_RESULT)}tryToShowDonorRatingBanner(e,t){var n,i,s;const a=bL.getInstance().generate();if(null!==this.donorRatingExperiment){if(e===Xn.NONE)return this.donorRatingExperiment.trackBannerVisibility({show:!1,position:e,frequency:this.donationDataPoint.frequency,amount:null!==(n=this.donationDataPoint.amountInUSD)&&void 0!==n?n:0}),void this.setDonorRatingData({shouldShowDonorRatingBanner:!1,immediateExit:!0});if(t)return this.donorRatingExperiment.trackBannerVisibility({show:!1,position:e,frequency:this.donationDataPoint.frequency,amount:null!==(i=this.donationDataPoint.amountInUSD)&&void 0!==i?i:0}),void this.setDonorRatingData({shouldShowDonorRatingBanner:!1,immediateExit:!0});this.isDonorRatingCheckoutExperimentEnabled&&this.showCheckoutDonorRatingBanner(e,a),this.donorRatingExperiment.trackBannerVisibility({show:!0,position:e,frequency:this.donationDataPoint.frequency,amount:null!==(s=this.donationDataPoint.amountInUSD)&&void 0!==s?s:0})}}showDonorRatingUpsell(e){this.produceViewState((t=>{t.donorRating.upsell=e}))}tryToCalculateDonorRatingTop(){var e;if(null===this.donorRatingExperiment)return DM.NONE_POSITION;const t=this.donorRatingExperiment.testGroupKey;return t?this.donorRatingCalculator.calculate({amount:null!==(e=this.donationDataPoint.amount)&&void 0!==e?e:0,currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency},t):DM.NONE_POSITION}tryToShowDonorRatingUpsell(e){var t,n,i,s;if(null===this.donorRatingExperiment)return kM.DEFAULT_RESULT;if(!this.donorRatingExperiment.isTestGroup2)return this.donorRatingExperiment.trackUpsellVisibility({position:kM.DEFAULT_RESULT.position,frequency:this.donationDataPoint.frequency,amount:null!==(t=this.donationDataPoint.amountInUSD)&&void 0!==t?t:0,upsellAmount:kM.DEFAULT_RESULT.amount}),kM.DEFAULT_RESULT;if(this.donorRatingExperiment.isUpsellApplied)return this.donorRatingExperiment.trackUpsellVisibility({position:kM.DEFAULT_RESULT.position,frequency:this.donationDataPoint.frequency,amount:null!==(n=this.donationDataPoint.amountInUSD)&&void 0!==n?n:0,upsellAmount:kM.DEFAULT_RESULT.amount}),kM.DEFAULT_RESULT;const a=this.donorRatingRecommendationCalculator.calculate({amount:null!==(i=this.donationDataPoint.amount)&&void 0!==i?i:0,currency:this.donationDataPoint.currency,frequency:this.donationDataPoint.frequency,position:e});return this.showDonorRatingUpsell(a),this.donorRatingExperiment.trackUpsellVisibility({position:a.position,frequency:this.donationDataPoint.frequency,amount:null!==(s=this.donationDataPoint.amountInUSD)&&void 0!==s?s:0,upsellAmount:this.currencyService.convert(a.amount,this.donationDataPoint.currency,"USD")}),a}baseChangeAmount(e){this.debouncedChangeAmount.cancel(),this.debouncedAmount=null,this.resetAmountValidationError(),this.checkoutState.donation.setDonationsAmount(e),this.checkoutService.syncUpdateCheckoutState();const t=this.donationDataPoint.frequency;this.produceViewState((n=>{n.donation.amount=this.donationDataPoint.amount,n.donation.donationItems=this.donationDataPoint.donationItemsDto,n.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(t),n.showFrequencyCustomAmountInput=!this.donationDataPoint.amountHint,n.donateButtonLabel=this.donateButtonLabel,n.tracking.donationItems=this.getDonationItemsTrackingData(),n.rateMatching=this.getRateMatching(e,n.donation.currency)})),this.fetchUpsellScreenDecision()}exposureCheckoutStepsExperiments(){this.experiments.get(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT).exposure()}tryExposePreDonationAmounts100200USDExperiments(){this.experiments.get(u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT).tryExpose({preDonationUpsellDataPoint:this.preDonationUpsellDataPoint})}getRateMatching(e,t){const n=this.rateMatchingService.getIsCountdownEnabled(new Date),i=this.rateMatchingService.getTotalAmountLimitInDonationCurrency(t,this.checkoutService.campaignConfig.defaultCurrency),s=this.rateMatchingService.getTotalAmountLimitWithRemains(t,this.checkoutService.campaignConfig.defaultCurrency),a=this.rateMatchingService.getMinRateMatchingAmount(t,this.checkoutService.campaignConfig.defaultCurrency),o=this.rateMatchingService.getMatchingImpact(e,s),r=this.rateMatchingService.isMatchingLimited(e,s),l=this.rateMatchingService.rateMatchingConfig,c=l.sponsorEnabled&&l.sponsor?l.sponsor:null,u=l.sponsorEnabled&&l.sponsorLogo?l.sponsorLogo:null;return{enabled:this.rateMatchingService.isRateMatchingEnabled,rate:l.rate,sponsor:c,sponsorLogo:u,minAmount:l.minAmount,endDate:this.rateMatchingService.getTimerEndDate(),sponsorEnabled:l.sponsorEnabled,totalAmountLimitEnabled:l.totalAmountLimitEnabled,matchingImpact:o,isMatchingLimited:r,isDonationMatched:this.rateMatchingService.isDonationMatched(e,a),minRateMatchingAmount:a,upsellAmountToAdd:this.rateMatchingService.getUpsellAmountToAdd(e,a),amountAfterUpsell:this.rateMatchingService.getAmountAfterUpsell(a,this.rateMatchingService.rateMatchingConfig.rate),isCountdownEnabled:n,isDaysCountdownEnabled:this.rateMatchingService.isDaysCountdownEnabled,isHourCountdownEnabled:this.rateMatchingService.isHourCountdownEnabled,totalAmountLimitInDonationCurrency:i,isDonationOverMaxLimit:this.rateMatchingService.isDonationOverMaxLimit(e,this.rateMatchingService.rateMatchingConfig.rate,i),isSponsorLogoShown:this.rateMatchingService.isSponsorLogoShown,isDonationLessThanMin:this.rateMatchingService.isDonationLessThanMin(e,a),isDonationEqualMin:this.rateMatchingService.isDonationEqualMin(e,a)}}shouldOpenCommentBottomSheet(){var e;const t=null===(e=this.checkoutService.checkoutConfiguration.external.flow)||void 0===e?void 0:e.screen;if(t===Ne.COMMENT){const e=this.flow.getHistoricalScreens(),n=this.flow.historyPreviousScreenName,i=1===e.length&&e[0]===Ne.DONATE_FORM&&null===n;return t===Ne.COMMENT&&this.commentDataPoint.isEnabled&&this.rateMatchingService.isRateMatchingEnabled&&i}return!1}resetAmountValidationError(){this.produceViewState((e=>{e.errors.amount.min=!1,e.errors.amount.max=!1,e.errors.amount.required=!1,e.errors.donationItems=e.errors.donationItems.map((e=>Object.assign(Object.assign({},e),{amount:{min:!1,max:!1,required:!1}}))),e.showError=!1}))}resetDonationItemValidationError(e){this.produceViewState((t=>{const n=t.donation.donationItems.findIndex((t=>t.id===e));-1!==n&&t.errors.donationItems[n]&&(t.errors.donationItems[n].amount={min:!1,max:!1,required:!1})}))}resetDonationItemsAmountValidation(){this.produceViewState((e=>{e.errors.donationItems=e.errors.donationItems.map((e=>Object.assign(Object.assign({},e),{amount:{min:!1,max:!1,required:!1}})))}))}resetAmountHint(){for(const e of this.donationDataPoint.donationItemsDto)this.checkoutState.donation.setDonationAmount(e.id,e.amount);this.checkoutService.syncUpdateCheckoutState();const e=this.donationDataPoint.frequency;this.produceViewState((t=>{t.donation.hintOptions=this.donationDataPoint.getFrequencyAmountHints(e),t.showFrequencyCustomAmountInput=!this.donationDataPoint.amountHint,t.hasAmountHintBeenReset=!0}))}syncDonationItemsErrors(){this.produceViewState((e=>{const t=e.donation.donationItems;e.errors.donationItems=t.map(((t,n)=>{const i=e.errors.donationItems[n];return{id:t.id,amount:(null==i?void 0:i.amount)||{min:!1,max:!1,required:!1},designation:(null==i?void 0:i.designation)||{required:!1}}}))}))}tryStartCheckoutWithoutPreDonationUpsellExperiment(){const e={canShowUpsellScreen:this.preDonationUpsellDataPoint.isEnabled,targetFrequency:this.preDonationUpsellDataPoint.upsellFrequency};this.checkoutWithoutPreDonationUpsellExperiment.tryStart(e),this.checkoutWithoutPreDonationUpsellExperiment.isEnabled(e)&&this.checkoutState.preDonationUpsell.setSuggestedAvailability(!1)}fetchUpsellScreenDecision(){return this.adaptivePreDonationUpsellSuggestionsService.resetSuggestionApplication(),this.tryStartCheckoutWithoutPreDonationUpsellExperiment(),this.adaptivePreDonationUpsellSuggestionsService.tryFetchSuggestion()}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}performFeeCoveringSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){(yield this.adaptiveFeeCoveringService.tryFetchSuggestion())&&(this.adaptiveFeeCoveringService.tryApplySuggestion(),this.adaptiveFeeCoveringService.tryTrackSuggestion())}))}performMlRequests(){return(0,d.sH)(this,void 0,void 0,(function*(){yield this.withPending((()=>(0,d.sH)(this,void 0,void 0,(function*(){this.setProcessingState(Xl.PENDING),(yield this.fetchUpsellScreenDecision())&&(this.adaptivePreDonationUpsellSuggestionsService.tryApplySuggestion(),this.adaptivePreDonationUpsellSuggestionsService.tryTrackSuggestion()),this.setProcessingState(Xl.IDLE)}))))}))}getGoalRepeat(e){return e===qn.ONCE?js.ONE_TIME:js.RECURRING}initializeAverageDonationHintExperiment(){const e=this.experiments.get(u.AVERAGE_DONATION_HINT_EXPERIMENT);e.tryStart({checkoutConfiguration:this.checkoutService.checkoutConfiguration,fiatDonationDataPoint:this.donationDataPoint}),e.exposure()}getDonationItemsTrackingData(){return this.donationItemsTrackingService.getDonationItemsTrackingData(this.isDesignationReadOnly(),this.isDesignationNotShown(),null)}applyDefaultAmountForSingleGoalChange(){var e;const t=null===(e=this.donationDataPoint.availableDonationItemsDto)||void 0===e?void 0:e[0];if(!t)return;const n=this.donationDataPoint.getFrequencyDefaultAmount(this.donationDataPoint.frequency);this.checkoutState.donation.setDonationAmount(t.id,n)}trackDonationItemsValidationError(){this.viewState.errors.donationItems.some((e=>void 0===e.amount))&&this.checkoutService.sendSentryLog(new Error("Donation items validation amount is undefined"),{extra:{donationItemsErrors:this.viewState.errors.donationItems,donationItems:this.viewState.donation.donationItems},fingerprint:["invalid-donation-items"]}),this.donationItemsTrackingService.trackDonationItemsValidationError(this.viewState.errors.donationItems,this.viewState.designations.selectedGoalsAvailability)}hasSelectedDesignations(){return this.designationsDataPoint.selectedGoals.length>0}isDesignationNotShown(){return!!this.hasSelectedDesignations()&&this.checkoutService.checkoutConfiguration.campaign.config.displayGoal===la.ASSIGN&&!this.checkoutService.checkoutConfiguration.campaign.config.showDesignation}tryInitializeDonateByVoiceExperiment(){this.checkoutState.process.setVoiceFlow(!1);const e=this.experiments.get(u.DONATE_BY_VOICE_V2_MODAL_EXPERIMENT);e.tryStart({companyKey:this.checkoutService.checkoutConfiguration.company.key,userCountry:this.checkoutService.checkoutConfiguration.user.address.countryCode,isStripeAccountConnected:!!this.checkoutService.checkoutConfiguration.company.stripeAccount,paymentOptions:this.checkoutService.checkoutConfiguration.company.paymentOptions,isAmountEditable:this.checkoutService.checkoutConfiguration.canModifyAmount,defaultCurrency:this.checkoutService.checkoutConfiguration.campaign.config.defaultCurrency,frequencies:this.checkoutService.checkoutConfiguration.campaign.config.frequencies,rateMatching:this.checkoutService.checkoutConfiguration.campaignPage.rateMatching}),this.produceViewState((t=>{t.isDonateByVoiceExperimentEnabled=e.isTestGroup}))}sendSentryLogInvalidDesignation(){const e=this.checkoutService.checkoutConfiguration.campaign.config.defaultGoals,t=this.checkoutService.checkoutConfiguration.campaign.config.displayGoal;t===la.ASSIGN&&e.length>1&&e.every((e=>null===e.frequency))&&this.checkoutService.sendSentryLog(new Error("Invalid designations for assign display goal"),{extra:{campaignKey:this.checkoutService.checkoutConfiguration.campaign.key,goals:e},fingerprint:["invalid-designations-assign"]}),t===la.ASSIGN&&0===e.length&&this.checkoutService.sendSentryLog(new Error("Display goal is assign and default goals are empty"),{extra:{campaignKey:this.checkoutService.checkoutConfiguration.campaign.key},fingerprint:["invalid-designations-assign-goals-empty"]})}}function NL(e){return e?XE.UPSELL_PAY_LATER:XE.CONTINUE}function DL(e,t){switch(e){case qn.DAILY:return t.translate("widgetSubscriptionPeriodLabel.daily.noun");case qn.WEEKLY:return t.translate("widgetSubscriptionPeriodLabel.weekly.noun");case qn.BIWEEKLY:return t.translate("widgetSubscriptionPeriodLabel.biweekly.noun");case qn.EVERY_4_WEEKS:return t.translate("widgetSubscriptionPeriodLabel.every4weeks.noun");case qn.MONTHLY:return t.translate("widgetSubscriptionPeriodLabel.monthly.noun");case qn.BIMONTHLY:return t.translate("widgetSubscriptionPeriodLabel.bimonthly.noun");case qn.QUARTERLY:return t.translate("widgetSubscriptionPeriodLabel.quarterly.noun");case qn.SEMIANNUAL:return t.translate("widgetSubscriptionPeriodLabel.semiannual.noun");case qn.ANNUAL:return t.translate("widgetSubscriptionPeriodLabel.annual.noun");default:throw new Bs.HP(e)}}class TL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.resetDtd();const e=this.getFormattedAmount(this.dtdDataPoint.dtdInitialTotal,this.dtdDataPoint.dtdCurrency),t=this.getFormattedAmount(this.dtdDataPoint.employerUpsellTotal,this.dtdDataPoint.dtdCurrency);let n="",i="",s="";const a=this.dtdDataPoint.dtdFrequency;a!==qn.ONCE?(n=this.intl.translate("doubleDonationScreen.button.donate.recurring",{amount:e,recurringType:DL(a,this.intl)}),i=this.intl.translate("doubleDonationScreen.button.changeAmount.recurring",{amount:t,recurringType:DL(a,this.intl)}),s=this.intl.translate("doubleDonationScreen.button.doNotChangeAmount.recurring",{amount:e,recurringType:DL(a,this.intl)})):(n=this.intl.translate("doubleDonationScreen.button.donate.once",{amount:e}),i=this.intl.translate("doubleDonationScreen.button.changeAmount.once",{amount:t}),s=this.intl.translate("doubleDonationScreen.button.doNotChangeAmount.once",{amount:e})),this.produceViewState((a=>{a.buttonType=NL(!1),a.total=this.dtdDataPoint.dtdInitialTotal,a.frequency=this.dtdDataPoint.dtdFrequency,a.currency=this.dtdDataPoint.dtdCurrency,a.isFeeCovered=this.dtdDataPoint.dtdInitialTotal!==this.dtdDataPoint.dtdInitialAmount,a.employer.name=this.dtdDataPoint.employerName,a.minimumMatchedAmount=this.dtdDataPoint.employerMinAmount,a.isIntegrationEnabled=this.dtdDataPoint.isIntegrationEnabled,a.showSkipButton=!0,a.matchingPromisedAmount=this.dtdDataPoint.employerUpsellTotalDoubled,a.matchingRatio=this.dtdDataPoint.employerRatio,a.proposedAmount=this.dtdDataPoint.employerUpsellTotal,a.proposedAmountBeforeFeeCovered=this.dtdDataPoint.employerRawMinAmount,a.formattedTotal=e,a.formattedUpsellTotal=t,a.declineButtonLabel=n,a.changeAmountButtonLabel=i,a.noChangeAmountButtonLabel=s,a.isAlreadyPaidAmountNotMatched=this.isAlreadyPaidAmountNotMatched()})),this.dtdDataPoint.employerId&&(this.setEmployerViewState(),this.checkoutState.doubleTheDonation.setUpsellShowed(this.viewState.showDTDUpsell&&this.viewState.showDTDUpsellExperiment))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutService.updateSession(),this.checkoutService.syncUpdateCheckoutState(),!0}))}changeEmployerName(e){e||this.resetEmployerDTD();const t=this.viewState.companies.some((t=>t.company_name.trim().toLocaleLowerCase()===e.trim().toLocaleLowerCase()));this.checkoutState.doubleTheDonation.setEmployerName(e),this.produceViewState((e=>{e.employer.name=this.dtdDataPoint.employerName,e.showEmployerMatchedBlock=t&&this.dtdDataPoint.employerMinAmount<=this.dtdDataPoint.dtdInitialTotal}))}skip(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.checkoutState.doubleTheDonation.setSkipped(),this.leave()}))}getDTDCompanies(e){return(0,d.sH)(this,void 0,void 0,(function*(){const t=yield this.dtdDataPoint.getEmployersByName(e);Jo()(t,this.viewState.companies)||this.produceViewState((e=>{e.companies=t}))}))}setEmployerDTD(e){const t=this.viewState.companies.find((t=>t.id===e));return!t||(this.checkoutState.doubleTheDonation.setEmployerData(t),this.setEmployerViewState(),this.checkoutState.doubleTheDonation.setUpsellShowed(this.viewState.showDTDUpsell&&this.viewState.showDTDUpsellExperiment),!1)}setEmployerViewState(){const e=this.getFormattedAmount(this.dtdDataPoint.employerUpsellTotal,this.dtdDataPoint.dtdCurrency);let t="";const n=this.dtdDataPoint.dtdFrequency;t=n!==qn.ONCE?this.intl.translate("doubleDonationScreen.button.changeAmount.recurring",{amount:e,recurringType:DL(n,this.intl)}):this.intl.translate("doubleDonationScreen.button.changeAmount.once",{amount:e}),this.produceViewState((n=>{n.employer.name=this.dtdDataPoint.employerName,n.showDTDDescription=!1,n.showDTDUpsell=this.dtdDataPoint.employerMinAmount>this.dtdDataPoint.dtdInitialTotal,n.showDTDUpsellExperiment=!this.isAlreadyPaidAmountNotMatched(),n.showSkipButton=!n.showDTDUpsell,n.showEmployerMatchedBlock=this.dtdDataPoint.employerMinAmount<=this.dtdDataPoint.dtdInitialTotal,n.DTDDoubledAmount=this.dtdDataPoint.dtdInitialTotalDoubled,n.minimumMatchedAmount=this.dtdDataPoint.employerMinAmount,n.upsellTotal=this.dtdDataPoint.employerUpsellTotal,n.formattedUpsellTotal=e,n.changeAmountButtonLabel=t,n.DTDUpsellDoubledAmount=this.dtdDataPoint.employerUpsellTotalDoubled,n.buttonType=NL(n.showDTDUpsell),n.matchingPromisedAmount=this.dtdDataPoint.employerUpsellTotalDoubled,n.matchingRatio=this.dtdDataPoint.employerRatio,n.proposedAmount=this.dtdDataPoint.employerUpsellTotal,n.proposedAmountBeforeFeeCovered=this.dtdDataPoint.employerRawMinAmount,n.isAlreadyPaidAmountNotMatched=this.isAlreadyPaidAmountNotMatched()}))}acceptUpsell(){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutState.doubleTheDonation.setUpsellAccepted(),this.checkoutState.donation.setDonationsAmount(this.dtdDataPoint.employerUpsellAmount),yield this.leave()}))}resetEmployerDTD(){this.checkoutState.doubleTheDonation.resetEmployerData(),this.produceViewState((e=>{e.showDTDDescription=!0,e.showDTDUpsell=!1,e.showSkipButton=!0,e.showEmployerMatchedBlock=!1,e.buttonType=NL(e.showDTDUpsell),e.isAlreadyPaidAmountNotMatched=this.isAlreadyPaidAmountNotMatched()}))}isAlreadyPaidAmountNotMatched(){return!this.checkoutService.checkoutConfiguration.infrastructureParams.showcase&&this.checkoutService.isPaid&&this.dtdDataPoint.employerMinAmount>this.dtdDataPoint.dtdInitialTotal}getInitialViewState(){return{locked:!1,showDTDDescription:!0,showEmployerMatchedBlock:!1,employer:{name:""},showDTDUpsell:!1,showDTDUpsellExperiment:!1,minimumMatchedAmount:0,DTDUpsellDoubledAmount:0,DTDDoubledAmount:0,currency:"USD",upsellTotal:0,showSkipButton:!0,total:0,processingState:Xl.IDLE,companies:[],buttonType:XE.CONTINUE,isFeeCovered:!1,matchingPromisedAmount:0,matchingRatio:[1,1],proposedAmount:0,proposedAmountBeforeFeeCovered:0,isIntegrationEnabled:!1,frequency:qn.ONCE,formattedTotal:"",formattedUpsellTotal:"",declineButtonLabel:"",changeAmountButtonLabel:"",noChangeAmountButtonLabel:"",isAlreadyPaidAmountNotMatched:!1,payErrorMessage:"",additionalPayErrorMessage:""}}get dtdDataPoint(){return this.checkoutState.doubleTheDonation.dataPoint}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}resetDtd(){this.dtdDataPoint.isUpsellAccepted&&this.checkoutState.donation.setDonationsAmount(this.dtdDataPoint.snapshot.dtdInitialAmount),this.checkoutState.doubleTheDonation.resetState()}getFormattedAmount(e,t){return this.intl.formatAmount({amount:e,currency:t,currencyFormat:Yt.SHORT,numberFormat:Kt.FLOAT,forceExplicit:!0})}}class kL extends dx{constructor(e){super(e),this.paymentService=e.paymentService}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{var t;e.isPaymentScreen=this.isPaymentScreen,e.formattedAmount=this.intl.formatCurrency(null!==(t=this.donationDataPoint.total)&&void 0!==t?t:0,{currency:this.donationDataPoint.currency,display:"floatcents"}),e.frequency=this.donationDataPoint.frequency}))}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.pending)return!1;if(this.pending=!0,this.setProcessingState(Xl.PENDING),!(yield this.paymentService.startSepaFlow()))return this.produceViewState((e=>{e.shakeKey+=1,e.processingState=Xl.IDLE})),this.pending=!1,!1;const e=yield this.checkoutService.hold();return wn.isFailure(e)?(this.pending=!1,yield this.showError(),!1):this.isPaymentScreen?this.pay():(this.pending=!1,!0)}))}initiateSepa(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){return this.paymentService.initiateSepa(e,t)}))}recalculatePaymentScreen(){this.produceViewState((e=>{e.isPaymentScreen=this.isPaymentScreen}))}getInitialViewState(){return{processingState:Xl.IDLE,shakeKey:0,locked:!1,isPaymentScreen:!1,formattedAmount:"",frequency:qn.ONCE}}get donationDataPoint(){return this.checkoutState.donation.dataPoint}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isFailure(e)?e.failureResult.shouldLeave?(this.pending=!1,!0):(this.pending=!1,yield this.showError(),!1):(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),this.pending=!1,!0)}))}showError(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")})),this.produceViewState((e=>{e.payErrorMessage=""}),!0)}))}setProcessingState(e){this.produceViewState((t=>{t.processingState=e}))}}class IL extends dx{constructor(e){super(e)}beforeEnter(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=this.processDataPoint.hasPaymentError;this.produceViewState((t=>{t.accountHolderName=this.ukBacsDataPoint.accountHolderName,t.accountNumber=this.ukBacsDataPoint.accountNumber,t.sortCode=this.ukBacsDataPoint.sortCode,t.termsChecked=this.ukBacsDataPoint.isTermsAccepted,e&&(t.shakeKey+=1)})),e&&(this.setProcessingState(Xl.ERROR),this.checkoutState.process.setInProgress())}))}beforeLeave(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.pending=!0;const e=this.ukBacsDataPoint.getValidationResult();return e.isValid?(this.setProcessingState(Xl.PENDING),this.produceViewState((e=>{e.payErrorMessage=""})),this.isPaymentScreen?this.pay():this.hold()):(this.produceViewState((t=>{t.errors.sortCode=!e.fields.sortCode.isValid,t.errors.accountNumber=!e.fields.accountNumber.isValid,t.errors.accountHolderName=!e.fields.accountHolderName.isValid,t.errors.termsChecked=!e.fields.isTermsAccepted.isValid,t.shakeKey+=1})),this.pending=!1,!1)}))}changeSortCode(e){e.length>6||(this.checkoutState.paymentOptions.setUkBacsSortCode(e),this.produceViewState((e=>{e.errors.sortCode=!1,e.sortCode=this.ukBacsDataPoint.sortCode})))}changeAccountNumber(e){e.length>17||(this.checkoutState.paymentOptions.setUkBacsAccountNumber(e),this.produceViewState((e=>{e.errors.accountNumber=!1,e.accountNumber=this.ukBacsDataPoint.accountNumber})))}changeAccountHolderName(e){this.checkoutState.paymentOptions.setUkBacsAccountHolderName(e),this.produceViewState((e=>{e.errors.accountHolderName=!1,e.accountHolderName=this.ukBacsDataPoint.accountHolderName}))}toggleTermsChecked(){this.checkoutState.paymentOptions.setUkBacsTermsAccepted(!this.ukBacsDataPoint.isTermsAccepted),this.produceViewState((e=>{e.errors.termsChecked=!1,e.termsChecked=this.ukBacsDataPoint.isTermsAccepted}))}fillDemoData(e){const t=IL.demoData.sortCode.split(""),n=IL.demoData.accountNumber.split(""),i=IL.demoData.accountHolderName.split(""),s=window.setInterval((()=>{var a,o,r;if(t.length)null===(a=e.sortCode.current)||void 0===a||a.focus(),this.changeSortCode(this.viewState.sortCode+t.shift());else if(n.length)null===(o=e.accountNumber.current)||void 0===o||o.focus(),this.changeAccountNumber(this.viewState.accountNumber+n.shift());else{if(!i.length)return clearInterval(s);null===(r=e.accountHolderName.current)||void 0===r||r.focus(),this.changeAccountHolderName(this.viewState.accountHolderName+i.shift())}}),50);return()=>clearInterval(s)}getInitialViewState(){return{locked:!1,accountNumber:"",sortCode:"",shakeKey:0,accountHolderName:"",termsChecked:!0,errors:{},processingState:Xl.IDLE,livemode:this.checkoutService.checkoutConfiguration.infrastructureParams.livemode,companyName:this.checkoutService.checkoutConfiguration.company.name}}get ukBacsDataPoint(){return this.checkoutState.paymentOptions.ukBacsDataPoint}get processDataPoint(){return this.checkoutState.process.dataPoint}get isPaymentScreen(){return this.name===this.checkoutService.getPaymentScreen(this.name,this.flow.getHistoricalScreens())}setProcessingState(e){this.produceViewState((t=>{t.payErrorMessage=this.checkoutService.payErrorMessage,t.processingState=e}))}pay(){return(0,d.sH)(this,void 0,void 0,(function*(){this.pending=!0;const e=yield this.checkoutService.hold();if(wn.isFailure(e))return this.handlePayFailure(e);const t=yield this.checkoutService.pay({screen:this.name,predictedNextScreen:this.flow.predictNextScreen()});return wn.isFailure(t)?this.handlePayFailure(t):(this.setProcessingState(Xl.SUCCESS),yield Ri(this.checkoutService.checkoutConfiguration.successPaymentDelayBeforeLeave),this.pending=!1,!0)}))}handlePayFailure(e){return(0,d.sH)(this,void 0,void 0,(function*(){return e.failureResult.shouldLeave?(this.pending=!1,!0):(yield this.showError(),this.pending=!1,!1)}))}hold(){return(0,d.sH)(this,void 0,void 0,(function*(){const e=yield this.withPending((()=>this.checkoutService.hold()));return!wn.isFailure(e)||(yield this.showError(),!1)}))}showError(){return(0,d.sH)(this,void 0,void 0,(function*(){this.produceViewState((e=>{e.processingState=Xl.ERROR,e.payErrorMessage=this.checkoutService.payErrorMessage||this.intl.translate("common.errorOccurredText")}))}))}}IL.demoData={sortCode:"108800",accountNumber:"00012345",accountHolderName:"Michael Smith"};const _L={[Vn.US_BANK_ACCOUNT]:class extends mL{},[Vn.US_BANK_ACCOUNT_DONATE_OPTIONS]:class extends gL{},[Vn.US_BANK_ACCOUNT_CONFIRMATION]:class extends pL{},[Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE]:class extends yL{},[Vn.AU_BECS]:class extends nL{},[Vn.DONATE]:class extends PL{},[Vn.DOUBLE]:class extends TL{},[Vn.GIFT_AID]:class extends oL{},[Vn.PAYMENT_OPTIONS]:class extends uL{},[Vn.SEPA]:class extends kL{},[Vn.IDEAL_CONFIRMATION]:class extends rL{},[Vn.UK_BACS]:class extends IL{},[Vn.UK_BACS_CONFIRMATION]:class extends dL{},[Vn.UPSELL]:class extends hL{},[Vn.COMMUNICATION_CONSENT]:class extends sL{},[Vn.FAST_TRACK_PAYMENT_OPTIONS]:class extends aL{},[Vn.DONATE_BY_VOICE]:class extends tL{},[wl.MANDATORY_QUESTIONS]:class extends fx{},[wl.QUESTIONS]:class extends Px{},[wl.COMMENT]:class extends mx{},[wl.MAILING_ADDRESS]:class extends yx{},[wl.PRIVACY]:class extends bx{},[wl.THANK_YOU]:class extends Gx{},[wl.REMIND_ME]:Nx,[wl.BLOCKED]:class extends hx{}};class OL{getDisplayedOptions(e){let{visibleOptions:t,selectedOption:n,showAll:i}=e;const s=this.getMaxVisibleOptionsLength(t);return i||4===s?t:this.getFirstOptions(t,s,n)}getMaxVisibleOptionsLength(e){return e.length<=4?4:3}getFirstOptions(e,t,n){const i=e.slice(0,t),s=e.findIndex((e=>e===n));return!n||s<t?i:[...i.slice(0,-1),n]}}class xL{static isDonateScreenController(e,t){return t===Vn.DONATE}static isPaymentOptionScreenController(e,t){return t===Vn.PAYMENT_OPTIONS}static isDoubleDonationScreenController(e,t){return t===Vn.DOUBLE}static isGiftAidScreenController(e,t){return t===Vn.GIFT_AID}static isUSBankAccountScreenController(e,t){return t===Vn.US_BANK_ACCOUNT}static isUSBankAccountDonateOptionsScreenController(e,t){return t===Vn.US_BANK_ACCOUNT_DONATE_OPTIONS}static isUSBankAccountConfirmationScreenController(e,t){return t===Vn.US_BANK_ACCOUNT_CONFIRMATION}static isUSBankAccountVerificationGuideScreenController(e,t){return t===Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE}static isIDEALConfirmationScreenController(e,t){return t===Vn.IDEAL_CONFIRMATION}static isSepaConversionScreenController(e,t){return t===Vn.SEPA}static isUKBacsScreenController(e,t){return t===Vn.UK_BACS}static isUKBacsConfirmationScreenController(e,t){return t===Vn.UK_BACS_CONFIRMATION}static isUpsellScreenController(e,t){return t===Vn.UPSELL}static isAUBecsScreenController(e,t){return t===Vn.AU_BECS}static isThankYouScreenController(e,t){return t===wl.THANK_YOU}static isMailingAddressScreenController(e,t){return t===wl.MAILING_ADDRESS}static isBlockedScreenController(e,t){return t===wl.BLOCKED}static isCommunicationConsentScreenController(e,t){return t===Vn.COMMUNICATION_CONSENT}static isPrivacyScreenController(e,t){return t===wl.PRIVACY}static isFastTrackPaymentOptionsScreenController(e,t){return t===Vn.FAST_TRACK_PAYMENT_OPTIONS}static isDonateByVoiceScreenController(e,t){return t===Vn.DONATE_BY_VOICE}constructor(e,t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y){this.checkoutService=e,this.checkoutState=t,this.paymentService=n,this.intl=i,this.debug=s,this.subscriptionPeriodLabelsService=a,this.mailingAddressCustomization=o,this.currencyService=r,this.suggestionsService=l,this.experiments=c,this.adaptivePreDonationUpsellSuggestionsService=u,this.feeCoveringSuggestions=d,this.donorRatingCalculator=h,this.donorRatingRecommendationCalculator=m,this.designationsFetcher=p,this.tracker=g,this.rateMatchingService=y}create(e,t){const n=_L[e],i={name:e,flow:t,checkoutService:this.checkoutService,checkoutState:this.checkoutState,debug:this.debug,intl:this.intl,subscriptionPeriodLabelsService:this.subscriptionPeriodLabelsService,currencyService:this.currencyService,experiments:this.experiments};return xL.isDonateScreenController(n,e)?new n(Object.assign(Object.assign({},i),{adaptivePreDonationUpsellSuggestionsService:this.adaptivePreDonationUpsellSuggestionsService}),this.upsellAggregate,this.feeCoveringSuggestions,this.donorRatingCalculator,this.donorRatingRecommendationCalculator,this.designationsFetcher,this.tracker,this.paymentService,this.rateMatchingService):xL.isPaymentOptionScreenController(n,e)?new n(Object.assign(Object.assign({},i),{paymentService:this.paymentService,paymentOptionListService:new OL})):xL.isAUBecsScreenController(n,e)||xL.isSepaConversionScreenController(n,e)?new n(Object.assign(Object.assign({},i),{paymentService:this.paymentService})):xL.isDoubleDonationScreenController(n,e)||xL.isGiftAidScreenController(n,e)?new n(Object.assign({},i)):xL.isUSBankAccountScreenController(n,e)?new n(i):xL.isUSBankAccountDonateOptionsScreenController(n,e)?new n(this.paymentService,i):xL.isUSBankAccountConfirmationScreenController(n,e)||xL.isUSBankAccountVerificationGuideScreenController(n,e)?new n(i):xL.isIDEALConfirmationScreenController(n,e)?new n(Object.assign(Object.assign({},i),{paymentService:this.paymentService})):xL.isUKBacsScreenController(n,e)||xL.isUKBacsConfirmationScreenController(n,e)?new n(Object.assign({},i)):xL.isUpsellScreenController(n,e)?new n(this.upsellAggregate,this.feeCoveringSuggestions,i):xL.isThankYouScreenController(n,e)?new n(this.redirectApi,this.sharingApi,Object.assign(Object.assign({},i),{suggestionsService:this.suggestionsService})):xL.isMailingAddressScreenController(n,e)?new n(this.countriesService,this.mailingAddressCustomization,this.tracker,i):xL.isBlockedScreenController(n,e)||xL.isCommunicationConsentScreenController(n,e)?new n(i):xL.isPrivacyScreenController(n,e)||xL.isFastTrackPaymentOptionsScreenController(n,e)||xL.isDonateByVoiceScreenController(n,e)?new n(Object.assign(Object.assign({},i),{paymentService:this.paymentService})):new n(i)}get redirectApi(){return this.checkoutService.redirectApi}get sharingApi(){return this._sharingApi||(this._sharingApi=cx({checkoutType:this.checkoutService.checkoutConfiguration.checkoutType,isShowcase:this.checkoutService.checkoutConfiguration.infrastructureParams.showcase,campaignConfig:this.checkoutService.campaignConfig})),this._sharingApi}get countriesService(){return this._countriesService||(this._countriesService=(0,nk.g)({intl:this.intl,excludePalestineFromCountriesList:this.checkoutService.checkoutConfiguration.featureConfig.excludePalestineFromCountriesList})),this._countriesService}get upsellAggregate(){return this._upsellAggregate||(this._upsellAggregate=new eL(this.checkoutState,this.intl)),this._upsellAggregate}}function wL(e){return Object.values(e).filter((e=>e.enabled)).length>1}class RL{constructor(e){this.deviceExperimentsSettings=e}getSuggestions(e){if(this.shouldSortSuggestions)return this.sortSuggestionsBasedOnCompanyExclusions(e)}getAmount(){if(this.shouldHideDefaultAmount)return this.showAmountBasedOnCompanyExclusions()}get shouldSortSuggestions(){return"ascSort"in this.deviceExperimentsSettings}get shouldHideDefaultAmount(){return"hasDefault"in this.deviceExperimentsSettings}sortSuggestionsBasedOnCompanyExclusions(e){return mk([...e],this.deviceExperimentsSettings.ascSort?ra.ASC:ra.DESC)}showAmountBasedOnCompanyExclusions(){if(!this.deviceExperimentsSettings.hasDefault)return null}}class ML{static convertMinAmount(e,t,n,i){let s=Math.max(t,e.convert(100,"USD",n));s=e.convert(s,n,i);const a=e.getDigits(i);return Math.ceil(s/Math.pow(10,a))*Math.pow(10,a)}constructor(e,t,n){var i,s;this.currencyService=t,this.suggestionsService=n,this.forceNullAmountWidgets=["FUNFXDEZPWX"],this.defaultData=Object.assign(Object.assign({},e),{disableCompanyExclusionLogic:{amounts:Boolean(null===(i=e.disableCompanyExclusionLogic)||void 0===i?void 0:i.amounts),suggestions:Boolean(null===(s=e.disableCompanyExclusionLogic)||void 0===s?void 0:s.suggestions)}}),this.currentData={frequency:this.defaultData.frequency,amount:this.defaultData.defaultAmount,minAmount:this.defaultData.minAmount||0,suggestions:this.defaultData.amountOptions,hintsAmounts:this.defaultData.hintsAmounts,isDonationEndDateActive:!this.defaultData.isExternalDonationEndDateShown||!!this.defaultData.isExternalDonationEndDateActive},this.setupCurrentData()}get amount(){return this.currentData.amount}get minAmount(){return this.currentData.minAmount}get isValidAmount(){return null!==this.currentData.amount&&this.currentData.amount>=this.currentData.minAmount}get suggestions(){return this.currentData.suggestions}get hintsAmounts(){return this.currentData.hintsAmounts||null}get currency(){return this.defaultData.currentCurrency}get currencyDigits(){return this.currencyService.getDigits(this.defaultData.currentCurrency)}get isDonationEndDateActive(){return this.currentData.isDonationEndDateActive}setDonationEndDateActive(e){this.currentData.isDonationEndDateActive=e}setAmount(e){this.currentData.amount=e,this.defaultData.disableAmountAI=!0}setCurrency(e,t){this.defaultData.previousCurrency=this.defaultData.currentCurrency,this.defaultData.currentCurrency=e,this.defaultData.disableAmountAI=!0,this.resetMinAmount(),t||(this.resetAmount(),this.applyNAIAmount(),this.applyRoundAmount()),this.resetSuggestions(),this.applyNAISuggestions(),this.applyRoundSuggestions(),this.resetHints(),this.applyRoundHints(),this.applyCompanyExclusions(),this.applyWidgetExclusions()}setSuggestionsAndDisableAi(e,t){this.defaultData.amountOptions=t,this.currentData.suggestions=e,this.defaultData.disableSuggestionsAI=!0}get needNAIAmount(){return Boolean(this.defaultData.aiEnabled&&!this.defaultData.showcase&&this.defaultData.trend&&!this.defaultData.disableAmountAI)}get needNAISuggestions(){return Boolean(this.defaultData.aiEnabled&&!this.defaultData.disableSuggestionsAI&&!this.defaultData.showcase&&this.defaultData.trend)}get suggestionsMultiplier(){return!this.defaultData.isLauncher&&this.defaultData.aiEnabled&&!this.defaultData.disableSuggestionsAI&&this.deviceExperimentsSettings.multiplySuggestions?1.4:1}get deviceExperimentsSettings(){return this.defaultData.experimentsSettings[this.defaultData.isMobile?Is.MOBILE:Is.DESKTOP]}setupCurrentData(){this.resetMinAmount(),this.resetAmount(),this.applyNAIAmount(),this.applyRoundAmount(),this.resetSuggestions(),this.applyNAISuggestions(),this.applyRoundSuggestions(),this.resetHints(),this.applyRoundHints(),this.applyCompanyExclusions(),this.applyWidgetExclusions()}resetMinAmount(){this.currentData.minAmount=ML.convertMinAmount(this.currencyService,this.defaultData.minAmount||0,this.defaultData.defaultCurrency,this.defaultData.currentCurrency)}resetAmount(){null!==this.currentData.amount&&(this.currentData.amount=this.currencyService.convert(this.currentData.amount,this.defaultData.previousCurrency,this.defaultData.currentCurrency,this.defaultData.aiEnabled&&!this.defaultData.disableAmountAI,this.defaultData.countryCode))}applyNAIAmount(){const e=this.defaultData.trend[this.currentData.frequency];if(null!==this.currentData.amount&&this.needNAIAmount){let t=this.currencyService.convert(e,this.defaultData.defaultCurrency,this.defaultData.currentCurrency,!1,this.defaultData.countryCode);TM(this.currentData.amount,e)>10&&(t=this.currentData.amount-this.currentData.amount/10),this.currentData.amount=e?t:dk(this.defaultData.xFactor,this.currentData.amount)}}applyRoundAmount(){null!==this.currentData.amount&&(this.needNAIAmount||this.defaultData.previousCurrency!==this.defaultData.currentCurrency)&&(this.currentData.amount=this.suggestionsService.beautify(this.currentData.amount,this.defaultData.currentCurrency,this.currentData.minAmount))}resetSuggestions(){this.currentData.suggestions=this.defaultData.amountOptions.map((e=>this.currencyService.convert(e,this.defaultData.defaultCurrency,this.defaultData.currentCurrency,this.defaultData.aiEnabled&&!this.defaultData.disableSuggestionsAI,this.defaultData.countryCode)))}applyNAISuggestions(){this.needNAISuggestions&&(this.currentData.suggestions=hk(this.defaultData.xFactor,this.currentData.suggestions))}applyRoundSuggestions(){if(this.needNAISuggestions||this.defaultData.currentCurrency!==this.defaultData.defaultCurrency){const e=this.currentData.suggestions.map((e=>{const t=e*this.suggestionsMultiplier;return this.defaultData.aiEnabled?Math.max(t,this.currentData.minAmount):t}));this.currentData.suggestions=this.suggestionsService.beautify(e,this.defaultData.currentCurrency,this.currentData.minAmount)}}resetHints(){this.defaultData.hintsAmounts&&(this.currentData.hintsAmounts=this.defaultData.hintsAmounts.map((e=>this.currencyService.convert(e,this.defaultData.defaultCurrency,this.defaultData.currentCurrency,!1,this.defaultData.countryCode))))}applyRoundHints(){this.currentData.hintsAmounts&&this.defaultData.currentCurrency!==this.defaultData.defaultCurrency&&(this.currentData.hintsAmounts=this.suggestionsService.beautify(this.currentData.hintsAmounts,this.defaultData.currentCurrency,this.currentData.minAmount))}applyCompanyExclusions(){const e=this.defaultData.disableCompanyExclusionLogic.amounts||this.defaultData.disableCompanyExclusionLogic.suggestions;if(!this.defaultData.aiEnabled&&!e)return;const t=new RL(this.deviceExperimentsSettings),n=t.getSuggestions(this.currentData.suggestions);if(!n||this.defaultData.disableCompanyExclusionLogic.suggestions||this.defaultData.disableSuggestionsAI||(this.currentData.suggestions=n),this.defaultData.disableAmountAI)return;const i=t.getAmount();null!==i||this.defaultData.disableCompanyExclusionLogic.amounts||(this.currentData.amount=i)}applyWidgetExclusions(){this.defaultData.widgetKey&&this.forceNullAmountWidgets.includes(this.defaultData.widgetKey)&&(this.currentData.amount=null)}}class LL{static get frequencyOrder(){return Ti}static convertMinAmount(e,t,n,i){let s=Math.max(t,LL.getMinInWidgetCurrency(e,n));s=e.convert(s,n,i);const a=e.getDigits(i);return Math.ceil(s/Math.pow(10,a))*Math.pow(10,a)}static getMinInWidgetCurrency(e,t){return e.convert(100,"USD",t)}constructor(e,t,n,i){if(this.exchequerCurrencyService=t,this.currencyService=n,this.suggestionsService=i,this.currentFrequency=qn.ONCE,this.strategyMap=new Map,this._enabledFrequencies=[],this.frequencies=Object.keys(e.frequencies),this._enabledFrequencies=Object.entries(e.frequencies).filter((e=>{let[,t]=e;return t.enabled})).map((e=>{let[t]=e;return t})),this.initStrategies(e),e.forceDefaultAmount){const t=this.getCurrentCurrency();this.setCurrency(e.defaultCurrency),this.setAmounts(e.forceDefaultAmount),this.setCurrency(t)}}get enabledFrequencies(){return this._enabledFrequencies}get isDonationEndDateActive(){return this.getStrategy(this.currentFrequency).isDonationEndDateActive}getCurrentFrequency(){return this.currentFrequency}getCurrentAmount(){return this.getStrategy(this.currentFrequency).amount}getCurrentCurrency(){return this.getStrategy(this.currentFrequency).currency}getAllAmounts(){const e={};for(const t of this.frequencies)e[t]=this.getStrategy(t).amount;return e}getAllMinAmounts(){const e={};for(const t of this.frequencies)e[t]=this.getStrategy(t).minAmount;return e}getAllSuggestions(){const e={};for(const t of this.frequencies)e[t]=this.getStrategy(t).suggestions;return e}setDonationEndDateActive(e){this.getStrategy(this.currentFrequency).setDonationEndDateActive(e)}setSuggestionsAndDisableAi(e,t,n){this.getStrategy(n).setSuggestionsAndDisableAi(e,t)}getAllHintsAmounts(){const e={};for(const t of this.frequencies)e[t]=this.getStrategy(t).hintsAmounts;return e}getGuessedCurrency(){return this.exchequerCurrencyService.guessedCurrency}getGuessedCurrenciesList(){return this.exchequerCurrencyService.guessedCurrenciesList}setFrequency(e){return this.currentFrequency=e,this}setAmount(e){return this.getStrategy(this.currentFrequency).setAmount(e),this}setAmountForFrequency(e,t){return this.getStrategy(t).setAmount(e),this}setAmounts(e){return this.strategyMap.forEach((t=>{t.setAmount(e)})),this}setCurrency(e,t){return this.strategyMap.forEach((n=>{n.setCurrency(e,t)})),this}getHighestFrequency(){if(1===this.enabledFrequencies.length)return this.enabledFrequencies[0];let e=this.enabledFrequencies[0];for(const t of this.enabledFrequencies)LL.frequencyOrder[t]>LL.frequencyOrder[e]&&(e=t);return e}getLowestFrequency(){if(1===this.enabledFrequencies.length)return this.enabledFrequencies[0];let e=this.enabledFrequencies[0];for(const t of this.enabledFrequencies)LL.frequencyOrder[t]<LL.frequencyOrder[e]&&(e=t);return e}getCurrentState(){const e=this.getStrategy(this.currentFrequency);return{frequency:this.currentFrequency,amount:e.amount,minAmount:e.minAmount,isValidAmount:e.isValidAmount,suggestions:e.suggestions,hintsAmounts:e.hintsAmounts,currency:e.currency,currencyDigits:e.currencyDigits,guessedCurrenciesList:this.exchequerCurrencyService.guessedCurrenciesList,guessedCurrency:this.exchequerCurrencyService.guessedCurrency}}getStrategy(e){const t=this.strategyMap.get(e);if(!t)throw new Error(`Strategy for frequency ${e} is not defined`);return t}initStrategies(e){for(const t of this.frequencies){e.frequencies[t].default&&(this.currentFrequency=t);const n=Ni[t].map(((n,i)=>e.frequencies[t].amountOptions[i]||n)),i=e.hintsAmounts&&e.hintsAmounts[t]||null,s=this.shouldDisableAi(t,e);this.strategyMap.set(t,new ML({widgetKey:e.widgetKey,countryCode:e.countryCode,defaultCurrency:e.defaultCurrency,isMobile:e.isMobile,isLauncher:e.isLauncher,showcase:e.showcase,aiEnabled:e.aiEnabled&&!s,disableAmountAI:e.disableAmountAI,disableSuggestionsAI:e.disableSuggestionsAI,trend:e.trend,xFactor:e.xFactor,disableCompanyExclusionLogic:e.disableCompanyExclusionLogic,experimentsSettings:e.experimentsSettings,frequency:t,minAmount:e.frequencies[t].minAmount,defaultAmount:e.frequencies[t].defaultAmount,amountOptions:n,currentCurrency:this.exchequerCurrencyService.defaultCurrentCurrency,previousCurrency:this.exchequerCurrencyService.defaultPreviousCurrency,isExternalDonationEndDateShown:e.isExternalDonationEndDateShown,isExternalDonationEndDateActive:e.isExternalDonationEndDateActive,hintsAmounts:i},this.currencyService,this.suggestionsService))}}shouldDisableAi(e,t){return"FUNGQSSKQKB"===t.widgetKey&&t.isMobile&&e===qn.ONCE}}class FL extends $x{constructor(e){super({checkoutConfiguration:e.checkoutConfiguration,isValidScreen:e.isValidScreen}),this.options=e}getInitialScreen(){return(0,d.sH)(this,void 0,void 0,(function*(){if(this.isCompanyBlocked())return wl.BLOCKED;const e=this.getInitialScreenFromHistory()||this.getCustomExternalParamsScreen();return void 0!==e?e===wl.COMMENT&&this.shouldOpenCommentBottomSheetOnDonateScreen()?Vn.DONATE:e:this.canSkipDefaultScreen()?(this.options.checkoutService.updateSessionWidgetDefaults(),this.tryApplyFeeCoveringSuggestion(),this.tryExposeCheckoutStepsExperiments(),(yield this.shouldShowPreDonationUpsell())?Vn.UPSELL:wl.PRIVACY):Vn.DONATE}))}get isAmountsValid(){return function(e,t,n){var i,s,a,o,r,l,c;let u=null===(s=null===(i=e.state)||void 0===i?void 0:i.donation)||void 0===s?void 0:s.frequency;const d=!wL(t.frequencies);!u&&d&&(u=null!==(a=Gs.getDefaultFrequencyWithOverride(t.frequencies,null))&&void 0!==a?a:void 0);const h=null===(r=null===(o=e.state)||void 0===o?void 0:o.donation)||void 0===r?void 0:r.amount,m=(null===(c=null===(l=e.state)||void 0===l?void 0:l.donation)||void 0===c?void 0:c.currency)||t.defaultCurrency;if(!u||!h||!m)return!1;const p=t.frequencies[u].minAmount,g=LL.convertMinAmount(n,p||0,t.defaultCurrency,m),y=h.toString().length>(0,Na.Bm)(m);return!(h<g||y)}(this.options.checkoutConfiguration.external,this.options.checkoutConfiguration.campaign.config,this.options.currencyService)}get preDonationUpsellDataPoint(){return this.options.checkoutState.preDonationUpsell.dataPoint}shouldOpenCommentBottomSheetOnDonateScreen(){return!!this.options.checkoutState.comment.dataPoint.isEnabled&&this.options.rateMatchingService.isRateMatchingEnabled}isCompanyBlocked(){return Boolean(this.options.checkoutConfiguration.company.blockedAt)}canSkipDefaultScreen(){return function(e){var t,n,i,s,a,o;const r=e.campaign.config,l=e.external,c=e.element.type;if(!c)return!1;if(r.showComment)return!1;const u=e.canModifyAmount,d=[Hn.DONATION_FORM,Hn.SIMPLE_FORM,Hn.BUTTON_GROUP,Hn.IMPACT_SLIDER];if(u&&!d.includes(c))return!1;const h=r.frequencies,m=c===Hn.DONATION_FORM,p=wL(h);if(!m&&p)return!1;if(!function(e,t,n){if(!e.show)return!0;if(!t)return!1;const i=null==n?void 0:n.inHonorOf,s=null==n?void 0:n.type,a=!!i&&s!==Ma.NONE,o=!i&&s===Ma.NONE;return a||o}(r.tribute,m,null===(t=l.state)||void 0===t?void 0:t.tribute))return!1;const g=!!(null===(i=null===(n=l.state)||void 0===n?void 0:n.donation)||void 0===i?void 0:i.isEndDateSelected);return!((null===(a=null===(s=l.state)||void 0===s?void 0:s.donation)||void 0===a?void 0:a.frequency)&&(null===(o=h[l.state.donation.frequency])||void 0===o?void 0:o.hasEndDate)&&!g)}(this.options.checkoutConfiguration)&&this.isAmountsValid&&this.isDesignationFilled()}isDesignationFilled(){var e,t,n,i;const s=this.options.checkoutConfiguration,a=this.options.checkoutState;if(a.designations.dataPoint.isDesignationReadOnly)return!0;if(!s.campaign.config.showDesignation&&s.campaign.config.displayGoal===la.ASSIGN)return!0;const o=null===(t=null===(e=s.external.state)||void 0===e?void 0:e.designation)||void 0===t?void 0:t.id;return!!o&&(null===(i=null===(n=a.designations.dataPoint.selectedGoals)||void 0===n?void 0:n[0])||void 0===i?void 0:i.id)===o}shouldShowPreDonationUpsell(){return(0,d.sH)(this,void 0,void 0,(function*(){return this.options.adaptivePreDonationUpsellSuggestionsService.resetSuggestionApplication(),this.tryApplyCheckoutWithoutPreDonationUpsellExperiment(),(yield this.options.adaptivePreDonationUpsellSuggestionsService.tryFetchSuggestion())&&this.options.adaptivePreDonationUpsellSuggestionsService.tryApplySuggestion(),this.tryExposePreDonationAmounts100200USDModalExperiment(),this.preDonationUpsellDataPoint.isEnabled}))}tryExposePreDonationAmounts100200USDModalExperiment(){this.options.experiments.get(u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT).tryExpose({preDonationUpsellDataPoint:this.preDonationUpsellDataPoint})}tryApplyFeeCoveringSuggestion(){return(0,d.sH)(this,void 0,void 0,(function*(){(yield this.options.adaptiveFeeCoveringService.tryFetchSuggestion())&&this.options.adaptiveFeeCoveringService.tryApplySuggestion()}))}tryExposeCheckoutStepsExperiments(){this.options.experiments.get(u.CHECKOUT_STEPS_CHECKOUT_MODAL_EXPERIMENT).exposure()}tryApplyCheckoutWithoutPreDonationUpsellExperiment(){const e={canShowUpsellScreen:this.preDonationUpsellDataPoint.isEnabled,targetFrequency:this.preDonationUpsellDataPoint.upsellFrequency},t=this.options.experiments.get(u.CHECKOUT_WITHOUT_PRE_DONATION_UPSELL_EXPERIMENT);t.tryStart(e),t.isEnabled(e)&&this.options.checkoutState.preDonationUpsell.setSuggestedAvailability(!1)}}class UL{constructor(e,t){this.checkoutState=e,this.params=t}get(e,t){switch(this.checkoutState.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod){case Gn.UK_BACS:return this.params.screenSet.ukBacsConfirmation;case Gn.US_BANK_ACCOUNT:return this.params.screenSet.usBankAccountConfirmation;case Gn.IDEAL:return this.params.screenSet.idealConfirmation;case Gn.CARD:return this.params.screenSet.paymentOptions;case Gn.AU_BECS:return this.params.screenSet.auBecs;case Gn.SEPA:return this.getScreenForSepaPaymentMethod(e,t);case Gn.ACSS:case Gn.APPLE_PAY:case Gn.GOOGLE_PAY:case Gn.VENMO:case Gn.PAYPAL:default:return this.params.screenSet.paymentOptions}}getScreenForSepaPaymentMethod(e,t){const n=e===this.params.screenSet.sepa,i=e===this.params.screenSet.mailingAddress,s=t.includes(this.params.screenSet.mailingAddress),a=this.checkoutState.mailingAddress.dataPoint.isRequired;return n&&a&&!s||i&&a?this.params.screenSet.mailingAddress:this.params.screenSet.sepa}}const jL=(e,t,n)=>{if(e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod!==t)throw new Error(`Can not move to ${n} screen if "clientPaymentMethod" is not "${t}"`);return!1},BL=e=>e.every(Boolean),GL=e=>e.some(Boolean),qL=(e,t)=>{var n;return BL([!t.has(Vn.DOUBLE),e.doubleTheDonation.dataPoint.isEnabled,GL([e.process.dataPoint.isCompleted,BL([e.doubleTheDonation.dataPoint.isIntegrationEnabled,(null!==(n=e.donation.dataPoint.amountInUSD)&&void 0!==n?n:0)<2500])])])},VL=(e,t)=>BL([!t.has(Vn.GIFT_AID),e.giftAid.dataPoint.isEnabled]),HL=(e,t)=>BL([!t.has(wl.MAILING_ADDRESS),e.mailingAddress.dataPoint.isEnabled,GL([BL([e.process.dataPoint.isCompleted,!e.mailingAddress.dataPoint.isRequired]),BL([!e.process.dataPoint.isCompleted,e.mailingAddress.dataPoint.isRequired])])]),KL=e=>BL([!e.process.dataPoint.isCompleted]),YL=e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.UK_BACS]),zL=e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT_VERIFICATION]),WL=e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT]),$L=e=>BL([e.questions.dataPoint.isEnabled]),XL=(e,t)=>BL([e.questions.dataPoint.isMandatoryQuestionsScreenEnabled,!t.has(wl.MANDATORY_QUESTIONS)]),QL=(e,t)=>BL([!e.process.dataPoint.isCompleted,!t.has(wl.MANDATORY_QUESTIONS),e.questions.dataPoint.isMandatoryQuestionsScreenEnabled,e.paymentOptions.paymentOptionsDataPoint.isFastTrackFlow]),ZL=(e,t)=>BL([!t.has(Vn.COMMUNICATION_CONSENT),e.communicationConsent.dataPoint.isCustomizedConsentEnabled,GL([!e.mailingAddress.dataPoint.isEnabled,t.has(wl.MAILING_ADDRESS)])]),JL=e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.isFastTrackFlow]),eF=Vn.DONATE;function tF(){return{initial:()=>eF,screens:{[Vn.DONATE]:{next:(e,t)=>{switch(!0){case(e=>e.process.dataPoint.isVoiceFlow)(e):return Vn.DONATE_BY_VOICE;case(e=>BL([e.comment.dataPoint.isEnabled,e.comment.dataPoint.isRequired]))(e):return wl.COMMENT;case(e=>BL([e.preDonationUpsell.dataPoint.isEnabled]))(e):return Vn.UPSELL;default:return wl.PRIVACY}}},[wl.COMMENT]:{next:()=>Vn.DONATE},[Vn.UPSELL]:{next:()=>wl.PRIVACY},[wl.PRIVACY]:{next:(e,t)=>{switch(!0){case qL(e,t):return Vn.DOUBLE;case VL(e,t):return Vn.GIFT_AID;case QL(e,t):return wl.MANDATORY_QUESTIONS;case JL(e):return Vn.FAST_TRACK_PAYMENT_OPTIONS;case HL(e,t):return wl.MAILING_ADDRESS;case XL(e,t):return wl.MANDATORY_QUESTIONS;default:return Vn.PAYMENT_OPTIONS}}},[Vn.DOUBLE]:{next:(e,t)=>{switch(!0){case VL(e,t):return Vn.GIFT_AID;case QL(e,t):return wl.MANDATORY_QUESTIONS;case JL(e):return Vn.FAST_TRACK_PAYMENT_OPTIONS;case HL(e,t):return wl.MAILING_ADDRESS;case XL(e,t):return wl.MANDATORY_QUESTIONS;case KL(e):return Vn.PAYMENT_OPTIONS;default:return nF(e,t)}}},[Vn.GIFT_AID]:{next:(e,t)=>{switch(!0){case QL(e,t):return wl.MANDATORY_QUESTIONS;case JL(e):return Vn.FAST_TRACK_PAYMENT_OPTIONS;case HL(e,t):return wl.MAILING_ADDRESS;case XL(e,t):return wl.MANDATORY_QUESTIONS;default:return Vn.PAYMENT_OPTIONS}}},[wl.MAILING_ADDRESS]:{mandatory:e=>(e=>BL([e.process.dataPoint.hasMailingAddressError]))(e),next:(e,t)=>{switch(!0){case YL(e):return Vn.UK_BACS_CONFIRMATION;case WL(e):return Vn.US_BANK_ACCOUNT_CONFIRMATION;case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.IDEAL]))(e):return Vn.IDEAL_CONFIRMATION;case XL(e,t):return wl.MANDATORY_QUESTIONS;case KL(e):return Vn.PAYMENT_OPTIONS;default:return nF(e,t)}}},[Vn.PAYMENT_OPTIONS]:{mandatory:e=>(e=>GL([BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.PAYPAL]),BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.CARD]),BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT_INSTANT,!e.paymentOptions.usBankAccountDataPoint.usBankAccountVerificationSetup.isInstantAndAbav])]))(e),next:(e,t)=>{switch((e=>{const t=e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod,n=e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption;if(!t&&!n)throw new Error('"clientPaymentMethod" and "selectedPaymentOption" can not be null at the same time')})(e),!0){case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.AU_BECS]))(e):return Vn.AU_BECS;case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.UK_BACS]))(e):return Vn.UK_BACS;case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.SEPA]))(e):return Vn.SEPA;case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.IDEAL]))(e):return Vn.IDEAL_CONFIRMATION;case(e=>BL([!e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,GL([e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT,BL([e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT_INSTANT,e.process.dataPoint.hasPaymentError])])]))(e):return Vn.US_BANK_ACCOUNT_DONATE_OPTIONS;case zL(e):return Vn.US_BANK_ACCOUNT;case WL(e):return Vn.US_BANK_ACCOUNT_CONFIRMATION;default:return nF(e,t)}}},[Vn.FAST_TRACK_PAYMENT_OPTIONS]:{next:(e,t)=>function(e,t){switch(!0){case ZL(e,t):return Vn.COMMUNICATION_CONSENT;case qL(e,t):return Vn.DOUBLE;case $L(e,t):return wl.QUESTIONS;default:return wl.THANK_YOU}}(e,t)},[Vn.AU_BECS]:{guard:e=>jL(e,Gn.AU_BECS,Vn.AU_BECS),next:(e,t)=>nF(e,t)},[Vn.SEPA]:{guard:e=>jL(e,Gn.SEPA,Vn.SEPA),next:(e,t)=>!0===(!e.process.dataPoint.isCompleted&&HL(e,t))?wl.MAILING_ADDRESS:nF(e,t)},[Vn.UK_BACS]:{mandatory:e=>(e=>BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.UK_BACS]))(e),guard:e=>jL(e,Gn.UK_BACS,Vn.UK_BACS),next:(e,t)=>{switch(!0){case HL(e,t):return wl.MAILING_ADDRESS;case YL(e):return Vn.UK_BACS_CONFIRMATION;default:return nF(e,t)}}},[Vn.UK_BACS_CONFIRMATION]:{guard:e=>jL(e,Gn.UK_BACS,Vn.UK_BACS_CONFIRMATION),next:(e,t)=>nF(e,t)},[Vn.IDEAL_CONFIRMATION]:{guard:e=>jL(e,Gn.IDEAL,Vn.IDEAL_CONFIRMATION),next:(e,t)=>nF(e,t)},[Vn.US_BANK_ACCOUNT_DONATE_OPTIONS]:{mandatory:e=>(e=>BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT_INSTANT,e.paymentOptions.usBankAccountDataPoint.usBankAccountVerificationSetup.isInstantAndAbav]))(e),guard:e=>jL(e,Gn.US_BANK_ACCOUNT,Vn.US_BANK_ACCOUNT_DONATE_OPTIONS),next:(e,t)=>!0===zL(e)?Vn.US_BANK_ACCOUNT:Vn.US_BANK_ACCOUNT_CONFIRMATION},[Vn.US_BANK_ACCOUNT]:{mandatory:e=>(e=>BL([e.process.dataPoint.hasPaymentError,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,e.paymentOptions.paymentOptionsDataPoint.selectedPaymentOption===ch.US_BANK_ACCOUNT_VERIFICATION]))(e),guard:e=>jL(e,Gn.US_BANK_ACCOUNT,Vn.US_BANK_ACCOUNT),next:()=>Vn.US_BANK_ACCOUNT_CONFIRMATION},[Vn.US_BANK_ACCOUNT_CONFIRMATION]:{guard:e=>jL(e,Gn.US_BANK_ACCOUNT,Vn.US_BANK_ACCOUNT_CONFIRMATION),next:(e,t)=>!0===(e=>BL([e.process.dataPoint.isCompleted,e.paymentOptions.paymentOptionsDataPoint.clientPaymentMethod===Gn.US_BANK_ACCOUNT,e.paymentOptions.usBankAccountDataPoint.usBankAccountVerificationSetup.isMicroDepositOnly]))(e)?Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE:nF(e,t)},[Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE]:{guard:e=>jL(e,Gn.US_BANK_ACCOUNT,Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE),next:(e,t)=>nF(e,t)},[Vn.COMMUNICATION_CONSENT]:{next:(e,t)=>nF(e,t)},[wl.MANDATORY_QUESTIONS]:{next:(e,t)=>!0===JL(e)?Vn.FAST_TRACK_PAYMENT_OPTIONS:Vn.PAYMENT_OPTIONS},[wl.QUESTIONS]:{next:()=>wl.THANK_YOU},[Vn.DONATE_BY_VOICE]:{next:()=>wl.THANK_YOU},[wl.THANK_YOU]:{},[wl.BLOCKED]:{},[wl.REMIND_ME]:{guard:e=>!e.remindMeLater.dataPoint.isEnabled,final:!0}}}}function nF(e,t){switch(!0){case ZL(e,t):return Vn.COMMUNICATION_CONSENT;case qL(e,t):return Vn.DOUBLE;case HL(e,t):return wl.MAILING_ADDRESS;case $L(e,t):return wl.QUESTIONS;default:return wl.THANK_YOU}}const iF=Zx([Vn.US_BANK_ACCOUNT,Vn.US_BANK_ACCOUNT_DONATE_OPTIONS,Vn.US_BANK_ACCOUNT_CONFIRMATION,Vn.US_BANK_ACCOUNT_VERIFICATION_GUIDE,Vn.AU_BECS,Vn.DONATE,Vn.DOUBLE,Vn.GIFT_AID,Vn.PAYMENT_OPTIONS,Vn.SEPA,Vn.IDEAL_CONFIRMATION,Vn.UK_BACS,Vn.UK_BACS_CONFIRMATION,Vn.UPSELL,Vn.COMMUNICATION_CONSENT,Vn.FAST_TRACK_PAYMENT_OPTIONS,Vn.DONATE_BY_VOICE,wl.MANDATORY_QUESTIONS,wl.QUESTIONS,wl.COMMENT,wl.MAILING_ADDRESS,wl.PRIVACY,wl.THANK_YOU,wl.REMIND_ME,wl.BLOCKED]);class sF{constructor(e,t){this.rateMatchingConfig=e,this.currencyService=t}get isRateMatchingEnabled(){if(!Hl())return!1;if(!this.rateMatchingConfig.show)return!1;const e=new Date;if(null!==this.rateMatchingConfig.startDate&&new Date(this.rateMatchingConfig.startDate)>e)return!1;if(this.rateMatchingConfig.endDateEnabled&&null!==this.rateMatchingConfig.endDate&&e>new Date(this.rateMatchingConfig.endDate))return!1;const t=this.getMaxRateMatchingAmount();return!(null!==t&&t<=0)}get isDaysCountdownEnabled(){const e=this.getHoursUntilEnd();return null!==e&&e>48}get isHourCountdownEnabled(){const e=this.getHoursUntilEnd();return null!==e&&e>0&&e<=48}get isSponsorLogoShown(){return this.rateMatchingConfig.sponsorEnabled&&null!==this.rateMatchingConfig.sponsorLogo}getMinRateMatchingAmount(e,t){const n=this.currencyService.convert(this.rateMatchingConfig.minAmount||0,t,e);return this.currencyService.ceil(n,e)}getMaxRateMatchingAmount(){var e,t;if(!this.rateMatchingConfig.totalAmountLimitEnabled)return null;const n=null!==(e=this.rateMatchingConfig.totalAmountLimit)&&void 0!==e?e:0,i=null!==(t=this.rateMatchingConfig.raised)&&void 0!==t?t:0;return Math.max(0,n-i)}getMatchingImpact(e,t){return e?t&&this.isDonationOverMaxLimit(e,this.rateMatchingConfig.rate,t)?e+t:e*this.rateMatchingConfig.rate:null}isMatchingLimited(e,t){return!(!e||null===t)&&e*this.rateMatchingConfig.rate>t}getUpsellAmountToAdd(e,t){return this.rateMatchingConfig.minAmount&&e?e>=t?null:t-e:null}getAmountAfterUpsell(e,t){return this.rateMatchingConfig.minAmount?e*t:null}isDonationMatched(e,t){return null!==e&&e>=t}isDonationOverMaxLimit(e,t,n){if(null===e||null===n)return!1;const i=e*t;return!!i&&i-e>n}getIsCountdownEnabled(e){if(!this.rateMatchingConfig.show)return!1;if(!this.rateMatchingConfig.endDate)return!1;if(!this.rateMatchingConfig.endDateEnabled)return!1;const t=new Date(this.rateMatchingConfig.endDate),n=t>e,i=new Date(e);return i.setDate(e.getDate()+14),n&&t<=i}getTotalAmountLimitInDonationCurrency(e,t){return this.rateMatchingConfig.totalAmountLimitEnabled&&null!==this.rateMatchingConfig.totalAmountLimit?this.currencyService.convert(this.rateMatchingConfig.totalAmountLimit,t,e):null}getTotalAmountLimitWithRemains(e,t){return this.rateMatchingConfig.remains?this.currencyService.convert(this.rateMatchingConfig.remains,t,e):this.getTotalAmountLimitInDonationCurrency(e,t)}getUpsellAmountForDonation(e,t,n){if(null===e)return null;const i=this.getMinRateMatchingAmount(t,n);return this.getUpsellAmountToAdd(e,i)}getTimerEndDate(){return this.getIsCountdownEnabled(new Date)&&this.rateMatchingConfig.endDate?new Date(this.rateMatchingConfig.endDate).toISOString():null}isDonationLessThanMin(e,t){return null!==e&&e<t}isDonationEqualMin(e,t){return e===t}getHoursUntilEnd(){if(!this.rateMatchingConfig.endDateEnabled||null===this.rateMatchingConfig.endDate)return null;const e=new Date(this.rateMatchingConfig.endDate),t=new Date;return(e.getTime()-t.getTime())/36e5}}const aF={[$n.MONEY]:function(e){let{checkoutConfiguration:t,intl:n,tracker:i,sessionTokenService:a,debug:o,currencyService:r,suggestionsService:l,targetWindow:c,globalWindow:d,sentry:h,paymentMethods:m,stripeLoadingPromise:p,applePayStripeLoadingPromise:g,subscriptionPeriodLabelsService:y,userSession:f,addressService:v,eventEmitter:S,checkoutAPIBridge:E,experiments:A,logger:C,stripe:b,sessionAPI:P,mailingAddressModule:N,paymentMethodAvailabilityManagerRepository:D,mailingAddressCustomization:T,adaptiveDefaultFrequencyFetcher:k,adaptiveAmountPresetsFetcher:I,widgetSessionConsentService:_,params:O}=e;var x,w,R,M;const L=new AO(P,r,l),F=new xM(P),U=function(e,t,n,i,s,a,o,r,l,c,u,d,h){const m=new Z_(e,t,i,n,c,s,a,r,{flowType:$n.MONEY},u,h),p=new J_(m),g=function(e,t,n,i,s,a,o){const r=function(e){return new kR(e)}(a),l=function(e,t){const n=new IR(e,t);return new _R(e,n)}(a,e),c=function(e,t,n,i){const s=new zR(e,t,n,i),a=new YR(e,t,i);return new WR(e,i,a,s)}(e,t,n,a),u=function(e,t){const n=new OR(e,t),i=new xR(t);return new wR(t,n,i)}(e,a),d=function(e,t,n){const i=new RR(e,t,n);return new MR(n,i)}(e,t,a),h=function(e,t,n,i,s){const a=new LR(e,t,n,i,s);return new FR(s,a)}(e,t,i,s,a),m=function(e,t,n){const i=new GR(e,n),s=new qR(e,t,n);return new VR(n,i,s)}(e,n,a),p=function(e,t,n){const i=new UR(e,t,n);return new jR(n,i)}(e,s,a),g=function(e,t){return new TR(e,t)}(e,a),y=function(e,t){const n=new $R(e,t);return new XR(t,n)}(e,a),f=function(e,t,n,i){return new SR(t,new vR(e,t,n),i)}(e,a,t,o);return new fR(r,l,c,u,d,h,m,p,g,y,f)}(e,t,n,o,l,p,d),y=[p,g],f=new nM(...y),v=new eM(...y),S=new tM(...y),E=new mM(...y),A=new lM(...y),C=new cM(...y),b=new sM(...y),P=new oM(...y),N=new JR(...y),D=new aM(...y),T=new ZR(...y),k=new rM(...y),I=new iM(...y),_=new dM(...y),O=new hM(...y),x=new uM(...y),w=new QR(...y);return new cT(f,v,S,E,A,k,C,P,b,N,D,T,I,_,O,x,w,g)}(t,r,l,v,f,P,N,T,D,n,L,i,A),j=new PM(U,t,P,_),B=new UL(U,{screenSet:{usBankAccountConfirmation:Vn.US_BANK_ACCOUNT_CONFIRMATION,ukBacsConfirmation:Vn.UK_BACS_CONFIRMATION,idealConfirmation:Vn.IDEAL_CONFIRMATION,mailingAddress:wl.MAILING_ADDRESS,auBecs:Vn.AU_BECS,sepa:Vn.SEPA,paymentOptions:Vn.PAYMENT_OPTIONS}}),G=IO(t.campaign.config),q=new SO(P),V=new OM(P),H=function(e,t){return new wM(e,t,{screens:{firstScreen:RM,unrestrictedExitScreens:qM,finalUnavailableScreens:HM,mobileExitScreens:VM,alwaysRenderedScreens:LM,screensWithoutTributeBadge:FM,mobileScreensWithoutAskTitle:KM,mobileScreensWithAskText:UM,mobileScreensWithoutFaqLinks:YM,mobileScreensWithoutAskPage:zM,screensWithoutAskOverlay:jM,canNotGoBackScreens:MM,conditionallyShowCloseButtonScreens:GM,alwaysShowCloseButtonScreens:BM}})}(G,U),K=A.get(u.STRIPE_LINK_CHECKOUT_EXPERIMENT).isTestGroup,Y=A.get(u.PRE_DONATION_AMOUNTS_100_200_USD_MODAL_EXPERIMENT),z=function(e){let{sessionAPI:t,checkoutConfiguration:n,checkoutState:i,currencyService:s,suggestionsService:a,tracker:o,useShowUpsell:r,checkForUseAmounts:l}=e;var c;const u={checkoutConfiguration:n,checkoutState:i,currencyService:s,suggestionsService:a,tracker:o,useShowUpsell:r},d=new dR(t);return new rR(Object.assign(Object.assign({},u),{adaptivePreDonationUpsellSuggestionsFetcher:d,useShowUpsell:null===(c=null==u?void 0:u.useShowUpsell)||void 0===c||c,checkForUseAmounts:null!=l?l:e=>!0}))}({sessionAPI:P,checkoutConfiguration:t,checkoutState:U,currencyService:r,suggestionsService:l,tracker:i,useShowUpsell:!0,checkForUseAmounts:e=>!Y.isEnabled({preDonationUpsellDataPoint:e.preDonationUpsell.dataPoint})}),W=new Bw(h,n,D,{stripe:{elementStyles:b.elementStyles,elementClasses:b.elementClasses,stripeLinkExperimentIsTestGroup:K}},i),$=new _M(t,U,W,P,j,r,n,m,c,p,g,{stripe:{elementsOptions:b.elementsOptions},clientId:i.clientId}),X=new CO(d,t,r,U),Q=new iR(P),Z=null===(x=i.page)||void 0===x?void 0:x.toObject(),J=new oR(U,t,i,Q,r,l,{clientDevicePixelRatio:null==Z?void 0:Z.clientDevicePixelRatio,clientDeviceMemory:null==Z?void 0:Z.clientDeviceMemory,clientHardwareConcurrency:null==Z?void 0:Z.clientHardwareConcurrency,clientBatteryLevel:null==Z?void 0:Z.clientBatteryLevel,clientConnectionDownlink:null==Z?void 0:Z.clientConnectionDownlink,clientConnectionType:null==Z?void 0:Z.clientConnectionType,clientDoNotTrack:null==Z?void 0:Z.clientDoNotTrack}),ee=new Bx(t,U,j,P,$,H,i,r,n,c,h,W,B,S,E,o,A,q,V,C,X,L,F,l,J,{screenSet:{thankYou:wl.THANK_YOU}}),te=new Xw(P),ne=A.get(u.SMART_COVERING_FEE_CHECKOUT_V_4_EXPERIMENT),ie=new eR(t,U,i,te,r,{clientBatteryLevel:null==Z?void 0:Z.clientBatteryLevel,clientDevicePixelRatio:null==Z?void 0:Z.clientDevicePixelRatio,clientDeviceMemory:null==Z?void 0:Z.clientDeviceMemory,clientHardwareConcurrency:null==Z?void 0:Z.clientHardwareConcurrency,clientConnectionDownlink:null==Z?void 0:Z.clientConnectionDownlink,clientConnectionType:null==Z?void 0:Z.clientConnectionType,clientDoNotTrack:null==Z?void 0:Z.clientDoNotTrack,version:ne.isTestGroup?Jw.V4:Jw.V3,isAdaptiveLogicEnabled:!0});if(!k)throw new Error("adaptiveDefaultFrequencyFetcher is required");const se=new DM(t.company.donorRating,r),ae=new kM({donorRating:null!==(R=null===(w=t.company.donorRating)||void 0===w?void 0:w[Qn.TEST_2])&&void 0!==R?R:{},currencyService:r}),oe=iT(t,U,s,h,null===(M=null==O?void 0:O.pendingRequests)||void 0===M?void 0:M.goals),re=new sF(t.campaign.config.rateMatching,r),le=QD(new xL(ee,U,$,n,o,y,T,r,l,A,z,ie,se,ae,oe,i,re),tF(),U),ce=new zw(t,r,U,i,k,{clientDevicePixelRatio:null==Z?void 0:Z.clientDevicePixelRatio,clientDeviceMemory:null==Z?void 0:Z.clientDeviceMemory,clientHardwareConcurrency:null==Z?void 0:Z.clientHardwareConcurrency,clientBatteryLevel:null==Z?void 0:Z.clientBatteryLevel,clientConnectionDownlink:null==Z?void 0:Z.clientConnectionDownlink,clientConnectionType:null==Z?void 0:Z.clientConnectionType});if(!I)throw new Error("adaptiveAmountPresetsFetcher is required");const ue=new Kw(ee,U,i,t,r,l,I),de=new tR(ce,ue,z,ie),he=new FL({checkoutState:U,checkoutService:ee,checkoutConfiguration:t,currencyService:r,isValidScreen:iF,adaptivePreDonationUpsellSuggestionsService:z,adaptiveFeeCoveringService:ie,experiments:A,rateMatchingService:re}),me=new sw,pe=new NM(r,U,H,me,t,a,{checkoutOpenTimestamp:i.checkoutOpenTimestamp,checkoutLocale:i.clientLocale,funEmbedRelease:O.funEmbedRelease}),ge=((e,t,n,i,s,a,o,r)=>{const l=new mR(e,t),c=new rT(e,t,l,r),u=new gR(n),d=new pR(e,t,i,s,a),h=new yR(e,u,d),m=new hR(o);return new aT({entryParamsApplier:c,restoreParamsApplier:h,adaptiveParamsApplier:m})})(t,U,P,j,a,he,de,n);return{checkoutService:ee,checkoutState:U,formFlow:le,initialScreenDecider:he,trackerCheckoutEventService:pe,adaptiveSuggestionsService:de,designationsFetcher:oe,externalParamsApplier:ge}},[$n.CRYPTO]:function(e){let{checkoutConfiguration:t,intl:n,tracker:i,sessionTokenService:a,debug:o,currencyService:r,suggestionsService:l,targetWindow:c,globalWindow:u,sentry:d,subscriptionPeriodLabelsService:h,userSession:m,addressService:p,eventEmitter:g,checkoutAPIBridge:y,experiments:f,logger:v,sessionAPI:S,mailingAddressModule:E,paymentMethodAvailabilityManagerRepository:A,mailingAddressCustomization:C,widgetSessionConsentService:b,params:P}=e;var N;const D=function(e,t,n,i,s,a,o,r,l,c,u,d){const h=new Z_(e,t,i,n,c,s,a,r,{flowType:$n.CRYPTO},u,d),m=new J_(h),p=function(e,t,n,i,s){const a=function(e){return new ST(e)}(s),o=function(e,t){const n=new AT(e,t);return new bT(e,n)}(s,e),r=function(e,t,n,i,s){const a=new PT(e,t,n,i,s);return new NT(s,a)}(e,t,n,i,s),l=function(e,t){const n=new TT(e,t);return new IT(t,n)}(e,s);return new fT(a,o,r,l)}(e,t,o,l,m),g=[m,p],y=new qT(...g),f=new LT(...g),v=new UT(...g),S=new BT(...g),E=new HT(...g),A=new wT(...g),C=new YT(...g),b=new MT(...g),P=new XT(...g),N=new ek(...g),D=new ZT(...g),T=new WT(...g);return new _T(y,f,v,S,E,A,C,b,P,N,D,T,p)}(t,r,l,p,m,S,E,C,A,n,new AO(S,r,l),f),T=new iO(D,t,S,b),k=new eO(D,{screenSet:{mailingAddress:wl.MAILING_ADDRESS,privacy:wl.PRIVACY}}),I=IO(t.campaign.config),_=new SO(S),O=function(e,t){return new OO(e,t,{screens:{firstScreen:GO,unrestrictedExitScreens:WO,mobileExitScreens:ZO,alwaysRenderedScreens:JO,screensWithoutTributeBadge:qO,mobileScreensWithoutAskTitle:QO,mobileScreensWithAskText:VO,mobileScreensWithoutFaqLinks:$O,mobileScreensWithoutAskPage:XO,screensWithoutAskOverlay:HO,canNotGoBackScreens:zO,alwaysShowCloseButtonScreens:KO,conditionallyShowCloseButtonScreens:YO}})}(I,D),x=new CO(u,t,r,D),w=new gT(t,D,O,T,S,i,r,n,c,d,k,g,y,o,f,_,v,x,{screenSet:{thankYou:wl.THANK_YOU}}),R=iT(t,D,s,d,null===(N=null==P?void 0:P.pendingRequests)||void 0===N?void 0:N.goals),M=QD(new Wx(w,D,n,o,r,h,C,f,R,i),{initial:()=>Qx,screens:{[$u.CRYPTO_CURRENCY]:{next:e=>e.comment.dataPoint.isRequired?wl.COMMENT:wl.PRIVACY},[wl.COMMENT]:{next:()=>$u.CRYPTO_CURRENCY},[wl.PRIVACY]:{next:e=>e.mailingAddress.dataPoint.isEnabled?wl.MAILING_ADDRESS:e.questions.dataPoint.isMandatoryQuestionsScreenEnabled?wl.MANDATORY_QUESTIONS:$u.CRYPTO_WALLET},[wl.MAILING_ADDRESS]:{next:e=>e.questions.dataPoint.isMandatoryQuestionsScreenEnabled?wl.MANDATORY_QUESTIONS:$u.CRYPTO_WALLET},[$u.CRYPTO_WALLET]:{next:e=>e.questions.dataPoint.isEnabled?wl.QUESTIONS:wl.THANK_YOU},[wl.MANDATORY_QUESTIONS]:{next:()=>$u.CRYPTO_WALLET},[wl.QUESTIONS]:{next:()=>wl.THANK_YOU},[wl.THANK_YOU]:{},[wl.BLOCKED]:{}}},D),L=new Xx({checkoutConfiguration:t,isValidScreen:Jx}),F=new sw,U=new vO(r,D,O,F,t,a,{checkoutOpenTimestamp:i.checkoutOpenTimestamp,checkoutLocale:i.clientLocale,funEmbedRelease:P.funEmbedRelease}),j=((e,t,n)=>{const i=new sT(e,t),s=new rT(e,t,i,n);return new aT({entryParamsApplier:s,restoreParamsApplier:null,adaptiveParamsApplier:null})})(t,D,n);return{checkoutService:w,checkoutState:D,formFlow:M,initialScreenDecider:L,trackerCheckoutEventService:U,adaptiveSuggestionsService:null,designationsFetcher:R,externalParamsApplier:j}}};function oF(e,t,i,s,a,o,r){return(0,d.sH)(this,void 0,void 0,(function*(){var l,c,d;const m=t.createInstance("Checkout");m.log("checkoutCreateParams",o);const p=yield KD(o,r),g=Te("#root",p),y=ke(p),f=null===(l=o.infrastructureQueryParams)||void 0===l?void 0:l._fundraiseup_country;if(!o.livemode&&f){const e=yield async function(e){return function(e,t){const n=e[t];return{location:{countryCode:t,city:"TEST_PANEL",country:"TEST_PANEL"},langCurrencies:n||["USD"],countryCurrencies:n||["USD"]}}((await Promise.resolve().then(n.t.bind(n,6532,19))).default,e)}(f);o.resolvedConfig.config.currencies.countryCurrencies=e.countryCurrencies,o.resolvedConfig.config.currencies.langCurrencies=e.langCurrencies,o.resolvedConfig.user.address.countryCode=f}(null===(c=o.infrastructureQueryParams)||void 0===c?void 0:c.checkoutIntent)&&(o.externalParams.intent=function(e){var t,n,i,s,a,o,r,l,c,u,d,h,m,p,g,y,f;if(e)try{const v=JSON.parse(function(e){try{return Buffer.from(e,"base64").toString()}catch{return atob(e)}}(e));return{flowType:v.flowType,donation:v.donation?{amount:null===(t=v.donation)||void 0===t?void 0:t.amount,currency:null===(n=v.donation)||void 0===n?void 0:n.currency,recurring:null===(i=v.donation)||void 0===i?void 0:i.recurring,frequency:null===(s=v.donation)||void 0===s?void 0:s.frequency,selectedHintId:null===(a=v.donation)||void 0===a?void 0:a.selectedHintId,donationItems:null===(o=v.donation)||void 0===o?void 0:o.donationItems}:void 0,supporter:v.supporter?{firstName:null===(r=v.supporter)||void 0===r?void 0:r.firstName,lastName:null===(l=v.supporter)||void 0===l?void 0:l.lastName,email:null===(c=v.supporter)||void 0===c?void 0:c.email}:void 0,campaign:v.campaign?{id:v.campaign.id}:void 0,element:v.element?{key:null===(u=v.element)||void 0===u?void 0:u.key,type:null===(d=v.element)||void 0===d?void 0:d.type}:void 0,comment:v.comment,tribute:v.tribute,checkoutSettings:v.checkoutSettings?{designation:null===(h=v.checkoutSettings)||void 0===h?void 0:h.designation,customFields:null===(m=v.checkoutSettings)||void 0===m?void 0:m.customFields,modifyAmount:null===(p=v.checkoutSettings)||void 0===p?void 0:p.modifyAmount,modifyDesignation:null===(g=v.checkoutSettings)||void 0===g?void 0:g.modifyDesignation}:void 0,fundraisingPage:v.fundraisingPage?{key:v.fundraisingPage.key,customerKey:v.fundraisingPage.customerKey}:void 0,feeCovered:v.feeCovered,benefit:v.benefit?{id:null===(y=v.benefit)||void 0===y?void 0:y.id,optionValueId:null===(f=v.benefit)||void 0===f?void 0:f.optionValueId}:void 0}}catch{return}}(o.infrastructureQueryParams.checkoutIntent));const v=new De.A,S=yield p.waitUntilFontsLoaded(),E=new Al(e,m,i,v,y.target,y.global,o,aF,r,a,s,S),A=new xD(g,p,v,E.sentryInstance,m,E);s.on(Ae.CHECKOUT_OPEN,(()=>{p.onShow()}));const C=new Ce(y.global),b=new _e(A,E,C);return yield E.run(),b.initialize(),p.configure({locale:E.intl.locale,styles:yield YD(E.intl.language),localizedTitle:E.intl.translate("iframe.title")}),yield A.onHide((e=>{b.destroy(e),m.log("Closed")})).open(),C.hideAll(),m.log("Opened"),E.logger.checkoutOpen({key:E.checkoutConfiguration.campaign.key,name:E.checkoutConfiguration.campaign.name},E.checkoutAPIBridge.getOpenParams()),o.steplessCheckoutExperimentVariant&&E.trackerCheckout.trackCheckoutCustomEvent({type:Ee.EXPERIMENT_TEST_GROUP_EXPOSED,data:{experimentId:h[u.STEPLESS_MOBILE_CHECKOUT_EXPERIMENT],variantName:o.steplessCheckoutExperimentVariant,exclusion:null!==(d=o.steplessCheckoutExperimentExcluded)&&void 0!==d&&d}}),b}))}var rF=n(708);class lF{constructor(e){this.errorsStack=[],this.sentry=null,e.forceOff||(e.sentry?this.sentry=e.sentry:Promise.all([n.e(472),n.e(326)]).then(n.bind(n,8363)).then((t=>{this.sentry=t.initSentry(e,this.errorsStack),this.errorsStack=[]})))}captureError(e,t){if(!this.sentry)return this.errorsStack.push(e),void console.error(e);if(e instanceof Error)return this.sentry.captureException(e,t),void console.error(e);if(this.isErrorLike(e)){const n=new Error(e.message||"Unknown error like");return n.name=e.name,n.stack=e.stack,this.sentry.captureException(n,t),void console.error(e)}const n=new Error("Non error exception");if(t&&"object"==typeof t&&"setExtra"in t)return t.setExtra("nonError",e),this.sentry.captureException(n,t),void console.error(e);if(t&&"function"==typeof t)return this.sentry.captureException(n,(n=>{const i=t(n);return i.setExtra("nonError",e),i})),void console.error(e);const i=t||{};t=Object.assign(Object.assign({},i),{extra:Object.assign(Object.assign({},(null==i?void 0:i.extra)||{}),{nonError:e})}),this.sentry.captureException(n,t),console.error(e)}getSentryInstance(){return{captureException:(e,t)=>this.captureError(e,t),getCurrentScope:()=>this.sentry?this.sentry.getCurrentScope():null}}isErrorLike(e){return e instanceof Error||"object"==typeof e&&null!==e&&"name"in e&&"message"in e}}class cF extends _e{constructor(e,t,n,i,s,a,o,r,l,c){super(e,t),this.checkoutUI=e,this.embedTracker=n,this.debug=i,this.keysKeeper=s,this.targetWindow=a,this.globalWindow=o,this.params=r,this.sentry=l,this.funSessionStorage=c}get questionsScreenPageCount(){return this.checkoutCore.flowManager.questionsScreenPageCount}update(e){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutCore.dispose(),this.removeStripeIframes(this.globalWindow.document),this.removeStripeIframes(this.targetWindow.document);const t=new Al(this.embedTracker,this.debug,this.keysKeeper,new De.A,this.targetWindow,this.globalWindow,Object.assign(Object.assign({},this.params),{resolvedConfig:this.convertShowcaseConfigToCheckoutConfig(e),isMobile:e.isMobile,localeCode:e.localeCode||""}),aF,this.sentry,this.funSessionStorage,new De.A),n=this.isFlowTypeChanged(t);this.checkoutCore=t,yield t.run({initialScreen:e.initialScreen,localeCode:e.localeCode||t.checkoutConfiguration.campaign.config.localization.defaultLocale}),yield this.checkoutUI.replaceCore(this.checkoutCore,{forceRender:n,showcaseContext:e.showcaseContext}),this.updateIframeHtmlClass(e.isMobile)}))}removeStripeIframes(e){e.querySelectorAll('iframe[name*="privateStripe"]').forEach((e=>{e.remove()}))}convertShowcaseConfigToCheckoutConfig(e){return function(e,t){const n={applicationFees:{money:200,crypto:200},coverFees:{custom:!1,amount:30,percent:100},stripeFee:{percent:100,fixed:30,currency:"USD"}},i=Object.assign({},e,{campaign:{...e.widget,recentDonations:null,totalRecentDonations:null,classification:{emotionalType:ds.NEUTRAL},benefits:e.benefits||null,config:{...e.widget.config,experimentsSettings:{desktop:{},mobile:{}},trend:{once:0,daily:0,weekly:0,biweekly:0,every4weeks:0,monthly:0,bimonthly:0,quarterly:0,semiannual:0,annual:0}}},config:{...e.serverConfig},goals:[],fundraisingPage:null,user:{address:{...e.user.address,region:""}},company:{...e.company,...n,parentCompanyConfig:{...n},donorRating:{control:{},test1:{},test2:{}}}});return i}(e)}isFlowTypeChanged(e){return this.checkoutCore.checkoutConfiguration.defaultFlowType!==e.checkoutConfiguration.defaultFlowType}updateIframeHtmlClass(e){const t=this.targetWindow.document.querySelector("html");e?null==t||t.classList.remove("desktop-view"):null==t||t.classList.add("desktop-view")}}class uF extends xD{replaceCore(e,t){return(0,d.sH)(this,void 0,void 0,(function*(){this.checkoutCore=e,(null==t?void 0:t.forceRender)?yield this.forceRender():(yield this.configure(),yield this.render(null==t?void 0:t.showcaseContext),yield this.checkoutCore.flowManager.restart())}))}configure(){return(0,d.sH)(this,void 0,void 0,(function*(){this.iframe.configure({locale:this.checkoutCore.intl.locale,styles:yield YD(this.checkoutCore.intl.language),showcase:!0})}))}forceRender(){return(0,d.sH)(this,void 0,void 0,(function*(){this.regenerateKey(),yield this.render(),this.show()}))}}const dF=(e,t,n,i,s,a,o)=>(0,d.sH)(void 0,void 0,void 0,(function*(){const c=function(e){return function(e){const t=[/^https?:\/\/translate\.googleusercontent\.com/i,/^file:\/\/\//,/^https?:\/\/craigchurchministries\.org/i,/^https?:\/\/heartwoodhaven\.org/i,/^https?:\/\/wordpress-506039-2071925\.cloudwaysapps\.com/i];window.FUN_EXPERIMENTAL_SENTRY||t.push(/^https?:\/\/.*\.?mozilla\.org/i);const n="SQUARESPACE_ROLLUPS"in window||"Squarespace"in window,i=t.some((e=>e.test(window.location.href))),s=window.Sentry,a=window.FUN_DASHBOARD;return new lF({env:e.env,uri:e.uri,mainDomain:e.mainDomain,version:e.version,forceOff:!a&&(i||n||!!s),sentry:a&&s?s:void 0,isBrowserSupported:e.isBrowserSupported,isBrowserSupportedVersion:e.isBrowserSupportedVersion,scope:e.scope})}({uri:e.integrations.sentryUri,version:e.embedVersion,mainDomain:e.mainDomain,env:e.env,isBrowserSupported:e.browserData.isCommonBrowser,isBrowserSupportedVersion:e.browserData.isSupported,scope:rF.b1.CHECKOUT}).getSentryInstance()}(a);try{if(a.showcase){const i=yield function(e,t,n,i,s,a,o){return(0,d.sH)(this,void 0,void 0,(function*(){const r=t.createInstance("ShowcaseCheckout");r.log("checkoutCreateParams",i);const l=yield KD(i,s),c=Te("#root",l),u=ke(l),d=new De.A,h=new Al(e,r,n,d,u.target,u.global,i,aF,s,a,new De.A),m=new uF(c,l,d,h.sentryInstance,r,h),p=new cF(m,h,e,r,n,u.target,u.global,i,s,a);yield h.run({initialScreen:i.initialScreen,localeCode:h.checkoutConfiguration.campaign.config.localization.defaultLocale});const g={locale:h.intl.locale};return l.configure(g),yield m.open({abortController:o}),r.log("Opened"),p}))}(e,t,n,a,c,s,o);return i}return yield oF(e,t,n,i,s,a,c)}catch(e){throw c.captureException(e,(e=>(e.setTag(r.ERROR_TYPE,l.CHECKOUT_INITIALIZATION_CRITICAL),e))),e}}));(window.FUN_SERVICE_CONTAINER||(window.FUN_SERVICE_CONTAINER=new class{constructor(){this.providers=new Map,this.cache=new Map}get(e,t=!0){const n=this.providers.get(e);if(!n)throw new Error(`${String(e)} is not provided`);if(t&&this.cache.has(e))return this.cache.get(e);const i=n();return t?(this.cache.has(e)||this.cache.set(e,i),i):i}provide(e,t){return this.providers.has(e)?(console.warn(`14 ${String(e)}`),this):(this.providers.set(e,t),this)}}),window.FUN_SERVICE_CONTAINER).provide(o.CHECKOUT,(()=>dF))},5514:function(e,t,n){"use strict";n.d(t,{R:function(){return i}});const i=(0,n(2155).createContext)(null)},7804:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var i=n(2155),s=n(5514);function a(){const e=(0,i.useContext)(s.R);if(!e)throw new Error("IntlService is not provided");return e}},534:function(e,t,n){var i={"./card-amex.png":3421,"./card-diners.png":2707,"./card-discover.png":1229,"./card-jcb.png":543,"./card-mastercard.png":9848,"./card-unionpay.png":8057,"./card-unknown-error.png":2217,"./card-unknown.png":8044,"./card-visa.png":9503};function s(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=a,e.exports=s,s.id=534},7065:function(e,t,n){var i={"./balloon.webp":212,"./blue-hearts.webp":3185,"./confetti-ball.webp":849,"./cool-face.webp":1174,"./diamond.webp":5151,"./double-hearts.webp":9182,"./double-stars.webp":584,"./empty-heart.webp":511,"./failed.webp":252,"./fire-flame.webp":6887,"./folded-hands.webp":6780,"./gift.webp":9855,"./grinning-face.webp":6089,"./happy-hand.webp":2521,"./heart.webp":5275,"./light.webp":3559,"./love-letter.webp":4012,"./medal.webp":44,"./message.webp":7508,"./party-popper.webp":6900,"./partying-face.webp":5993,"./prize.webp":2807,"./receipt.webp":2147,"./sad-face.webp":1503,"./share-hearts.webp":2454,"./smiling-face.webp":9546,"./star.webp":2061,"./success.webp":2856,"./thumbs-up.webp":2902,"./trophy.webp":4487};function s(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=a,e.exports=s,s.id=7065},3367:function(e,t,n){var i={"./ar_001.json":[3372,830],"./da.json":[1104,639],"./de.json":[444,436],"./de_x_informal.json":[5100,245],"./en_CA.json":[9821,234],"./en_GB.json":[4828,627],"./en_US.json":[2853,616],"./es.json":[847,425],"./es_US.json":[7868,662],"./fi_FI.json":[1078,471],"./fr_CA.json":[5292,381],"./fr_FR.json":[3764,572],"./hu.json":[5472,775],"./it.json":[8054,966],"./ja.json":[6598,561],"./ko.json":[9277,752],"./nl.json":[2785,763],"./no.json":[7396,954],"./pl_PL.json":[3848,989],"./pt_BR.json":[9672,180],"./pt_PT.json":[8216,740],"./ru_RU.json":[6214,901],"./sv.json":[2642,710],"./zh_CN.json":[507,519],"./zh_TW.json":[2851,496]};function s(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return n.e(t[1]).then((function(){return n.t(s,19)}))}s.keys=function(){return Object.keys(i)},s.id=3367,e.exports=s},2073:function(e,t,n){const i=n(4921),s=n(6580),a=n(3854),o=n(2819),r=n(7984),l=n(5323),c=n(7469),u=n(7565),d=n(2139),h=n(6301),m=n(3263),p=n(4454),g=n(2240),y=n(311),f=n(4916),v=n(323);e.exports={creditCard:h,applePay:g,googlePay:p,clickToPay:m,ach:a,usBankAccount:o,plaid:r,paypal:u,venmo:d,auBecsDebit:l,ukBacs:c,acss:s,sepa:i,ideal:v,crypto:y,stock:f}},4729:function(e,t,n){"use strict";n.d(t,{ZD:function(){return d},Qk:function(){return o},iJ:function(){return u},N_:function(){return c},q1:function(){return l}});const i=[n(3867).L.AR],s=[n(6971).D.AR_001];var a=n(5029);function o(e){return e.split("-")[0]}const r={"&amp;":"&"};function l(e){let t=e;for(const a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.includes(a)&&(n=t,i=a,s=r[a],t=n.replace(new RegExp(i,"g"),s));var n,i,s;return t}function c(e,t=!1){return!t&&function(e){return s.includes(e)}(e)?a.p.RTL:a.p.LTR}function u(e,t=!1){return!t&&function(e){return i.includes(e)}(e)?a.p.RTL:a.p.LTR}function d(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}},3867:function(e,t,n){"use strict";var i;n.d(t,{L:function(){return i}}),function(e){e.EN="en",e.ES="es",e.FR="fr",e.NL="nl",e.NO="no",e.DE="de",e.FI="fi",e.AR="ar",e.SV="sv",e.IT="it",e.PT="pt",e.ZH="zh",e.JA="ja",e.KO="ko",e.HU="hu",e.DA="da",e.RU="ru",e.PL="pl"}(i||(i={}))},5029:function(e,t,n){"use strict";var i;n.d(t,{p:function(){return i}}),function(e){e.LTR="ltr",e.RTL="rtl"}(i||(i={}))},6971:function(e,t,n){"use strict";var i;n.d(t,{D:function(){return i}}),function(e){e.EN_US="en-US",e.EN_GB="en-GB",e.EN_CA="en-CA",e.FR_CA="fr-CA",e.FR_FR="fr-FR",e.ES="es",e.NL="nl",e.NO="no",e.DE="de",e.DE_X_INFORMAL="de-x-informal",e.FI_FI="fi-FI",e.AR_001="ar-001",e.SV="sv",e.IT="it",e.PT_PT="pt-PT",e.PT_BR="pt-BR",e.ZH_CN="zh-CN",e.ZH_TW="zh-TW",e.JA="ja",e.KO="ko",e.HU="hu",e.DA="da",e.RU_RU="ru-RU",e.ES_US="es-US",e.PL_PL="pl-PL"}(i||(i={}))},2319:function(e,t){"use strict";t.A=function(e,t=0){let n,i,s,a,o,r,l,c;for(n=3&e.length,i=e.length-n,s=t,o=3432918353,r=461845907,c=0;c<i;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*r+(((l>>>16)*r&65535)<<16)&4294967295,s^=l,s=s<<13|s>>>19,a=5*(65535&s)+((5*(s>>>16)&65535)<<16)&4294967295,s=27492+(65535&a)+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;break;case 2:l^=(255&e.charCodeAt(c+1))<<8;break;case 1:l^=255&e.charCodeAt(c),l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*r+(((l>>>16)*r&65535)<<16)&4294967295,s^=l}return s^=e.length,s^=s>>>16,s=2246822507*(65535&s)+((2246822507*(s>>>16)&65535)<<16)&4294967295,s^=s>>>13,s=3266489909*(65535&s)+((3266489909*(s>>>16)&65535)<<16)&4294967295,s^=s>>>16,s>>>0}},8809:function(e,t,n){"use strict";n.d(t,{S:function(){return y}});var i=n(5959),s=n(5723),a=n(8814),o=n(5938),r=n(578),l=n(5284),c=n(5357),u=n.n(c),d=n(2155);const h=e=>({top:"bottom",right:"left",bottom:"top",left:"right"}[e]),m={DEFAULT_PLACEMENT:"right",DEFAULT_OFFSET:10,DEFAULT_FLIP:{padding:5,fallbackAxisSideDirection:"start"},DEFAULT_SHIFT:{padding:5},DEFAULT_TRIGGER:"hover",DEFAULT_SHOW_ARROW:!0,DEFAULT_HIDE_ON_SCROLL_EDGE_OFFSET:5,DEFAULT_VARIANT:"default",DEFAULT_SIZE:"default",MAX_WIDTH:"200px",DEFAULT_HAS_ANIMATION:!0,ANIMATION_DURATION_OPEN:150,ANIMATION_DURATION_CLOSE:100,ANIMATION_TRANSITION_OFFSET:"5px",ARROW_SIZE_DEFAULT:"12px",ARROW_SIZE_SM:"7px",ARROW_PADDING:16},p=(0,d.forwardRef)((({arrowData:e,direction:t,size:n,dataTestId:i},a)=>{const o="sm"===n?m.ARROW_SIZE_SM:m.ARROW_SIZE_DEFAULT;var r;const l=(r=o,Math.sqrt(2)*parseFloat(r)/2),c="bottom"===t||"left"===t?-1*l:l,u={width:o,height:o,transformOrigin:t,[h(t)]:`-${l}px`};return(null==e?void 0:e.x)&&(u.left=e.x+c/2),(null==e?void 0:e.y)&&(u.top=e.y+c/2),(0,s.jsx)("div",{ref:a,"data-testid":i,className:"ui-tooltip-arrow",style:u})})),g=(0,d.forwardRef)(((e,t)=>{var{className:n,direction:a,variant:o,size:r,showArrow:c,children:u,floatingStyle:d,transitionStyle:h,arrowRef:m,context:p,dataTestId:g}=e,y=(0,i.Tt)(e,["className","direction","variant","size","showArrow","children","floatingStyle","transitionStyle","arrowRef","context","dataTestId"]);return(0,s.jsx)("div",Object.assign({ref:t,className:(0,l.A)(`ui-tooltip ui-tooltip-variant-${o} ui-tooltip-size-${r} ui-tooltip-${a}`,n),style:d,"data-testid":g},y,{children:(0,s.jsx)("div",{className:"ui-tooltip-body",style:h,children:u})}))})),y=(0,d.forwardRef)(((e,t)=>{var n,c,{children:h,contentRef:y,content:f,trigger:v=m.DEFAULT_TRIGGER,placement:S=m.DEFAULT_PLACEMENT,fallbackPlacements:E,offset:A=m.DEFAULT_OFFSET,shift:C=m.DEFAULT_SHIFT,flip:b=m.DEFAULT_FLIP,maxWidth:P=m.MAX_WIDTH,maxHeight:N,arrow:D=m.DEFAULT_SHOW_ARROW,arrowPadding:T=m.ARROW_PADDING,hasAnimation:k=m.DEFAULT_HAS_ANIMATION,hideOnScrollEdgeOffset:I=m.DEFAULT_HIDE_ON_SCROLL_EDGE_OFFSET,zIndex:_,hasPortal:O=!0,isInteractive:x=!1,shouldTrapFocusInside:w=!1,manualOpen:R,variant:M=m.DEFAULT_VARIANT,size:L=m.DEFAULT_SIZE,returnFocus:F=!0,rootContainer:U,dataQa:j}=e,B=(0,i.Tt)(e,["children","contentRef","content","trigger","placement","fallbackPlacements","offset","shift","flip","maxWidth","maxHeight","arrow","arrowPadding","hasAnimation","hideOnScrollEdgeOffset","zIndex","hasPortal","isInteractive","shouldTrapFocusInside","manualOpen","variant","size","returnFocus","rootContainer","dataQa"]);const G=(0,d.useRef)(null),[q,V]=(0,d.useState)(!1),H=q&&!!f||R,{context:K,refs:Y,floatingStyles:z,middlewareData:W,placement:$}=(0,a.we)({open:H,onOpenChange:V,placement:S,whileElementsMounted:o.ll,middleware:[(0,r.cY)(A),(0,r.Ej)({apply({elements:e}){P&&(e.floating.style.maxWidth="none"===P?"calc(100vw - 40px)":`min(${P}, calc(100vw - 40px))`)}}),(0,r.mG)(),(0,r.BN)(C),(0,r.UU)(Object.assign(Object.assign({},b),{fallbackPlacements:E})),(0,r.UE)({element:G,padding:T}),(0,r.jD)({padding:I})]}),{delay:X}=(0,a.ck)(K),Q=(0,a.It)(K,{role:"tooltip"}),Z=$.split("-")[0],J=(0,a.s9)(K),ee=(0,a.Mk)(K,{enabled:"hover"===v,handleClose:x?(0,a.iB)():void 0,delay:X}),te=(0,a.kp)(K,{enabled:"click"===v}),ne=(0,a.iQ)(K,{enabled:u()(["focus","hover"],v)}),{getReferenceProps:ie,getFloatingProps:se}=(0,a.bv)([ee,ne,te,J,Q]),{isMounted:ae,styles:oe}=(0,a.DL)(K,{duration:k?{open:Number(m.ANIMATION_DURATION_OPEN),close:Number(m.ANIMATION_DURATION_CLOSE)}:{open:0,close:0},initial:({side:e})=>({opacity:0,translate:{top:`0 ${m.ANIMATION_TRANSITION_OFFSET} 0`,bottom:`0 -${m.ANIMATION_TRANSITION_OFFSET} 0`,left:`${m.ANIMATION_TRANSITION_OFFSET} 0 0`,right:`-${m.ANIMATION_TRANSITION_OFFSET} 0 0`}[e]}),open:{opacity:1,translate:"0 0 0"}}),re=(0,d.cloneElement)(h,Object.assign({ref:Y.setReference,className:(0,l.A)(null===(n=h.props)||void 0===n?void 0:n.className)},ie({onClick:e=>{var t,n;null===(n=(t=h.props).onClick)||void 0===n||n.call(t,e)}}))),le=Object.assign(Object.assign(Object.assign({},z),{visibility:(null===(c=W.hide)||void 0===c?void 0:c.referenceHidden)?"hidden":"visible"}),_&&{zIndex:_}),ce={maxHeight:N?`min(${N}, calc(100vh - 40px))`:"calc(100vh - 40px)"};(0,d.useImperativeHandle)(t,(()=>Y.reference.current),[Y.reference]);const ue=(0,s.jsx)(a.s3,{context:K,initialFocus:-1,returnFocus:F,modal:w,children:(0,s.jsxs)(g,Object.assign({dataTestId:"ui-tooltip-popup",ref:Y.setFloating,direction:Z,variant:M,size:L,floatingStyle:le,transitionStyle:oe},se(),B,{children:[D&&(0,s.jsx)(p,{ref:G,arrowData:W.arrow,direction:Z,size:L,dataTestId:"ui-tooltip-arrow"}),(0,s.jsx)("div",{ref:y,className:"ui-tooltip-content",style:ce,"data-qa":j,children:f})]}))});return(0,s.jsxs)(d.Fragment,{children:[re,ae&&(O?(0,s.jsx)(a.XF,{root:U,children:ue}):ue)]})}));y.displayName="UITooltip"},2036:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(3867);class s{constructor(e,t){this.intlService=e,this.params=t,this.countries=this.getInitialCountriesList()}getMailingAddressCountriesList(){return this.countries.map((({countryName:e,countryCode:t})=>({countryName:e,countryCode:t})))}getTelInputCountries(){return this.countries.filter((e=>"dialCode"in e)).map((e=>({name:e.countryName,iso2:e.countryCode,dialCode:e.dialCode,priority:e.priority||0,areaCodes:e.areaCodes||null})))}get language(){return this.intlService.language}getInitialCountriesList(){var e;let t=[{countryName:this.intlService.translate("countries.afghanistan")||"Afghanistan",countryCode:"AF",dialCode:"93"},{countryName:this.intlService.translate("countries.albania")||"Albania",countryCode:"AL",dialCode:"355"},{countryName:this.intlService.translate("countries.algeria")||"Algeria",countryCode:"DZ",dialCode:"213"},{countryName:this.intlService.translate("countries.andorra")||"Andorra",countryCode:"AD",dialCode:"376"},{countryName:this.intlService.translate("countries.angola")||"Angola",countryCode:"AO",dialCode:"244"},{countryName:this.intlService.translate("countries.anguilla")||"Anguilla",countryCode:"AI",dialCode:"1264"},{countryName:this.intlService.translate("countries.antiguaAndBarbuda")||"Antigua and Barbuda",countryCode:"AG",dialCode:"1268"},{countryName:this.intlService.translate("countries.argentina")||"Argentina",countryCode:"AR",dialCode:"54"},{countryName:this.intlService.translate("countries.armenia")||"Armenia",countryCode:"AM",dialCode:"374"},{countryName:this.intlService.translate("countries.aruba")||"Aruba",countryCode:"AW",dialCode:"297"},{countryName:this.intlService.translate("countries.australia")||"Australia",countryCode:"AU",dialCode:"61",priority:0},{countryName:this.intlService.translate("countries.austria")||"Austria",countryCode:"AT",dialCode:"43"},{countryName:this.intlService.translate("countries.alandIslands")||"land Islands",countryCode:"AX",dialCode:"358",priority:1},{countryName:this.intlService.translate("countries.azerbaijan")||"Azerbaijan",countryCode:"AZ",dialCode:"994"},{countryName:this.intlService.translate("countries.bahamas")||"Bahamas",countryCode:"BS",dialCode:"1242"},{countryName:this.intlService.translate("countries.bahrain")||"Bahrain",countryCode:"BH",dialCode:"973"},{countryName:this.intlService.translate("countries.bangladesh")||"Bangladesh",countryCode:"BD",dialCode:"880"},{countryName:this.intlService.translate("countries.barbados")||"Barbados",countryCode:"BB",dialCode:"1246"},{countryName:this.intlService.translate("countries.belarus")||"Belarus",countryCode:"BY",dialCode:"375"},{countryName:this.intlService.translate("countries.belgium")||"Belgium",countryCode:"BE",dialCode:"32"},{countryName:this.intlService.translate("countries.belize")||"Belize",countryCode:"BZ",dialCode:"501"},{countryName:this.intlService.translate("countries.benin")||"Benin",countryCode:"BJ",dialCode:"229"},{countryName:this.intlService.translate("countries.bermuda")||"Bermuda",countryCode:"BM",dialCode:"1441"},{countryName:this.intlService.translate("countries.bhutan")||"Bhutan",countryCode:"BT",dialCode:"975"},{countryName:this.intlService.translate("countries.bolivia")||"Bolivia",countryCode:"BO",dialCode:"591"},{countryName:this.intlService.translate("countries.bosniaAndHerzegovina")||"Bosnia and Herzegovina",countryCode:"BA",dialCode:"387"},{countryName:this.intlService.translate("countries.botswana")||"Botswana",countryCode:"BW",dialCode:"267"},{countryName:this.intlService.translate("countries.brazil")||"Brazil",countryCode:"BR",dialCode:"55"},{countryName:this.intlService.translate("countries.britishIndianOceanTerritory")||"British Indian Ocean Territory",countryCode:"IO",dialCode:"246"},{countryName:this.intlService.translate("countries.britishVirginIslands")||"British Virgin Islands",countryCode:"VG",dialCode:"1284"},{countryName:this.intlService.translate("countries.brunei")||"Brunei",countryCode:"BN",dialCode:"673"},{countryName:this.intlService.translate("countries.bulgaria")||"Bulgaria",countryCode:"BG",dialCode:"359"},{countryName:this.intlService.translate("countries.burkinaFaso")||"Burkina Faso",countryCode:"BF",dialCode:"226"},{countryName:this.intlService.translate("countries.burundi")||"Burundi",countryCode:"BI",dialCode:"257"},{countryName:this.intlService.translate("countries.cambodia")||"Cambodia",countryCode:"KH",dialCode:"855"},{countryName:this.intlService.translate("countries.cameroon")||"Cameroon",countryCode:"CM",dialCode:"237"},{countryName:this.intlService.translate("countries.canada")||"Canada",countryCode:"CA",dialCode:"1",priority:1,areaCodes:["204","226","236","249","250","289","306","343","365","387","403","416","418","431","437","438","450","506","514","519","548","579","581","587","604","613","639","647","672","705","709","742","778","780","782","807","819","825","867","873","902","905"]},{countryName:this.intlService.translate("countries.capeVerde")||"Cape Verde",countryCode:"CV",dialCode:"238"},{countryName:this.intlService.translate("countries.caribbeanNetherlands")||"Caribbean Netherlands",countryCode:"BQ",dialCode:"599",priority:1},{countryName:this.intlService.translate("countries.caymanIslands")||"Cayman Islands",countryCode:"KY",dialCode:"1345"},{countryName:this.intlService.translate("countries.centralAfricanRepublic")||"Central African Republic",countryCode:"CF",dialCode:"236"},{countryName:this.intlService.translate("countries.chad")||"Chad",countryCode:"TD",dialCode:"235"},{countryName:this.intlService.translate("countries.chile")||"Chile",countryCode:"CL",dialCode:"56"},{countryName:this.intlService.translate("countries.china")||"China",countryCode:"CN",dialCode:"86"},{countryName:this.intlService.translate("countries.christmasIsland")||"Christmas Island",countryCode:"CX",dialCode:"61",priority:2},{countryName:this.intlService.translate("countries.cocos")||"Cocos Islands",countryCode:"CC",dialCode:"61",priority:1},{countryName:this.intlService.translate("countries.colombia")||"Colombia",countryCode:"CO",dialCode:"57"},{countryName:this.intlService.translate("countries.comoros")||"Comoros",countryCode:"KM",dialCode:"269"},{countryName:this.intlService.translate("countries.congoDRC")||"Congo (DRC)",countryCode:"CD",dialCode:"243"},{countryName:this.intlService.translate("countries.congoRepublic")||"Congo (Republic)",countryCode:"CG",dialCode:"242"},{countryName:this.intlService.translate("countries.cookIslands")||"Cook Islands",countryCode:"CK",dialCode:"682"},{countryName:this.intlService.translate("countries.costaRica")||"Costa Rica",countryCode:"CR",dialCode:"506"},{countryName:this.intlService.translate("countries.coteDIvoire")||"Cte dIvoire",countryCode:"CI",dialCode:"225"},{countryName:this.intlService.translate("countries.croatia")||"Croatia",countryCode:"HR",dialCode:"385"},{countryName:this.intlService.translate("countries.cuba")||"Cuba",countryCode:"CU",dialCode:"53"},{countryName:this.intlService.translate("countries.curasao")||"Curaao",countryCode:"CW",dialCode:"599",priority:0},{countryName:this.intlService.translate("countries.cyprus")||"Cyprus",countryCode:"CY",dialCode:"357"},{countryName:this.intlService.translate("countries.czechRepublic")||"Czech Republic",countryCode:"CZ",dialCode:"420"},{countryName:this.intlService.translate("countries.denmark")||"Denmark",countryCode:"DK",dialCode:"45"},{countryName:this.intlService.translate("countries.djibouti")||"Djibouti",countryCode:"DJ",dialCode:"253"},{countryName:this.intlService.translate("countries.dominica")||"Dominica",countryCode:"DM",dialCode:"1767"},{countryName:this.intlService.translate("countries.dominicanRepublic")||"Dominican Republic",countryCode:"DO",dialCode:"1",priority:2,areaCodes:["809","829","849"]},{countryName:this.intlService.translate("countries.ecuador")||"Ecuador",countryCode:"EC",dialCode:"593"},{countryName:this.intlService.translate("countries.egypt")||"Egypt",countryCode:"EG",dialCode:"20"},{countryName:this.intlService.translate("countries.elSalvador")||"El Salvador",countryCode:"SV",dialCode:"503"},{countryName:this.intlService.translate("countries.equatorialGuinea")||"Equatorial Guinea",countryCode:"GQ",dialCode:"240"},{countryName:this.intlService.translate("countries.eritrea")||"Eritrea",countryCode:"ER",dialCode:"291"},{countryName:this.intlService.translate("countries.estonia")||"Estonia",countryCode:"EE",dialCode:"372"},{countryName:this.intlService.translate("countries.ethiopia")||"Ethiopia",countryCode:"ET",dialCode:"251"},{countryName:this.intlService.translate("countries.falklandIslands")||"Falkland Islands",countryCode:"FK",dialCode:"500"},{countryName:this.intlService.translate("countries.faroeIslands")||"Faroe Islands",countryCode:"FO",dialCode:"298"},{countryName:this.intlService.translate("countries.fiji")||"Fiji",countryCode:"FJ",dialCode:"679"},{countryName:this.intlService.translate("countries.finland")||"Finland",countryCode:"FI",dialCode:"358",priority:0},{countryName:this.intlService.translate("countries.france")||"France",countryCode:"FR",dialCode:"33"},{countryName:this.intlService.translate("countries.frenchGuiana")||"French Guiana",countryCode:"GF",dialCode:"594"},{countryName:this.intlService.translate("countries.frenchPolynesia")||"French Polynesia",countryCode:"PF",dialCode:"689"},{countryCode:"TF",countryName:this.intlService.translate("countries.frenchSouthernTerritories")||"French Southern Territories"},{countryName:this.intlService.translate("countries.gabon")||"Gabon",countryCode:"GA",dialCode:"241"},{countryName:this.intlService.translate("countries.gambia")||"Gambia",countryCode:"GM",dialCode:"220"},{countryName:this.intlService.translate("countries.georgia")||"Georgia",countryCode:"GE",dialCode:"995"},{countryName:this.intlService.translate("countries.germany")||"Germany",countryCode:"DE",dialCode:"49"},{countryName:this.intlService.translate("countries.ghana")||"Ghana",countryCode:"GH",dialCode:"233"},{countryName:this.intlService.translate("countries.gibraltar")||"Gibraltar",countryCode:"GI",dialCode:"350"},{countryName:this.intlService.translate("countries.greece")||"Greece",countryCode:"GR",dialCode:"30"},{countryName:this.intlService.translate("countries.greenland")||"Greenland",countryCode:"GL",dialCode:"299"},{countryName:this.intlService.translate("countries.grenada")||"Grenada",countryCode:"GD",dialCode:"1473"},{countryName:this.intlService.translate("countries.guadeloupe")||"Guadeloupe",countryCode:"GP",dialCode:"590",priority:0},{countryName:this.intlService.translate("countries.guatemala")||"Guatemala",countryCode:"GT",dialCode:"502"},{countryName:this.intlService.translate("countries.guernsey")||"Guernsey",countryCode:"GG",dialCode:"44",priority:1},{countryName:this.intlService.translate("countries.guinea")||"Guinea",countryCode:"GN",dialCode:"224"},{countryName:this.intlService.translate("countries.guineaBissau")||"Guinea-Bissau",countryCode:"GW",dialCode:"245"},{countryName:this.intlService.translate("countries.guyana")||"Guyana",countryCode:"GY",dialCode:"592"},{countryName:this.intlService.translate("countries.haiti")||"Haiti",countryCode:"HT",dialCode:"509"},{countryName:this.intlService.translate("countries.honduras")||"Honduras",countryCode:"HN",dialCode:"504"},{countryName:this.intlService.translate("countries.hongKong")||"Hong Kong",countryCode:"HK",dialCode:"852"},{countryName:this.intlService.translate("countries.hungary")||"Hungary",countryCode:"HU",dialCode:"36"},{countryName:this.intlService.translate("countries.iceland")||"Iceland",countryCode:"IS",dialCode:"354"},{countryName:this.intlService.translate("countries.india")||"India",countryCode:"IN",dialCode:"91"},{countryName:this.intlService.translate("countries.indonesia")||"Indonesia",countryCode:"ID",dialCode:"62"},{countryName:this.intlService.translate("countries.iran")||"Iran",countryCode:"IR",dialCode:"98"},{countryName:this.intlService.translate("countries.iraq")||"Iraq",countryCode:"IQ",dialCode:"964"},{countryName:this.intlService.translate("countries.ireland")||"Ireland",countryCode:"IE",dialCode:"353"},{countryName:this.intlService.translate("countries.isleOfMan")||"Isle of Man",countryCode:"IM",dialCode:"44",priority:2},{countryName:this.intlService.translate("countries.israel")||"Israel",countryCode:"IL",dialCode:"972"},{countryName:this.intlService.translate("countries.italy")||"Italy",countryCode:"IT",dialCode:"39",priority:0},{countryName:this.intlService.translate("countries.jamaica")||"Jamaica",countryCode:"JM",dialCode:"1876"},{countryName:this.intlService.translate("countries.japan")||"Japan",countryCode:"JP",dialCode:"81"},{countryName:this.intlService.translate("countries.jersey")||"Jersey",countryCode:"JE",dialCode:"44",priority:3},{countryName:this.intlService.translate("countries.jordan")||"Jordan",countryCode:"JO",dialCode:"962"},{countryName:this.intlService.translate("countries.kazakhstan")||"Kazakhstan",countryCode:"KZ",dialCode:"7",priority:1},{countryName:this.intlService.translate("countries.kenya")||"Kenya",countryCode:"KE",dialCode:"254"},{countryName:this.intlService.translate("countries.kiribati")||"Kiribati",countryCode:"KI",dialCode:"686"},{countryName:this.intlService.translate("countries.kosovo")||"Kosovo",countryCode:"XK",dialCode:"383"},{countryName:this.intlService.translate("countries.kuwait")||"Kuwait",countryCode:"KW",dialCode:"965"},{countryName:this.intlService.translate("countries.kyrgyzstan")||"Kyrgyzstan",countryCode:"KG",dialCode:"996"},{countryName:this.intlService.translate("countries.laos")||"Laos",countryCode:"LA",dialCode:"856"},{countryName:this.intlService.translate("countries.latvia")||"Latvia",countryCode:"LV",dialCode:"371"},{countryName:this.intlService.translate("countries.lebanon")||"Lebanon",countryCode:"LB",dialCode:"961"},{countryName:this.intlService.translate("countries.lesotho")||"Lesotho",countryCode:"LS",dialCode:"266"},{countryName:this.intlService.translate("countries.liberia")||"Liberia",countryCode:"LR",dialCode:"231"},{countryName:this.intlService.translate("countries.libya")||"Libya",countryCode:"LY",dialCode:"218"},{countryName:this.intlService.translate("countries.liechtenstein")||"Liechtenstein",countryCode:"LI",dialCode:"423"},{countryName:this.intlService.translate("countries.lithuania")||"Lithuania",countryCode:"LT",dialCode:"370"},{countryName:this.intlService.translate("countries.luxembourg")||"Luxembourg",countryCode:"LU",dialCode:"352"},{countryName:this.intlService.translate("countries.macau")||"Macau",countryCode:"MO",dialCode:"853"},{countryName:this.intlService.translate("countries.macedonia")||"Macedonia (FYROM)",countryCode:"MK",dialCode:"389"},{countryName:this.intlService.translate("countries.madagascar")||"Madagascar",countryCode:"MG",dialCode:"261"},{countryName:this.intlService.translate("countries.malawi")||"Malawi",countryCode:"MW",dialCode:"265"},{countryName:this.intlService.translate("countries.malaysia")||"Malaysia",countryCode:"MY",dialCode:"60"},{countryName:this.intlService.translate("countries.maldives")||"Maldives",countryCode:"MV",dialCode:"960"},{countryName:this.intlService.translate("countries.mali")||"Mali",countryCode:"ML",dialCode:"223"},{countryName:this.intlService.translate("countries.malta")||"Malta",countryCode:"MT",dialCode:"356"},{countryName:this.intlService.translate("countries.marshallIslands")||"Marshall Islands",countryCode:"MH",dialCode:"692"},{countryName:this.intlService.translate("countries.martinique")||"Martinique",countryCode:"MQ",dialCode:"596"},{countryName:this.intlService.translate("countries.mauritania")||"Mauritania",countryCode:"MR",dialCode:"222"},{countryName:this.intlService.translate("countries.mauritius")||"Mauritius",countryCode:"MU",dialCode:"230"},{countryName:this.intlService.translate("countries.mayotte")||"Mayotte",countryCode:"YT",dialCode:"262",priority:1},{countryName:this.intlService.translate("countries.mexico")||"Mexico",countryCode:"MX",dialCode:"52"},{countryName:this.intlService.translate("countries.micronesia")||"Micronesia",countryCode:"FM",dialCode:"691"},{countryName:this.intlService.translate("countries.moldova")||"Moldova",countryCode:"MD",dialCode:"373"},{countryName:this.intlService.translate("countries.monaco")||"Monaco",countryCode:"MC",dialCode:"377"},{countryName:this.intlService.translate("countries.mongolia")||"Mongolia",countryCode:"MN",dialCode:"976"},{countryName:this.intlService.translate("countries.montenegro")||"Montenegro",countryCode:"ME",dialCode:"382"},{countryName:this.intlService.translate("countries.montserrat")||"Montserrat",countryCode:"MS",dialCode:"1664"},{countryName:this.intlService.translate("countries.morocco")||"Morocco",countryCode:"MA",dialCode:"212",priority:0},{countryName:this.intlService.translate("countries.mozambique")||"Mozambique",countryCode:"MZ",dialCode:"258"},{countryName:this.intlService.translate("countries.myanmar")||"Myanmar (Burma)",countryCode:"MM",dialCode:"95"},{countryName:this.intlService.translate("countries.namibia")||"Namibia",countryCode:"NA",dialCode:"264"},{countryName:this.intlService.translate("countries.nauru")||"Nauru",countryCode:"NR",dialCode:"674"},{countryName:this.intlService.translate("countries.nepal")||"Nepal",countryCode:"NP",dialCode:"977"},{countryName:this.intlService.translate("countries.netherlands")||"Netherlands",countryCode:"NL",dialCode:"31"},{countryName:this.intlService.translate("countries.newCaledonia")||"New Caledonia",countryCode:"NC",dialCode:"687"},{countryName:this.intlService.translate("countries.newZealand")||"New Zealand",countryCode:"NZ",dialCode:"64"},{countryName:this.intlService.translate("countries.nicaragua")||"Nicaragua",countryCode:"NI",dialCode:"505"},{countryName:this.intlService.translate("countries.niger")||"Niger",countryCode:"NE",dialCode:"227"},{countryName:this.intlService.translate("countries.nigeria")||"Nigeria",countryCode:"NG",dialCode:"234"},{countryName:this.intlService.translate("countries.niue")||"Niue",countryCode:"NU",dialCode:"683"},{countryName:this.intlService.translate("countries.norfolkIsland")||"Norfolk Island",countryCode:"NF",dialCode:"672"},{countryName:this.intlService.translate("countries.northKorea")||"North Korea",countryCode:"KP",dialCode:"850"},{countryName:this.intlService.translate("countries.norway")||"Norway",countryCode:"NO",dialCode:"47",priority:0},{countryName:this.intlService.translate("countries.oman")||"Oman",countryCode:"OM",dialCode:"968"},{countryName:this.intlService.translate("countries.pakistan")||"Pakistan",countryCode:"PK",dialCode:"92"},{countryName:this.intlService.translate("countries.palau")||"Palau",countryCode:"PW",dialCode:"680"},{countryName:this.intlService.translate("countries.palestine")||"Palestine",countryCode:"PS",dialCode:"970"},{countryName:this.intlService.translate("countries.panama")||"Panama",countryCode:"PA",dialCode:"507"},{countryName:this.intlService.translate("countries.papuaNewGuinea")||"Papua New Guinea",countryCode:"PG",dialCode:"675"},{countryName:this.intlService.translate("countries.paraguay")||"Paraguay",countryCode:"PY",dialCode:"595"},{countryName:this.intlService.translate("countries.peru")||"Peru",countryCode:"PE",dialCode:"51"},{countryName:this.intlService.translate("countries.philippines")||"Philippines",countryCode:"PH",dialCode:"63"},{countryCode:"PN",countryName:this.intlService.translate("countries.pitcairn")||"Pitcairn"},{countryName:this.intlService.translate("countries.poland")||"Poland",countryCode:"PL",dialCode:"48"},{countryName:this.intlService.translate("countries.portugal")||"Portugal",countryCode:"PT",dialCode:"351"},{countryName:this.intlService.translate("countries.qatar")||"Qatar",countryCode:"QA",dialCode:"974"},{countryName:this.intlService.translate("countries.reunion")||"Runion",countryCode:"RE",dialCode:"262",priority:0},{countryName:this.intlService.translate("countries.romania")||"Romania",countryCode:"RO",dialCode:"40"},{countryName:this.intlService.translate("countries.russia")||"Russia",countryCode:"RU",dialCode:"7",priority:0},{countryName:this.intlService.translate("countries.rwanda")||"Rwanda",countryCode:"RW",dialCode:"250"},{countryName:this.intlService.translate("countries.saintBarthelemy")||"Saint Barthlemy",countryCode:"BL",dialCode:"590",priority:1},{countryName:this.intlService.translate("countries.saintHelena")||"Saint Helena",countryCode:"SH",dialCode:"290"},{countryName:this.intlService.translate("countries.saintKittsAndNevis")||"Saint Kitts and Nevis",countryCode:"KN",dialCode:"1869"},{countryName:this.intlService.translate("countries.saintLucia")||"Saint Lucia",countryCode:"LC",dialCode:"1758"},{countryName:this.intlService.translate("countries.saintMartin")||"Saint Martin (Saint-Martin",countryCode:"MF",dialCode:"590",priority:2},{countryName:this.intlService.translate("countries.saintPierreAndMiquelon")||"Saint Pierre and Miquelon",countryCode:"PM",dialCode:"508"},{countryName:this.intlService.translate("countries.saintVincentAndTheGrenadines")||"Saint Vincent and the Grenadines",countryCode:"VC",dialCode:"1784"},{countryName:this.intlService.translate("countries.samoa")||"Samoa",countryCode:"WS",dialCode:"685"},{countryName:this.intlService.translate("countries.sanMarino")||"San Marino",countryCode:"SM",dialCode:"378"},{countryName:this.intlService.translate("countries.saoTomeAndPrincipe")||"So Tom and Prncipe",countryCode:"ST",dialCode:"239"},{countryName:this.intlService.translate("countries.saudiArabia")||"Saudi Arabia",countryCode:"SA",dialCode:"966"},{countryName:this.intlService.translate("countries.senegal")||"Senegal",countryCode:"SN",dialCode:"221"},{countryName:this.intlService.translate("countries.serbia")||"Serbia",countryCode:"RS",dialCode:"381"},{countryName:this.intlService.translate("countries.seychelles")||"Seychelles",countryCode:"SC",dialCode:"248"},{countryName:this.intlService.translate("countries.sierraLeone")||"Sierra Leone",countryCode:"SL",dialCode:"232"},{countryName:this.intlService.translate("countries.singapore")||"Singapore",countryCode:"SG",dialCode:"65"},{countryName:this.intlService.translate("countries.sintMaarten")||"Sint Maarten",countryCode:"SX",dialCode:"1721"},{countryName:this.intlService.translate("countries.slovakia")||"Slovakia",countryCode:"SK",dialCode:"421"},{countryName:this.intlService.translate("countries.slovenia")||"Slovenia",countryCode:"SI",dialCode:"386"},{countryName:this.intlService.translate("countries.solomonIslands")||"Solomon Islands",countryCode:"SB",dialCode:"677"},{countryName:this.intlService.translate("countries.somalia")||"Somalia",countryCode:"SO",dialCode:"252"},{countryName:this.intlService.translate("countries.southAfrica")||"South Africa",countryCode:"ZA",dialCode:"27"},{countryCode:"GS",countryName:this.intlService.translate("countries.southGeorgiaAndTheSouthSandwichIslands")||"South Georgia and the South Sandwich Islands"},{countryName:this.intlService.translate("countries.southKorea")||"South Korea",countryCode:"KR",dialCode:"82"},{countryName:this.intlService.translate("countries.southSudan")||"South Sudan",countryCode:"SS",dialCode:"211"},{countryName:this.intlService.translate("countries.spain")||"Spain",countryCode:"ES",dialCode:"34"},{countryName:this.intlService.translate("countries.sriLanka")||"Sri Lanka",countryCode:"LK",dialCode:"94"},{countryName:this.intlService.translate("countries.sudan")||"Sudan",countryCode:"SD",dialCode:"249"},{countryName:this.intlService.translate("countries.suriname")||"Suriname",countryCode:"SR",dialCode:"597"},{countryName:this.intlService.translate("countries.svalbardAndJanMayen")||"Svalbard and Jan Mayen",countryCode:"SJ",dialCode:"47",priority:1},{countryName:this.intlService.translate("countries.swaziland")||"Swaziland",countryCode:"SZ",dialCode:"268"},{countryName:this.intlService.translate("countries.sweden")||"Sweden",countryCode:"SE",dialCode:"46"},{countryName:this.intlService.translate("countries.switzerland")||"Switzerland",countryCode:"CH",dialCode:"41"},{countryName:this.intlService.translate("countries.syria")||"Syria",countryCode:"SY",dialCode:"963"},{countryName:this.intlService.translate("countries.taiwan")||"Taiwan",countryCode:"TW",dialCode:"886"},{countryName:this.intlService.translate("countries.tajikistan")||"Tajikistan",countryCode:"TJ",dialCode:"992"},{countryName:this.intlService.translate("countries.tanzania")||"Tanzania",countryCode:"TZ",dialCode:"255"},{countryName:this.intlService.translate("countries.thailand")||"Thailand",countryCode:"TH",dialCode:"66"},{countryName:this.intlService.translate("countries.timorLeste")||"Timor-Leste",countryCode:"TL",dialCode:"670"},{countryName:this.intlService.translate("countries.togo")||"Togo",countryCode:"TG",dialCode:"228"},{countryName:this.intlService.translate("countries.tokelau")||"Tokelau",countryCode:"TK",dialCode:"690"},{countryName:this.intlService.translate("countries.tonga")||"Tonga",countryCode:"TO",dialCode:"676"},{countryName:this.intlService.translate("countries.trinidadAndTobago")||"Trinidad and Tobago",countryCode:"TT",dialCode:"1868"},{countryName:this.intlService.translate("countries.tunisia")||"Tunisia",countryCode:"TN",dialCode:"216"},{countryName:this.intlService.translate("countries.turkey")||"Turkey",countryCode:"TR",dialCode:"90"},{countryName:this.intlService.translate("countries.turkmenistan")||"Turkmenistan",countryCode:"TM",dialCode:"993"},{countryName:this.intlService.translate("countries.turksAndCaicosIslands")||"Turks and Caicos Islands",countryCode:"TC",dialCode:"1649"},{countryName:this.intlService.translate("countries.tuvalu")||"Tuvalu",countryCode:"TV",dialCode:"688"},{countryName:this.intlService.translate("countries.uganda")||"Uganda",countryCode:"UG",dialCode:"256"},{countryName:this.intlService.translate("countries.ukraine")||"Ukraine",countryCode:"UA",dialCode:"380"},{countryName:this.intlService.translate("countries.unitedArabEmirates")||"United Arab Emirates",countryCode:"AE",dialCode:"971"},{countryName:this.intlService.translate("countries.unitedKingdom")||"United Kingdom",countryCode:"GB",dialCode:"44",priority:0},{countryCode:"UM",countryName:this.intlService.translate("countries.unitedStatesMinorOutlyingIslands")||"United States Minor Outlying Islands"},{countryName:this.intlService.translate("countries.unitedStates")||"United States",countryCode:"US",dialCode:"1",priority:0},{countryName:this.intlService.translate("countries.uruguay")||"Uruguay",countryCode:"UY",dialCode:"598"},{countryName:this.intlService.translate("countries.uzbekistan")||"Uzbekistan",countryCode:"UZ",dialCode:"998"},{countryName:this.intlService.translate("countries.vanuatu")||"Vanuatu",countryCode:"VU",dialCode:"678"},{countryName:this.intlService.translate("countries.vaticanCity")||"Vatican City",countryCode:"VA",dialCode:"39",priority:1},{countryName:this.intlService.translate("countries.venezuela")||"Venezuela",countryCode:"VE",dialCode:"58"},{countryName:this.intlService.translate("countries.vietnam")||"Vietnam",countryCode:"VN",dialCode:"84"},{countryName:this.intlService.translate("countries.wallisAndFutuna")||"Wallis and Futuna",countryCode:"WF",dialCode:"681"},{countryName:this.intlService.translate("countries.westernSahara")||"Western Sahara",countryCode:"EH",dialCode:"212",priority:1},{countryName:this.intlService.translate("countries.yemen")||"Yemen",countryCode:"YE",dialCode:"967"},{countryName:this.intlService.translate("countries.zambia")||"Zambia",countryCode:"ZM",dialCode:"260"},{countryName:this.intlService.translate("countries.zimbabwe")||"Zimbabwe",countryCode:"ZW",dialCode:"263"}];return this.language&&this.language!==i.L.EN&&(t=this.sortCountryListAlphabetically(t)),n=t,(null===(e=this.params)||void 0===e?void 0:e.excludePalestineFromCountriesList)?n.filter((({countryCode:e})=>"PS"!==e)):n;var n}sortCountryListAlphabetically(e){return e.sort(((e,t)=>{const n=e.countryName.toLowerCase(),i=t.countryName.toLowerCase();return n<i?-1:n>i?1:0}))}}const a={language:null,translate:()=>null};function o(e){const t=(null==e?void 0:e.intl)||a;return new s(t,{excludePalestineFromCountriesList:null==e?void 0:e.excludePalestineFromCountriesList})}},7149:function(e,t,n){"use strict";n.d(t,{Ay:function(){return l},Bm:function(){return c}});var i=n(9895),s=n(1158),a=(n(6532),n(5913));const o=s,r=i;function l(e){return{...a.$.formatFiatCurrencies(o,e),...a.$.formatCryptoCurrencies(r)}}Object.values(o).map((e=>e.code)),Object.values(i).map((e=>e.code));const c=e=>"IDR"===e?12:8},5913:function(e,t,n){"use strict";n.d(t,{$:function(){return a}});var i=n(1158),s=n(104);class a{loadFiat(e){const t=i;return a.formatFiatCurrencies(t,e)}async loadCrypto(){const e=await this.getCryptoCurrencies();return a.formatCryptoCurrencies(e)}static formatFiatCurrencies(e,t){t||(t={translate:()=>null});const n={};for(const i in e){const a=e[i];n[i]={name:t.translate(`currencies.${i}`)||a.name,code:i,symbol:a.symbol,digits:a.digits,type:s.Z.FIAT,sources:[s.Z.FIAT]}}return n}static formatCryptoCurrencies(e){const t={};for(const n in e){const i=e[n];t[n]={name:i.name,code:n,symbol:i.symbol,digits:i.digits,protocol:i.protocol,networkName:i.networkName,network:i.network,provider:i.provider,type:s.Z.CRYPTO,sources:i.provider}}return t}}},1040:function(e,t,n){"use strict";n.d(t,{Uk:function(){return a},lt:function(){return i},yb:function(){return s}});const i=2,s='RangeError: currencyDisplay must be either "code", "symbol", or "name"',a="symbol"},6837:function(e,t,n){"use strict";n.d(t,{p:function(){return s}});var i=n(3417);function s(e,t){return t&&i.F.includes(e)?"":e}},3417:function(e,t,n){"use strict";n.d(t,{F:function(){return i},f:function(){return s}});const i=["GBP"];function s(e){return i.includes(e)}},104:function(e,t,n){"use strict";var i;n.d(t,{Z:function(){return i}}),function(e){e.FIAT="fiat",e.CRYPTO="crypto"}(i||(i={}))},8366:function(e,t,n){"use strict";n.d(t,{Cf:function(){return i},HP:function(){return s},gR:function(){return a}});class i extends Error{constructor(e){super(e),this.name=this.constructor.name}}class s extends i{constructor(e,t){super(t?`Unreachable statement: ${e} [${t}]`:`Unreachable statement: ${e}`)}}class a extends i{constructor(){super("Unexpected error")}}},4280:function(e,t,n){"use strict";n.d(t,{k0:function(){return u}});var i=n(8366);const s=new WeakMap;let a=null;const o=new Promise((e=>{a=e}));class r extends i.Cf{constructor(e){super(e?`'Script failed to load': ${e}`:"Script failed to load"),this.name="LoadScriptError"}}class l extends i.Cf{constructor(e){super(e?`Load script timeout: ${e}`:"Load script timeout"),this.name="LoadScriptTimeoutError"}}function c(e,t,n={},i=!1,a=null){t=t||window;let o={};s.has(t)?o=s.get(t):s.set(t,o);const c=o[e];if(!i&&c)return c;const d=new Promise((function(i,s){setTimeout((()=>{const a=function(e,t){const n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.src=e,Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),n}(e,n);a.onerror=function(e){if("string"==typeof e)return void s(new r);const t=null==e?void 0:e.target;t instanceof HTMLScriptElement?s(new r(t.src)):s(new r)},a.onload=function(){i(!0)},t.document.documentElement.appendChild(a),u._immedeatly&&i(!0)}),0)})),h=[d];if(null!==a){const t=new Promise(((t,n)=>{setTimeout((()=>n(new l(e))),a)}));h.push(t)}const m=Promise.race(h);return o[e]=m,m}function u(e,t=!1,n,i,s,a){if(i&&(!(r=i)||r.constructor!=={}.constructor))throw new Error("Expected attributes to be an object.");var r;return t?o.then((()=>c(e,n,i,s,a))):c(e,n,i,s,a)}u._windows=s,u._immedeatly=!1},7226:function(e,t,n){"use strict";n.d(t,{Em:function(){return a},GI:function(){return r},Ki:function(){return l}});var i=n(708);const s=new Map;async function a(e){const t=new o(e),n=s.get(e.url);e.cancelSimilar&&n&&n(),s.set(e.url,t.abort.bind(t));try{const n=await t.send();return s.delete(e.url),n}catch(t){throw"AbortError"!==(null==t?void 0:t.originalErrorName)&&s.delete(e.url),t}}class o{constructor(e){this.options=e,this.abortController=function(){try{return void 0!==window.AbortController}catch{return!1}}()?new AbortController:null}abort(){var e;null===(e=this.abortController)||void 0===e||e.abort()}async send(){var e,t;const n=this.getUrl(),i=this.getHeaders(),s=this.getBody(),a=this.getCredentials();let o;try{o=await fetch(n,{method:this.options.method,signal:null===(e=this.abortController)||void 0===e?void 0:e.signal,headers:i,credentials:a,body:s})}catch(e){const t=e instanceof Error?e.message:"Network Error";throw new r(0,t,this.options.method,this.options.url,null==e?void 0:e.name,this.options.setCustomFingerprint)}const l=o.status;let c;const u=o.headers.get("content-type");if(c=(null==u?void 0:u.includes("application/json"))?await o.json():await o.text(),l>=500&&this.options.rejectOnInvalid)throw new r(l,o.statusText,this.options.method,this.options.url,"",this.options.setCustomFingerprint);const d=l>=200&&l<400||(null===(t=this.options.validStatuses)||void 0===t?void 0:t.includes(l));return{data:c,valid:Boolean(d),status:l}}getHeaders(){const e=new Headers,t=this.options.headers;return t&&Object.keys(t).forEach((n=>{const i=t[n];void 0!==i&&e.append(n,i)})),e}getBody(){return void 0!==this.options.params&&"GET"!==this.options.method?JSON.stringify(this.options.params):null}getUrl(){let e=this.options.url;if("GET"===this.options.method&&this.options.params){const t=new URLSearchParams;for(const e of Object.keys(this.options.params))void 0!==this.options.params[e]&&t.set(e,String(this.options.params[e]));e+=`?${t.toString()}`}return e}getCredentials(){return"withCredentials"in this.options?this.options.withCredentials?"include":"omit":"include"}}class r extends Error{constructor(e,t,n,s,a,o){super(`[Checkout Shared]: Server ${n} response status ${e}, ${t} for url ${s}`),this.originalErrorName=a,o&&(this[i.Zk]=[s,t]),this.statusCode=e}}class l extends Error{constructor(){super('Request returned failure result with "rejectOnInvalid" flag set')}}},708:function(e,t,n){"use strict";n.d(t,{Zk:function(){return i},b1:function(){return s}});const i=Symbol("CUSTOM_FINGERPRINT");var s;Symbol("EXTRA"),Symbol("TAGS"),function(e){e.COMMON="common",e.ADMIN="admin",e.DASHBOARD="dashboard",e.DONOR_PORTAL="donorPortal",e.CAMPAIGN_PAGE="campaign-page",e.INTEGRATION="integration",e.BILLING="billing",e.CHECKOUT="checkout",e.CHECKOUT_STEPLESS="checkout-stepless",e.EMAILS="emails"}(s||(s={}))},3488:function(e,t,n){"use strict";var i,s;n.d(t,{bG:function(){return s},lS:function(){return i}}),function(e){e.IOS="iOS",e.ANDROID="Android"}(i||(i={})),function(e){e.MOBILE_SAFARI="Mobile Safari",e.SAFARI="Safari"}(s||(s={}))},9199:function(e,t,n){"use strict";n.d(t,{MS:function(){return a}});const i=36e5,s=24*i,a={SECOND:1e3,MINUTE:6e4,HOUR:i,DAY:s,YEAR:365*s}},936:function(e,t,n){"use strict";var i,s;n.d(t,{N:function(){return s},f:function(){return i}}),function(e){e.ASK_VIDEO_SHOWN="askVideoShown",e.ASK_VIDEO_PLAY="askVideoPlay",e.ASK_VIDEO_PAUSE="askVideoPause",e.ASK_VIDEO_FINISHED="askVideoFinished",e.ASK_VIDEO_MUTE_CHANGED="askVideoMuteChanged",e.ASK_VIDEO_CAPTIONS_CHANGED="askVideoCaptionsChanged",e.ASK_VIDEO_FULLSCREEN_CHANGED="askVideoOnFullScreen",e.ASK_VIDEO_INIT_PLAYER_ERROR="askVideoInitPlayerError",e.ASK_VIDEO_ERROR="askVideoError",e.ASK_VIDEO_SHOW_IMAGE_AS_FALLBACK="askVideoShowImageAsFallback"}(i||(i={})),function(e){e.MUTE="mute",e.UNMUTE="unmute"}(s||(s={}))},9279:function(e,t,n){"use strict";var i;n.d(t,{h:function(){return i}}),function(e){e.DEVELOPMENT="development",e.PRODUCTION="production",e.STAGING="staging",e.TESTING="testing"}(i||(i={}))},3421:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-amex.f704acb7cb0f1c209efa.png"},2707:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-diners.b69117170ac25814aa42.png"},1229:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-discover.dbc0569d3c7cfb9e0c1e.png"},543:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-jcb.12e905d1462fd708b795.png"},9848:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-mastercard.51e8e6a0a1b07ef9c09b.png"},8057:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-unionpay.98ea5861340fc8694663.png"},2217:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-unknown-error.7afd2ac2559f2f9f3960.png"},8044:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-unknown.265c1bce7f59ecbff072.png"},9503:function(e,t,n){"use strict";e.exports=n.p+"checkout-shared/src/images/card-visa.d358d698a9d21919e7c1.png"},7755:function(e,t,n){"use strict";e.exports=n.p+"src/experiments/DonateByVoiceExperiment/images/conversation-progress.93d50bc52df763a26452.gif"},6843:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans-arabic/ibmplexsans-arabic-v12-300.woff2"},4312:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans-arabic/ibmplexsans-arabic-v12-400.woff2"},7977:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans-arabic/ibmplexsans-arabic-v12-500.woff2"},5870:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans-arabic/ibmplexsans-arabic-v12-600.woff2"},9807:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans-arabic/ibmplexsans-arabic-v12-700.woff2"},8552:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v19-300.woff2"},1755:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v19-400.woff2"},9706:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v19-500.woff2"},3717:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v19-600.woff2"},8676:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v19-700.woff2"},6569:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v23-400-italic.woff2"},4823:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/ibm-plex-sans/ibmplexsans-v23-600-italic.woff2"},3179:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/sacramento/sacramento-v15-400.woff2"},9562:function(e,t,n){"use strict";e.exports=n.p+"common-fonts/verveine/verveine-400.woff2"},212:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/balloon.3fadac351c7afa144770.webp"},3185:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/blue-hearts.8bb18c2f0b4e964d4779.webp"},849:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/confetti-ball.e1a40c497a4c57d9821d.webp"},1174:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/cool-face.353b5af16e3e0f36241f.webp"},5151:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/diamond.c4bfa4b2104eb94d3d01.webp"},9182:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/double-hearts.e20e9a2f95791efaa17e.webp"},584:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/double-stars.454dd2863edd2c84ddb4.webp"},511:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/empty-heart.cf61de4f9bc65a6e3954.webp"},252:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/failed.78b69623c61fe7a40b46.webp"},6887:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/fire-flame.6292ff12fc65ed58cb7e.webp"},6780:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/folded-hands.4572e756866b1590030b.webp"},9855:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/gift.c0eb317183783d50261e.webp"},6089:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/grinning-face.16f96a5b9c681552cb19.webp"},2521:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/happy-hand.8515328153094631b81d.webp"},5275:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/heart.5d7a1f48cd8491c92848.webp"},3559:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/light.26cc637c6953c0b2e37a.webp"},4012:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/love-letter.a1f82f7933ffa4777a35.webp"},44:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/medal.c9e991f25a8e6e3727ba.webp"},7508:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/message.a2091555f6d1ec9586cb.webp"},6900:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/party-popper.9db53a740cd202cc9d33.webp"},5993:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/partying-face.7580b4fb974a2b4d99a9.webp"},2807:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/prize.b58e60fdf9beaa7499ec.webp"},2147:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/receipt.3f8ea25f872d39931bb2.webp"},1503:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/sad-face.23e02a045497ae51a43f.webp"},2454:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/share-hearts.a8d666cbc0bc6402300f.webp"},9546:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/smiling-face.17c1e2b99534c5d47b67.webp"},2061:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/star.2883ff6fe9846cc43586.webp"},2856:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/success.ef2f2ef95bdf4f922d4e.webp"},2902:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/thumbs-up.8e4a48f80a904136e17a.webp"},4487:function(e,t,n){"use strict";e.exports=n.p+"common-images/emoji/trophy.e9bd7c307c89e3d91280.webp"},9658:function(e){"use strict";e.exports=JSON.parse('{"u":"URL","ck":"companyKey","cm":"checkoutCompanyKey","cd":"clientId","ct":"clientTime","cz":"clientTimeZone","lo":"clientLocale","ek":"elementKey","el":"elementLocale","er":"elementReminderKey","ey":"elementType","ep":"elementParams","et":"eventType","te":"customEventType","ev":"customEventData","ed":"elementData","eg":"eventTags","pv":"pageViewId","pl":"pageViewLifetime","r":"referer","rh":"resolutionHeight","rw":"resolutionWidth","t":"title","hl":"uaHistoryLength","wk":"widgetKey","wh":"windowHeight","wx":"windowScrollX","wy":"windowScrollY","ww":"windowWidth","cv":"checkoutViewId","ce":"checkoutError","co":"checkoutOpenTime","cl":"checkoutLifetime","cs":"checkoutScreen","sd":"checkoutScreenData","cc":"checkoutClickElement","cf":"checkoutFrequency","fp":"clickDOMPath","fh":"clickAHref","ft":"clickText","dk":"chargeCampaignKey","dd":"chargeKey","du":"chargeInUSDAmount","di":"chargeInDefaultCurrencyAmount","da":"chargeAmount","dc":"chargeCurrency","df":"chargeFeeCovered","dm":"chargePaymentMethod","dr":"chargeIsRecurring","dn":"chargeHasComment","dh":"chargeHasTribute","dg":"chargeGoal","st":"splitTestName","sv":"splitTestVariant","pm":"paymentMethod","ws":"widgetSession","lm":"livemode","fv":"funSnippetVersion","fe":"funEmbedRelease","vf":"isFundraiseupVisitor","lc":"checkoutLocale","cr":"checkoutIsRecurring","cy":"checkoutCurrency","ca":"checkoutAmount","cu":"checkoutInUSDAmount","yr":"checkoutCurrencyRate","fa":"checkoutDefaultAmount","cp":"checkoutPresets","ps":"pageScripts","ol":"clientOnLine","dt":"clientDoNotTrack","pr":"clientDevicePixelRatio","rm":"clientDeviceMemory","hc":"clientHardwareConcurrency","nt":"clientConnectionType","nd":"clientConnectionDownlink","nr":"clientConnectionRTT","ne":"clientConnectionEffectiveType","bc":"clientBatteryCharging","bt":"clientBatteryChargingTime","bd":"clientBatteryDischargingTime","bl":"clientBatteryLevel","de":"dataLayerEventName","dp":"dataLayerParams","fn":"pixelEventName","fs":"pixelEventData","gk":"fundraisingGroupKey","pk":"fundraisingPageKey","pc":"fundraisingPageCustomerKey","ec":"eventComment","ba":"uaIsInApp","uw":"uaWebdriver","rd":"duration","se":"source","sk":"supporterKey","ak":"agentKey","pu":"pointingDeviceIsUsed","fo":"donationType","cn":"clientCookieConsent","tt":"checkoutType","pi":"paymentIntentId","ds":"donationItems"}')},9895:function(e){"use strict";e.exports=JSON.parse('{"BTC":{"name":"Bitcoin","code":"BTC","symbol":"","digits":8,"network":"bitcoin","provider":["gemini","coinbaseCommerce"],"protocol":"","networkName":"Bitcoin","coin":true},"ETH":{"name":"Ethereum","code":"ETH","symbol":"","digits":8,"network":"ethereum","provider":["gemini","coinbaseCommerce"],"protocol":"ERC-20","networkName":"Ethereum","coin":true},"USDT":{"name":"Tether USD","code":"USDT","symbol":"","digits":8,"network":"ethereum","provider":["coinbaseCommerce"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"USDC":{"name":"USD Coin","code":"USDC","symbol":"","digits":8,"network":"ethereum","provider":["gemini","coinbaseCommerce"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"SOL":{"name":"Solana","code":"SOL","symbol":"","digits":8,"network":"solana","provider":["gemini"],"protocol":"","networkName":"Solana","coin":true},"DOT":{"name":"Polkadot","code":"DOT","symbol":"","digits":8,"network":"polkadot","provider":["gemini"],"protocol":"","networkName":"Polkadot","coin":true},"DOGE":{"name":"Dogecoin","code":"DOGE","symbol":"","digits":8,"network":"dogecoin","provider":["gemini","coinbaseCommerce"],"protocol":"","networkName":"Dogecoin","coin":true},"SHIB":{"name":"Shiba Inu","code":"SHIB","symbol":"","digits":8,"network":"ethereum","provider":["gemini","coinbaseCommerce"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"LTC":{"name":"Litecoin","code":"LTC","symbol":"","digits":8,"network":"litecoin","provider":["gemini","coinbaseCommerce"],"protocol":"","networkName":"Litecoin","coin":true},"BCH":{"name":"Bitcoin Cash","code":"BCH","symbol":"","digits":8,"network":"bitcoincash","provider":["gemini","coinbaseCommerce"],"protocol":"","networkName":"Bitcoin Cash","coin":true},"XTZ":{"name":"Tezos","code":"XTZ","symbol":"","digits":8,"network":"tezos","provider":["gemini"],"protocol":"","networkName":"Tezos","coin":true},"FIL":{"name":"Filecoin","code":"FIL","symbol":"","digits":8,"network":"filecoin","provider":["gemini"],"protocol":"","networkName":"Filecoin","coin":true},"FTM":{"name":"Fantom","code":"FTM","symbol":"","digits":8,"network":"ethereum","provider":["gemini"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"GALA":{"name":"Gala","code":"GALA","symbol":"","digits":8,"network":"ethereum","provider":["gemini"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"PAXG":{"name":"PAX Gold","code":"PAXG","symbol":"","digits":8,"network":"ethereum","provider":["gemini"],"protocol":"ERC-20","networkName":"Ethereum","coin":false},"ZEC":{"name":"Zcash","code":"ZEC","symbol":"","digits":8,"network":"zcash","provider":["gemini"],"protocol":"","networkName":"Zcash","coin":true}}')},1158:function(e){"use strict";e.exports=JSON.parse('{"SHP":{"name":"St. Helena Pound","code":"SHP","symbol":"","digits":2},"EUR":{"name":"Euro","code":"EUR","symbol":"","digits":2},"AED":{"name":"United Arab Emirates Dirham","code":"AED","symbol":"","digits":2},"AFN":{"name":"Afghan Afghani","code":"AFN","symbol":"","digits":2},"XCD":{"name":"East Caribbean Dollar","code":"XCD","symbol":"$","digits":2},"ALL":{"name":"Albanian Lek","code":"ALL","symbol":"","digits":2},"AMD":{"name":"Armenian Dram","code":"AMD","symbol":"","digits":2},"AOA":{"name":"Angolan Kwanza","code":"AOA","symbol":"Kz","digits":2},"ARS":{"name":"Argentine Peso","code":"ARS","symbol":"$","digits":2},"USD":{"name":"US Dollar","code":"USD","symbol":"$","digits":2},"AUD":{"name":"Australian Dollar","code":"AUD","symbol":"$","digits":2},"ANG":{"name":"Netherlands Antillean Guilder","code":"ANG","symbol":"","digits":2},"AWG":{"name":"Aruban Florin","code":"AWG","symbol":"","digits":2},"AZN":{"name":"Azerbaijani Manat","code":"AZN","symbol":"","digits":2},"BAM":{"name":"Bosnia-Herzegovina Convertible Mark","code":"BAM","symbol":"KM","digits":2},"BBD":{"name":"Barbadian Dollar","code":"BBD","symbol":"$","digits":2},"INR":{"name":"Indian Rupee","code":"INR","symbol":"","digits":2},"PKR":{"name":"Pakistani Rupee","code":"PKR","symbol":"Rs","digits":2},"BDT":{"name":"Bangladeshi Taka","code":"BDT","symbol":"","digits":2},"XOF":{"name":"West African CFA Franc","code":"XOF","symbol":"","digits":0},"BGN":{"name":"Bulgarian Lev","code":"BGN","symbol":"","digits":2},"BHD":{"name":"Bahraini Dinar","code":"BHD","symbol":"","digits":2},"BIF":{"name":"Burundian Franc","code":"BIF","symbol":"","digits":0},"BMD":{"name":"Bermudan Dollar","code":"BMD","symbol":"$","digits":2},"MYR":{"name":"Malaysian Ringgit","code":"MYR","symbol":"RM","digits":2},"BND":{"name":"Brunei Dollar","code":"BND","symbol":"$","digits":2},"BOB":{"name":"Bolivian Boliviano","code":"BOB","symbol":"Bs","digits":2},"BRL":{"name":"Brazilian Real","code":"BRL","symbol":"R$","digits":2},"BSD":{"name":"Bahamian Dollar","code":"BSD","symbol":"$","digits":2},"BTN":{"name":"Bhutanese Ngultrum","code":"BTN","symbol":"","digits":2},"NOK":{"name":"Norwegian Krone","code":"NOK","symbol":"kr","digits":2},"ZAR":{"name":"South African Rand","code":"ZAR","symbol":"R","digits":2},"BWP":{"name":"Botswanan Pula","code":"BWP","symbol":"P","digits":2},"BYN":{"name":"Belarusian Ruble","code":"BYN","symbol":"","digits":2},"BZD":{"name":"Belize Dollar","code":"BZD","symbol":"$","digits":2},"CAD":{"name":"Canadian Dollar","code":"CAD","symbol":"$","digits":2},"CDF":{"name":"Congolese Franc","code":"CDF","symbol":"","digits":2},"XAF":{"name":"Central African CFA Franc","code":"XAF","symbol":"","digits":0},"CHF":{"name":"Swiss Franc","code":"CHF","symbol":"","digits":2},"NZD":{"name":"New Zealand Dollar","code":"NZD","symbol":"$","digits":2},"CLP":{"name":"Chilean Peso","code":"CLP","symbol":"$","digits":0},"CNY":{"name":"Chinese Yuan","code":"CNY","symbol":"","digits":2},"COP":{"name":"Colombian Peso","code":"COP","symbol":"$","digits":2},"CRC":{"name":"Costa Rican Coln","code":"CRC","symbol":"","digits":2},"CVE":{"name":"Cape Verdean Escudo","code":"CVE","symbol":"","digits":2},"CZK":{"name":"Czech Koruna","code":"CZK","symbol":"K","digits":2},"DJF":{"name":"Djiboutian Franc","code":"DJF","symbol":"","digits":0},"DKK":{"name":"Danish Krone","code":"DKK","symbol":"kr","digits":2},"DOP":{"name":"Dominican Peso","code":"DOP","symbol":"$","digits":2},"DZD":{"name":"Algerian Dinar","code":"DZD","symbol":"","digits":2},"EGP":{"name":"Egyptian Pound","code":"EGP","symbol":"E","digits":2},"MAD":{"name":"Moroccan Dirham","code":"MAD","symbol":"","digits":2},"ETB":{"name":"Ethiopian Birr","code":"ETB","symbol":"","digits":2},"FJD":{"name":"Fijian Dollar","code":"FJD","symbol":"$","digits":2},"FKP":{"name":"Falkland Islands Pound","code":"FKP","symbol":"","digits":2},"JPY":{"name":"Japanese Yen","code":"JPY","symbol":"","digits":0},"GBP":{"name":"British Pound","code":"GBP","symbol":"","digits":2},"GEL":{"name":"Georgian Lari","code":"GEL","symbol":"","digits":2},"GHS":{"name":"Ghanaian Cedi","code":"GHS","symbol":"GH","digits":2},"GIP":{"name":"Gibraltar Pound","code":"GIP","symbol":"","digits":2},"GMD":{"name":"Gambian Dalasi","code":"GMD","symbol":"","digits":2},"GNF":{"name":"Guinean Franc","code":"GNF","symbol":"FG","digits":0},"GTQ":{"name":"Guatemalan Quetzal","code":"GTQ","symbol":"Q","digits":2},"GYD":{"name":"Guyanaese Dollar","code":"GYD","symbol":"$","digits":2},"HKD":{"name":"Hong Kong Dollar","code":"HKD","symbol":"$","digits":2},"HNL":{"name":"Honduran Lempira","code":"HNL","symbol":"L","digits":2},"HRK":{"name":"Croatian Kuna","code":"HRK","symbol":"kn","digits":2},"HTG":{"name":"Haitian Gourde","code":"HTG","symbol":"","digits":2},"HUF":{"name":"Hungarian Forint","code":"HUF","symbol":"Ft","digits":2},"IDR":{"name":"Indonesian Rupiah","code":"IDR","symbol":"Rp","digits":2},"ILS":{"name":"Israeli New Shekel","code":"ILS","symbol":"","digits":2},"ISK":{"name":"Icelandic Krna","code":"ISK","symbol":"kr","digits":2},"JMD":{"name":"Jamaican Dollar","code":"JMD","symbol":"$","digits":2},"JOD":{"name":"Jordanian Dinar","code":"JOD","symbol":"","digits":2},"KES":{"name":"Kenyan Shilling","code":"KES","symbol":"","digits":2},"KGS":{"name":"Kyrgystani Som","code":"KGS","symbol":"","digits":2},"KHR":{"name":"Cambodian Riel","code":"KHR","symbol":"","digits":2},"KMF":{"name":"Comorian Franc","code":"KMF","symbol":"CF","digits":0},"KRW":{"name":"South Korean Won","code":"KRW","symbol":"","digits":0},"KWD":{"name":"Kuwaiti Dinar","code":"KWD","symbol":"","digits":2},"KYD":{"name":"Cayman Islands Dollar","code":"KYD","symbol":"$","digits":2},"KZT":{"name":"Kazakhstani Tenge","code":"KZT","symbol":"","digits":2},"LAK":{"name":"Laotian Kip","code":"LAK","symbol":"","digits":2},"LBP":{"name":"Lebanese Pound","code":"LBP","symbol":"L","digits":2},"LKR":{"name":"Sri Lankan Rupee","code":"LKR","symbol":"Rs","digits":2},"LRD":{"name":"Liberian Dollar","code":"LRD","symbol":"$","digits":2},"LSL":{"name":"Lesotho Loti","code":"LSL","symbol":"","digits":2},"MDL":{"name":"Moldovan Leu","code":"MDL","symbol":"","digits":2},"MGA":{"name":"Malagasy Ariary","code":"MGA","symbol":"Ar","digits":0},"MKD":{"name":"Macedonian Denar","code":"MKD","symbol":"","digits":2},"MMK":{"name":"Myanmar Kyat","code":"MMK","symbol":"K","digits":2},"MNT":{"name":"Mongolian Tugrik","code":"MNT","symbol":"","digits":2},"MOP":{"name":"Macanese Pataca","code":"MOP","symbol":"","digits":2},"MRO":{"name":"Mauritanian Ouguiya (19732017)","code":"MRO","symbol":"","digits":2},"MUR":{"name":"Mauritian Rupee","code":"MUR","symbol":"Rs","digits":2},"MVR":{"name":"Maldivian Rufiyaa","code":"MVR","symbol":"","digits":2},"MWK":{"name":"Malawian Kwacha","code":"MWK","symbol":"","digits":2},"MXN":{"name":"Mexican Peso","code":"MXN","symbol":"$","digits":2},"MZN":{"name":"Mozambican Metical","code":"MZN","symbol":"","digits":2},"NAD":{"name":"Namibian Dollar","code":"NAD","symbol":"$","digits":2},"XPF":{"name":"CFP Franc","code":"XPF","symbol":"","digits":0},"NGN":{"name":"Nigerian Naira","code":"NGN","symbol":"","digits":2},"NIO":{"name":"Nicaraguan Crdoba","code":"NIO","symbol":"C$","digits":2},"SEK":{"name":"Swedish Krona","code":"SEK","symbol":"kr","digits":2},"NPR":{"name":"Nepalese Rupee","code":"NPR","symbol":"Rs","digits":2},"OMR":{"name":"Omani Rial","code":"OMR","symbol":"","digits":2},"PAB":{"name":"Panamanian Balboa","code":"PAB","symbol":"","digits":2},"PEN":{"name":"Peruvian Sol","code":"PEN","symbol":"","digits":2},"PGK":{"name":"Papua New Guinean Kina","code":"PGK","symbol":"","digits":2},"PHP":{"name":"Philippine Peso","code":"PHP","symbol":"","digits":2},"PLN":{"name":"Polish Zloty","code":"PLN","symbol":"z","digits":2},"PYG":{"name":"Paraguayan Guarani","code":"PYG","symbol":"","digits":0},"QAR":{"name":"Qatari Riyal","code":"QAR","symbol":"","digits":2},"RON":{"name":"Romanian Leu","code":"RON","symbol":"lei","digits":2},"RSD":{"name":"Serbian Dinar","code":"RSD","symbol":"","digits":2},"RUB":{"name":"Russian Ruble","code":"RUB","symbol":"","digits":2},"RWF":{"name":"Rwandan Franc","code":"RWF","symbol":"RF","digits":0},"SAR":{"name":"Saudi Riyal","code":"SAR","symbol":"","digits":2},"SBD":{"name":"Solomon Islands Dollar","code":"SBD","symbol":"$","digits":2},"SCR":{"name":"Seychellois Rupee","code":"SCR","symbol":"","digits":2},"SGD":{"name":"Singapore Dollar","code":"SGD","symbol":"$","digits":2},"SLL":{"name":"Sierra Leonean Leone (19642022)","code":"SLL","symbol":"","digits":2},"SLE":{"name":"Sierra Leonean Leone","code":"SLE","symbol":"","digits":2},"SOS":{"name":"Somali Shilling","code":"SOS","symbol":"","digits":2},"SRD":{"name":"Surinamese Dollar","code":"SRD","symbol":"$","digits":2},"STD":{"name":"So Tom & Prncipe Dobra (19772017)","code":"STD","symbol":"","digits":2},"SVC":{"name":"Salvadoran Coln","code":"SVC","symbol":"","digits":2},"SZL":{"name":"Swazi Lilangeni","code":"SZL","symbol":"","digits":2},"THB":{"name":"Thai Baht","code":"THB","symbol":"","digits":2},"TJS":{"name":"Tajikistani Somoni","code":"TJS","symbol":"","digits":2},"TND":{"name":"Tunisian Dinar","code":"TND","symbol":"","digits":2},"TOP":{"name":"Tongan Paanga","code":"TOP","symbol":"T$","digits":2},"TRY":{"name":"Turkish Lira","code":"TRY","symbol":"","digits":2},"TTD":{"name":"Trinidad & Tobago Dollar","code":"TTD","symbol":"$","digits":2},"TWD":{"name":"New Taiwan Dollar","code":"TWD","symbol":"$","digits":2},"TZS":{"name":"Tanzanian Shilling","code":"TZS","symbol":"","digits":2},"UAH":{"name":"Ukrainian Hryvnia","code":"UAH","symbol":"","digits":2},"UYU":{"name":"Uruguayan Peso","code":"UYU","symbol":"$","digits":2},"UZS":{"name":"Uzbekistani Som","code":"UZS","symbol":"","digits":2},"VND":{"name":"Vietnamese Dong","code":"VND","symbol":"","digits":0},"VUV":{"name":"Vanuatu Vatu","code":"VUV","symbol":"","digits":0},"WST":{"name":"Samoan Tala","code":"WST","symbol":"","digits":2},"YER":{"name":"Yemeni Rial","code":"YER","symbol":"","digits":2},"ZMW":{"name":"Zambian Kwacha","code":"ZMW","symbol":"ZK","digits":2}}')},6532:function(e){"use strict";e.exports=JSON.parse('{"AC":["SHP"],"AD":["EUR"],"AE":["AED"],"AF":["AFN"],"AG":["XCD"],"AI":["XCD"],"AL":["ALL"],"AM":["AMD"],"AO":["AOA"],"AR":["ARS"],"AS":["USD"],"AT":["EUR"],"AU":["AUD"],"AW":["AWG","ANG"],"AX":["EUR"],"AZ":["AZN"],"BA":["BAM"],"BB":["BBD","XCD"],"BD":["BDT","PKR","INR"],"BE":["EUR"],"BF":["XOF"],"BG":["BGN","EUR"],"BH":["BHD"],"BI":["BIF"],"BJ":["XOF"],"BL":["EUR"],"BM":["BMD"],"BN":["BND","MYR"],"BO":["BOB"],"BQ":["USD","ANG"],"BR":["BRL"],"BS":["BSD"],"BT":["BTN","INR"],"BV":["NOK"],"BW":["BWP","ZAR"],"BY":["BYN","EUR"],"BZ":["BZD"],"CA":["CAD","USD"],"CC":["AUD"],"CD":["CDF"],"CF":["XAF"],"CG":["XAF"],"CH":["CHF"],"CI":["XOF"],"CK":["NZD"],"CL":["CLP"],"CM":["XAF"],"CN":["CNY"],"CO":["COP"],"CR":["CRC"],"CS":["EUR"],"CU":["USD"],"CV":["CVE"],"CW":["ANG"],"CX":["AUD"],"CY":["EUR"],"CZ":["CZK","EUR"],"DE":["EUR"],"DG":["USD"],"DJ":["DJF"],"DK":["DKK","EUR"],"DM":["XCD"],"DO":["DOP","USD"],"DZ":["DZD"],"EA":["EUR"],"EC":["USD"],"EE":["EUR"],"EG":["EGP"],"EH":["MAD"],"ER":["ETB"],"ES":["EUR"],"ET":["ETB"],"EU":["EUR"],"FI":["EUR"],"FJ":["FJD"],"FK":["FKP"],"FM":["USD","JPY"],"FO":["DKK"],"FR":["EUR"],"GA":["XAF"],"GB":["GBP","EUR"],"GD":["XCD"],"GE":["GEL"],"GF":["EUR"],"GG":["GBP"],"GH":["GHS"],"GI":["GIP"],"GL":["DKK"],"GM":["GMD"],"GN":["GNF"],"GP":["EUR"],"GQ":["XAF"],"GR":["EUR"],"GS":["GBP"],"GT":["GTQ"],"GU":["USD"],"GW":["XOF"],"GY":["GYD"],"HK":["HKD"],"HM":["AUD"],"HN":["HNL"],"HR":["EUR"],"HT":["USD","HTG"],"HU":["HUF","EUR"],"IC":["EUR"],"ID":["IDR"],"IE":["EUR","GBP"],"IL":["ILS"],"IM":["GBP"],"IN":["INR"],"IO":["USD"],"IQ":["INR","EGP"],"IS":["ISK","DKK"],"IT":["EUR"],"JE":["GBP"],"JM":["JMD"],"JO":["JOD"],"JP":["JPY"],"KE":["KES"],"KG":["KGS"],"KH":["KHR"],"KI":["AUD"],"KM":["KMF"],"KN":["XCD"],"KR":["KRW"],"KW":["KWD"],"KY":["KYD","JMD"],"KZ":["KZT"],"LA":["LAK"],"LB":["LBP"],"LC":["XCD"],"LI":["CHF"],"LK":["LKR"],"LR":["LRD"],"LS":["LSL","ZAR"],"LT":["EUR"],"LU":["EUR"],"LV":["EUR"],"MA":["MAD"],"MC":["EUR"],"MD":["MDL"],"ME":["EUR"],"MF":["EUR"],"MG":["MGA"],"MH":["USD"],"MK":["MKD"],"ML":["XOF","XOF"],"MM":["MMK"],"MN":["MNT"],"MO":["MOP"],"MP":["USD"],"MQ":["EUR"],"MR":["XOF"],"MS":["XCD"],"MT":["EUR"],"MU":["MUR"],"MV":["MVR"],"MW":["MWK"],"MX":["MXN","USD"],"MY":["MYR"],"MZ":["MZN"],"NA":["NAD","ZAR"],"NC":["XPF"],"NE":["XOF"],"NF":["AUD"],"NG":["NGN"],"NI":["NIO"],"NL":["EUR"],"NO":["NOK","SEK","EUR"],"NP":["NPR","INR"],"NR":["AUD"],"NU":["NZD"],"NZ":["NZD"],"OM":["OMR"],"PA":["USD","PAB"],"PE":["PEN"],"PF":["XPF"],"PG":["PGK","AUD"],"PH":["PHP"],"PK":["PKR","INR"],"PL":["PLN","EUR"],"PM":["EUR"],"PN":["NZD"],"PR":["USD"],"PS":["JOD","ILS","JOD"],"PT":["EUR"],"PW":["USD"],"PY":["PYG"],"QA":["QAR"],"RE":["EUR"],"RO":["RON","EUR"],"RS":["RSD"],"RU":["RUB","EUR"],"RW":["RWF"],"SA":["SAR"],"SB":["SBD","AUD"],"SC":["SCR"],"SD":["GBP","EGP"],"SE":["SEK","EUR"],"SG":["SGD","MYR"],"SH":["SHP"],"SI":["EUR"],"SJ":["NOK"],"SK":["EUR"],"SL":["SLE","GBP","SLL"],"SM":["EUR"],"SN":["XOF"],"SO":["SOS"],"SR":["SRD"],"ST":["USD"],"SV":["USD"],"SX":["ANG"],"SZ":["SZL"],"TA":["GBP"],"TC":["USD"],"TD":["XAF"],"TF":["EUR"],"TG":["XOF"],"TH":["THB"],"TJ":["TJS"],"TK":["NZD"],"TL":["USD","IDR"],"TN":["TND"],"TO":["TOP"],"TP":["IDR"],"TR":["TRY"],"TT":["TTD"],"TV":["AUD"],"TW":["TWD"],"TZ":["TZS"],"UA":["UAH","EUR"],"UM":["USD"],"US":["USD"],"UY":["UYU"],"UZ":["UZS"],"VA":["EUR"],"VC":["XCD"],"VG":["GBP","USD"],"VI":["USD"],"VN":["VND"],"VU":["VUV"],"WF":["XPF"],"WS":["WST"],"XK":["EUR"],"YE":["YER"],"YT":["EUR","KMF"],"ZA":["ZAR"],"ZM":["ZMW"],"ZW":["USD"]}')},3854:function(e){"use strict";e.exports=JSON.parse('{"name":"ACH","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"minAmount":{"size":9500,"currency":"USD"}},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},6580:function(e){"use strict";e.exports=JSON.parse('{"name":"ACSS","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":["CAD"],"companyCountry":["CA","US"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["CAD"],"companyCountry":["CA","US"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"minAmount":{"size":200,"currency":"CAD"}},"currency":["CAD"],"companyCountry":["CA","US"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["CAD"],"companyCountry":["CA","US"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},2240:function(e){"use strict";e.exports=JSON.parse('{"name":"Apple Pay","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},5323:function(e){"use strict";e.exports=JSON.parse('{"name":"BECS Direct Debit","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"minAmount":{"size":200,"currency":"AUD"}},"currency":["AUD"],"companyCountry":["AU"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["AUD"],"companyCountry":["AU"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"minAmount":{"size":200,"currency":"AUD"}},"currency":["AUD"],"companyCountry":["AU"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["AUD"],"companyCountry":["AU"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":false},"repeat":["once","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},3263:function(e){"use strict";e.exports=JSON.parse('{"name":"Click to Pay","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},6301:function(e){"use strict";e.exports=JSON.parse('{"name":"Credit Card","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},311:function(e){"use strict";e.exports=JSON.parse('{"name":"Crypto","provider":"gemini","donorPortalSubscriptionEditor":{},"dashboardSubscriptionEditor":{},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once"]},"virtualTerminal":{}}')},4454:function(e){"use strict";e.exports=JSON.parse('{"name":"Google Pay","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},323:function(e){"use strict";e.exports=JSON.parse('{"name":"iDEAL","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"minAmount":{"size":200,"currency":"EUR"}},"currency":["EUR"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"customerCountry":["NL","BE","LU","DE"],"email":{"required":true},"address":{"required":false},"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{},"widget":{"amount":{"minAmount":{"size":200,"currency":"EUR"}},"currency":["EUR"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"customerCountry":["NL","BE","LU","DE"],"email":{"required":true},"address":{"required":false},"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{}}')},7565:function(e){"use strict";e.exports=JSON.parse('{"name":"PayPal","provider":"paypal","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","daily","weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},7984:function(e){"use strict";e.exports=JSON.parse('{"name":"Plaid","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},4921:function(e){"use strict";e.exports=JSON.parse('{"name":"SEPA Direct Debit","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"minAmount":{"size":200,"currency":"EUR"}},"currency":["EUR"],"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true}},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["EUR"],"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true}},"widget":{"amount":{"minAmount":{"size":200,"currency":"EUR"}},"currency":["EUR"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"requiredIfIbanCountry":["AD","PF","TF","GI","GB","GG","VA","IM","JE","MC","NC","BL","PM","SM","CH","WF"]},"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["EUR"],"companyCountry":["AT","BE","CY","EE","FI","FR","DE","GR","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SG","SK","SI","ES","SE","NO","US","CH","AU","BG","CA","HR","CZ","DK","GI","HK","HU","JP","LI","MX","NZ","GB"],"address":{"requiredIfIbanCountry":["AD","PF","TF","GI","GB","GG","VA","IM","JE","MC","NC","BL","PM","SM","CH","WF"]},"email":{"required":true},"repeat":["once","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},4916:function(e){"use strict";e.exports=JSON.parse('{"name":"Stock","provider":"manualBrokerage","donorPortalSubscriptionEditor":{},"dashboardSubscriptionEditor":{},"widget":{"amount":{"availableAll":true},"currency":{"availableAll":true},"companyCountry":{"availableAll":true},"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once"]},"virtualTerminal":{}}')},7469:function(e){"use strict";e.exports=JSON.parse('{"name":"Bacs Direct Debit","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"minAmount":{"size":200,"currency":"GBP"}},"currency":["GBP"],"companyCountry":["GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true},"repeat":["weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["GBP"],"companyCountry":["GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true},"repeat":["weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"minAmount":{"size":200,"currency":"GBP"}},"currency":["GBP"],"companyCountry":["GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true},"repeat":["weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["GBP"],"companyCountry":["GB"],"customerCountry":{"availableAll":true},"email":{"required":true},"address":{"required":true},"repeat":["weekly","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},2819:function(e){"use strict";e.exports=JSON.parse('{"name":"ACH","provider":"stripe","donorPortalSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"dashboardSubscriptionEditor":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"widget":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]},"virtualTerminal":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once","biweekly","every4weeks","monthly","bimonthly","quarterly","semiannual","annual"]}}')},2139:function(e){"use strict";e.exports=JSON.parse('{"name":"Venmo","provider":"paypal","donorPortalSubscriptionEditor":{},"dashboardSubscriptionEditor":{},"widget":{"amount":{"availableAll":true},"currency":["USD"],"companyCountry":["US"],"customerCountry":{"availableAll":true},"email":{"required":false},"address":{"required":false},"repeat":["once"]},"virtualTerminal":{}}')}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=a,e=[],r.O=function(t,n,i,s){if(!n){var a=1/0;for(u=0;u<e.length;u++){n=e[u][0],i=e[u][1],s=e[u][2];for(var o=!0,l=0;l<n.length;l++)(!1&s||a>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[l])}))?n.splice(l--,1):(o=!1,s<a&&(a=s));if(o){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,i,s]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},n=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},r.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var s=Object.create(null);r.r(s);var a={};t=t||[null,n({}),n([]),n(n)];for(var o=2&i&&e;"object"==typeof o&&!~t.indexOf(o);o=n(o))Object.getOwnPropertyNames(o).forEach((function(t){a[t]=function(){return e[t]}}));return a.default=function(){return e},r.d(s,a),s},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return({173:"legacy-currency-filter",180:"checkout-locale19",234:"checkout-locale4",245:"checkout-locale3",326:"sentry",381:"checkout-locale10",425:"checkout-locale7",436:"checkout-locale2",471:"checkout-locale9",472:"checkout-sentry-vendor",496:"checkout-locale24",519:"checkout-locale23",561:"checkout-locale14",572:"checkout-locale11",616:"checkout-locale6",627:"checkout-locale5",639:"checkout-locale1",645:"checkout-rtl-styles",662:"checkout-locale8",706:"checkout-styles",710:"checkout-locale22",740:"checkout-locale20",752:"checkout-locale15",763:"checkout-locale16",775:"checkout-locale12",830:"checkout-locale0",901:"checkout-locale21",954:"checkout-locale17",966:"checkout-locale13",989:"checkout-locale18"}[e]||e)+"."+{91:"798f20e6e3c23af6dab4",173:"b9830a45e5af4ff3a485",180:"ce8a1cb0e292a23b8f38",234:"db379bb2837f3da2e9f0",245:"26fb588fbe58fe8e78af",326:"e809494c4ee0d2c12c27",381:"785ec768140d67beb14e",425:"a2e64c95945e48ec2e3e",436:"063894f2876b995e5141",471:"98c7b7224b8ed358c49b",472:"8bc953106b174ad55c35",496:"e2799be32fe0a51bca1f",519:"49fc9771eb106c5ee986",561:"f956f71cb2d40b768b26",572:"44a4969a0b92709dea46",616:"97a405cb8035f947c0c5",624:"1c828d6c0a0dc15ba452",627:"8779a22a0853ca8f5134",639:"0caddf9f8f541a8fd165",645:"7f7cb845d623180b317f",662:"8182e16380bb65743c8f",706:"58d18785ff1669f15305",710:"456d4e71c6d4c4abf65a",740:"563c317be28eaa938f6b",752:"9df4e1236e61fe9a91a2",763:"bcbda274c1b678690ded",772:"76ced162886cbccddff9",775:"468cc4a77635c471687e",806:"5004929529a1a3b0fb24",821:"05e20cef0feaab6e5e82",830:"d6e28b8eec12b8a184f2",842:"14ff6e44c65e540ea9d2",901:"e23dc61c0aae73849f1f",954:"27ed27a92c4e8b9c38f6",966:"df81e80050388a74a6e8",989:"0c0b59f6dfd50a72bd9d"}[e]+".js"},r.miniCssF=function(e){},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i={},s="@fundraiseup/checkout:",r.l=function(e,t,n,a){if(i[e])i[e].push(t);else{var o,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==s+n){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",s+n),o.src=e),i[e]=[t];var h=function(t,n){o.onerror=o.onload=null,clearTimeout(m);var s=i[e];if(delete i[e],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.p="https://static.fundraiseup.com/",function(){r.b=document.baseURI||self.location.href;var e={251:0};r.f.j=function(t,n){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise((function(n,s){i=e[t]=[n,s]}));n.push(i[2]=s);var a=r.p+r.u(t),o=new Error;r.l(a,(function(n){if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,i[1](o)}}),"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,a=n[0],o=n[1],l=n[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(l)var u=l(r)}for(t&&t(n);c<a.length;c++)s=a[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},n=self.webpackChunk_fundraiseup_checkout=self.webpackChunk_fundraiseup_checkout||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var l=r.O(void 0,[521],(function(){return r(7852)}));l=r.O(l)}();